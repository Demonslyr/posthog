# serializer version: 1
# name: TestSubscriptionEventsBuilder.test_build_subscription_queries_only_for_events_with_subscription_property
  '''
  SELECT subscription_id AS id,
         'revenue_analytics.events.subscription_charge' AS source_label,
         NULL AS plan_id,
         product_id AS product_id,
         toString(person_id) AS customer_id,
         NULL AS status,
         started_at AS started_at,
         ended_at AS ended_at,
         NULL AS metadata
  FROM
    (SELECT person.id AS person_id,
            properties.subscription_id AS subscription_id,
            min(properties.product_id) AS product_id,
            min(timestamp) AS started_at,
            max(timestamp) AS ended_at
     FROM events
     WHERE true
     GROUP BY subscription_id,
              person_id)
  ORDER BY started_at DESC
  '''
# ---
# name: TestSubscriptionEventsBuilder.test_query_structure_contains_required_fields
  '''
  SELECT subscription_id AS id,
         'revenue_analytics.events.subscription_charge' AS source_label,
         NULL AS plan_id,
         product_id AS product_id,
         toString(person_id) AS customer_id,
         NULL AS status,
         started_at AS started_at,
         ended_at AS ended_at,
         NULL AS metadata
  FROM
    (SELECT person.id AS person_id,
            properties.subscription_id AS subscription_id,
            min(properties.product_id) AS product_id,
            min(timestamp) AS started_at,
            max(timestamp) AS ended_at
     FROM events
     WHERE true
     GROUP BY subscription_id,
              person_id)
  ORDER BY started_at DESC
  '''
# ---
