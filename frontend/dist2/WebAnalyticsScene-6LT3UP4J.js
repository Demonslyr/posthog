import{a as wt}from"/static/chunk-OSFSBH6R.js";import{a as It}from"/static/chunk-WZKEGFTL.js";import"/static/chunk-JNQTMPE2.js";import{a as xt}from"/static/chunk-FB53JKJK.js";import"/static/chunk-ZDFMFKTJ.js";import{a as ht,c as Tt}from"/static/chunk-X3DMY2SE.js";import{a as St}from"/static/chunk-IVGZ2YI3.js";import"/static/chunk-CIEHRPUV.js";import{a as Ct}from"/static/chunk-LZ4U35M5.js";import{a as gt}from"/static/chunk-GH3IWF3M.js";import{e as vt,f as p,j as O}from"/static/chunk-CBJ7RAUW.js";import"/static/chunk-XSEDUXPL.js";import{b as ft}from"/static/chunk-NKVVAJQ7.js";import"/static/chunk-2HTNY362.js";import"/static/chunk-S27Q4QO6.js";import"/static/chunk-JUFFFVO5.js";import"/static/chunk-JZCOVRBI.js";import"/static/chunk-EIJECEWK.js";import{$c as Je,A as We,Ae as et,Al as ct,Bd as He,Bl as me,Cd as ae,Cl as mt,Do as b,Eo as pe,Ep as bt,Fb as Oe,Ha as Ue,Jk as lt,Ko as q,Lh as rt,Mb as $e,Mh as nt,Ml as pt,Nd as Ye,Nl as ut,Ob as Se,Pg as tt,Sa as V,Sd as f,Ta as F,Ue as R,Vh as st,Wb as De,Wd as te,Xd as Y,Zc as Xe,a as B,cc as Ve,ce as we,ch as ot,ga as W,h as ee,ha as Fe,ia as Me,ik as at,jc as Qe,ke as qe,m as D,ni as it,oe as Ke,pa as Ce,pe as je,pg as le,po as dt,r as g,se as Ze,ub as Re,vd as Ge,vo as yt,yc as ze,yg as ce,zl as oe}from"/static/chunk-RFJTZKD6.js";import"/static/chunk-XPJ4MQJV.js";import"/static/chunk-KQJ3FYBQ.js";import{F as G,Fa as Le,Ga as Ee,a as be,ea as H,fb as _e,hb as Be,sc as he,tc as Te}from"/static/chunk-3UDJFOQH.js";import"/static/chunk-HHT4SG7V.js";import"/static/chunk-K7LQKAJG.js";import"/static/chunk-QQTK3LZH.js";import"/static/chunk-IJQNM355.js";import"/static/chunk-4CN6THWS.js";import"/static/chunk-272RTCFX.js";import"/static/chunk-2ROB4QWU.js";import"/static/chunk-ALT2ZZSO.js";import"/static/chunk-UE6SLBBN.js";import"/static/chunk-GINZUAUY.js";import"/static/chunk-SQELCOUW.js";import"/static/chunk-IGYUTZ65.js";import"/static/chunk-YM6UBNGD.js";import"/static/chunk-C6TQ5FFZ.js";import"/static/chunk-GXGA523B.js";import"/static/chunk-N4MMWRNK.js";import"/static/chunk-NRLAI7OY.js";import"/static/chunk-LVVHNICT.js";import"/static/chunk-2AXSSSSX.js";import"/static/chunk-DGXQI7RB.js";import"/static/chunk-HUCRWDLX.js";import"/static/chunk-RFEQG3YN.js";import"/static/chunk-PUISI233.js";import{d as m,e as u,g as d,j as y}from"/static/chunk-SJXEOBQC.js";u();y();d();u();y();d();var ie=m(ee()),S=m(B());u();y();d();var Ie=m(g());function xe({shrinkOn:e,...t}){let{windowSize:{width:r=0}}=wt();return e!=null&&t.options.length>=e||r<t.options.length*100?(0,Ie.jsx)(je,{...t}):(0,Ie.jsx)(Ke,{...t})}var zt=m(be());u();y();d();var Nt=m(ee());var k=m(g()),Ht=e=>{let t=e.record;return(0,k.jsx)("div",{className:"flex items-start space-x-1.5 group",children:(0,k.jsx)(tt,{title:t.name||"Unknown Type",description:(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("div",{className:"line-clamp-1",children:t.description}),(0,k.jsx)("div",{className:"space-x-1",children:(0,k.jsx)(ot,{time:t.last_seen,className:"border-dotted border-b"})})]}),className:"flex-1",to:b.errorTrackingIssue(t.id)})})},Yt={extraDataTableQueryFeatures:[12],showOpenEditorButton:!1,showQueryEditor:!1,columns:{error:{width:"50%",render:Ht},users:{align:"right"},occurrences:{align:"right"}}},kt=({tile:e})=>{let{layout:t,query:r}=e,n=b.errorTracking();return(0,k.jsxs)("div",{className:(0,Nt.default)("col-span-1 row-span-1 flex flex-col",t.colSpanClassName??"md:col-span-6",t.rowSpanClassName??"md:row-span-1",t.orderWhenLargeClassName??"xxl:order-12",t.className),children:[(0,k.jsx)("h2",{className:"m-0 mb-3",children:"Error tracking"}),(0,k.jsx)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col py-2 px-1",children:(0,k.jsx)(O,{query:r,embedded:!0,context:Yt})}),(0,k.jsx)("div",{className:"flex flex-row-reverse my-2",children:(0,k.jsx)(f,{to:n,icon:(0,k.jsx)(W,{}),size:"small",type:"secondary",children:"View all"})})]})};u();y();d();var Pt=m(ee()),ue=m(B());var P=m(g());function At({tile:e}){let{layout:t}=e,{replayFilters:r,webAnalyticsFilters:n}=(0,ue.useValues)(p),{currentTeam:i}=(0,ue.useValues)(q),a=at({logicKey:"webAnalytics",filters:r}),{sessionRecordings:c,sessionRecordingsResponseLoading:l}=(0,ue.useValues)(a),h=c.slice(0,5),T=i?.session_recording_opt_in?n.length>0?{title:"There are no recordings matching the current filters",description:"Try changing the filters, or view all recordings.",buttonText:"View all",buttonTo:b.replay()}:{title:"There are no recordings matching this date range",description:"Make sure you have the javascript snippet setup in your website.",buttonText:"Learn more",buttonTo:"https://posthog.com/docs/user-guides/recordings"}:{title:"Recordings are not enabled for this project",description:"Once recordings are enabled, new recordings will display here.",buttonText:"Enable recordings",buttonTo:b.settings("project-replay","replay")},C=h.length>0?b.replay("home",r):b.replay();return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{className:(0,Pt.default)("col-span-1 row-span-1 flex flex-col",t.colSpanClassName??"md:col-span-6",t.rowSpanClassName??"md:row-span-1",t.orderWhenLargeClassName??"xxl:order-12",t.className),children:[(0,P.jsx)("h2",{className:"m-0 mb-3",children:"Session replay"}),(0,P.jsx)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col py-2 px-1",children:l?(0,P.jsx)("div",{className:"p-2 space-y-6",children:Array.from({length:6},(L,J)=>(0,P.jsx)(Ze,{},J))}):h.length===0&&T?(0,P.jsx)(Ct,{...T}):h.map((L,J)=>(0,P.jsx)(It,{recording:L},J))}),(0,P.jsx)("div",{className:"flex flex-row-reverse my-2",children:(0,P.jsx)(f,{to:C,icon:(0,P.jsx)(W,{}),size:"small",type:"secondary",children:"View all"})})]})})}u();y();d();var Pe=m(ee()),A=m(B());var z=m(be());u();y();d();var Ne=m(B());var E=m(g()),Kt=new Set(["Page","InitialPage","ExitPage","ExitClick"]),Et=({breakdownBy:e,value:t})=>{let{featureFlags:r}=(0,Ne.useValues)(D),{authorizedUrls:n}=(0,Ne.useValues)(Tt({actionId:null,experimentId:null,type:"TOOLBAR_URLS"}));if(t==="")return(0,E.jsx)(E.Fragment,{});if(!Kt.has(e))return(0,E.jsx)(E.Fragment,{});let i=n[0];if(!i)return(0,E.jsx)(f,{icon:(0,E.jsx)(Ce,{}),type:"tertiary",size:"xsmall",disabledReason:(0,E.jsxs)("span",{children:["No authorized URLs found. Authorize them first in"," ",(0,E.jsx)(F,{target:"blank",to:b.toolbarLaunch(),children:"the toolbar settings"}),"."]}),onClick:l=>l.stopPropagation()});let a=`${i}${t}`.replace(/\/\//,"/"),c=r[G.HEATMAPS_UI]?b.heatmaps(`pageURL=${a}`):ht(a,{userIntent:"heatmaps"});return(0,E.jsx)(f,{to:c,icon:(0,E.jsx)(Ce,{}),type:"tertiary",size:"xsmall",tooltip:"View heatmap for this page",className:"no-underline",targetBlank:!0,onClick:l=>{l.stopPropagation(),R({from:"web_analytics",to:"heatmaps",intent_context:"web_analytics_insight"})}})};u();y();d();var $=m(g()),Zt={DeviceType:"person",InitialPage:"session",ExitPage:"session",Page:"event",Browser:"person",OS:"person",InitialChannelType:"session",InitialReferringDomain:"session",InitialUTMSource:"session",InitialUTMCampaign:"session",InitialUTMMedium:"session",InitialUTMContent:"session",InitialUTMTerm:"session"},eo={DeviceType:"$device_type",InitialPage:"$entry_pathname",ExitPage:"$end_pathname",Page:"$pathname",Browser:"$browser",OS:"$os",InitialChannelType:"$channel_type",InitialReferringDomain:"$entry_referring_domain",InitialUTMSource:"$entry_utm_source",InitialUTMCampaign:"$entry_utm_campaign",InitialUTMMedium:"$entry_utm_medium",InitialUTMContent:"$entry_utm_content",InitialUTMTerm:"$entry_utm_term"},_t=({date_from:e,date_to:t,breakdownBy:r,value:n})=>{let i={icon:(0,$.jsx)(Xe,{}),type:"tertiary",size:"xsmall",tooltip:"View recordings",className:"no-underline",targetBlank:!0,onClick:l=>{l.stopPropagation(),R({from:"web_analytics",to:"session_replay",intent_context:"web_analytics_insight"})}};if(n==="")return(0,$.jsx)(f,{...i,to:b.replay("home",{date_from:e,date_to:t})});if(r==="Viewport")return(0,$.jsx)(f,{...i,to:b.replay("home",{date_from:e,date_to:t,filter_group:{type:"AND",values:[{type:"AND",values:[{key:"$viewport_width",type:"event",value:[n[0]],operator:"exact"},{key:"$viewport_height",type:"event",value:[n[1]],operator:"exact"}]}]}})});if(r==="InitialUTMSourceMediumCampaign"){let l=n.split(" / ");return(0,$.jsx)(f,{...i,to:b.replay("home",{date_from:e,date_to:t,filter_group:{type:"AND",values:[{type:"AND",values:[{key:"$entry_utm_source",type:"session",value:[l[0]||""],operator:"exact"},{key:"$entry_utm_medium",type:"session",value:[l[1]||""],operator:"exact"},{key:"$entry_utm_campaign",type:"session",value:[l[2]||""],operator:"exact"}]}]}})})}let a=Zt[r]||"person",c=eo[r];return!c||!a?(0,$.jsx)($.Fragment,{}):(0,$.jsx)(f,{...i,to:b.replay("home",{date_from:e,date_to:t,filter_group:{type:"AND",values:[{type:"AND",values:[{key:c,type:a,value:[n],operator:"exact"}]}]}})})};var o=m(g()),oo=e=>{if(e===0)return"UTC";let t=Math.floor(e),r=t>0?"+":"-",i=(e-t)*60,a=i>0?`:${i}`:"";return`UTC${r}${t}${a}`},M=({isPercentage:e,reverseColors:t}={isPercentage:!1,reverseColors:!1})=>{let r=n=>e?`${(n*100).toFixed(1)}%`:n?.toLocaleString()??"(empty)";return function({value:i}){let{compareFilter:a}=(0,A.useValues)(p);if(!i)return null;if(!Array.isArray(i))return(0,o.jsx)("span",{children:String(i)});let[c,l]=i,h=l===0&&c===0?0:c===null||!a||a.compare===!1?null:l===null||l===0?1/0:c/l-1,T=h===null?null:h===0?{Icon:Fe,color:H("muted")}:h>0?{Icon:Ge,color:t?H("danger"):H("success")}:{Icon:Me,color:t?H("success"):H("danger")},C=h!==null?`${c>=l?"Increased":"Decreased"} by ${Ee(Math.abs(h),0)} since last period (from ${r(l)} to ${r(c)})`:null;return(0,o.jsx)("div",{className:(0,Pe.default)({"pr-4":!T}),children:(0,o.jsx)(V,{title:C,children:(0,o.jsxs)("span",{children:[r(c),"\xA0",T&&(0,o.jsx)("span",{style:{color:T.color},children:(0,o.jsx)(T.Icon,{color:T.color,className:"ml-1"})})]})})})}},ro=e=>{let{query:t}=e,{source:r}=t;if(r.kind!=="WebStatsTableQuery")return null;let{breakdownBy:n}=r;switch(n){case"Page":return(0,o.jsx)(o.Fragment,{children:"Path"});case"InitialPage":return(0,o.jsx)(o.Fragment,{children:"Initial Path"});case"ExitPage":return(0,o.jsx)(o.Fragment,{children:"End Path"});case"ExitClick":return(0,o.jsx)(o.Fragment,{children:"Exit Click"});case"ScreenName":return(0,o.jsx)(o.Fragment,{children:"Screen Name"});case"InitialChannelType":return(0,o.jsx)(o.Fragment,{children:"Initial Channel Type"});case"InitialReferringDomain":return(0,o.jsx)(o.Fragment,{children:"Referring Domain"});case"InitialUTMSource":return(0,o.jsx)(o.Fragment,{children:"UTM Source"});case"InitialUTMCampaign":return(0,o.jsx)(o.Fragment,{children:"UTM Campaign"});case"InitialUTMMedium":return(0,o.jsx)(o.Fragment,{children:"UTM Medium"});case"InitialUTMTerm":return(0,o.jsx)(o.Fragment,{children:"UTM Term"});case"InitialUTMContent":return(0,o.jsx)(o.Fragment,{children:"UTM Content"});case"Browser":return(0,o.jsx)(o.Fragment,{children:"Browser"});case"OS":return(0,o.jsx)(o.Fragment,{children:"OS"});case"Viewport":return(0,o.jsx)(o.Fragment,{children:"Viewport"});case"DeviceType":return(0,o.jsx)(o.Fragment,{children:"Device Type"});case"Country":return(0,o.jsx)(o.Fragment,{children:"Country"});case"Region":return(0,o.jsx)(o.Fragment,{children:"Region"});case"City":return(0,o.jsx)(o.Fragment,{children:"City"});case"Timezone":return(0,o.jsx)(o.Fragment,{children:"Timezone"});case"Language":return(0,o.jsx)(o.Fragment,{children:"Language"});case"InitialUTMSourceMediumCampaign":return(0,o.jsx)(o.Fragment,{children:"Source / Medium / Campaign"});default:throw new Te(n)}},no=e=>{let{value:t,query:r}=e,{source:n}=r;if(n.kind!=="WebStatsTableQuery")return null;let{breakdownBy:i}=n;switch(i){case"ExitPage":case"InitialPage":case"Page":{if(typeof t!="string")return(0,o.jsx)(o.Fragment,{children:t});let a=Le(t);return(0,o.jsx)(o.Fragment,{children:n.doPathCleaning?lt(a):a})}case"Viewport":if(Array.isArray(t)){let[a,c]=t;return(0,o.jsxs)(o.Fragment,{children:[a,"x",c]})}break;case"Country":if(typeof t=="string"){let a=t;return(0,o.jsxs)(o.Fragment,{children:[oe(a)," ",me[a]||a]})}break;case"Region":if(Array.isArray(t)){let[a,c,l]=t;return(0,o.jsxs)(o.Fragment,{children:[oe(a)," ",me[a]||a," -"," ",l||c]})}break;case"City":if(Array.isArray(t)){let[a,c]=t;return(0,o.jsxs)(o.Fragment,{children:[oe(a)," ",me[a]||a," - ",c]})}break;case"Timezone":if(typeof t=="number")return(0,o.jsx)(o.Fragment,{children:oo(t)});break;case"Language":if(typeof t=="string"){let[a,c]=t.split("-"),l=c?.match(/([A-Z]{2})/)?.[0]??"";return(0,o.jsxs)(o.Fragment,{children:[oe(l)??ct(a),"\xA0",mt[a]||a]})}break}return typeof t=="string"?(0,o.jsx)(o.Fragment,{children:t}):null},U=(e,t)=>function(){let{tablesOrderBy:n}=(0,A.useValues)(p),{setTablesOrderBy:i}=(0,A.useActions)(p),{featureFlags:a}=(0,A.useValues)(D),c=n?.[0]===t,l=n?.[1]==="ASC",h=(0,z.useCallback)(()=>{!c||l?i(t,"DESC"):i(t,"ASC")},[l,c,i]);return a[G.WEB_ANALYTICS_TABLE_SORTING]?(0,o.jsxs)("span",{onClick:h,className:"group cursor-pointer inline-flex items-center",children:[e,(0,o.jsx)(Re,{fontSize:"20px",className:(0,Pe.default)("-mr-1 ml-1 text-muted-alt opacity-0 group-hover:opacity-100",{"text-primary opacity-100":c,"rotate-180":c&&l})})]}):(0,o.jsx)("span",{className:"pr-5",children:e})},Bt=e=>{switch(e){case"Page":return{key:"$pathname",type:"event"};case"InitialPage":return{key:"$entry_pathname",type:"session"};case"ExitPage":return{key:"$end_pathname",type:"session"};case"ExitClick":return{key:"$last_external_click_url",type:"session"};case"ScreenName":return{key:"$screen_name",type:"event"};case"InitialChannelType":return{key:"$channel_type",type:"session"};case"InitialReferringDomain":return{key:"$entry_referring_domain",type:"session"};case"InitialUTMSource":return{key:"$entry_utm_source",type:"session"};case"InitialUTMCampaign":return{key:"$entry_utm_campaign",type:"session"};case"InitialUTMMedium":return{key:"$entry_utm_medium",type:"session"};case"InitialUTMContent":return{key:"$entry_utm_content",type:"session"};case"InitialUTMTerm":return{key:"$entry_utm_term",type:"session"};case"Browser":return{key:"$browser",type:"event"};case"OS":return{key:"$os",type:"event"};case"Viewport":return{key:"$viewport",type:"event"};case"DeviceType":return{key:"$device_type",type:"event"};case"Country":return{key:"$geoip_country_code",type:"event"};case"Region":return{key:"$geoip_subdivision_1_code",type:"event"};case"City":return{key:"$geoip_city_name",type:"event"};case"Timezone":return{key:"$timezone",type:"event"};case"Language":return{key:"$geoip_language",type:"event"};case"InitialUTMSourceMediumCampaign":return;default:throw new Te(e)}},K={columns:{breakdown_value:{renderTitle:ro,render:no},bounce_rate:{renderTitle:U("Bounce Rate","BounceRate"),render:M({isPercentage:!0,reverseColors:!0}),align:"right"},views:{renderTitle:U("Views","Views"),render:M(),align:"right"},clicks:{renderTitle:U("Clicks","Clicks"),render:M(),align:"right"},visitors:{renderTitle:U("Visitors","Visitors"),render:M(),align:"right"},average_scroll_percentage:{renderTitle:U("Average Scroll","AverageScrollPercentage"),render:M({isPercentage:!0}),align:"right"},scroll_gt80_percentage:{renderTitle:U("Deep Scroll Rate","ScrollGt80Percentage"),render:M({isPercentage:!0}),align:"right"},total_conversions:{renderTitle:U("Total Conversions","TotalConversions"),render:M(),align:"right"},unique_conversions:{renderTitle:U("Unique Conversions","UniqueConversions"),render:M(),align:"right"},conversion_rate:{renderTitle:U("Conversion Rate","ConversionRate"),render:M({isPercentage:!0}),align:"right"},converting_users:{renderTitle:U("Converting Users","ConvertingUsers"),render:M(),align:"right"},action_name:{title:"Action"},cross_sell:{title:" ",render:({record:e,query:t})=>{let r=t.source?.dateRange,n=t.source?.breakdownBy,i=e[0]??"";return(0,o.jsxs)("div",{className:"flex flex-row items-center justify-end",children:[(0,o.jsx)(_t,{date_from:r?.date_from,date_to:r?.date_to,breakdownBy:n,value:i}),(0,o.jsx)(Et,{breakdownBy:n,value:i})]})},align:"right"}}},so=({query:e,showIntervalTile:t,insightProps:r})=>{let{togglePropertyFilter:n,setInterval:i}=(0,A.useActions)(p),{hasCountryFilter:a,dateFilter:{interval:c}}=(0,A.useValues)(p),l=Bt("Country")?.key,h=(0,z.useCallback)(C=>{l&&n("event",l,C,{geographyTab:a?void 0:"REGIONS"})},[n,l]),T=(0,z.useMemo)(()=>({...K,onDataPointClick({breakdown:C},L){C==="string"&&L&&(L.count>0||L.aggregated_value>0)&&h(C)},insightProps:{...r,query:e}}),[h,r]);return(0,o.jsxs)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col",children:[t&&(0,o.jsx)("div",{className:"flex flex-row items-center justify-end m-2 mr-4",children:(0,o.jsxs)("div",{className:"flex flex-row items-center",children:[(0,o.jsx)("span",{className:"mr-2",children:"Group by"}),(0,o.jsx)(ut,{interval:c,onIntervalChange:i,options:[{value:"hour",label:"Hour"},{value:"day",label:"Day"},{value:"week",label:"Week"},{value:"month",label:"Month"}]})]})}),(0,o.jsx)(O,{query:e,readOnly:!0,context:T})]})},io=({query:e,breakdownBy:t,insightProps:r,control:n})=>{let{togglePropertyFilter:i}=(0,A.useActions)(p),{key:a,type:c}=Bt(t)||{},l=(0,z.useCallback)(T=>{!a||!c||i(c,a,T)},[i,c,a]),h=(0,z.useMemo)(()=>({...K,insightProps:r,rowProps:C=>{if(!a||!c)return{};if(t==="Language"||t==="Timezone")return{};let L=ao(C,t);return L===void 0?{}:{onClick:()=>l(L)}}}),[l,r]);return(0,o.jsxs)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col",children:[n!=null&&(0,o.jsx)("div",{className:"flex flex-row items-center justify-end m-2 mr-4",children:n}),(0,o.jsx)(O,{query:e,readOnly:!0,context:h})]})},ao=(e,t)=>{if(typeof e!="object"||!e||!("result"in e))return;let r=e.result;if(!Array.isArray(r))return;let n=r[0];switch(t){case"Country":if(Array.isArray(n))return n[0];break;case"Region":if(Array.isArray(n))return n[1];break;case"City":if(Array.isArray(n))return n[1];break}if(n===null)return null;if(typeof n=="string")return n},lo=({query:e,insightProps:t})=>{let{actions:r,actionsLoading:n}=(0,A.useValues)(ce),{updateHasSeenProductIntroFor:i}=(0,A.useActions)(pe);return n?null:r.length?(0,o.jsxs)("div",{className:"border rounded bg-surface-primary flex-1",children:[(0,o.jsx)("div",{className:"flex flex-row-reverse p-2",children:(0,o.jsx)(f,{to:b.actions(),sideIcon:(0,o.jsx)(W,{}),type:"secondary",size:"small",children:"Manage actions"})}),(0,o.jsx)(O,{query:e,readOnly:!0,context:{...K,insightProps:t}})]}):(0,o.jsx)(gt,{productName:"Actions",productKey:"actions",thingName:"action",isEmpty:!0,description:"Use actions to combine events that you want to have tracked together or to make detailed Autocapture events easier to reuse.",docsURL:"https://posthog.com/docs/data/actions",actionElementOverride:(0,o.jsx)(xt,{onSelectOption:()=>i("actions",!0)})})},co=({query:e,insightProps:t})=>{let{shouldStripQueryParams:r}=(0,A.useValues)(p),{setShouldStripQueryParams:n}=(0,A.useActions)(p);return(0,o.jsxs)("div",{className:"border rounded bg-surface-primary flex-1 flex flex-col",children:[(0,o.jsx)("div",{className:"flex flex-row items-center justify-end m-2 mr-4",children:(0,o.jsx)("div",{className:"flex flex-row items-center space-x-2",children:(0,o.jsx)(Y,{label:"Strip query parameters",checked:r,onChange:n,className:"h-full"})})}),(0,o.jsx)(O,{query:e,readOnly:!0,context:{...K,insightProps:t}})]})},mo=({query:e,insightProps:t})=>{let{isPathCleaningEnabled:r}=(0,A.useValues)(p),{setIsPathCleaningEnabled:n}=(0,A.useActions)(p);return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"flex flex-row items-center gap-1 m-2",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold",children:"Path Breakdown"}),!r&&(0,o.jsx)(V,{title:(0,o.jsxs)("span",{children:["Path Breakdown is more useful when path cleaning is turned on."," ",(0,o.jsx)(F,{onClick:()=>n(!0),children:"Enable it."})]}),interactive:!0,children:(0,o.jsx)(He,{className:"mb-2",fontSize:"18"})})]}),(0,o.jsx)(O,{query:e,readOnly:!0,context:{...K,insightProps:t}})]})},re=({query:e,showIntervalSelect:t,control:r,insightProps:n})=>e.kind==="DataTableNode"&&e.source.kind==="WebStatsTableQuery"?(0,o.jsx)(io,{query:e,breakdownBy:e.source.breakdownBy,insightProps:n,control:r}):e.kind==="DataTableNode"&&e.source.kind==="WebExternalClicksTableQuery"?(0,o.jsx)(co,{query:e,insightProps:n}):e.kind==="InsightVizNode"?(0,o.jsx)(so,{query:e,showIntervalTile:t,insightProps:n}):e.kind==="DataTableNode"&&e.source.kind==="WebGoalsQuery"?(0,o.jsx)(lo,{query:e,insightProps:n}):e.kind==="WebVitalsPathBreakdownQuery"?(0,o.jsx)(mo,{query:e,insightProps:n}):(0,o.jsx)(O,{query:e,readOnly:!0,context:{...K,insightProps:n}});u();y();d();var Wt=m(B());var v=m(g()),Ft=()=>{let{statusCheck:e,conversionGoalWarning:t,productTab:r}=(0,Wt.useValues)(p);if(t)switch(t){case"CustomEventWithNoSessionId":return(0,v.jsxs)(te,{type:"warning",className:"mt-2",children:[(0,v.jsxs)("p",{children:["A custom event has been set as a conversion goal, but it has been seen with no"," ",(0,v.jsx)("code",{children:"$session_id"}),". This means that some queries will not be able to include these events."]}),(0,v.jsxs)("p",{children:["To fix this, please see"," ",(0,v.jsx)(F,{to:"https://posthog.com/docs/data/sessions#custom-session-ids",children:"documentation for custom session IDs"}),"."]})]})}if(!e)return null;if(r==="web-vitals"){if(!e.isSendingWebVitals)return(0,v.jsxs)(te,{type:"warning",className:"mt-2",children:[(0,v.jsxs)("p",{children:["No ",(0,v.jsx)("code",{children:"$web_vitals"})," events have been received. Web Vitals won't work correctly (it'll be a little empty!)"]}),(0,v.jsxs)("p",{children:["Please see"," ",(0,v.jsx)(F,{to:"https://posthog.com/docs/web-analytics/web-vitals",children:"documentation for how to set up web vitals"}),"."]})]})}else if(e.isSendingPageViews){if(!e.isSendingPageLeaves)return(0,v.jsxs)(te,{type:"warning",className:"mt-2",children:[(0,v.jsxs)("p",{children:["No ",(0,v.jsx)("code",{children:"$pageleave"})," events have been received, this means that Bounce rate and Session duration might be inaccurate."]}),(0,v.jsxs)("p",{children:["Please see"," ",(0,v.jsx)(F,{to:"https://posthog.com/docs/libraries/js",children:"documentation for how to set up posthog-js"}),"."]})]})}else return(0,v.jsxs)(te,{type:"warning",className:"mt-2",children:[(0,v.jsxs)("p",{children:["No ",(0,v.jsx)("code",{children:"$pageview"})," ",e.isSendingPageLeaves?null:(0,v.jsxs)(v.Fragment,{children:["or ",(0,v.jsx)("code",{children:"$pageleave"})," "]}),"events have been received. Web analytics won't work correctly (it'll be a little empty!)"]}),(0,v.jsxs)("p",{children:["Please see"," ",(0,v.jsx)(F,{to:"https://posthog.com/docs/libraries/js",children:"documentation for how to set up posthog-js"}),"."]})]});return null};u();y();d();var ge=m(B());u();y();d();var Mt=m(g()),ye=({webAnalyticsFilters:e,setWebAnalyticsFilters:t})=>(0,Mt.jsx)(rt,{taxonomicGroupTypes:["event_properties","person_properties","session_properties"],onChange:r=>t(r.filter(bt)),propertyFilters:e,pageKey:"web-analytics",eventNames:["$pageview"]});var _=m(g()),Ut=()=>{let{modal:e,dateFilter:{dateFrom:t,dateTo:r},webAnalyticsFilters:n}=(0,ge.useValues)(p),{closeModal:i,setDates:a,setWebAnalyticsFilters:c}=(0,ge.useActions)(p);return e?(0,_.jsx)(we,{isOpen:!!e,onClose:i,simple:!1,title:e?.title||"",width:1600,fullScreen:!1,closable:!0,children:(0,_.jsxs)("div",{className:"WebAnalyticsModal space-y-4",children:[(0,_.jsxs)("div",{className:"flex flex-row flex-wrap gap-2",children:[(0,_.jsx)(ye,{setWebAnalyticsFilters:c,webAnalyticsFilters:n}),(0,_.jsx)(le,{dateFrom:t,dateTo:r,onChange:a})]}),(0,_.jsx)(we.Content,{embedded:!0,children:(0,_.jsx)(re,{query:e.query,insightProps:e.insightProps,showIntervalSelect:e.showIntervalSelect,control:e.control})}),(0,_.jsx)("div",{className:"flex flex-row justify-end",children:e.canOpenInsight?(0,_.jsx)(f,{to:b.insightNew({query:e.query}),icon:(0,_.jsx)(W,{}),size:"small",type:"secondary",onClick:()=>{R({from:"web_analytics",to:"product_analytics",intent_context:"web_analytics_insight"})},children:"Open as new Insight"}):null})]})}):null};u();y();d();var se=m(B());var Rt=m(be());var ne=m(g()),Ot=()=>{let{conversionGoal:e}=(0,se.useValues)(p),{setConversionGoal:t}=(0,se.useActions)(p),{actions:r}=(0,se.useValues)(ce),[n,i]=(0,Rt.useState)("custom_events"),a=e&&"actionId"in e?e.actionId:e?.customEventName;return(0,ne.jsx)(nt,{allowClear:!0,"data-attr":"web-analytics-conversion-filter",groupType:n,value:a,onChange:(c,l)=>{l==="actions"&&typeof c=="number"?(t({actionId:c}),i("actions")):l==="custom_events"&&typeof c=="string"&&c?(t({customEventName:c}),i("custom_events")):t(null)},renderValue:()=>{if(e){if("actionId"in e){let c=r.find(l=>l.id===e.actionId);return(0,ne.jsx)("span",{className:"text-overflow max-w-full",children:c?.name??"Conversion goal"})}}else return null;return(0,ne.jsx)("span",{className:"text-overflow max-w-full",children:e?.customEventName})},groupTypes:["custom_events","actions"],icon:(0,ne.jsx)(Oe,{}),placeholder:"Add conversion goal",placeholderClass:"",size:"small"})};u();y();d();var $t=m(ee()),fe=m(B());var j=m(g()),yo={Visitors:"Visitors",Views:"Views",Clicks:"Clicks",BounceRate:"Bounce rate",AverageScrollPercentage:"Average scroll percentage",ScrollGt80Percentage:"Scroll > 80%",TotalConversions:"Total conversions",UniqueConversions:"Unique conversions",ConversionRate:"Conversion rate",ConvertingUsers:"Converting users"},Dt=()=>{let{tablesOrderBy:e}=(0,fe.useValues)(p),{clearTablesOrderBy:t}=(0,fe.useActions)(p);return e?(0,j.jsx)(f,{type:"secondary",size:"small",icon:(0,j.jsx)(Ue,{className:(0,$t.default)({"rotate-180":e[1]==="ASC"})}),sideIcon:(0,j.jsx)(ae,{}),onClick:t,children:(0,j.jsxs)("span",{children:["Sort by: ",yo[e[0]]]})}):null};u();y();d();var Ae=m(B());u();y();d();var w=m(B());var Vt=(0,w.kea)([(0,w.path)(["scenes","activity","live-events","liveEventsTableLogic"]),(0,w.connect)({values:[q,["currentTeam"],D,["featureFlags"]]}),(0,w.actions)(()=>({pollStats:!0,setLiveUserCount:({liveUserCount:e,now:t})=>({liveUserCount:e,now:t}),setNow:({now:e})=>({now:e})})),(0,w.reducers)({liveUserCount:[null,{setLiveUserCount:(e,{liveUserCount:t})=>t}],statsUpdatedTime:[null,{setLiveUserCount:(e,{now:t})=>t}],now:[null,{setNow:(e,{now:t})=>t,setLiveUserCount:(e,{now:t})=>t}]}),(0,w.selectors)({liveUserUpdatedSecondsAgo:[e=>[e.statsUpdatedTime,e.now],(e,t)=>{if(!e||!t)return null;let r=Math.ceil((t.getTime()-e.getTime())/1e3);return r<0||r>=300?null:r}]}),(0,w.listeners)(({actions:e,values:t})=>({pollStats:async()=>{try{if(!t.currentTeam)return;let i=(await(await fetch(`${it()}/stats`,{headers:{Authorization:`Bearer ${t.currentTeam.live_events_token}`}})).json()).users_on_product||0;e.setLiveUserCount({liveUserCount:i,now:new Date})}catch(r){console.error("Failed to poll stats:",r)}}})),(0,w.events)(({actions:e,cache:t})=>({afterMount:()=>{e.setNow({now:new Date}),e.pollStats(),t.statsInterval=setInterval(()=>{e.pollStats()},3e4),t.nowInterval=setInterval(()=>{e.setNow({now:new Date})},500)},beforeUnmount:()=>{t.statsInterval&&(clearInterval(t.statsInterval),t.statsInterval=null)}}))]);var X=m(g()),Qt=()=>{let{liveUserCount:e,liveUserUpdatedSecondsAgo:t}=(0,Ae.useValues)(Vt),{currentTeam:r}=(0,Ae.useValues)(q);if(e==null)return null;let n=`${_e(e)} ${e===1?"user is":"users are"} online`,i=r?` in ${r.name}`:"",a=t===0?" (updated just now)":t==null?"":` (updated ${t} seconds ago)`,c=`${n}${i}${a}`;return(0,X.jsx)("div",{className:"hidden sm:flex items-center mb-2 border-b",children:(0,X.jsx)(V,{title:c,children:(0,X.jsxs)("span",{className:"whitespace-nowrap","data-attr":"web-analytics-live-user-count",children:[(0,X.jsx)(Qe,{})," ",(0,X.jsx)("strong",{children:Be(e)})," currently online"]})})})};var s=m(g()),go=()=>{let{webAnalyticsFilters:e,dateFilter:{dateTo:t,dateFrom:r},compareFilter:n,productTab:i,webVitalsPercentile:a}=(0,S.useValues)(p),{setWebAnalyticsFilters:c,setDates:l,setCompareFilter:h,setWebVitalsPercentile:T}=(0,S.useActions)(p),{hasAvailableFeature:C}=(0,S.useValues)(pe),L=C("paths_advanced"),J=(0,s.jsx)(ye,{setWebAnalyticsFilters:c,webAnalyticsFilters:e});return(0,s.jsxs)("div",{className:"flex flex-row flex-wrap gap-2 md:[&>*]:grow-0 [&>*]:grow",children:[(0,s.jsx)(le,{dateFrom:r,dateTo:t,onChange:l,allowTimePrecision:!0}),i==="analytics"?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(pt,{compareFilter:n,updateCompareFilter:h}),(0,s.jsx)(Ot,{}),(0,s.jsx)(Dt,{})]}):(0,s.jsx)(xe,{size:"small",value:a,onChange:T,options:[{value:"p75",label:"P75"},{value:"p90",label:(0,s.jsx)(V,{title:"P90 is recommended by the standard as a good baseline",delayMs:0,children:"P90"})},{value:"p99",label:"P99"}]}),L&&(0,s.jsx)(fo,{}),(0,s.jsx)("div",{className:"hidden md:block",children:J}),(0,s.jsx)("div",{className:"xl:ml-auto",children:(0,s.jsx)(ft,{})}),(0,s.jsx)("div",{className:"block md:hidden",children:J})]})},fo=()=>{let{isPathCleaningEnabled:e}=(0,S.useValues)(p),{setIsPathCleaningEnabled:t}=(0,S.useActions)(p);return(0,s.jsx)(V,{title:(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsx)("p",{className:"mb-2",children:"Path cleaning helps standardize URLs by removing unnecessary parameters and fragments."}),(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsx)(F,{to:"https://posthog.com/docs/product-analytics/paths#path-cleaning-rules",children:"Learn more about path cleaning rules"})}),(0,s.jsx)(f,{icon:(0,s.jsx)(De,{}),type:"primary",size:"small",to:b.settings("project-product-analytics","path-cleaning"),targetBlank:!0,className:"w-full",children:"Edit path cleaning settings"})]}),placement:"top",interactive:!0,children:(0,s.jsxs)(f,{icon:(0,s.jsx)(We,{}),onClick:()=>t(!e),type:"secondary",size:"small",children:["Path cleaning: ",(0,s.jsx)(Y,{checked:e,className:"ml-1",size:"xsmall"})]})})},vo=()=>{let{tiles:e}=(0,S.useValues)(p);return(0,s.jsx)("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 xxl:grid-cols-3 gap-x-4 gap-y-12",children:e.map((t,r)=>t.kind==="query"?(0,s.jsx)(bo,{tile:t},r):t.kind==="tabs"?(0,s.jsx)(ho,{tile:t},r):t.kind==="replay"?(0,s.jsx)(At,{tile:t},r):t.kind==="error_tracking"?(0,s.jsx)(kt,{tile:t},r):null)})},bo=({tile:e})=>{let{query:t,title:r,layout:n,insightProps:i,control:a,showIntervalSelect:c,docs:l}=e,{openModal:h}=(0,S.useActions)(p),{getNewInsightUrl:T}=(0,S.useValues)(p),C=[e.canOpenInsight?(0,s.jsx)(f,{to:T(e.tileId),icon:(0,s.jsx)(W,{}),size:"small",type:"secondary",onClick:()=>{R({from:"web_analytics",to:"product_analytics",intent_context:"web_analytics_insight"})},children:"Open as new Insight"},"open-insight-button"):null,e.canOpenModal?(0,s.jsx)(f,{onClick:()=>h(e.tileId),icon:(0,s.jsx)(Se,{}),size:"small",type:"secondary",children:"Show more"},"open-modal-button"):null].filter(he);return(0,s.jsxs)("div",{className:(0,ie.default)("col-span-1 row-span-1 flex flex-col",n.colSpanClassName??"md:col-span-6",n.rowSpanClassName??"md:row-span-1",n.orderWhenLargeClassName??"xxl:order-12",n.className),children:[r&&(0,s.jsxs)("h2",{className:"flex-1 m-0 flex flex-row ml-1",children:[r,l&&(0,s.jsx)(Xt,{url:l.url,title:l.title,description:l.description})]}),(0,s.jsx)(re,{query:t,insightProps:i,control:a,showIntervalSelect:c}),C.length>0?(0,s.jsx)("div",{className:"flex justify-end my-2 space-x-2",children:C}):null]})},ho=({tile:e})=>{let{layout:t}=e,{openModal:r}=(0,S.useActions)(p),{getNewInsightUrl:n}=(0,S.useValues)(p);return(0,s.jsx)(To,{className:(0,ie.default)("col-span-1 row-span-1",t.colSpanClassName||"md:col-span-1",t.rowSpanClassName||"md:row-span-1",t.orderWhenLargeClassName||"xxl:order-12",t.className),activeTabId:e.activeTabId,setActiveTabId:e.setTabId,tabs:e.tabs.map(i=>({id:i.id,content:(0,s.jsx)(re,{query:i.query,showIntervalSelect:i.showIntervalSelect,control:i.control,insightProps:i.insightProps},i.id),linkText:i.linkText,title:i.title,canOpenModal:!!i.canOpenModal,canOpenInsight:!!i.canOpenInsight,query:i.query,docs:i.docs})),tileId:e.tileId,openModal:r,getNewInsightUrl:n})},To=({className:e,activeTabId:t,tabs:r,setActiveTabId:n,openModal:i,getNewInsightUrl:a,tileId:c})=>{let l=r.find(C=>C.id===t),h=a(c,t),T=[l?.canOpenInsight&&h?(0,s.jsx)(f,{to:h,icon:(0,s.jsx)(W,{}),size:"small",type:"secondary",onClick:()=>{R({from:"web_analytics",to:"product_analytics",intent_context:"web_analytics_insight"})},children:"Open as new Insight"},"open-insight-button"):null,l?.canOpenModal?(0,s.jsx)(f,{onClick:()=>i(c,t),icon:(0,s.jsx)(Se,{}),size:"small",type:"secondary",children:"Show more"},"open-modal-button"):null].filter(he);return(0,s.jsxs)("div",{className:(0,ie.default)(e,"flex flex-col"),children:[(0,s.jsxs)("div",{className:"flex flex-row items-center self-stretch mb-3",children:[(0,s.jsxs)("h2",{className:"flex-1 m-0 flex flex-row ml-1",children:[l?.title,l?.docs&&(0,s.jsx)(Xt,{url:l.docs.url,title:l.docs.title,description:l.docs.description})]}),(0,s.jsx)(xe,{shrinkOn:7,size:"small",disabled:!1,value:t,dropdownMatchSelectWidth:!1,onChange:n,options:r.map(({id:C,linkText:L})=>({value:C,label:L}))})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col",children:l?.content}),T.length>0?(0,s.jsx)("div",{className:"flex justify-end my-2 space-x-2",children:T}):null]})},Xt=({url:e,title:t,description:r})=>{let[n,i]=(0,zt.useState)(!1);return(0,s.jsx)(Ye,{visible:n,onClickOutside:()=>i(!1),overlay:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex flex-row w-full",children:[(0,s.jsx)("h2",{className:"flex-1",children:t}),(0,s.jsx)(f,{targetBlank:!0,type:"tertiary",onClick:()=>i(!1),size:"small",icon:(0,s.jsx)(ae,{})})]}),(0,s.jsx)("div",{className:"text-sm text-gray-700",children:r}),e&&(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)(f,{to:e,onClick:()=>i(!1),targetBlank:!0,sideIcon:(0,s.jsx)(ze,{}),children:"Learn more"})})]}),children:(0,s.jsx)(f,{onClick:()=>i(!n),size:"small",icon:(0,s.jsx)(Ve,{}),className:"ml-1 mb-1"})})},Jt=()=>{let{mobileLayout:e}=(0,S.useValues)(dt),{featureFlags:t}=(0,S.useValues)(D),{productTab:r}=(0,S.useValues)(p),{setProductTab:n}=(0,S.useActions)(p);return(0,s.jsx)(S.BindLogic,{logic:p,props:{},children:(0,s.jsxs)(S.BindLogic,{logic:st,props:{key:vt},children:[(0,s.jsx)(Ut,{}),(0,s.jsx)(St,{}),(0,s.jsxs)("div",{className:"WebAnalyticsDashboard w-full flex flex-col",children:[(0,s.jsxs)("div",{className:(0,ie.default)("sticky z-20 bg-primary border-b pb-2",e?"top-[var(--breadcrumbs-height-full)]":"top-[var(--breadcrumbs-height-compact)]"),children:[(0,s.jsxs)("div",{className:"flex flex-row",children:[t[G.WEB_VITALS]&&(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(et,{size:"small",activeKey:r,onChange:n,tabs:[{key:"analytics",label:"Web analytics"},{key:"web-vitals",label:"Web vitals"}]})}),(0,s.jsx)(Qt,{})]}),(0,s.jsx)(go,{})]}),(0,s.jsx)(Ft,{}),(0,s.jsx)(vo,{})]})]})})};u();y();d();var ve=m(B());var Z=m(g()),Gt=()=>{let{shouldFilterTestAccounts:e}=(0,ve.useValues)(p),{setShouldFilterTestAccounts:t}=(0,ve.useActions)(p);return(0,Z.jsx)(qe,{items:[{label:"Session Attribution Explorer",to:b.sessionAttributionExplorer(),icon:(0,Z.jsx)(Je,{})},{label:()=>(0,Z.jsx)(Y,{checked:e,onChange:()=>{t(!e)},fullWidth:!0,label:"Filter test accounts"})}],closeOnClickInside:!1,children:(0,Z.jsx)(f,{icon:(0,Z.jsx)($e,{}),size:"small"})})};var Q=m(g());function Co(){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(yt,{buttons:(0,Q.jsx)(Gt,{})}),(0,Q.jsx)(Jt,{})]})}var Ii={component:Co,logic:p};export{Co as WebAnalyticsScene,Ii as scene};
//# sourceMappingURL=/static/WebAnalyticsScene-6LT3UP4J.js.map
