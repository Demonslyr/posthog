import{Io as t,Tf as U,Za as F,a as y,de as d,ie as l,r as c,re as f}from"/static/chunk-RFJTZKD6.js";import{d as n,e as a,g as m,j as G}from"/static/chunk-SJXEOBQC.js";a();G();m();var u=n(y()),g=n(F());var i=n(c()),C=(0,u.kea)([(0,u.path)(["scenes","settings","environment","userGroupsLogic"]),(0,u.actions)({ensureAllGroupsLoaded:!0,openGroupCreationForm:!0,setSearch:r=>({search:r})}),(0,u.reducers)({search:["",{setSearch:(r,{search:e})=>e}]}),(0,g.loaders)(({values:r})=>({userGroups:[[],{loadUserGroups:async()=>(await t.userGroups.list()).results,deleteUserGroup:async e=>(await t.userGroups.delete(e),[...r.userGroups].filter(o=>o.id!==e)),createUserGroup:async e=>{let s=await t.userGroups.create(e);return[...r.userGroups,s]},addMember:async({id:e,user:s})=>{let o=r.userGroups.find(p=>p.id===e);return o?(await t.userGroups.addMember(e,s.id),o.members=[...o.members,s],r.userGroups.map(p=>p.id===e?o:p)):r.userGroups},removeMember:async({id:e,user:s})=>{let o=r.userGroups.find(p=>p.id===e);return o?(await t.userGroups.removeMember(e,s.id),o.members=o.members.filter(p=>p.id!==s.id),r.userGroups.map(p=>p.id===e?o:p)):r.userGroups}}]})),(0,u.selectors)({userGroupsFuse:[r=>[r.userGroups],r=>new f(r,{keys:["name"],threshold:.3})],filteredGroups:[r=>[r.userGroups,r.userGroupsFuse,r.search],(r,e,s)=>s?e.search(s).map(o=>o.item):r??[]]}),(0,u.listeners)(({values:r,actions:e})=>({openGroupCreationForm:()=>{d.openForm({title:"Create user group",initialValues:{name:""},content:(0,i.jsx)(U,{name:"name",children:(0,i.jsx)(l,{placeholder:"Name",autoFocus:!0})}),errors:{name:s=>s?void 0:"You must enter a name"},onSubmit:({name:s})=>e.createUserGroup(s)})},ensureAllGroupsLoaded:()=>{r.userGroupsLoading||r.userGroups.length===0&&e.loadUserGroups()}}))]);export{C as a};
//# sourceMappingURL=/static/chunk-FCOMHTD6.js.map
