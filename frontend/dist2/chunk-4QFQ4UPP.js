import{$m as P,Eo as C,Io as a,Za as N,a as T,fn as y,hg as f,mn as A,on as b}from"/static/chunk-RFJTZKD6.js";import{Da as M}from"/static/chunk-3UDJFOQH.js";import{d,e as l,g,j as c}from"/static/chunk-SJXEOBQC.js";l();c();g();var t=d(T()),I=d(N());var H=(0,t.kea)([(0,t.path)(["scenes","pipeline","frontendAppsLogic"]),(0,t.connect)({values:[f,["currentProjectId"],C,["user"]]}),(0,t.actions)({loadPluginConfigs:!0,updatePluginConfig:e=>({pluginConfig:e})}),(0,I.loaders)(({values:e})=>({plugins:[{},{loadPlugins:async()=>A("api/organizations/@current/pipeline_frontend_apps")}],pluginConfigs:[{},{loadPluginConfigs:async()=>{let r=await a.loadPaginatedResults(`api/projects/${e.currentProjectId}/pipeline_frontend_apps_configs`);return Object.fromEntries(r.map(n=>[n.id,n]))},toggleEnabled:async({id:r,enabled:n})=>{if(!b("site-app",n))return e.pluginConfigs;let{pluginConfigs:s,plugins:u}=e,o=s[r],m=u[o.plugin];y(`plugin ${n?"enabled":"disabled"}`,m,o);let _=await a.update(`api/plugin_config/${r}`,{enabled:n});return{...s,[r]:_}},updatePluginConfig:({pluginConfig:r})=>({...e.pluginConfigs,[r.id]:r})}]})),(0,t.selectors)({loading:[e=>[e.pluginsLoading,e.pluginConfigsLoading],(e,r)=>e||r],frontendApps:[e=>[e.plugins,e.pluginConfigs],(e,r)=>Object.values(r).map(o=>({...o,plugin_info:e[o.plugin]||null})).map(o=>P(o,"site-app")).sort((o,m)=>Number(m.enabled)-Number(o.enabled))]}),(0,t.afterMount)(({actions:e})=>{e.loadPlugins(),e.loadPluginConfigs()})]);l();c();g();var p=d(T()),j=d(N());var ie=(0,p.kea)([(0,p.path)(["scenes","pipeline","importAppsLogic"]),(0,p.connect)({values:[f,["currentProjectId"],C,["user"]]}),(0,p.actions)({loadPluginConfigs:!0,updatePluginConfig:e=>({pluginConfig:e})}),(0,j.loaders)(({values:e})=>({plugins:[{},{loadPlugins:async()=>A("api/organizations/@current/pipeline_import_apps")}],pluginConfigs:[{},{loadPluginConfigs:async()=>{let r=await a.loadPaginatedResults(`api/projects/${e.currentProjectId}/pipeline_import_apps_configs`);return Object.fromEntries(r.map(n=>[n.id,n]))},toggleEnabled:async({id:r,enabled:n})=>{if(!b("legacy-source",n))return e.pluginConfigs;let{pluginConfigs:s,plugins:u}=e,o=s[r],m=u[o.plugin];y(`plugin ${n?"enabled":"disabled"}`,m,o);let _=await a.update(`api/plugin_config/${r}`,{enabled:n});return{...s,[r]:_}},updatePluginConfig:({pluginConfig:r})=>({...e.pluginConfigs,[r.id]:r})}]})),(0,p.selectors)({loading:[e=>[e.pluginsLoading,e.pluginConfigsLoading],(e,r)=>e||r],importApps:[e=>[e.plugins,e.pluginConfigs],(e,r)=>Object.values(r).map(o=>({...o,plugin_info:e[o.plugin]||null})).map(o=>P(o,"legacy-source")).sort((o,m)=>Number(m.enabled)-Number(o.enabled))],hasEnabledImportApps:[e=>[e.importApps],e=>e.some(r=>r.enabled)]}),(0,p.afterMount)(({actions:e})=>{e.loadPlugins(),e.loadPluginConfigs()})]);l();c();g();var le=e=>{switch(e){case"HTTP":return"PostHog HTTP";default:return e}};l();c();g();var i=d(T()),D=d(N());var h="-7d",ye=(0,i.kea)([(0,i.props)({}),(0,i.key)(({id:e})=>e),(0,i.path)(e=>["scenes","pipeline","appMetricsLogic",e]),(0,i.connect)({values:[f,["currentProjectId"]]}),(0,i.actions)({setDateRange:(e,r)=>({from:e,to:r}),openErrorDetailsModal:e=>({errorType:e}),closeErrorDetailsModal:!0}),(0,D.loaders)(({values:e,props:r})=>({appMetricsResponse:[null,{loadMetrics:async()=>{let n=M({date_from:e.dateRange.from,date_to:e.dateRange.to});return await a.get(`api/projects/${e.currentProjectId}/app_metrics/${r.id}?${n}`)}}],errorDetails:[[],{openErrorDetailsModal:async({errorType:n})=>{let s=M({error_type:n}),{result:u}=await a.get(`api/projects/${e.currentProjectId}/app_metrics/${r.id}/error_details?${s}`);return u}}]})),(0,i.reducers)({dateRange:[{from:h,to:null},{setDateRange:(e,{from:r,to:n})=>({from:r??h,to:n})}],errorDetailsModalError:[null,{openErrorDetailsModal:(e,{errorType:r})=>r,closeErrorDetailsModal:()=>null}]}),(0,i.listeners)(({actions:e})=>({setDateRange:()=>{e.loadMetrics()}})),(0,i.afterMount)(({actions:e})=>{e.loadMetrics()})]);export{le as a,H as b,ie as c,ye as d};
//# sourceMappingURL=/static/chunk-4QFQ4UPP.js.map
