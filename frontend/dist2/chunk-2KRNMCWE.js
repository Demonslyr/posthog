import{a as Z}from"/static/chunk-4QFQ4UPP.js";import{a as W}from"/static/chunk-LYMEBJGW.js";import{a as Q}from"/static/chunk-QIBQKJHN.js";import{$d as R,Ai as J,Bi as M,Do as N,Eo as b,Io as Y,Pg as G,Sd as F,Ta as S,Tc as w,Wm as V,Za as se,_m as U,a as B,f as oe,hn as K,ie as z,m as C,pe as O,qn as T,r as h,re as X,tn as q,ze as $}from"/static/chunk-RFJTZKD6.js";import{F as v,o as I}from"/static/chunk-3UDJFOQH.js";import{d as l,e as d,g as f,j as y}from"/static/chunk-SJXEOBQC.js";d();y();f();var D=l(B());d();y();f();var E=l(B());d();y();f();var L=l(h());function j({stage:e,size:n}){return(0,L.jsxs)(F,{"data-attr":`new-${e}`,to:N.pipelineNodeNew(e),type:"primary",icon:(0,L.jsx)(w,{}),size:n,children:["New ",e]})}var m=l(h());function te({types:e,hideSearch:n,hideShowPaused:p,hideKind:r,hideFeedback:t,hideAddDestinationButton:s=!0}){let{filters:c}=(0,E.useValues)(T({types:e})),{setFilters:u,openFeedbackDialog:g}=(0,E.useActions)(T({types:e})),a=e.includes("transformation");return(0,m.jsx)("div",{className:"space-y-2",children:(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[!n&&(0,m.jsx)(z,{type:"search",placeholder:"Search...",value:c.search??"",onChange:P=>u({search:P})}),t?null:(0,m.jsx)(S,{className:"text-sm font-semibold",subtle:!0,onClick:()=>g(),children:"Can't find what you're looking for?"}),(0,m.jsx)("div",{className:"flex-1"}),typeof p!="boolean"&&(0,m.jsx)(R,{label:"Show paused",bordered:!0,size:"small",checked:c.showPaused,onChange:P=>u({showPaused:P??void 0})}),!r&&!a&&(0,m.jsx)(O,{type:"secondary",size:"small",options:[{label:"All kinds",value:null},{label:"Realtime",value:"hog_function"},{label:"Batch exports",value:"batch_export"}].filter(Boolean),value:c.kind??null,onChange:P=>u({kind:P??null})}),s?null:(0,m.jsx)(j,{stage:a?"transformation":"destination",size:"small"})]})})}d();y();f();var o=l(B()),ie=l(se()),k=l(oe());var H=l(h()),ne=(0,o.kea)([(0,o.path)(()=>["scenes","pipeline","destinations","newDestinationsLogic"]),(0,o.props)({}),(0,o.key)(e=>e.types.join(",")??""),(0,o.connect)(({types:e})=>({values:[b,["user"],C,["featureFlags"],T({types:e}),["filters"]]})),(0,o.actions)({openFeedbackDialog:!0}),(0,ie.loaders)(({props:e,values:n})=>({hogFunctionTemplates:[{},{loadHogFunctionTemplates:async()=>{let r=!!n.featureFlags[v.SITE_DESTINATIONS]?e.types:e.types.filter(s=>s!=="site_destination");return(await Y.hogFunctions.listTemplates({types:r})).results.reduce((s,c)=>(s[c.id]=c,s),{})}}]})),(0,o.selectors)(()=>({loading:[e=>[e.hogFunctionTemplatesLoading],e=>e],types:[()=>[(e,n)=>n.types],e=>e],batchExportServiceNames:[e=>[e.user,e.featureFlags,e.types],(e,n,p)=>{if(!p.includes("destination"))return[];let r=n[v.BATCH_EXPORTS_POSTHOG_HTTP]||e?.is_impersonated||e?.is_staff;return I.filter(s=>r?!0:s!=="HTTP")}],destinations:[e=>[e.hogFunctionTemplates,e.batchExportServiceNames,k.router.selectors.hashParams,e.user],(e,n,p,r)=>[...Object.values(e).filter(t=>W(t,r)).map(t=>({icon:(0,H.jsx)(q,{size:"small",src:t.icon_url}),name:t.name,description:t.description,backend:"hog_function",url:(0,k.combineUrl)(N.pipelineNodeNew(U(t.type),`hog-${t.id}`),{},p).url,status:t.status,free:t.free})),...n.map(t=>({icon:(0,H.jsx)(K,{type:t}),name:Z(t),description:`${t} batch export`,backend:"batch_export",url:N.pipelineNodeNew("destination",`${t}`),free:!1}))]],destinationsFuse:[e=>[e.destinations],e=>new X(e||[],{keys:["name","description"],threshold:.3})],filteredDestinations:[e=>[e.filters,e.destinations,e.destinationsFuse],(e,n,p)=>{let{search:r,kind:t}=e;return(r?p.search(r).map(s=>s.item):n).filter(s=>!(t&&s.backend!==t))}],hiddenDestinations:[e=>[e.destinations,e.filteredDestinations],(e,n)=>e.filter(p=>!n.includes(p))]})),(0,o.afterMount)(({actions:e})=>{e.loadHogFunctionTemplates()})]);var i=l(h());function rt({types:e}){return(0,i.jsxs)("div",{className:"space-y-2",children:[e.includes("destination")?(0,i.jsx)(M,{feature:"data_pipelines"}):null,(0,i.jsx)(te,{types:e,hideShowPaused:!0}),(0,i.jsx)(ae,{types:e})]})}function ae({types:e}){let{loading:n,filteredDestinations:p,hiddenDestinations:r}=(0,D.useValues)(ne({types:e})),{canEnableDestination:t}=(0,D.useValues)(V),{resetFilters:s}=(0,D.useActions)(T({types:e})),{user:c}=(0,D.useValues)(b);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{dataSource:p,size:"small",loading:n,columns:[{title:"App",width:0,render:(u,g)=>g.icon},{title:"Name",sticky:!0,key:"name",sorter(u,g){return u.name.localeCompare(g.name)},render:function(g,a){return(0,i.jsx)(G,{to:t(a)?a.url:void 0,title:(0,i.jsxs)(i.Fragment,{children:[a.name,a.status&&(0,i.jsx)(Q,{status:a.status})]}),description:a.description})}},{width:100,align:"right",render:function(g,a){return t(a)?(0,i.jsx)(F,{type:"primary","data-attr":"new-destination",icon:(0,i.jsx)(w,{}),to:a.url,children:"Create"}):(0,i.jsxs)("span",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,i.jsx)(J,{feature:"data_pipelines",type:"secondary"}),c?.is_impersonated&&(0,i.jsx)(F,{type:"primary",icon:(0,i.jsx)(w,{}),tooltip:"Staff users can create destinations as an override",to:a.url})]})}}]}),r.length>0&&(0,i.jsxs)("div",{className:"text-secondary",children:[r.length," hidden. ",(0,i.jsx)(S,{onClick:()=>s(),children:"Show all"})]})]})}export{j as a,te as b,rt as c,ae as d};
//# sourceMappingURL=/static/chunk-2KRNMCWE.js.map
