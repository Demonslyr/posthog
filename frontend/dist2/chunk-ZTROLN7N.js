import{a as se,g as oe}from"/static/chunk-36DSVTR6.js";import{a as le}from"/static/chunk-DXU2OWVA.js";import{a as re}from"/static/chunk-XW2JOKCQ.js";import{d as g}from"/static/chunk-VVSLW35Y.js";import{Ac as W,Bd as H,Do as X,Lc as q,Mi as te,Sa as b,Sd as N,Ta as Q,Xg as ee,Yi as ie,Zc as G,Zd as Y,a as M,b as U,cc as V,ch as K,cm as ae,f as Ee,fe as Z,ga as O,h as _e,nl as ne,r as R,ze as j}from"/static/chunk-RFJTZKD6.js";import{F as $,a as ke,fb as D,na as y}from"/static/chunk-3UDJFOQH.js";import{d as p,e as T,g as F,j as L}from"/static/chunk-SJXEOBQC.js";T();L();F();var pe=p(M()),ue=p(Ee());var e=p(R());function qe({metric:s,metricIndex:f=0,isSecondary:k=!1}){let{experimentId:C,experiment:v,metricResults:h,secondaryMetricResults:E,tabularExperimentResults:_,getMetricType:P,exposureCountDataForVariant:J,conversionRateForVariant:u,experimentMathAggregationForTrends:x,countDataForVariant:ye,getHighestProbabilityVariant:be,credibleIntervalForVariant:z,featureFlags:ge}=(0,pe.useValues)(g),I=P(s),o=k?E?.[f]:h?.[f];if(!o)return(0,e.jsx)(e.Fragment,{});let he=be(o),m=[{key:"variants",title:"Variant",render:function(d,n){return(0,e.jsx)("div",{className:"flex items-center",children:(0,e.jsx)(se,{experimentId:C,variantKey:n.key})})}}];return I==="TRENDS"&&(m.push({key:"counts",title:(0,e.jsxs)("div",{className:"flex",children:[o.insight?.[0]&&"action"in o.insight[0]&&(0,e.jsx)(ae,{filter:o.insight[0].action}),(0,e.jsx)("span",{className:"pl-1",children:x()?"metric":"count"})]}),render:function(d,n){let i=ye(o,n.key);return i?(0,e.jsx)("div",{className:"flex",children:D(i)}):(0,e.jsx)(e.Fragment,{children:"\u2014"})}}),m.push({key:"exposure",title:(0,e.jsxs)("div",{className:"inline-flex items-center space-x-1",children:[(0,e.jsx)("div",{className:"",children:"Exposure"}),(0,e.jsx)(b,{title:(0,e.jsxs)("div",{children:["The number of users who were exposed to this variant. By default, this is measured by the count of ",(0,e.jsx)(Z,{type:"option",children:"$feature_flag_called"})," events per unique user. Check your metric settings to confirm how this is measured."]}),children:(0,e.jsx)(V,{className:"text-secondary text-base"})})]}),render:function(d,n){let i=J(o,n.key);return i?(0,e.jsx)("div",{children:D(i)}):(0,e.jsx)(e.Fragment,{children:"\u2014"})}}),m.push({key:"mean",title:"Mean",render:function(d,n){let i=n;return!i.count||!i.absolute_exposure?(0,e.jsx)("div",{className:"font-semibold",children:"\u2014"}):(0,e.jsx)("div",{className:"font-semibold",children:(i.count/i.absolute_exposure).toFixed(2)})}}),m.push({key:"delta",title:(0,e.jsxs)("div",{className:"inline-flex items-center space-x-1",children:[(0,e.jsx)("div",{className:"",children:"Delta %"}),(0,e.jsx)(b,{title:"Delta % indicates the percentage change in the mean between the control and the test variant.",children:(0,e.jsx)(V,{className:"text-secondary text-base"})})]}),render:function(d,n){let i=n;if(i.key==="control")return(0,e.jsx)("em",{children:"Baseline"});let a=o.variants.find(({key:Ne})=>Ne==="control");if(!i.count||!i.absolute_exposure||!a||!a.count||!a.absolute_exposure)return(0,e.jsx)("div",{className:"font-semibold",children:"\u2014"});let l=a.count/a.absolute_exposure,S=(i.count/i.absolute_exposure-l)/l*100;return(0,e.jsx)("div",{className:`font-semibold ${S>0?"text-success":S<0?"text-danger":""}`,children:`${S>0?"+":""}${S.toFixed(2)}%`})}}),m.push({key:"credibleInterval",title:(0,e.jsxs)("div",{className:"inline-flex items-center space-x-1",children:[(0,e.jsx)("div",{className:"",children:"Credible interval (95%)"}),(0,e.jsx)(b,{title:"A credible interval estimates the percentage change in the mean, indicating with 95% probability how much higher or lower the test variant's mean is compared to the control.",children:(0,e.jsx)(V,{className:"text-secondary text-base"})})]}),render:function(d,n){let i=n;if(i.key==="control")return(0,e.jsx)("em",{children:"Baseline"});let a=z(o||null,i.key,I);if(!a)return(0,e.jsx)(e.Fragment,{children:"\u2014"});let[l,w]=a;return(0,e.jsx)("div",{className:"font-semibold",children:`[${l>0?"+":""}${l.toFixed(2)}%, ${w>0?"+":""}${w.toFixed(2)}%]`})}})),I==="FUNNELS"&&(m.push({key:"conversionRate",title:"Conversion rate",render:function(d,n){let i=u(o,n.key);return i?(0,e.jsx)("div",{className:"font-semibold",children:`${i.toFixed(2)}%`}):(0,e.jsx)(e.Fragment,{children:"\u2014"})}}),m.push({key:"delta",title:(0,e.jsxs)("div",{className:"inline-flex items-center space-x-1",children:[(0,e.jsx)("div",{className:"",children:"Delta %"}),(0,e.jsx)(b,{title:"Delta % indicates the percentage change in the conversion rate between the control and the test variant.",children:(0,e.jsx)(V,{className:"text-secondary text-base"})})]}),render:function(d,n){if(n.key==="control")return(0,e.jsx)("em",{children:"Baseline"});let i=u(o,"control"),a=u(o,n.key);if(!i||!a)return(0,e.jsx)(e.Fragment,{children:"\u2014"});let l=(a-i)/i*100;return(0,e.jsx)("div",{className:`font-semibold ${l>0?"text-success":l<0?"text-danger":""}`,children:`${l>0?"+":""}${l.toFixed(2)}%`})}}),m.push({key:"credibleInterval",title:(0,e.jsxs)("div",{className:"inline-flex items-center space-x-1",children:[(0,e.jsx)("div",{className:"",children:"Credible interval (95%)"}),(0,e.jsx)(b,{title:"A credible interval estimates the percentage change in the conversion rate, indicating with 95% probability how much higher or lower the test variant's conversion rate is compared to the control.",children:(0,e.jsx)(V,{className:"text-secondary text-base"})})]}),render:function(d,n){if(n.key==="control")return(0,e.jsx)("em",{children:"Baseline"});let i=z(o||null,n.key,I);if(!i)return(0,e.jsx)(e.Fragment,{children:"\u2014"});let[a,l]=i;return(0,e.jsx)("div",{className:"font-semibold",children:`[${a>0?"+":""}${a.toFixed(2)}%, ${l>0?"+":""}${l.toFixed(2)}%]`})}})),ge[$.EXPERIMENT_P_VALUE]&&m.push({key:"pValue",title:"P-value",render:function(d,n){let i=n.key,a=o?.probability?.[i]!==void 0?1-o.probability[i]:void 0;return(0,e.jsx)(e.Fragment,{children:a!=null?(0,e.jsx)("span",{className:"inline-flex items-center w-52 space-x-4",children:(0,e.jsx)("span",{className:"w-1/4 font-semibold",children:a<.001?"< 0.001":a.toFixed(3)})}):"\u2014"})}}),m.push({key:"winProbability",title:"Win probability",sorter:(c,d)=>{let n=(o?.probability?.[c.key]||0)*100,i=(o?.probability?.[d.key]||0)*100;return n-i},render:function(d,n){let i=n.key,a=o?.probability?.[i]!==void 0&&o.probability?.[i]*100,l=i===he,w=u(o,i),S=w!=null;return(0,e.jsx)(e.Fragment,{children:a&&(I!=="FUNNELS"||S)?(0,e.jsxs)("span",{className:"inline-flex items-center w-52 space-x-4",children:[(0,e.jsx)(le,{className:"inline-flex w-3/4",percent:a}),(0,e.jsxs)("span",{className:`w-1/4 font-semibold ${l&&"text-success"}`,children:[a.toFixed(2),"%"]})]}):"\u2014"})}}),m.push({key:"recordings",title:"",render:function(d,n){let i=n.key,a=ne(s,v.feature_flag_key,i);return(0,e.jsx)(N,{size:"xsmall",icon:(0,e.jsx)(G,{}),tooltip:"Watch recordings of people who were exposed to this variant.",disabledReason:a.length===0?"Unable to identify recordings for this metric":void 0,type:"secondary",onClick:()=>{let l={filter_group:{type:"AND",values:[{type:"AND",values:a}]},date_from:v?.start_date,date_to:v?.end_date,filter_test_accounts:s.kind==="ExperimentMetric"?!1:s.kind==="ExperimentTrendsQuery"?s.count_query.filterTestAccounts:s.funnels_query.filterTestAccounts};ue.router.actions.push(X.replay("home",l)),U.capture("viewed recordings from experiment",{variant:i})},children:"View recordings"})}}),(0,e.jsx)("div",{className:"mb-4",children:(0,e.jsx)(j,{loading:!1,columns:m,dataSource:_(f,k)})})}T();L();F();var B=p(M());T();L();F();var fe=p(_e()),A=p(M());var ve=p(ke());var r=p(R());function xe(){let[s,f]=(0,ve.useState)(!1),{experiment:k}=(0,A.useValues)(g),{changeExperimentStartDate:C}=(0,A.useActions)(g),{created_at:v,start_date:h,end_date:E}=k;return h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"block","data-attr":"experiment-start-date",children:[(0,r.jsx)("div",{className:(0,fe.default)("text-xs font-semibold uppercase tracking-wide",s&&"text-center"),children:"Start date"}),(0,r.jsx)("div",{className:"flex",children:s?(0,r.jsx)(Y,{granularity:"minute",visible:!0,value:(0,y.default)(h),onChange:_=>{_&&C(_.toISOString())},onClose:()=>f(!1),onClickOutside:()=>f(!1),clearable:!1,selectionPeriod:"past",buttonProps:{size:"xsmall","data-attr":"experiment-start-date-picker"}}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(K,{time:h}),(0,r.jsx)(N,{title:"Move start date","data-attr":"move-experiment-start-date",icon:(0,r.jsx)(W,{}),size:"small",onClick:()=>f(!0),noPadding:!0,className:"ml-2"})]})})]}),E&&(0,r.jsxs)("div",{className:"block","data-attr":"experiment-end-date",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"End date"}),(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)(K,{time:E})})]})]}):v?(0,r.jsxs)("div",{className:"block","data-attr":"experiment-creation-date",children:[(0,r.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"Creation date"}),(0,r.jsx)(K,{time:v})]}):(0,r.jsx)(r.Fragment,{})}var t=p(R());function kt(){let{experiment:s,featureFlags:f,metricResults:k,metricResultsLoading:C,secondaryMetricResultsLoading:v}=(0,B.useValues)(g),{updateExperiment:h,setExperimentStatsVersion:E,refreshExperimentResults:_}=(0,B.useActions)(g),{created_by:P}=s;if(!s.feature_flag)return(0,t.jsx)(t.Fragment,{});let J=s.stats_config?.version||1,u=k?.[0]?.last_refresh;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-wrap justify-between gap-4",children:[(0,t.jsxs)("div",{className:"inline-flex space-x-8",children:[(0,t.jsxs)("div",{className:"block","data-attr":"experiment-status",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"Status"}),(0,t.jsx)(oe,{experiment:s})]}),s.feature_flag&&(0,t.jsxs)("div",{className:"block",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:(0,t.jsx)("span",{children:"Feature flag"})}),ee(s)==="running"&&!s.feature_flag.active&&(0,t.jsx)(b,{placement:"bottom",title:"Your experiment is running, but the linked flag is disabled. No data is being collected.",children:(0,t.jsx)(H,{style:{transform:"translateY(2px)"},className:"mr-1 text-danger",fontSize:"18px"})}),(0,t.jsx)(te,{iconStyle:{color:"var(--lemon-button-icon-opacity)"},className:"font-normal text-sm",description:"feature flag key",children:s.feature_flag.key}),(0,t.jsx)(Q,{target:"_blank",className:"font-semibold",to:s.feature_flag?X.featureFlag(s.feature_flag.id):void 0,children:(0,t.jsx)(O,{fontSize:"18"})})]}),(0,t.jsxs)("div",{className:"block",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:(0,t.jsx)("span",{children:"Stats Engine"})}),(0,t.jsx)("div",{className:"flex gap-1",children:"Bayesian"})]}),f[$.EXPERIMENT_STATS_V2]&&(0,t.jsxs)("div",{className:"block",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:(0,t.jsx)("span",{children:"Stats Version"})}),(0,t.jsx)("div",{className:"flex gap-1",children:[1,2].map(x=>(0,t.jsxs)(N,{size:"xsmall",type:"tertiary",active:J===x,onClick:()=>{E(x)},children:["v",x]},x))})]})]}),(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsxs)("div",{className:"inline-flex space-x-8",children:[s.start_date&&(0,t.jsxs)("div",{className:"block",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"Last refreshed"}),(0,t.jsxs)("div",{className:"inline-flex space-x-2",children:[(0,t.jsx)("span",{className:`${u?(0,y.default)().diff((0,y.default)(u),"hours")>12?"text-danger":(0,y.default)().diff((0,y.default)(u),"hours")>6?"text-warning":"":""}`,children:C||v?"Loading\u2026":u?(0,y.default)(u).fromNow():"a while ago"}),(0,t.jsx)(N,{type:"secondary",size:"xsmall",onClick:()=>{_(!0)},"data-attr":"refresh-experiment",icon:(0,t.jsx)(q,{}),tooltip:"Refresh experiment results"})]})]}),(0,t.jsx)(xe,{}),(0,t.jsxs)("div",{className:"block",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"Created by"}),P&&(0,t.jsx)(ie,{user:P,size:"md",showName:!0})]})]})})]}),(0,t.jsxs)("div",{className:"block mt-4",children:[(0,t.jsx)("div",{className:"text-xs font-semibold uppercase tracking-wide",children:"Description"}),(0,t.jsx)(re,{className:"py-2",multiline:!0,markdown:!0,name:"description",value:s.description||"",placeholder:"Add your hypothesis for this test (optional)",onSave:x=>h({description:x}),maxLength:400,"data-attr":"experiment-description",compactButtons:!0})]})]})}export{qe as a,kt as b};
//# sourceMappingURL=/static/chunk-ZTROLN7N.js.map
