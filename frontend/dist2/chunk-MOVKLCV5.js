import{a as yt}from"/static/chunk-FT4MFWRB.js";import{b as ve}from"/static/chunk-HRNZBUVG.js";import{Ap as St,Bi as ut,Bp as Jt,Cg as z,Dg as st,Do as C,Dp as Ut,Eo as bt,Fg as lt,Fp as Se,Gp as Qt,Io as Zt,Ji as pt,Kh as re,Lk as Ce,Mo as Gt,Od as tt,Oh as ct,Oo as Wt,Pe as rt,Ta as S,Vo as Vt,X as $e,Xh as dt,Yi as ae,Za as Gn,Zh as Re,Zl as mt,Zm as ft,a as Ge,ch as $,cp as Ft,dp as Ie,ee as ie,ep as Nt,f as bn,fp as Rt,gm as ht,gp as Ct,h as Zn,hp as Ae,jg as at,jp as vt,kg as Ne,kp as It,m as qe,ne as Fe,qa as et,r as R,se as pe,sp as oe,tg as ot,we as nt,wg as ge,wk as gt,xe as it,yp as At}from"/static/chunk-TW5IU73S.js";import{Aa as je,F as _e,Ha as We,Ja as Ve,Ma as Oe,Q as He,Tb as B,Wa as ne,Z as ze,a as yn,na as K,sb as Pe,sc as Ke}from"/static/chunk-3UDJFOQH.js";import{d as Z,e as W,g as V,j as F}from"/static/chunk-SJXEOBQC.js";W();F();V();var Je=Z(R()),Wn=({filters:e})=>(0,Je.jsx)("div",{className:"PropertyFilters flex-wrap",children:e&&e.map(t=>(0,Je.jsx)(re,{item:t},t.key))}),Ue=Wn;W();F();V();var hn=Z(Zn()),Ze=Z(Ge());W();F();V();var U=Z(Ge()),gn=Z(Gn()),P=Z(bn());W();F();V();var k=Z(R());function w(e){let t=!!e;return typeof e=="string"&&(t=e.toLowerCase()==="true"),t}function Xt(e,t,n){let i=[];for(let r of e){if(!r.detail||!r.scope)continue;let o=t?.(r);if(!o)continue;let{description:a,extendedDescription:l}=o(r,n);a!==null&&i.push({email:r.user?.email,name:r.user?Ve(r.user):void 0,isSystem:r.is_system,description:a,extendedDescription:l,created_at:(0,K.default)(r.created_at),unread:r.unread})}return i}function h(e){return e.is_system?"PostHog":e.user?Ve(e.user):"A user"}var Vn=["DataManagement","EventDefinition","PropertyDefinition"];function Qe(e,t=!1){let n=e.split(/(?=[A-Z])/).join(" ");return!t&&!Vn.includes(e)&&(n+="s"),n}function A(e,t=!1,n){if(n=n||e.detail.name||`a ${Qe(e.scope,!0)}`,e.activity=="deleted")return{description:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("strong",{children:h(e)})," deleted ",(0,k.jsx)("b",{children:n})]})};if(e.activity=="commented"){let i;e.scope==="Comment"?i=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("strong",{children:h(e)})," replied to a ",Qe(e.scope,!0)]}):i=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("strong",{children:h(e)})," commented",t?(0,k.jsxs)(k.Fragment,{children:[" on a ",Qe(e.scope,!0)]}):null]});let r=e.detail.changes?.[0].after;return{description:i,extendedDescription:r?(0,k.jsx)("div",{className:"border rounded bg-surface-primary p-4",children:(0,k.jsx)(rt,{lowKeyHeadings:!0,children:r})}):void 0}}return{description:null}}W();F();V();var E=Z(R()),Xe=(e,t)=>{let n=t||"(empty string)";return e?(0,E.jsx)(S,{to:C.cohort(e),children:n}):n};function xt(e,t){return e.scope!="Cohort"?(console.error("cohort describer received a non-cohort activity"),{description:null}):e.activity=="created"?{description:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("strong",{children:h(e)})," created the cohort:"," ",Xe(e?.item_id,e?.detail.name)]})}:e.activity=="deleted"?{description:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("strong",{children:h(e)})," deleted the cohort: ",e.detail.name]})}:e.activity=="updated"?{description:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("strong",{children:h(e)})," updated the cohort:"," ",Xe(e?.item_id,e?.detail.name)]})}:A(e,t,Xe(e?.detail.short_id))}W();F();V();W();F();V();var L=Z(R());function v({listParts:e,prefix:t=null,suffix:n=null}){return(0,L.jsxs)("div",{className:"sentence-list",children:[t&&(0,L.jsxs)("div",{className:"sentence-part",children:[t,"\xA0"]}),(0,L.jsx)(L.Fragment,{children:e.filter(i=>!!i).flatMap((i,r,o)=>{let a=r>0,l=r===o.length-1,u=o.length>=2;return[a&&(0,L.jsxs)("div",{className:"sentence-part",children:[","," "]},`${r}-a`),l&&u&&(0,L.jsx)("div",{className:"sentence-part",children:"\xA0and\xA0"},`${r}-b`),(0,L.jsx)("div",{className:"sentence-part",children:i},`${r}-c`)]})}),n&&(0,L.jsxs)("div",{className:"sentence-part",children:["\xA0",n]})]})}var G=Z(R()),kt={description:e=>({description:[(0,G.jsxs)(G.Fragment,{children:["changed description to ",(0,G.jsxs)("strong",{children:['"',e?.after,'"']})]})]}),tags:function(t){let n=t?.before,i=t?.after,r=i?.filter(l=>n?.indexOf(l)===-1)||[],o=n?.filter(l=>i?.indexOf(l)===-1)||[],a=[];return r.length&&a.push((0,G.jsxs)(G.Fragment,{children:["added ",B(r.length,"tag","tags",!1)," ",(0,G.jsx)(z,{tags:r,saving:!1,style:{display:"inline"},staticOnly:!0})]})),o.length&&a.push((0,G.jsxs)(G.Fragment,{children:["removed ",B(o.length,"tag","tags",!1)," ",(0,G.jsx)(z,{tags:o,saving:!1,style:{display:"inline"},staticOnly:!0})]})),{description:a}},verified:(e,t)=>{let n=w(e?.after);return{description:[(0,G.jsxs)(G.Fragment,{children:["marked ",me(t)," as ",(0,G.jsx)("strong",{children:n?"verified":"unverified"})," ",n&&(0,G.jsx)(et,{})]})],suffix:(0,G.jsx)(G.Fragment,{})}}};function me(e){return e?.item_id?(0,G.jsx)(S,{to:C.eventDefinition(e.item_id),children:e?.detail.name||"unknown"}):e?.detail.name?(0,G.jsx)(G.Fragment,{children:e?.detail.name}):(0,G.jsx)(G.Fragment,{children:"unknown"})}function Bt({logItem:e}){let t=e.scope==="EventDefinition"?"event":"property";return t==="property"?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("span",{className:"highlighted-activity",children:e.detail?.type})," property definition"]}):(0,G.jsxs)(G.Fragment,{children:[t," definition"]})}function Yt(e,t){if(e.scope!=="EventDefinition"&&e.scope!=="PropertyDefinition")return console.error("data management describer received a non-data-management activity"),{description:null};if(e.activity=="changed"){let n=[],i=(0,G.jsxs)(G.Fragment,{children:["on ",(0,G.jsx)(Bt,{logItem:e})," ",me(e)]});for(let r of e.detail.changes||[]){if(!r?.field||!kt[r.field])continue;let o=kt[r.field],a=o(r,e);if(a===null)continue;let{description:l,suffix:u}=a;l&&(n=n.concat(l)),u&&(i=u)}if(n.length)return{description:(0,G.jsx)(v,{listParts:n,prefix:(0,G.jsx)("strong",{children:h(e)}),suffix:i})}}return e.activity=="deleted"?{description:(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("strong",{children:h(e)})," deleted ",(0,G.jsx)(Bt,{logItem:e})," ",me(e)]})}:A(e,t,me(e))}W();F();V();var m=Z(R()),ee=(e,t)=>{let n=t||"(empty string)";return e?(0,m.jsx)(S,{to:C.featureFlag(e),children:n}):n},Fn={name:function(){return{description:[(0,m.jsx)(m.Fragment,{children:"changed the description"})]}},active:function(t,n){let i=!!t?.after;return typeof t?.after=="string"&&(i=t?.after.toLowerCase()==="true"),{description:[(0,m.jsx)(m.Fragment,{children:i?"enabled":"disabled"})],suffix:(0,m.jsx)(m.Fragment,{children:ee(n?.item_id,n?.detail.name)})}},filters:function(t){let n=t?.before,i=t?.after,r=Array.isArray(i?.groups),o=i?.multivariate,a=[];if(r)if(i.groups.length===0||!i.groups.some(l=>l.rollout_percentage!==0))a.push((0,m.jsx)(m.Fragment,{children:"changed the filter conditions to apply to no users"}));else{i.payloads&&Object.keys(i.payloads).forEach(f=>{let I=i.payloads?.[f]?.toString()||null;a.push((0,m.jsx)(v,{listParts:[I],prefix:"changed payload to"}))});let l=[],u=[];i.groups.filter((f,I)=>{let Y=n?.groups?.[I];return!Y||JSON.stringify(Y)!==JSON.stringify(f)}).forEach(f=>{let{properties:I,rollout_percentage:Y=null}=f;if((I?.length||0)>0){let M=I,Me=M.map((we,fn)=>(0,m.jsxs)(m.Fragment,{children:[" ",fn===0&&(0,m.jsxs)("span",{children:[(0,m.jsxs)("strong",{children:[Y??100,"%"]})," of"," "]}),(0,m.jsx)(re,{item:we},we.key)]}))||[];Me[0]=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("span",{children:[(0,m.jsxs)("strong",{children:[Y??100,"%"]})," of"," "]}),(0,m.jsx)(re,{item:M[0]},M[0].key)]}),l.push(...Me)}else l.push((0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("strong",{children:[Y??100,"%"]})," of ",(0,m.jsx)("strong",{children:"all users"})]}))}),l.length&&a.push((0,m.jsx)(v,{listParts:l,prefix:"changed the filter conditions to apply to"}));let b=(n?.groups||[]).filter((f,I)=>!i?.groups?.[I]);b.length&&u.push((0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("strong",{children:"removed "})," ",B(b.length,"release condition","release conditions")]})),u.length&&a.push((0,m.jsx)(v,{listParts:u}))}return o&&(i.payloads&&Object.keys(i.payloads).forEach(l=>{let u=i.payloads?.[l]?.toString()||null;a.push((0,m.jsx)(v,{listParts:[(0,m.jsx)("span",{className:"highlighted-activity",children:u},l)],prefix:(0,m.jsxs)("span",{children:["changed payload on ",(0,m.jsxs)("b",{children:["variant: ",l]})," to"]})}))}),a.push((0,m.jsx)(v,{listParts:(i.multivariate?.variants||[]).map(l=>(0,m.jsxs)("div",{className:"highlighted-activity",children:[l.key,": ",(0,m.jsxs)("strong",{children:[l.rollout_percentage,"%"]})]},l.key)),prefix:"changed the rollout percentage for the variants to"}))),a.length>0?{description:a}:(console.error({change:t},"could not describe this change"),null)},deleted:function(t,n){let i=w(t?.after);return{description:[(0,m.jsx)(m.Fragment,{children:i?"deleted":"un-deleted"})],suffix:(0,m.jsx)(m.Fragment,{children:ee(n?.item_id,n?.detail.name)})}},rollout_percentage:function(t){return{description:[(0,m.jsxs)(m.Fragment,{children:["changed rollout percentage to ",(0,m.jsxs)("div",{className:"highlighted-activity",children:[t?.after,"%"]})]})]}},key:function(t,n){let i=t?.before,r=t?.after;return{description:[(0,m.jsxs)(m.Fragment,{children:["changed flag key on ",i," to"]})],suffix:(0,m.jsx)(m.Fragment,{children:ee(n?.item_id,r)})}},ensure_experience_continuity:function(t){let i=w(t?.after)?"enabled":"disabled";return{description:[(0,m.jsxs)(m.Fragment,{children:[i," experience continuity"]})]}},tags:function(t){let n=t?.before,i=t?.after,r=i.filter(l=>n.indexOf(l)===-1),o=n.filter(l=>i.indexOf(l)===-1),a=[];return r.length&&a.push((0,m.jsxs)(m.Fragment,{children:["added ",B(r.length,"tag","tags",!1)," ",(0,m.jsx)(z,{tags:r,saving:!1,style:{display:"inline"},staticOnly:!0})]})),o.length&&a.push((0,m.jsxs)(m.Fragment,{children:["removed ",B(o.length,"tag","tags",!1)," ",(0,m.jsx)(z,{tags:o,saving:!1,style:{display:"inline"},staticOnly:!0})]})),{description:a}},id:()=>null,created_at:()=>null,created_by:()=>null,is_simple_flag:()=>null,experiment_set:()=>null,features:()=>null,usage_dashboard:()=>null,rollback_conditions:()=>null,performed_rollback:()=>null,can_edit:()=>null,analytics_dashboards:()=>null,has_enriched_analytics:()=>null,surveys:()=>null,user_access_level:()=>null,is_remote_configuration:()=>null,has_encrypted_payloads:()=>null,status:()=>null};function Et(e,t){if(e.scope!="FeatureFlag")return console.error("feature flag describer received a non-feature flag activity"),{description:null};if(e.activity==="created")return{description:(0,m.jsx)(v,{listParts:[(0,m.jsx)(m.Fragment,{children:"created a new feature flag:"})],prefix:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("strong",{children:h(e)})}),suffix:(0,m.jsxs)(m.Fragment,{children:[" ",ee(e?.item_id,e?.detail.name)]})})};if(e.activity=="updated"){let n=[],i=(0,m.jsxs)(m.Fragment,{children:["on ",t&&" the flag ",ee(e?.item_id,e?.detail.name)]});for(let r of e.detail.changes||[]){if(!r?.field)continue;let o=Fn[r.field](r,e);if(o){let{description:a,suffix:l}=o;a&&(n=n.concat(a)),l&&(i=l)}}if(n.length)return{description:(0,m.jsx)(v,{listParts:n,prefix:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("strong",{children:h(e)})}),suffix:i})}}return A(e,t,ee(e?.item_id,e?.detail.name))}W();F();V();var D=Z(R()),Dt={version:()=>null,content:()=>({description:[(0,D.jsx)(D.Fragment,{children:"changed content"})]})};function Lt(e){return e?.detail?.short_id?(0,D.jsx)(S,{to:C.notebook(e.detail.short_id),children:e?.detail.name||"unknown"}):e?.detail.name?(0,D.jsx)(D.Fragment,{children:e?.detail.name}):(0,D.jsx)("i",{children:"Untitled"})}function Tt(e,t){if(e.scope!=="Notebook")return console.error("notebook describer received a non-Notebook activity"),{description:null};if(e.activity=="changed"||e.activity=="updated"){let n=[],i=(0,D.jsxs)(D.Fragment,{children:["on ",Lt(e)]});for(let r of e.detail.changes||[]){if(!r?.field||!Dt[r.field])continue;let o=Dt[r.field],a=o(r,e);if(a===null)continue;let{description:l,suffix:u}=a;l&&(n=n.concat(l)),u&&(i=u)}if(n.length)return{description:(0,D.jsx)(v,{listParts:n,prefix:(0,D.jsx)("strong",{children:h(e)}),suffix:i})}}return A(e,t,Lt(e))}W();F();V();var J=Z(R());function Mt(e,t){if(e.scope!="Person")return console.error("person describer received a non-person activity"),{description:null};if(e.activity==="deleted")return{description:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("strong",{children:h(e)})," deleted the person: ",e.detail.name]})};if(e.activity==="updated")return{description:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("strong",{children:h(e)})," edited this person's properties"]})};if(e.activity==="people_merged_into"&&e.detail.merge?.source)return{description:(0,J.jsx)(v,{prefix:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("strong",{children:h(e)})," merged"]}),listParts:e.detail.merge.source.flatMap(n=>(0,J.jsx)("span",{className:"highlighted-activity",children:(0,J.jsx)(gt,{person:n})})),suffix:"into this person"})};if(e.activity==="split_person"){let n=e.detail.changes?.[0].after?.distinct_ids;if(n)return{description:(0,J.jsx)(v,{prefix:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("strong",{children:h(e)})," split this person into"]}),listParts:n.map(i=>(0,J.jsx)("span",{className:"highlighted-activity",children:(0,J.jsx)(S,{to:C.personByDistinctId(i),children:i})},i))})}}return A(e,t)}W();F();V();var y=Z(R()),xe=(e,t)=>{let n=t||"(empty string)";return e?(0,y.jsx)(S,{to:ft("destination",e),children:n}):n};function Nn({before:e,after:t,language:n}){return(0,y.jsx)(st,{height:"300px",original:e,modified:t,language:n??"json",onMount:(i,r)=>{n==="hog"&&lt(r)},options:{lineNumbers:"off",minimap:{enabled:!1},folding:!1,wordWrap:"on",renderLineHighlight:"none",scrollbar:{vertical:"auto",horizontal:"hidden"},overviewRulerBorder:!1,hideCursorInOverviewRuler:!0,overviewRulerLanes:0,tabFocusMode:!0,enableSplitViewResizing:!1,renderSideBySide:!1,readOnly:!0}})}function wt({before:e,after:t,language:n,children:i}){return(0,y.jsx)(tt,{closeOnClickInside:!1,overlay:(0,y.jsx)("div",{className:"w-[50vw] min-w-[300px]",children:(0,y.jsx)(Nn,{before:e,after:t,language:n})}),children:(0,y.jsx)("span",{className:"Link",children:i})})}function _t(e,t){if(e.scope!="HogFunction")return console.error("HogFunction describer received a non-HogFunction activity"),{description:null};let n=e?.detail.type??"hog function";if(e.activity=="created")return{description:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("strong",{children:h(e)})," created the ",n,":"," ",xe(e?.item_id,e?.detail.name)]})};if(e.activity=="deleted")return{description:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("strong",{children:h(e)})," deleted the ",n,": ",e.detail.name]})};if(e.activity=="updated"){let i=[];for(let a of e.detail.changes??[])switch(a.field){case"encrypted_inputs":{i.push({inline:"updated encrypted inputs for",inlist:"updated encrypted inputs"});break}case"inputs":{let l=[];Object.entries(a.after??{}).forEach(([f,I])=>{let Y=JSON.stringify(a.before?.[f]?.value),M=JSON.stringify(I?.value);Y!==M&&l.push((0,y.jsx)(wt,{before:Y,after:M,children:f}))});let u=[];for(let f=0;f<l.length;f++)f!==0&&f===l.length-1?u.push((0,y.jsx)(y.Fragment,{children:" and "})):f>0&&u.push((0,y.jsx)(y.Fragment,{children:", "})),u.push(l[f]);let b=l.length===1?"input":"inputs";i.push({inline:(0,y.jsxs)(y.Fragment,{children:["updated the ",b," ",u," for"]}),inlist:(0,y.jsxs)(y.Fragment,{children:["updated ",b,": ",u]})});break}case"inputs_schema":case"filters":case"hog":case"name":case"description":case"masking":{let l=(0,y.jsx)(wt,{language:a.field==="hog"?"hog":"json",before:typeof a.before=="string"?a.before:JSON.stringify(a.before,null,2),after:typeof a.after=="string"?a.after:JSON.stringify(a.after,null,2),children:a.field==="hog"?"source code":a.field==="inputs_schema"?"inputs schema":a.field});i.push({inline:(0,y.jsxs)(y.Fragment,{children:["updated ",l," for"]}),inlist:(0,y.jsxs)(y.Fragment,{children:["updated ",l]})});break}case"deleted":{a.after?i.push({inline:"deleted",inlist:`deleted the ${n}`}):i.push({inline:"undeleted",inlist:`undeleted the ${n}`});break}case"enabled":{a.after?i.push({inline:"enabled",inlist:`enabled the ${n}`}):i.push({inline:"disabled",inlist:`disabled the ${n}`});break}case"priority":{i.push({inline:(0,y.jsxs)(y.Fragment,{children:["changed priority from ",a.before," to ",a.after," for"," "]}),inlist:(0,y.jsxs)(y.Fragment,{children:["changed priority from ",a.before," to ",a.after," for"," "]})});break}default:i.push({inline:`updated unknown field: ${a.field}`,inlist:`updated unknown field: ${a.field}`})}let r=h(e),o=xe(e?.item_id,e?.detail.name);return{description:i.length==1?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("strong",{children:r})," ",i[0].inline," the ",n,": ",o]}):(0,y.jsxs)("div",{children:[(0,y.jsx)("strong",{children:r})," updated the ",n,": ",o,(0,y.jsx)("ul",{className:"list-disc ml-5",children:i.map((a,l)=>(0,y.jsx)("li",{children:a.inlist},l))})]})}}return A(e,t,xe(e?.detail.short_id))}W();F();V();W();F();V();var le="**************** POSTHOG SECRET FIELD ****************";function ke(e){return Array.isArray(e)?e:Object.entries(e).map(([t,n])=>({key:t,...n})).sort((t,n)=>(t.order||999999)-(n.order||999999))}function Rn(e){if(Array.isArray(e)){let t={};return e.forEach((n,i)=>{n.key&&(t[n.key]={...n,order:i})}),t}return e}function Pr(e){let t={};for(let n of ke(e.config_schema))n.key&&typeof n.default<"u"&&(t[n.key]=n.default);return t}function Kr(e,t,n){let i=Rn(e),r=new FormData,o={};for(let[a,l]of Object.entries(n))i[a]?.type==="attachment"?(l&&!l.saved&&r.append(`add_attachment[${a}]`,l),!l&&t?.[a]&&r.append(`remove_attachment[${a}]`,"true")):(!i[a]?.secret||l!==le)&&(o[a]=l);return r.append("config",JSON.stringify(o)),r}var Ht=(e,t,n)=>{let i=e(t||"")||"";return typeof n>"u"&&!!i||n===i},qr=(e,t)=>{let n=[];for(let i of Object.values(ke(t.config_schema||{}))){if(!i.visible_if||!i.key)continue;i.visible_if.every(([o,a])=>Ht(e,o,a))||n.push(i.key)}return n},$r=(e,t)=>{let n=[];for(let i of Object.values(ke(t.config_schema||{})))i.key&&(i.required||i.required_if&&Array.isArray(i.required_if)&&i.required_if.every(([o,a])=>Ht(e,o,a)))&&n.push(i.key);return n},Cn=e=>Array.isArray(e.choices)&&!!e.choices.length&&!e.choices.find(t=>typeof t!="string")&&!e.secret,ea=e=>e.type!=="choice"||Cn(e);var g=Z(R());function zt(e,t){if(e.scope!=="Plugin"&&e.scope!=="PluginConfig")return console.error("plugin describer received a non-plugin activity"),{description:null};if(e.activity=="installed")return{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," installed the app: ",(0,g.jsx)("b",{children:e.detail.name})]})};if(e.activity=="uninstalled")return{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," uninstalled the app: ",(0,g.jsx)("b",{children:e.detail.name})]})};if(e.activity=="enabled"){let n=[];for(let i of e.detail.changes||[]){let r=i.after===le?"<secret_value>":i.after;n.push((0,g.jsxs)(g.Fragment,{children:["field ",(0,g.jsx)("code",{children:i.field})," set to ",(0,g.jsx)("code",{children:r})]}))}return{description:(0,g.jsx)(v,{listParts:n,prefix:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," enabled the app: ",(0,g.jsx)("b",{children:e.detail.name})," ","with config ID ",e.item_id,n.length>0?", with":"."]})})}}if(e.activity=="disabled")return{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," disabled the app: ",(0,g.jsx)("b",{children:e.detail.name})," with config ID ",e.item_id,"."]})};if(e.activity=="job_triggered"&&e.detail.trigger?.job_type=="Export historical events V2"){let[n,i]=e.detail.trigger.payload.dateRange;return{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," started exporting historical events between"," ",n," and ",i," (inclusive)."]})}}if(e.activity=="job_triggered"&&e.detail.trigger)return{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," triggered job:"," ",(0,g.jsx)("code",{children:e.detail.trigger.job_type})," with config ID ",e.item_id,"."]}),extendedDescription:(0,g.jsxs)(g.Fragment,{children:["Payload: ",(0,g.jsx)("code",{children:JSON.stringify(e.detail.trigger.payload,null,2)})]})};if(e.activity=="export_success"&&e.detail.trigger){let{dateFrom:n,dateTo:i}=e.detail.trigger.payload,r=(0,K.default)(n).format("YYYY-MM-DD"),o=(0,K.default)(i).subtract(1,"day").format("YYYY-MM-DD");return{description:(0,g.jsxs)(g.Fragment,{children:["Finished exporting historical events between ",r," and ",o," (inclusive)."]})}}if(e.activity=="export_fail"&&e.detail.trigger){let{dateFrom:n,dateTo:i}=e.detail.trigger.payload,r=(0,K.default)(n).format("YYYY-MM-DD"),o=(0,K.default)(i).subtract(1,"day").format("YYYY-MM-DD");return{description:(0,g.jsxs)(g.Fragment,{children:["Fatal error exporting historical events between ",r," and ",o," (inclusive). Check logs for more details."]})}}if(e.activity=="config_updated"){let n=[];for(let i of e.detail.changes||[]){let r="",o=i.before===le?"<secret_value>":i.before,a=i.after===le?"<secret_value>":i.after;i.action==="created"?r=(0,g.jsxs)(g.Fragment,{children:["added new field ",(0,g.jsx)("code",{children:i.field}),'" with value ',(0,g.jsx)("code",{children:a})]}):i.action==="deleted"?r=(0,g.jsxs)(g.Fragment,{children:["removed field ",(0,g.jsx)("code",{children:i.field}),", which had value ",(0,g.jsx)("code",{children:o})]}):i.action==="changed"&&(r=(0,g.jsxs)(g.Fragment,{children:["updated field ",(0,g.jsx)("code",{children:i.field})," from value ",(0,g.jsx)("code",{children:o})," to value ",(0,g.jsx)("code",{children:a})," "]})),n.push(r)}return{description:(0,g.jsx)(v,{prefix:(0,g.jsx)("strong",{children:h(e)}),listParts:n,suffix:(0,g.jsxs)(g.Fragment,{children:["on app ",(0,g.jsx)("b",{children:e.detail.name})," with config ID ",e.item_id,"."]})})}}if(e.activity.startsWith("attachment_"))for(let n of e.detail.changes||[]){let i="";return e.activity==="attachment_created"?i=(0,g.jsxs)(g.Fragment,{children:["attached a file ",(0,g.jsx)("code",{children:n.after})]}):e.activity=="attachment_updated"?n.after===n.before?i=(0,g.jsxs)(g.Fragment,{children:["updated attached file ",(0,g.jsx)("code",{children:n.after})]}):i=(0,g.jsxs)(g.Fragment,{children:["updated attached file from ",(0,g.jsx)("code",{children:n.before})," to"," ",(0,g.jsx)("code",{children:n.after})]}):e.activity==="attachment_deleted"&&(i=(0,g.jsxs)(g.Fragment,{children:["deleted attached file ",(0,g.jsx)("code",{children:n.before})]})),{description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("strong",{children:h(e)})," ",i," on app:"," ",(0,g.jsx)("b",{children:e.detail.name})," with config ID ",e.item_id]})}}return A(e,t)}W();F();V();W();F();V();var ce=Z(Ge());var de=Z(yn());var c=Z(R());function jt({groupFilter:e,embedded:t}){let{cohortsById:n}=(0,ce.useValues)(ct),{formatPropertyValueForDisplay:i}=(0,ce.useValues)(ot);return!!e&&e.values.flatMap(o=>o.values).length>0?(0,c.jsx)(c.Fragment,{children:e.values.map(({values:o,type:a},l)=>(0,c.jsxs)(de.default.Fragment,{children:[l===0?null:(0,c.jsx)("em",{className:"text-[11px] font-semibold",children:e.type==="OR"?"OR":"AND"}),o.map((u,b)=>{let f=b===0,I=f&&l===0;return(0,c.jsx)("div",{className:"SeriesDisplay__condition",children:(0,c.jsxs)("span",{children:[f?t?"where ":null:a==="OR"?"or ":"and ",Ut(u)?(0,c.jsxs)(c.Fragment,{children:[I&&!t?"Person":"person"," belongs to cohort",(0,c.jsx)("span",{className:"SeriesDisplay__raw-name",children:Jt(u,n,Y=>i(u.key,Y)?.toString()||"?")})]}):(0,c.jsxs)(c.Fragment,{children:[I&&!t?We(u.type||"event"):u.type||"event","'s",(0,c.jsx)("span",{className:"SeriesDisplay__raw-name",children:Se(u)&&u.key&&(0,c.jsx)(ge,{value:u.key,type:St[u.type]})}),Oe[Qt(u)&&u.operator||"exact"]," ",(0,c.jsx)("b",{children:Se(u)&&(Array.isArray(u.value)?u.value.join(" or "):u.value)})]})]})},b)})]},l))}):(0,c.jsx)("i",{children:"None"})}function Be({entity:e}){return(0,c.jsxs)(c.Fragment,{children:[e.custom_name&&(0,c.jsxs)("b",{children:[' "',e.custom_name,'"']}),Wt(e)?(0,c.jsx)(S,{to:C.action(e.id),className:"SeriesDisplay__raw-name SeriesDisplay__raw-name--action",title:"Action series",children:e.name}):Gt(e)?(0,c.jsx)("span",{className:"SeriesDisplay__raw-name SeriesDisplay__raw-name--event",title:"Event series",children:(0,c.jsx)(ge,{value:e.event||"$pageview",type:"events"})}):(0,c.jsx)("i",{children:e.kind})]})}function vn({query:e,seriesIndex:t}){let{mathDefinitions:n}=(0,ce.useValues)(Ne),i=e.series[t],r=Ae(e)&&oe(e.breakdownFilter),o=n[Ct(e)?"dau":i.math?at(i.math,i.math_group_type_index):"total"];return(0,c.jsx)(Fe,{fullWidth:!0,className:"SeriesDisplay",icon:(0,c.jsx)(pt,{seriesIndex:t,hasBreakdown:r}),extendedContent:i.properties&&i.properties.length>0&&(0,c.jsx)(jt,{groupFilter:{type:"AND",values:[{type:"AND",values:i.properties}]},embedded:!0}),children:(0,c.jsxs)("span",{children:[Ie(e)?"Performed":"Showing",(0,c.jsx)(Be,{entity:i}),!Ie(e)&&(0,c.jsxs)("span",{className:"leading-none",children:["counted by"," ",o?.category===5?(0,c.jsx)("code",{children:i.math_hogql}):(0,c.jsxs)(c.Fragment,{children:[o?.category===4&&i.math_property&&(0,c.jsxs)(c.Fragment,{children:[" ","event's",(0,c.jsx)("span",{className:"SeriesDisplay__raw-name",children:(0,c.jsx)(ge,{value:i.math_property,type:"event_properties"})})]}),(0,c.jsx)("b",{children:o?.name.toLowerCase()})]})]})]})})}function In({query:e}){let{includeEventTypes:t,startPoint:n,endPoint:i}=e.pathsFilter;return(0,c.jsxs)("div",{className:"SeriesDisplay",children:[(0,c.jsxs)("div",{children:["User paths based on ",(0,c.jsx)("b",{children:mt(t).join(" and ")})]}),n&&(0,c.jsxs)("div",{children:["starting at ",(0,c.jsx)("b",{children:n})]}),i&&(0,c.jsxs)("div",{children:["ending at ",(0,c.jsx)("b",{children:i})]})]})}function An({query:e}){let{aggregationLabel:t}=(0,ce.useValues)(Ne);return(0,c.jsxs)(c.Fragment,{children:[e.aggregation_group_type_index!=null?`${We(t(e.aggregation_group_type_index).plural)} which`:"Users who"," performed",(0,c.jsx)(Be,{entity:e.retentionFilter.targetEntity?.type==="actions"?{kind:"ActionsNode",name:e.retentionFilter.targetEntity.name,id:e.retentionFilter.targetEntity.id}:{kind:"EventsNode",name:e.retentionFilter.targetEntity?.name,event:e.retentionFilter.targetEntity?.id}}),(0,c.jsx)("strong",{children:e.retentionFilter.retentionType==="retention_recurring"?"recurringly":"for the first time"})," ","in the preceding"," ",(0,c.jsxs)("strong",{children:[(e.retentionFilter.totalIntervals||11)-1," ",e.retentionFilter.period?.toLocaleLowerCase()??"day","s"]}),(0,c.jsx)("br",{}),"and came back to perform",(0,c.jsx)(Be,{entity:{...e.retentionFilter.returningEntity,kind:e.retentionFilter.returningEntity?.type==="actions"?"ActionsNode":"EventsNode"}}),"in any of the next periods"]})}function Ye({query:e,heading:t}){return(0,c.jsxs)("section",{children:[t!==null&&(0,c.jsx)("h5",{children:t||"Query summary"}),(0,c.jsxs)("div",{className:"InsightDetails__query",children:[Ft(e)&&e.trendsFilter?.formula&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Fe,{className:"InsightDetails__formula",icon:(0,c.jsx)($e,{}),fullWidth:!0,children:(0,c.jsxs)("span",{children:["Formula:",(0,c.jsx)("code",{children:e.trendsFilter?.formula})]})}),(0,c.jsx)(ie,{})]}),(0,c.jsx)("div",{className:"InsightDetails__series",children:Rt(e)?(0,c.jsx)(In,{query:e}):Nt(e)?(0,c.jsx)(An,{query:e}):vt(e)?(0,c.jsx)(c.Fragment,{children:e.series.map((n,i)=>(0,c.jsxs)(de.default.Fragment,{children:[i!==0&&(0,c.jsx)(ie,{className:"my-1"}),(0,c.jsx)(vn,{query:e,seriesIndex:i})]},i))}):(0,c.jsxs)("i",{children:["Query summary is not available for ",e.kind," yet"]})})]})]})}function Ee({properties:e}){return(0,c.jsxs)("section",{children:[(0,c.jsx)("h5",{children:"Filters"}),(0,c.jsx)("div",{children:(0,c.jsx)(jt,{groupFilter:At(e)})})]})}function De({query:e}){if(!Ae(e)||!oe(e.breakdownFilter))return null;let{breakdown_type:t,breakdown:n,breakdowns:i}=e.breakdownFilter;return(0,c.jsxs)("section",{children:[(0,c.jsx)("h5",{children:"Breakdown by"}),(0,c.jsx)("div",{children:Array.isArray(i)?i.map(r=>(0,c.jsx)(Ce,{breakdown:r.property,breakdownType:r.type},`${r.type}-${r.property}`)):n&&(Array.isArray(n)?n:[n].map(r=>(0,c.jsx)(Ce,{breakdown:r,breakdownType:t},r)))})]})}var $a=de.default.memo(de.default.forwardRef(function({query:t,footerInfo:n},i){return(0,c.jsxs)("div",{className:"InsightDetails",ref:i,children:[Vt(t)&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(Ye,{query:t.source}),(0,c.jsx)(Ee,{properties:t.source.properties}),(0,c.jsx)(De,{query:t.source})]}),n&&(0,c.jsxs)("div",{className:"InsightDetails__footer",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h5",{children:"Created by"}),(0,c.jsxs)("section",{children:[(0,c.jsx)(ae,{user:n.created_by,showName:!0,size:"md"})," ",(0,c.jsx)($,{time:n.created_at})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("h5",{children:"Last modified by"}),(0,c.jsxs)("section",{children:[(0,c.jsx)(ae,{user:n.last_modified_by,showName:!0,size:"md"})," ",(0,c.jsx)($,{time:n.last_modified_at})]})]}),n.last_refresh&&(0,c.jsxs)("div",{children:[(0,c.jsx)("h5",{children:"Last computed"}),(0,c.jsx)("section",{children:(0,c.jsx)($,{time:n.last_refresh})})]})]})]})}));var p=Z(R()),_=(e,t)=>{let n=t||"(empty string)";return e?(0,p.jsx)(S,{to:C.insightView(e),children:n}):n},Ot=e=>"dashboard"in e?e.dashboard:e,Pt=e=>(0,p.jsx)("div",{className:"highlighted-activity",children:(0,p.jsx)(S,{to:C.dashboard(e.id),children:e.name})}),Kt={name:function(t,n,i){return{description:[(0,p.jsxs)(p.Fragment,{children:["renamed ",i&&"the insight ",'"',t?.before,'" to'," ",(0,p.jsxs)("strong",{children:['"',_(n?.detail.short_id,t?.after),'"']})]})],suffix:(0,p.jsx)(p.Fragment,{})}},filters:function(t){let n=t?.after;return je(n)?null:qt(n)},query:function(t){if(t?.action==="deleted")return null;let n=t?.after;return It(n)?qt(dt(t?.after)):{description:["cannot yet summarize changes to this insight's query: "+n?.kind]}},deleted:function(t,n,i){let o=w(t?.after)?"deleted":"un-deleted";return{description:[(0,p.jsxs)(p.Fragment,{children:[o,i&&" the insight "]})],suffix:(0,p.jsx)(p.Fragment,{children:_(n?.detail.short_id,n?.detail.name)})}},short_id:function(t,n,i){return{description:[(0,p.jsxs)(p.Fragment,{children:["changed the short id ",i&&" of the insight ","to"," ",(0,p.jsxs)("strong",{children:['"',t?.after,'"']})]})]}},derived_name:function(t,n,i){return{description:[(0,p.jsxs)(p.Fragment,{children:["renamed ",i&&" the insight ",'"',t?.before,'" to'," ",(0,p.jsxs)("strong",{children:['"',_(n?.detail.short_id,t?.after),'"']})]})],suffix:(0,p.jsx)(p.Fragment,{})}},description:function(t,n,i){return{description:[(0,p.jsxs)(p.Fragment,{children:["changed the description ",i&&" of the insight ","to"," ",(0,p.jsxs)("strong",{children:['"',t?.after,'"']})]})]}},favorited:function(t,n,i){let r=w(t?.after);return{description:[(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"highlighted-activity",children:[r?"":"un-","favorited",i&&" the insight "]})})],suffix:(0,p.jsx)(p.Fragment,{children:_(n?.detail.short_id,n?.detail.name)})}},tags:function(t){let n=t?.before,i=t?.after,r=i.filter(l=>n.indexOf(l)===-1),o=n.filter(l=>i.indexOf(l)===-1),a=[];return r.length&&a.push((0,p.jsxs)(p.Fragment,{children:["added ",B(r.length,"tag","tags",!1)," ",(0,p.jsx)(z,{tags:r,saving:!1,style:{display:"inline"},staticOnly:!0})]})),o.length&&a.push((0,p.jsxs)(p.Fragment,{children:["removed ",B(o.length,"tag","tags",!1)," ",(0,p.jsx)(z,{tags:o,saving:!1,style:{display:"inline"},staticOnly:!0})]})),{description:a}},dashboards:function(t,n,i){let r=(t?.before).map(Ot),o=(t?.after).map(Ot),a=o.filter(f=>!r.some(I=>I.id===f.id)),l=r.filter(f=>!o.some(I=>I.id===f.id)),u=a.length?(0,p.jsx)(v,{prefix:(0,p.jsxs)(p.Fragment,{children:["added ",i&&" the insight ",_(n?.detail.short_id,n?.detail.name)," to"]}),listParts:a.map(f=>(0,p.jsx)(p.Fragment,{children:Pt(f)}))}):null,b=l.length?(0,p.jsx)(v,{prefix:(0,p.jsxs)(p.Fragment,{children:["removed ",i&&" the insight ",_(n?.detail.short_id,n?.detail.name)," from"]}),listParts:l.map(f=>(0,p.jsx)(p.Fragment,{children:Pt(f)}))}):null;return{description:[u,b],suffix:(0,p.jsx)(p.Fragment,{})}},id:()=>null,created_at:()=>null,created_by:()=>null,updated_at:()=>null,last_modified_at:()=>null,order:()=>null,result:()=>null,last_refresh:()=>null,cache_target_age:()=>null,next_allowed_client_refresh:()=>null,last_modified_by:()=>null,next:()=>null,saved:()=>null,is_sample:()=>null,timezone:()=>null,effective_restriction_level:()=>null,effective_privilege_level:()=>null,disable_baseline:()=>null,dashboard_tiles:()=>null,query_status:()=>null,user_access_level:()=>null};function qt(e){let t=ht(e),n=t;return{description:["changed query definition"],extendedDescription:(0,p.jsxs)("div",{className:"ActivityDescription",children:[(0,p.jsx)(Ye,{query:t}),(0,p.jsx)(Ee,{properties:t.properties}),oe(n?.breakdownFilter)&&(0,p.jsx)(De,{query:t})]})}}function $t(e,t){if(e.scope!="Insight")return console.error("insight describer received a non-insight activity"),{description:null};if(e.activity=="created")return{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:h(e)})," created the insight:"," ",_(e?.detail.short_id,e?.detail.name)]})};if(e.activity=="deleted")return{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:h(e)})," deleted ",t?"your":"the"," insight:"," ",e.detail.name]})};if(e.activity=="exported for opengraph image")return{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:"PostHog"})," exported ",t?"your":"the"," insight: ",e.detail.name," ","as an image for the shared insight link."]})};if(e.activity=="sharing enabled")return{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:h(e)})," shared ",t?"your":"the"," insight:"," ",e.detail.name,"."]})};if(e.activity=="sharing disabled")return{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:h(e)})," deleted shared link for"," ",t?"your":"the"," insight: ",e.detail.name,"."]})};if(e.activity=="updated"){let n=[],i,r=(0,p.jsxs)(p.Fragment,{children:["on ",t&&" the insight ",_(e?.detail.short_id,e?.detail.name)]});try{for(let o of e.detail.changes||[]){if(!o?.field||!Kt[o.field])continue;let a=Kt[o.field],l=a(o,e,t);if(l===null)continue;let{description:u,extendedDescription:b,suffix:f}=l;u&&(n=n.concat(u)),b&&(i=b),f&&(r=f)}}catch(o){console.error("Error while summarizing insight update",o),ze(o)}if(n.length)return{description:(0,p.jsx)(v,{listParts:n,prefix:(0,p.jsx)("strong",{children:h(e)}),suffix:r}),extendedDescription:i}}if(e.activity==="exported"){let n=e.detail.changes?.[0]?.after,i="in an unknown format";return typeof n=="string"&&(i=n.split("/")[1]),{description:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("strong",{children:h(e)})," exported"," ",_(e?.detail.short_id,e?.detail.name)," as a ",i]})}}return A(e,t,_(e?.detail.short_id))}W();F();V();W();F();V();var T=Symbol("@ts-pattern/matcher"),fe="@ts-pattern/anonymous-select-key",Le=function(e){return!!(e&&typeof e=="object")},he=function(e){return e&&!!e[T]},q=function e(t,n,i){if(Le(t)){if(he(t)){var r=t[T]().match(n),o=r.matched,a=r.selections;return o&&a&&Object.keys(a).forEach(function(u){return i(u,a[u])}),o}if(!Le(n))return!1;if(Array.isArray(t))return!!Array.isArray(n)&&t.length===n.length&&t.every(function(u,b){return e(u,n[b],i)});if(t instanceof Map)return n instanceof Map&&Array.from(t.keys()).every(function(u){return e(t.get(u),n.get(u),i)});if(t instanceof Set){if(!(n instanceof Set))return!1;if(t.size===0)return n.size===0;if(t.size===1){var l=Array.from(t.values())[0];return he(l)?Array.from(n.values()).every(function(u){return e(l,u,i)}):n.has(l)}return Array.from(t.values()).every(function(u){return n.has(u)})}return Object.keys(t).every(function(u){var b,f=t[u];return(u in n||he(b=f)&&b[T]().matcherType==="optional")&&e(f,n[u],i)})}return Object.is(n,t)},j=function e(t){var n,i,r;return Le(t)?he(t)?(n=(i=(r=t[T]()).getSelectionKeys)==null?void 0:i.call(r))!=null?n:[]:Array.isArray(t)?ue(t,e):ue(Object.values(t),e):[]},ue=function(e,t){return e.reduce(function(n,i){return n.concat(t(i))},[])};function en(e){var t;return(t={})[T]=function(){return{match:function(n){var i={},r=function(o,a){i[o]=a};return n===void 0?(j(e).forEach(function(o){return r(o,void 0)}),{matched:!0,selections:i}):{matched:q(e,n,r),selections:i}},getSelectionKeys:function(){return j(e)},matcherType:"optional"}},t}function tn(e){var t;return(t={})[T]=function(){return{match:function(n){if(!Array.isArray(n))return{matched:!1};var i={};if(n.length===0)return j(e).forEach(function(o){i[o]=[]}),{matched:!0,selections:i};var r=function(o,a){i[o]=(i[o]||[]).concat([a])};return{matched:n.every(function(o){return q(e,o,r)}),selections:i}},getSelectionKeys:function(){return j(e)}}},t}function nn(){var e,t=[].slice.call(arguments);return(e={})[T]=function(){return{match:function(n){var i={},r=function(o,a){i[o]=a};return{matched:t.every(function(o){return q(o,n,r)}),selections:i}},getSelectionKeys:function(){return ue(t,j)},matcherType:"and"}},e}function rn(){var e,t=[].slice.call(arguments);return(e={})[T]=function(){return{match:function(n){var i={},r=function(o,a){i[o]=a};return ue(t,j).forEach(function(o){return r(o,void 0)}),{matched:t.some(function(o){return q(o,n,r)}),selections:i}},getSelectionKeys:function(){return ue(t,j)},matcherType:"or"}},e}function an(e){var t;return(t={})[T]=function(){return{match:function(n){return{matched:!q(e,n,function(){})}},getSelectionKeys:function(){return[]},matcherType:"not"}},t}function H(e){var t;return(t={})[T]=function(){return{match:function(n){return{matched:!!e(n)}}}},t}function on(){var e,t=[].slice.call(arguments),n=typeof t[0]=="string"?t[0]:void 0,i=t.length===2?t[1]:typeof t[0]=="string"?void 0:t[0];return(e={})[T]=function(){return{match:function(r){var o,a=((o={})[n??fe]=r,o);return{matched:i===void 0||q(i,r,function(l,u){a[l]=u}),selections:a}},getSelectionKeys:function(){return[n??fe].concat(i===void 0?[]:j(i))}}},e}var sn=H(function(e){return!0}),Sn=sn,Jn=H(function(e){return typeof e=="string"}),Un=H(function(e){return typeof e=="number"}),Qn=H(function(e){return typeof e=="boolean"}),Xn=H(function(e){return typeof e=="bigint"}),xn=H(function(e){return typeof e=="symbol"}),kn=H(function(e){return e==null}),Te={__proto__:null,optional:en,array:tn,intersection:nn,union:rn,not:an,when:H,select:on,any:sn,_:Sn,string:Jn,number:Un,boolean:Qn,bigint:Xn,symbol:xn,nullish:kn,instanceOf:function(e){return H(function(t){return function(n){return n instanceof t}}(e))},typed:function(){return{array:tn,optional:en,intersection:nn,union:rn,not:an,select:on,when:H}}};function ln(e){return new Bn(e,[])}var Bn=function(){function e(n,i){this.value=void 0,this.cases=void 0,this.value=n,this.cases=i}var t=e.prototype;return t.with=function(){var n=[].slice.call(arguments),i=n[n.length-1],r=[n[0]],o=[];return n.length===3&&typeof n[1]=="function"?(r.push(n[0]),o.push(n[1])):n.length>2&&r.push.apply(r,n.slice(1,n.length-1)),new e(this.value,this.cases.concat([{match:function(a){var l={},u=!!(r.some(function(b){return q(b,a,function(f,I){l[f]=I})})&&o.every(function(b){return b(a)}));return{matched:u,value:u&&Object.keys(l).length?fe in l?l[fe]:l:a}},handler:i}]))},t.when=function(n,i){return new e(this.value,this.cases.concat([{match:function(r){return{matched:!!n(r),value:r}},handler:i}]))},t.otherwise=function(n){return new e(this.value,this.cases.concat([{match:function(i){return{matched:!0,value:i}},handler:n}])).run()},t.exhaustive=function(){return this.run()},t.run=function(){for(var n=this.value,i=void 0,r=0;r<this.cases.length;r++){var o=this.cases[r],a=o.match(this.value);if(a.matched){n=a.value,i=o.handler;break}}if(!i){var l;try{l=JSON.stringify(this.value)}catch{l=this.value}throw new Error("Pattern matching error: no pattern matches value "+l)}return i(n,this.value)},e}();var s=Z(R()),te=e=>e==null||e==="",Yn=(e,t,n)=>{let i=t||"(empty string)";return n==="deleted"?(0,s.jsx)("strong",{children:i}):e?(0,s.jsx)(S,{to:C.survey(e),children:i}):i},En={name:function(t){return{description:[(0,s.jsxs)(s.Fragment,{children:["changed the name from ",(0,s.jsxs)("strong",{children:['"',t?.before,'"']})," to"," ",(0,s.jsxs)("strong",{children:['"',t?.after,'"']})]})]}},description:function(t){return{description:[(0,s.jsxs)(s.Fragment,{children:["updated the description from ",ye(t?.before)," to"," ",ye(t?.after)]})]}},type:function(t){return{description:[(0,s.jsxs)(s.Fragment,{children:["changed the type from ",(0,s.jsx)("strong",{children:t?.before})," to"," ",(0,s.jsx)("strong",{children:t?.after})]})]}},questions:function(t){if(!t)return null;let n=t.before,i=t.after;if(n.length!==i.length)return{description:[(0,s.jsxs)(s.Fragment,{children:["changed the number of questions from ",(0,s.jsx)("strong",{children:n.length})," to"," ",(0,s.jsx)("strong",{children:i.length})]})]};let r=i.map((o,a)=>{let l=n[a];return JSON.stringify(l)!==JSON.stringify(o)?{index:a+1,changes:Ln(l,o)}:null}).filter(o=>o!==null);return r.length===0?{description:[(0,s.jsx)(s.Fragment,{children:"No changes to questions"})]}:{description:[(0,s.jsxs)(s.Fragment,{children:["updated ",(0,s.jsx)("strong",{children:r.length})," question",r.length!==1?"s":"",":",(0,s.jsx)("ul",{className:"bullet-list",children:r.map(({index:o,changes:a})=>(0,s.jsxs)("li",{children:["Question ",o,":",(0,s.jsx)("ul",{className:"bullet-list",children:a.map((l,u)=>(0,s.jsx)("li",{children:l},u))})]},o))})]})]}},archived:function(t){return{description:[w(t?.after)?(0,s.jsx)(s.Fragment,{children:"archived"}):(0,s.jsx)(s.Fragment,{children:"unarchived"})]}},start_date:function(t){return t?.before===null&&t?.after!==null?{description:[(0,s.jsx)(s.Fragment,{children:"launched"})]}:null},end_date:function(t){return t?.before===null&&t?.after!==null?{description:[(0,s.jsx)(s.Fragment,{children:"stopped"})]}:null},appearance:function(t){let n=t?.before,i=t?.after,r=[];return Object.entries({backgroundColor:"background color",submitButtonColor:"submit button color",submitButtonText:"submit button text",submitButtonTextColor:"submit button text color",ratingButtonColor:"rating button color",ratingButtonActiveColor:"active rating button color",borderColor:"border color",placeholder:"placeholder text",whiteLabel:"white label option",displayThankYouMessage:"thank you message display",thankYouMessageHeader:"thank you message header",thankYouMessageDescription:"thank you message description",thankYouMessageDescriptionContentType:"thank you message content type",thankYouMessageCloseButtonText:"thank you message close button text",autoDisappear:"auto-disappear option",position:"survey position",shuffleQuestions:"question shuffling",surveyPopupDelaySeconds:"survey popup delay",widgetType:"widget type",widgetSelector:"widget selector",widgetLabel:"widget label",widgetColor:"widget color",zIndex:"survey form zIndex",fontFamily:"font family"}).forEach(([a,l])=>{let u=n?.[a],b=i?.[a],f=O(l,u,b);f.props.children&&r.push(f)}),r.length>0?{description:r}:null},conditions:function(t){let n=t?.before,i=t?.after,r=[];return r.push(O("URL condition",n?.url,i?.url),O("selector",n?.selector,i?.selector),O("wait period",n?.seenSurveyWaitPeriodInDays,i?.seenSurveyWaitPeriodInDays,"days"),O("URL match type",n?.urlMatchType,i?.urlMatchType)),JSON.stringify(n?.events)!==JSON.stringify(i?.events)&&r.push((0,s.jsx)(s.Fragment,{children:"modified event conditions"})),r.filter(o=>o.props.children).length>0?{description:r.filter(o=>o.props.children)}:null},responses_limit:function(t){return{description:[O("response limit",t?.before,t?.after,"responses")].filter(n=>n.props.children)}},iteration_count:function(t){return{description:[O("iteration count",t?.before,t?.after)].filter(n=>n.props.children)}},iteration_frequency_days:function(t){return{description:[O("iteration frequency",t?.before,t?.after,"days")].filter(n=>n.props.children)}},targeting_flag:function(t){let n=t?.before,i=t?.after,r=[];return!n&&i?(r.push((0,s.jsxs)(s.Fragment,{children:["added a targeting flag with key ",(0,s.jsx)("strong",{children:i.key})]})),i.filters?.groups?.length>0&&r.push((0,s.jsxs)(s.Fragment,{children:["set targeting conditions to:",(0,s.jsx)("pre",{children:JSON.stringify(i.filters,null,2)})]}))):n&&!i?r.push((0,s.jsxs)(s.Fragment,{children:["removed the targeting flag with key ",(0,s.jsx)("strong",{children:n.key})]})):n&&i&&n.key!==i.key&&r.push((0,s.jsxs)(s.Fragment,{children:["changed targeting flag key from ",(0,s.jsx)("strong",{children:n.key})," to"," ",(0,s.jsx)("strong",{children:i.key})]})),r.length>0?{description:r}:null},targeting_flag_filters:function(t){let n=t?.before,i=t?.after,r=[];return!n&&i?r.push((0,s.jsxs)(s.Fragment,{children:["added targeting flag filter with the following conditions:",(0,s.jsx)("pre",{children:JSON.stringify(i,null,2)})]})):n&&!i?r.push((0,s.jsx)(s.Fragment,{children:"removed targeting flag filter"})):n&&i&&JSON.stringify(n)!==JSON.stringify(i)&&r.push((0,s.jsxs)(s.Fragment,{children:["changed targeting conditions from:",(0,s.jsx)("pre",{children:JSON.stringify(n,null,2)}),"to:",(0,s.jsx)("pre",{children:JSON.stringify(i,null,2)})]})),r.length>0?{description:r}:null}};function cn(e,t){if(e.scope!=="Survey")return console.error("survey describer received a non-survey activity"),{description:null};let n=(0,s.jsx)("strong",{children:h(e)}),i=Yn(e?.item_id,e?.detail.name,e.activity);if(e.activity==="created")return{description:(0,s.jsxs)(s.Fragment,{children:[n," created ",i]})};if(e.activity==="deleted")return{description:(0,s.jsxs)(s.Fragment,{children:[n," deleted ",i]})};if(e.activity==="updated"){let r=[];for(let o of e.detail.changes||[]){if(!o?.field)continue;let a=En[o.field]?.(o,e);a?.description&&(Array.isArray(a.description)&&a.description.length>1?r.push(...a.description.map(l=>({field:"conditions",description:l}))):r.push({field:o.field,description:a.description[0]}))}if(r.length===1){let{field:o,description:a}=r[0],l=o==="conditions"?"for":Dn(o);return{description:(0,s.jsxs)(s.Fragment,{children:[n," ",a," ",l," ",i]})}}else if(r.length>1)return{description:(0,s.jsxs)(s.Fragment,{children:[n," made multiple changes to ",i,":",(0,s.jsx)("ul",{className:"bullet-list",children:r.map(({description:o},a)=>(0,s.jsx)("li",{children:o},a))})]})}}return A(e,t,i)}function Dn(e){switch(e){case"questions":case"appearance":case"type":return"of";case"name":case"description":case"responses_limit":case"iteration_count":case"iteration_frequency_days":case"targeting_flag_filters":case"targeting_flag":return"for";case"archived":case"start_date":case"end_date":return"";default:return"of"}}function Ln(e,t){let n=Tn(e,t),i=e.type!==t.type?[(0,s.jsxs)(s.Fragment,{children:["changed question type from ",(0,s.jsx)("strong",{children:ve[e.type]})," to"," ",(0,s.jsx)("strong",{children:ve[t.type]})]})]:[],r=ln([e,t]).with([{type:"link"},{type:"link"}],Mn).with([{type:"rating"},{type:"rating"}],wn).with([{type:Te.union("single_choice","multiple_choice")},{type:Te.union("single_choice","multiple_choice")}],_n).otherwise(()=>[]);return[...n,...i,...r,...Hn(e,t)]}function Tn(e,t){let n=[];return e.question!==t.question&&n.push((0,s.jsxs)(s.Fragment,{children:['changed question text from "',(0,s.jsx)("strong",{children:e.question}),'" to "',(0,s.jsx)("strong",{children:t.question}),'"']})),e.description!==t.description&&n.push((0,s.jsxs)(s.Fragment,{children:["changed the question description from ",ye(e.description)," to"," ",ye(t.description)]})),e.optional!==t.optional&&n.push((0,s.jsx)(s.Fragment,{children:t.optional?"made question optional":"made question required"})),e.buttonText!==t.buttonText&&n.push((0,s.jsxs)(s.Fragment,{children:['changed button text from "',(0,s.jsx)("strong",{children:e.buttonText}),'" to "',(0,s.jsx)("strong",{children:t.buttonText}),'"']})),n}function Mn([e,t]){return e.link!==t.link?[(0,s.jsxs)(s.Fragment,{children:["updated link from ",(0,s.jsx)("strong",{children:e.link})," to ",(0,s.jsx)("strong",{children:t.link})]})]:[]}function wn([e,t]){let n=[];return e.display!==t.display&&n.push((0,s.jsxs)(s.Fragment,{children:["changed rating display from ",(0,s.jsx)("strong",{children:e.display})," to ",(0,s.jsx)("strong",{children:t.display})]})),e.scale!==t.scale&&n.push((0,s.jsxs)(s.Fragment,{children:["changed rating scale from ",(0,s.jsx)("strong",{children:e.scale})," to ",(0,s.jsx)("strong",{children:t.scale})]})),(e.lowerBoundLabel!==t.lowerBoundLabel||e.upperBoundLabel!==t.upperBoundLabel)&&n.push((0,s.jsxs)(s.Fragment,{children:["updated rating labels from ",(0,s.jsxs)("strong",{children:['"',e.lowerBoundLabel,'"']}),"-",(0,s.jsxs)("strong",{children:['"',e.upperBoundLabel,'"']})," to ",(0,s.jsxs)("strong",{children:['"',t.lowerBoundLabel,'"']}),"-",(0,s.jsxs)("strong",{children:['"',t.upperBoundLabel,'"']})]})),n}function _n([e,t]){let n=[];if(JSON.stringify(e.choices)!==JSON.stringify(t.choices)){let i=t.choices.filter(o=>!e.choices.includes(o)),r=e.choices.filter(o=>!t.choices.includes(o));i.length>0&&n.push((0,s.jsxs)(s.Fragment,{children:["added choices: ",(0,s.jsx)("strong",{children:i.join(", ")})]})),r.length>0&&n.push((0,s.jsxs)(s.Fragment,{children:["removed choices: ",(0,s.jsx)("strong",{children:r.join(", ")})]}))}return e.shuffleOptions!==t.shuffleOptions&&n.push((0,s.jsxs)(s.Fragment,{children:[t.shuffleOptions?"enabled":"disabled"," option shuffling"]})),e.hasOpenChoice!==t.hasOpenChoice&&n.push((0,s.jsxs)(s.Fragment,{children:[t.hasOpenChoice?"added":"removed"," open choice option"]})),n}function Hn(e,t){return JSON.stringify(e.branching)!==JSON.stringify(t.branching)?[(0,s.jsx)(s.Fragment,{children:"updated branching logic"})]:[]}var ye=e=>e==null||e===""?(0,s.jsx)("i",{children:"unset"}):(0,s.jsxs)("strong",{children:['"',Pe(e,50),'"']});function O(e,t,n,i){return te(t)&&te(n)?(0,s.jsx)(s.Fragment,{}):te(t)&&!te(n)?(0,s.jsxs)(s.Fragment,{children:["set ",e," to"," ",(0,s.jsxs)("strong",{children:[String(n),i?` ${i}`:""]})]}):!te(t)&&te(n)?(0,s.jsxs)(s.Fragment,{children:["removed ",e," (was"," ",(0,s.jsxs)("strong",{children:[String(t),i?` ${i}`:""]}),")"]}):t!==n?(0,s.jsxs)(s.Fragment,{children:["changed ",e," from"," ",(0,s.jsxs)("strong",{children:[String(t),i?` ${i}`:""]})," ","to"," ",(0,s.jsxs)("strong",{children:[String(n),i?` ${i}`:""]})]}):(0,s.jsx)(s.Fragment,{})}W();F();V();var d=Z(R()),dn={session_recording_minimum_duration_milliseconds:e=>{let t=e?.after;if(t===void 0||typeof t!="number")return null;let n="changed";return e?.action==="created"&&(n="set"),{description:[(0,d.jsxs)(d.Fragment,{children:[n," the minimum session recording duration to ",t/1e3," seconds"]})]}},session_recording_url_trigger_config(e){let t=e?.before,n=e?.after;return t===null&&n===null?null:{description:[(0,d.jsx)(d.Fragment,{children:"Changed session replay URL triggers"})]}},session_recording_url_blocklist_config(e){let t=e?.before,n=e?.after;return t===null&&n===null?null:{description:[(0,d.jsx)(d.Fragment,{children:"Changed session replay URL blocklist"})]}},session_recording_event_trigger_config(e){let t=e?.before,n=e?.after;return t===null&&n===null?null:{description:[(0,d.jsx)(d.Fragment,{children:"Changed session replay event triggers"})]}},capture_console_log_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," console log capture in session replay"]})]}},capture_performance_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," console network performance capture in session replay"]})]}},capture_dead_clicks(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," dead clicks autocapture"]})]}},recording_domains(e){let t=Array.isArray(e?.before)?e?.before.map(String)??null:null,n=Array.isArray(e?.after)?e?.after.map(String)??null:null;if(n===null&&t===null)return null;let i=[],r=[];if(n)for(let a of n)(!t||!t.includes(a))&&a.trim().length>0&&r.push(a);r.length&&i.push((0,d.jsxs)(d.Fragment,{children:["added ",r.join(", ")," to session recording authorised"," ",B(r.length,"domain","domains",!1)]}));let o=[];if(t)for(let a of t)(!n||!n.includes(a))&&a.trim().length>0&&o.push(a);return o.length&&i.push((0,d.jsxs)(d.Fragment,{children:["removed ",o.join(", ")," from session recording authorised"," ",B(o.length,"domain","domains",!1)]})),{description:i}},session_recording_linked_flag(e){let t=e?.after?.key??e?.before?.key??String(e?.after);return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"linked":"unlinked"," session recording to feature flag ",t]})]}},session_recording_network_payload_capture_config(e){let t=ne(e?.before)?e?.before.recordBody:!!e?.before,n=ne(e?.after)?e?.after.recordBody:!!e?.after,i=t!==n,r=ne(e?.before)?e?.before.recordHeaders:!!e?.before,o=ne(e?.after)?e?.after.recordHeaders:!!e?.after,a=r!==o,l=[];return i&&l.push((0,d.jsxs)(d.Fragment,{children:[n?"enabled":"disabled"," network body capture in session replay"]})),a&&l.push((0,d.jsxs)(d.Fragment,{children:[o?"enabled":"disabled"," network headers capture in session replay"]})),l.length?{description:l}:null},session_recording_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," session recording"]})]}},session_recording_sample_rate(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.action==="created"?"set":"changed"," the session recording sample rate to"," ",e?.after,"%"]})]}},survey_config:e=>{let t=e.before,n=e.after,i=[],r="Survey Configuration : ";t===void 0&&i.push("Survey Configuration was enabled");let o=(a,l)=>{l(t)!==l(n)&&i.push(`${r} ${a} was changed from "${l(t)}" to "${l(n)}"`)};return t?.appearance?.whiteLabel!==n?.appearance?.whiteLabel&&i.push(`${r} Survey white labeling was ${n?.appearance?.whiteLabel?"enabled":"disabled"}`),t?.appearance?.displayThankYouMessage!==n?.appearance?.displayThankYouMessage&&i.push(`${r} displayThankYouMessage was ${n?.appearance?.whiteLabel?"enabled":"disabled"}`),o("backgroundColor",a=>a?.appearance?.backgroundColor),o("submitButtonColor",a=>a?.appearance?.submitButtonColor),o("submitButtonTextColor",a=>a?.appearance?.submitButtonTextColor),o("ratingButtonColor",a=>a?.appearance?.ratingButtonColor),o("ratingButtonActiveColor",a=>a?.appearance?.ratingButtonActiveColor),o("borderColor",a=>a?.appearance?.borderColor),o("placeholder",a=>a?.appearance?.placeholder),o("thankYouMessageHeader",a=>a?.appearance?.thankYouMessageHeader),o("position",a=>a?.appearance?.position),{description:i}},session_replay_config(e){let t=e?.after,n=t&&typeof t=="object"&&!Array.isArray(t)?t.record_canvas:null;return n===null?null:{description:[(0,d.jsxs)(d.Fragment,{children:[n?"enabled":"disabled"," canvas recording in session replay"]})]}},autocapture_exceptions_errors_to_ignore:()=>null,autocapture_exceptions_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," exception autocapture"]})]}},autocapture_web_vitals_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," web vitals autocapture"]})]}},autocapture_web_vitals_allowed_metrics(e){let t=e?.after,n=Array.isArray(t)?t.join(", "):"CLS, FCP, INP, and LCP";return{description:[(0,d.jsxs)(d.Fragment,{children:["set allowed web vitals autocapture metrics to ",n]})]}},autocapture_opt_out(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"opted out of":"opted in to"," autocapture"]})]}},heatmaps_opt_in(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled"," heatmaps"]})]}},name(e){return{description:[(0,d.jsxs)(d.Fragment,{children:[e?.action==="created"?"set":"changed"," the team name to ",e?.after]})]}},test_account_filters:e=>{let t=Array.isArray(e?.after)?e?.after||[]:[],n=Array.isArray(e?.before)?e?.before||[]:[],i=t.filter(a=>!n.some(l=>l.key===a.key)),r=n.filter(a=>!t.some(l=>l.key===a.key)),o=[];return i.length&&o.push((0,d.jsxs)(d.Fragment,{children:["added ",(0,d.jsx)(Ue,{filters:i})]})),r.length&&o.push((0,d.jsxs)(d.Fragment,{children:["removed ",(0,d.jsx)(Ue,{filters:r})]})),o.length===0?null:{description:[(0,d.jsx)(d.Fragment,{children:'Updated the "internal and test" account filters'}),(0,d.jsx)(v,{listParts:o},0)]}},test_account_filters_default_checked:e=>({description:[(0,d.jsxs)(d.Fragment,{children:[e?.after?"enabled":"disabled",' "internal & test account filters" for all insights']})]}),extra_settings:e=>{let t=e?.after;if(typeof t!="object")return null;let n=[];for(let i in t)i==="poe_v2_enabled"&&n.push((0,d.jsxs)(d.Fragment,{children:[t[i]?"enabled":"disabled"," Person on Events (v2)"]}));return{description:n}},modifiers:e=>{let t=e?.after;if(typeof t!="object")return null;let n=[];for(let i in t)n.push((0,d.jsxs)(d.Fragment,{children:["set ",(0,d.jsx)("em",{children:i}),' to "',String(t[i]),'"']}));return{description:n}},default_data_theme:e=>({description:[(0,d.jsxs)(d.Fragment,{children:["changed the default color theme"," ",e?.before&&(0,d.jsxs)(d.Fragment,{children:["from ",(0,d.jsx)(Re,{id:e.before})," "]}),"to"," ",(0,d.jsx)("em",{children:(0,d.jsx)(Re,{id:e?.after})})]})]}),human_friendly_comparison_periods:e=>e?{description:[(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("strong",{children:e?.after?"enabled":"disabled"})," human friendly comparison periods"]})]}:null,revenue_tracking_config:e=>{if(!e)return null;let t=typeof e.before=="object"&&e.before&&"events"in e.before?e.before.events:[],n=typeof e.after=="object"&&e.after&&"events"in e.after?e.after.events:[],i=t?.map(b=>b?.eventName),r=n?.map(b=>b?.eventName),o=r?.filter(b=>!i?.includes(b)),a=i?.filter(b=>!r?.includes(b)),l=r?.filter(b=>i?.includes(b)),u=[o?.length?`added ${o.length} ${B(o.length,"event","events",!0)} (${o.join(", ")})`:null,a?.length?`removed ${a.length} ${B(a.length,"event","events",!0)} (${a.join(", ")})`:null,l?.length?`modified ${l.length} ${B(l.length,"event","events",!0)} (${l.join(", ")})`:null].filter(Ke);return u.length?{description:[(0,d.jsxs)(d.Fragment,{children:["Updated revenue tracking config: ",u.join(", ")]})]}:null},access_control:()=>null,anonymize_ips:()=>null,app_urls:()=>null,completed_snippet_onboarding:()=>null,correlation_config:()=>null,data_attributes:()=>null,effective_membership_level:()=>null,has_group_types:()=>null,ingested_event:()=>null,is_demo:()=>null,live_events_columns:()=>null,organization:()=>null,project_id:()=>null,path_cleaning_filters:()=>null,person_display_name_properties:()=>null,person_on_events_querying_enabled:()=>null,primary_dashboard:()=>null,slack_incoming_webhook:()=>null,timezone:()=>null,surveys_opt_in:()=>null,flags_persistence_default:()=>null,week_start_day:()=>null,default_modifiers:()=>null,has_completed_onboarding_for:()=>null,onboarding_tasks:()=>null,created_at:()=>null,api_token:()=>null,id:()=>null,updated_at:()=>null,uuid:()=>null,user_access_level:()=>null,live_events_token:()=>null,product_intents:()=>null,cookieless_server_hash_mode:()=>null,access_control_version:()=>null};function un(e){return e?.detail?.short_id?(0,d.jsx)(S,{to:C.notebook(e.detail.short_id),children:e?.detail.name||"unknown"}):e?.detail.name?(0,d.jsx)(d.Fragment,{children:e?.detail.name}):(0,d.jsx)("i",{children:"Untitled"})}function pn(e,t){if(e.scope!=="Team")return console.error("team describer received a non-Team activity"),{description:null};if(e.activity=="changed"||e.activity=="updated"){let n=[],i=(0,d.jsxs)(d.Fragment,{children:["on ",un(e)]});for(let r of e.detail.changes||[]){if(!r?.field||!(r.field in dn))continue;let o=dn[r.field],a=o(r,e);if(a===null)continue;let{description:l,suffix:u}=a;l&&(n=n.concat(l)),u&&(i=u)}if(n.length)return{description:(0,d.jsx)(v,{listParts:n,prefix:(0,d.jsx)("strong",{children:h(e)}),suffix:i})}}return A(e,t,un(e))}var zn=e=>{switch(e?.scope){case"FeatureFlag":return Et;case"Plugin":case"PluginConfig":return zt;case"HogFunction":return _t;case"Cohort":return xt;case"Insight":return $t;case"Person":return Mt;case"EventDefinition":case"PropertyDefinition":return Yt;case"Notebook":return Tt;case"Team":return pn;case"Survey":return cn;default:return(t,n)=>A(t,n)}},mn=(0,U.kea)([(0,U.props)({}),(0,U.key)(({scope:e,id:t})=>`activity/${Array.isArray(e)?e.join(","):e}/${t||"all"}`),(0,U.path)(e=>["lib","components","ActivityLog","activitylog","logic",e]),(0,U.actions)({setPage:e=>({page:e})}),(0,gn.loaders)(({values:e,props:t})=>({activity:[{results:[],count:0},{fetchActivity:async()=>{let n=await Zt.activity.listLegacy(t,e.page);return{results:n.results,count:n.total_count??n.count}}}]})),(0,U.reducers)(()=>({page:[1,{setPage:(e,{page:t})=>t}]})),(0,U.selectors)(({actions:e})=>({pagination:[t=>[t.page,t.totalCount],(t,n)=>({controlled:!0,pageSize:He,currentPage:t,entryCount:n||0,onBackward:()=>e.setPage(t-1),onForward:()=>e.setPage(t+1)})],humanizedActivity:[t=>[t.activity],t=>t.results?Xt(t.results,zn):[]],totalCount:[t=>[t.activity],t=>t.count??null]})),(0,U.listeners)(({actions:e})=>({setPage:async(t,n)=>{n(),e.fetchActivity()}})),(0,P.urlToAction)(({values:e,actions:t,props:n})=>{let i=(r,o,a,l)=>{let u=r.page,b=Array.isArray(n.scope)?n.scope[0]:n.scope;(l||a==="Person"&&o.activeTab==="history"||["FeatureFlag","Insight","Plugin"].includes(a)&&r.tab==="history")&&u&&u!==e.page&&a===b&&t.setPage(u);let I=a==="Person"&&o.activeTab!=="history"||["FeatureFlag","Insight","Plugin"].includes(a)&&r.tab!=="history";if(!l&&I&&"page"in P.router.values.searchParams){let{page:Y,...M}=P.router.values.searchParams;P.router.actions.replace(P.router.values.currentLocation.pathname,M,P.router.values.hashParams)}};return{"/person/*":(r,o,a)=>i(o,a,"Person"),[C.featureFlags()]:(r,o,a)=>i(o,a,"FeatureFlag"),[C.savedInsights()]:(r,o,a)=>i(o,a,"Insight"),[C.featureFlag(":id")]:(r,o,a)=>i(o,a,"FeatureFlag",!0),[C.pipelineNode("destination",":id","history")]:(r,o,a)=>i(o,a,"HogFunction"),[C.pipeline("history")]:(r,o,a)=>i(o,a,"Plugin")}}),(0,U.events)(({actions:e})=>({afterMount:()=>{e.fetchActivity()}}))]);var N=Z(R()),jn=({scope:e})=>{let t=(Array.isArray(e)?e[0]:e).replace(/([A-Z])/g," $1").trim().toLowerCase();return(0,N.jsx)(yt,{productName:t.toUpperCase(),productKey:"history",thingName:"history record",description:`History shows any ${t} changes that have been made. After making changes you'll see them logged here.`,isEmpty:!0})},be=()=>(0,N.jsxs)("div",{className:"ActivityLogRow items-start",children:[(0,N.jsx)(pe.Circle,{}),(0,N.jsxs)("div",{className:"details space-y-4 mt-2",children:[(0,N.jsx)(pe,{className:"w-1/2 h-4"}),(0,N.jsx)(pe,{})]})]}),On=()=>(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(be,{}),(0,N.jsx)(be,{}),(0,N.jsx)(be,{}),(0,N.jsx)(be,{})]}),Pn=({logItem:e,showExtendedDescription:t,renderSideAction:n})=>(0,N.jsxs)("div",{className:(0,hn.default)("ActivityLogRow",e.unread&&"ActivityLogRow--unread"),children:[(0,N.jsx)(ae,{showName:!1,user:{first_name:e.isSystem?e.name:void 0,email:e.email??void 0},type:e.isSystem?"system":"person",size:"xl"}),(0,N.jsxs)("div",{className:"ActivityLogRow__details",children:[(0,N.jsx)("div",{className:"ActivityLogRow__description",children:e.description}),t&&e.extendedDescription&&(0,N.jsx)("div",{className:"ActivityLogRow__description__extended",children:e.extendedDescription}),(0,N.jsx)("div",{className:"text-secondary",children:(0,N.jsx)($,{time:e.created_at})})]}),n?.(e)]}),ll=({scope:e,id:t,caption:n,startingPage:i=1,renderSideAction:r})=>{let o=mn({scope:e,id:t,caption:n,startingPage:i}),{humanizedActivity:a,activityLoading:l,pagination:u}=(0,Ze.useValues)(o),{user:b}=(0,Ze.useValues)(bt),{featureFlags:f}=(0,Ze.useValues)(qe),I=it(a||[],u);return(0,N.jsxs)("div",{className:"ActivityLog",children:[n&&(0,N.jsx)("div",{className:"page-caption",children:n}),(0,N.jsx)(ut,{feature:"audit_logs",overrideShouldShowGate:b?.is_impersonated||!!f[_e.AUDIT_LOGS_ACCESS],children:l&&a.length===0?(0,N.jsx)(On,{}):a.length===0?(0,N.jsx)(jn,{scope:e}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("div",{className:"space-y-2",children:a.map((Y,M)=>(0,N.jsx)(Pn,{logItem:Y,showExtendedDescription:!0,renderSideAction:r},M))}),(0,N.jsx)(ie,{}),(0,N.jsx)(nt,{...I,nouns:["activity","activities"]})]})})]})};export{Ye as a,Ee as b,De as c,$a as d,Xt as e,h as f,Qe as g,le as h,ke as i,Pr as j,Kr as k,qr as l,$r as m,ea as n,Ue as o,zn as p,mn as q,Pn as r,ll as s};
//# sourceMappingURL=/static/chunk-MOVKLCV5.js.map
