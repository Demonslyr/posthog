import{d as O}from"/static/chunk-NUJQT2B6.js";import"/static/chunk-336DAFEI.js";import"/static/chunk-LZ4U35M5.js";import{a as H}from"/static/chunk-XW2JOKCQ.js";import{a as j}from"/static/chunk-RSTRTBMR.js";import{An as U,Do as R,Gm as I,Io as A,Np as G,Oh as w,On as k,Pn as x,Qn as E,Rn as D,Sd as m,Tn as M,Vd as _,Za as $,a as L,ak as P,bh as F,bk as C,dk as T,ee as S,f as Z,hk as h,r as N,se as a,ve as b,vo as W,zn as B}from"/static/chunk-RFJTZKD6.js";import"/static/chunk-XPJ4MQJV.js";import{da as Y}from"/static/chunk-3UDJFOQH.js";import"/static/chunk-HHT4SG7V.js";import"/static/chunk-K7LQKAJG.js";import"/static/chunk-QQTK3LZH.js";import"/static/chunk-IJQNM355.js";import"/static/chunk-4CN6THWS.js";import"/static/chunk-272RTCFX.js";import"/static/chunk-2ROB4QWU.js";import"/static/chunk-ALT2ZZSO.js";import"/static/chunk-UE6SLBBN.js";import"/static/chunk-GINZUAUY.js";import"/static/chunk-SQELCOUW.js";import"/static/chunk-IGYUTZ65.js";import"/static/chunk-YM6UBNGD.js";import"/static/chunk-C6TQ5FFZ.js";import"/static/chunk-GXGA523B.js";import"/static/chunk-N4MMWRNK.js";import"/static/chunk-NRLAI7OY.js";import"/static/chunk-LVVHNICT.js";import"/static/chunk-2AXSSSSX.js";import"/static/chunk-DGXQI7RB.js";import"/static/chunk-HUCRWDLX.js";import"/static/chunk-RFEQG3YN.js";import"/static/chunk-PUISI233.js";import{d as o,e as u,g,j as f}from"/static/chunk-SJXEOBQC.js";u();f();g();var d=o(L());u();f();g();var q=o(Y()),s=o(L()),z=o($()),p=o(Z());var v=(0,s.kea)([(0,s.path)(e=>["scenes","session-recordings","playlist","sessionRecordingsPlaylistSceneLogic",e]),(0,s.props)({}),(0,s.key)(e=>e.shortId),(0,s.connect)({values:[w,["cohortsById"],G,["activeScene"]]}),(0,s.actions)({updatePlaylist:(e,i=!1)=>({properties:e,silent:i}),setFilters:e=>({filters:e}),loadPinnedRecordings:!0,onPinnedChange:(e,i)=>({pinned:i,recording:e})}),(0,z.loaders)(({values:e,props:i})=>({playlist:[null,{getPlaylist:async()=>x(i.shortId),updatePlaylist:async({properties:l,silent:r})=>e.playlist?.short_id?E(e.playlist?.short_id,l??{filters:e.filters||void 0},r):e.playlist,duplicatePlaylist:async()=>D(e.playlist??{},!0),deletePlaylist:async()=>e.playlist?M(e.playlist,()=>{p.router.actions.replace(R.replay("playlists"))}):null}],pinnedRecordings:[null,{loadPinnedRecordings:async(l,r)=>{if(!i.shortId)return null;await r(100);let n=await A.recordings.listPlaylistRecordings(i.shortId,{limit:T});return r(),n.results},onPinnedChange:async({recording:l,pinned:r})=>{let n=e.pinnedRecordings??[];return n=n.filter(c=>c.id!==l.id),r?(await B(i.shortId,l.id),n.push(l)):await U(i.shortId,l.id),n}}]})),(0,s.reducers)(()=>({filters:[null,{getPlaylistSuccess:(e,{playlist:i})=>i?.filters||null,updatePlaylistSuccess:(e,{playlist:i})=>i?.filters||null,setFilters:(e,{filters:i})=>i}]})),(0,s.listeners)(({actions:e,values:i})=>({getPlaylistSuccess:()=>{i.playlist?.derived_name!==i.derivedName&&e.updatePlaylist({derived_name:i.derivedName},!0)}})),(0,p.beforeUnload)(({values:e,actions:i})=>({enabled:l=>e.activeScene==="ReplayPlaylist"&&e.hasChanges&&l?.pathname!==p.router.values.location.pathname,message:`Leave playlist?
Changes you made will be discarded.`,onConfirm:()=>{i.setFilters(e.playlist?.filters||null)}})),(0,s.selectors)(({asyncActions:e})=>({breadcrumbs:[i=>[i.playlist],i=>[{key:"Replay",name:"Replay",path:R.replay()},{key:"playlists",name:"Playlists",path:R.replay("playlists")},{key:["ReplayPlaylist",i?.short_id||"new"],name:i?.name||i?.derived_name||"Unnamed",onRename:async l=>{if(!i){_.error("Cannot rename unsaved playlist");return}await e.updatePlaylist({short_id:i.short_id,name:l})}}]],hasChanges:[i=>[i.playlist,i.filters],(i,l)=>!(0,q.default)(i?.filters,l)],derivedName:[i=>[i.filters,i.cohortsById],(i,l)=>{if(!i)return"Unnamed";let r=P(i)?i:h({},i);return k(C(r),l)?.slice(0,400)||"Unnamed"}]})),(0,s.afterMount)(({actions:e})=>{e.getPlaylist(),e.loadPinnedRecordings()})]);var t=o(N()),We={component:se,logic:v,paramsToProps:({params:{id:e}})=>({shortId:e})};function se(){let{playlist:e,playlistLoading:i,pinnedRecordings:l,hasChanges:r}=(0,d.useValues)(v),{setFilters:n,updatePlaylist:c,duplicatePlaylist:J,deletePlaylist:K,onPinnedChange:V}=(0,d.useActions)(v),{showFilters:y}=(0,d.useValues)(F),{setShowFilters:X}=(0,d.useActions)(F);return!e&&i?(0,t.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,t.jsx)(a,{className:"h-10 w-1/4"}),(0,t.jsx)(a,{className:"h-4 w-1/3"}),(0,t.jsx)(a,{className:"h-4 w-1/4"}),(0,t.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,t.jsx)(a.Button,{}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(a.Button,{}),(0,t.jsx)(a.Button,{})]})]}),(0,t.jsxs)("div",{className:"flex justify-between gap-4 mt-8",children:[(0,t.jsx)("div",{className:"space-y-8 w-1/4",children:(0,t.jsx)(a,{className:"h-10",repeat:10})}),(0,t.jsx)("div",{className:"flex-1"})]})]}):e?(0,t.jsxs)("div",{className:"-mb-14",children:[(0,t.jsx)(W,{buttons:(0,t.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[(0,t.jsx)(b,{overlay:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{onClick:()=>J(),fullWidth:!0,"data-attr":"duplicate-playlist",children:"Duplicate"}),(0,t.jsx)(m,{onClick:()=>c({short_id:e.short_id,pinned:!e.pinned}),fullWidth:!0,children:e.pinned?"Unpin playlist":"Pin playlist"}),(0,t.jsx)(S,{}),(0,t.jsx)(m,{status:"danger",onClick:()=>K(),fullWidth:!0,children:"Delete playlist"})]})}),(0,t.jsx)(S,{vertical:!0}),(0,t.jsx)(m,{type:"primary",disabledReason:y&&!r?"No changes to save":void 0,loading:r&&i,onClick:()=>{y?c():X(!y)},children:y?(0,t.jsx)(t.Fragment,{children:"Save changes"}):(0,t.jsx)(t.Fragment,{children:"Edit"})})]}),caption:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H,{multiline:!0,name:"description",markdown:!0,value:e.description||"",placeholder:"Description (optional)",onSave:Q=>c({description:Q}),saveOnBlur:!0,maxLength:400,"data-attr":"playlist-description",compactButtons:!0}),(0,t.jsx)(j,{at:e.last_modified_at,by:e.last_modified_by,className:"mt-2"})]})}),e.short_id&&l!==null?(0,t.jsx)("div",{className:"SessionRecordingPlaylistHeightWrapper",children:(0,t.jsx)(O,{logicKey:e.short_id,filters:e.filters&&P(e.filters)?e.filters:h({},e.filters),onFiltersChange:n,onPinnedChange:V,pinnedRecordings:l??[],updateSearchParams:!0})}):null]}):(0,t.jsx)(I,{object:"Recording Playlist"})}export{se as SessionRecordingsPlaylistScene,We as scene};
//# sourceMappingURL=/static/SessionRecordingsPlaylistScene-BDF6JSTZ.js.map
