import{a as Wn}from"/static/chunk-VUSJMGUX.js";import{a as Vt,b as je,c as vo,d as le,e as Hn,g as An}from"/static/chunk-XP6SEOGC.js";import"/static/chunk-R2FGESDV.js";import"/static/chunk-FGATK7EO.js";import"/static/chunk-UNRPRUE4.js";import"/static/chunk-FB53JKJK.js";import"/static/chunk-ZDFMFKTJ.js";import"/static/chunk-VZDALGXW.js";import"/static/chunk-4MNNHUJC.js";import"/static/chunk-MHUMFW53.js";import"/static/chunk-I3JBH3PJ.js";import"/static/chunk-X3DMY2SE.js";import"/static/chunk-N2KORDXB.js";import"/static/chunk-G6Q3YRDS.js";import"/static/chunk-VVSLW35Y.js";import"/static/chunk-KYJ4OXJI.js";import"/static/chunk-GVAK35JD.js";import"/static/chunk-HOCRDURT.js";import"/static/chunk-KHKNIVWH.js";import"/static/chunk-34UVU7UN.js";import"/static/chunk-LZWHW4MC.js";import"/static/chunk-DYVMG6MY.js";import"/static/chunk-44P5EQSU.js";import"/static/chunk-GH3IWF3M.js";import{a as Sn,b as kn,c as In,e as En,f as Ln,g as Tn,h as Nn,i as wo,j as zn,k as Dn,m as Pn}from"/static/chunk-XSEDUXPL.js";import"/static/chunk-HRNZBUVG.js";import"/static/chunk-OKGJSIGC.js";import{b as xn,f as Cn,h as Rn}from"/static/chunk-2HTNY362.js";import"/static/chunk-S27Q4QO6.js";import"/static/chunk-JUFFFVO5.js";import"/static/chunk-JZCOVRBI.js";import{Ae as cn,Cd as an,Hg as fn,Ig as gn,Il as Ye,Io as Mn,Jl as wn,Lb as mo,Mb as en,Mi as pn,Ne as un,Oc as on,Pk as yn,Qd as ho,Sa as po,Sc as nn,Sd as oe,Tg as Qt,Vg as ce,Vn as yo,Wb as tn,Wh as gt,Wn as vn,Zi as mn,a as Se,ad as rn,c as li,ce as sn,eb as Zo,ee as bo,ej as hn,f as di,fe as ut,fj as bn,g as ci,h as go,ke as ln,m as Gt,pe as dn,r as Y,ze as ft}from"/static/chunk-RFJTZKD6.js";import"/static/chunk-XPJ4MQJV.js";import{F as At,a as He,kb as ct}from"/static/chunk-3UDJFOQH.js";import"/static/chunk-HHT4SG7V.js";import"/static/chunk-K7LQKAJG.js";import"/static/chunk-QQTK3LZH.js";import"/static/chunk-IJQNM355.js";import"/static/chunk-4CN6THWS.js";import"/static/chunk-272RTCFX.js";import"/static/chunk-2ROB4QWU.js";import"/static/chunk-ALT2ZZSO.js";import"/static/chunk-UE6SLBBN.js";import"/static/chunk-GINZUAUY.js";import"/static/chunk-SQELCOUW.js";import"/static/chunk-IGYUTZ65.js";import"/static/chunk-YM6UBNGD.js";import"/static/chunk-C6TQ5FFZ.js";import"/static/chunk-GXGA523B.js";import"/static/chunk-N4MMWRNK.js";import"/static/chunk-NRLAI7OY.js";import"/static/chunk-LVVHNICT.js";import"/static/chunk-2AXSSSSX.js";import"/static/chunk-DGXQI7RB.js";import"/static/chunk-HUCRWDLX.js";import"/static/chunk-RFEQG3YN.js";import"/static/chunk-PUISI233.js";import{d as W,e as O,g as B,j as $}from"/static/chunk-SJXEOBQC.js";O();$();B();var Pe=W(Se());var Kt=W(He());O();$();B();var ke=W(Se());var ui=100,Gn=350,fi=100,gi=300,Ft=(0,ke.kea)([(0,ke.path)(["scenes","data-warehouse","editor","editorSizingLogic"]),(0,ke.props)({}),(0,ke.connect)(e=>({values:[yo(e.sourceNavigatorResizerProps),["desiredSize as sourceNavigatorDesiredSize"],yo(e.queryPaneResizerProps),["desiredSize as queryPaneDesiredSize"]]})),(0,ke.selectors)({editorSceneRef:[()=>[(e,t)=>t.editorSceneRef],e=>e],sourceNavigatorWidth:[e=>[e.sourceNavigatorDesiredSize],e=>Math.max(e||Gn,ui)],queryPaneHeight:[e=>[e.queryPaneDesiredSize],e=>Math.max(e||gi,fi)],queryTabsWidth:[e=>[e.queryPaneDesiredSize],e=>e||Gn],sourceNavigatorResizerProps:[()=>[(e,t)=>t.sourceNavigatorResizerProps],e=>e],queryPaneResizerProps:[()=>[(e,t)=>t.queryPaneResizerProps],e=>e]})]);O();$();B();var re=W(Se()),vr=W(di());var xr=W(He());O();$();B();var Eo=W(go()),ue=W(Se());var De=W(He());O();$();B();var y=W(He(),1),mt=W(li(),1);O();$();B();function Qn(e){var t,o,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(o=Qn(e[t]))&&(n&&(n+=" "),n+=o)}else for(o in e)e[o]&&(n&&(n+=" "),n+=o);return n}function pi(){for(var e,t,o=0,n="",r=arguments.length;o<r;o++)(e=arguments[o])&&(t=Qn(e))&&(n&&(n+=" "),n+=t);return n}var Le=pi;var P=W(Y(),1);function ye(e,t,o){let n=typeof e.colSpan=="function"?e.colSpan(o):1;if(Number.isInteger(n)&&n>1&&(!e.frozen||e.idx+n-1<=t))return n}function mi(e){e.stopPropagation()}function Ot(e){e?.scrollIntoView({inline:"nearest",block:"nearest"})}function pt(e){let t=!1,o={...e,preventGridDefault(){t=!0},isGridDefaultPrevented(){return t}};return Object.setPrototypeOf(o,Object.getPrototypeOf(e)),o}var hi=new Set(["Unidentified","Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Tab","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp","Insert","ContextMenu","Escape","Pause","Play","PrintScreen","F1","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]);function Ro(e){return(e.ctrlKey||e.metaKey)&&e.key!=="Control"}function bi(e){return Ro(e)&&e.keyCode!==86?!1:!hi.has(e.key)}function yi({key:e,target:t}){return e==="Tab"&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement)?t.closest(".rdg-editor-container")?.querySelectorAll("input, textarea, select").length===1:!1}var wi="mlln6zg7-0-0-beta-47";function vi(e){return e.map(({key:t,idx:o,minWidth:n,maxWidth:r})=>(0,P.jsx)("div",{className:wi,style:{gridColumnStart:o+1,minWidth:n,maxWidth:r},"data-measuring-cell-key":t},t))}function xi({selectedPosition:e,columns:t,rows:o}){let n=t[e.idx],r=o[e.rowIdx];return _n(n,r)}function _n(e,t){return e.renderEditCell!=null&&(typeof e.editable=="function"?e.editable(t):e.editable)!==!1}function Ci({rows:e,topSummaryRows:t,bottomSummaryRows:o,rowIdx:n,mainHeaderRowIdx:r,lastFrozenColumnIndex:i,column:a}){let s=t?.length??0;if(n===r)return ye(a,i,{type:"HEADER"});if(t&&n>r&&n<=s+r)return ye(a,i,{type:"SUMMARY",row:t[n+s]});if(n>=0&&n<e.length){let f=e[n];return ye(a,i,{type:"ROW",row:f})}if(o)return ye(a,i,{type:"SUMMARY",row:o[n-e.length]})}function Ri({moveUp:e,moveNext:t,cellNavigationMode:o,columns:n,colSpanColumns:r,rows:i,topSummaryRows:a,bottomSummaryRows:s,minRowIdx:f,mainHeaderRowIdx:d,maxRowIdx:b,currentPosition:{idx:h,rowIdx:x},nextPosition:g,lastFrozenColumnIndex:E,isCellWithinBounds:C}){let{idx:R,rowIdx:S}=g,c=n.length,k=z=>{for(let p of r){let m=p.idx;if(m>R)break;let v=Ci({rows:i,topSummaryRows:a,bottomSummaryRows:s,rowIdx:S,mainHeaderRowIdx:d,lastFrozenColumnIndex:E,column:p});if(v&&R>m&&R<v+m){R=m+(z?v:0);break}}},D=z=>z.level+d,T=()=>{if(t){let p=n[R].parent;for(;p!==void 0;){let m=D(p);if(S===m){R=p.idx+p.colSpan;break}p=p.parent}}else if(e){let p=n[R].parent,m=!1;for(;p!==void 0;){let v=D(p);if(S>=v){R=p.idx,S=v,m=!0;break}p=p.parent}m||(R=h,S=x)}};if(C(g)&&(k(t),S<d&&T()),o==="CHANGE_ROW"&&(R===c?S===b||(R=0,S+=1):R===-1&&(S===f||(S-=1,R=c-1),k(!1))),S<d){let p=n[R].parent,m=S;for(S=d;p!==void 0;){let v=D(p);v>=m&&(S=v,R=p.idx),p=p.parent}}return{idx:R,rowIdx:S}}function Si({maxColIdx:e,minRowIdx:t,maxRowIdx:o,selectedPosition:{rowIdx:n,idx:r},shiftKey:i}){return i?r===0&&n===t:r===e&&n===o}var ki="cj343x07-0-0-beta-47",Kn=`rdg-cell ${ki}`,Ii="csofj7r7-0-0-beta-47",Ei=`rdg-cell-frozen ${Ii}`;function Un(e){return{"--rdg-grid-row-start":e}}function Jn(e,t,o){let n=t+1,r=`calc(${o-1} * var(--rdg-header-row-height))`;return e.parent===void 0?{insetBlockStart:0,gridRowStart:1,gridRowEnd:n,paddingBlockStart:r}:{insetBlockStart:`calc(${t-o} * var(--rdg-header-row-height))`,gridRowStart:n-o,gridRowEnd:n,paddingBlockStart:r}}function bt(e,t=1){let o=e.idx+1;return{gridColumnStart:o,gridColumnEnd:o+t,insetInlineStart:e.frozen?`var(--rdg-frozen-left-${e.idx})`:void 0}}function $t(e,...t){return Le(Kn,...t,e.frozen&&Ei)}var{min:ht,max:Bt,floor:Vn,sign:Li,abs:Ti}=Math;function xo(e){if(typeof e!="function")throw new Error("Please specify the rowKeyGetter prop to use selection")}function qn(e,{minWidth:t,maxWidth:o}){return e=Bt(e,t),typeof o=="number"&&o>=t?ht(e,o):e}function Yn(e,t){return e.parent===void 0?t:e.level-e.parent.level}var Ni="c1bn88vv7-0-0-beta-47",zi=`rdg-checkbox-input ${Ni}`;function Di({onChange:e,indeterminate:t,...o}){function n(r){e(r.target.checked,r.nativeEvent.shiftKey)}return(0,P.jsx)("input",{ref:r=>{r&&(r.indeterminate=t===!0)},type:"checkbox",className:zi,onChange:n,...o})}var Pi="g1s9ylgp7-0-0-beta-47",Qs=`rdg-group-cell-content ${Pi}`,Mi="cz54e4y7-0-0-beta-47",Vs=`rdg-caret ${Mi}`;function Wi(e){try{return e.row[e.column.key]}catch{return null}}var jn=(0,y.createContext)(void 0),Hi=jn.Provider;function Zn(){return(0,y.useContext)(jn)}var Ai=(0,y.createContext)(void 0),Gi=Ai.Provider,Qi=(0,y.createContext)(void 0),Vi=Qi.Provider;var Fi=(0,y.createContext)(void 0),Oi=Fi.Provider,Bi=(0,y.createContext)(void 0),$i=Bi.Provider;var Fn="rdg-select-column";var Xi="auto",_i=50;function Ki({rawColumns:e,defaultColumnOptions:t,getColumnWidth:o,viewportWidth:n,scrollLeft:r,enableVirtualization:i}){let a=t?.width??Xi,s=t?.minWidth??_i,f=t?.maxWidth??void 0,d=t?.renderCell??Wi,b=t?.sortable??!1,h=t?.resizable??!1,x=t?.draggable??!1,{columns:g,colSpanColumns:E,lastFrozenColumnIndex:C,headerRowsCount:R}=(0,y.useMemo)(()=>{let p=-1,m=1,v=[];M(e,1);function M(H,V,te){for(let Q of H){if("children"in Q){let et={name:Q.name,parent:te,idx:-1,colSpan:0,level:0,headerCellClass:Q.headerCellClass};M(Q.children,V+1,et);continue}let U=Q.frozen??!1,xe={...Q,parent:te,idx:0,level:0,frozen:U,width:Q.width??a,minWidth:Q.minWidth??s,maxWidth:Q.maxWidth??f,sortable:Q.sortable??b,resizable:Q.resizable??h,draggable:Q.draggable??x,renderCell:Q.renderCell??d};v.push(xe),U&&p++,V>m&&(m=V)}}v.sort(({key:H,frozen:V},{key:te,frozen:Q})=>H===Fn?-1:te===Fn?1:V?Q?0:-1:Q?1:0);let G=[];return v.forEach((H,V)=>{H.idx=V,er(H,V,0),H.colSpan!=null&&G.push(H)}),{columns:v,colSpanColumns:G,lastFrozenColumnIndex:p,headerRowsCount:m}},[e,a,s,f,d,h,b,x]),{templateColumns:S,layoutCssVars:c,totalFrozenColumnWidth:k,columnMetrics:D}=(0,y.useMemo)(()=>{let p=new Map,m=0,v=0,M=[];for(let H of g){let V=o(H);typeof V=="number"?V=qn(V,H):V=H.minWidth,M.push(`${V}px`),p.set(H,{width:V,left:m}),m+=V}if(C!==-1){let H=p.get(g[C]);v=H.left+H.width}let G={};for(let H=0;H<=C;H++){let V=g[H];G[`--rdg-frozen-left-${V.idx}`]=`${p.get(V).left}px`}return{templateColumns:M,layoutCssVars:G,totalFrozenColumnWidth:v,columnMetrics:p}},[o,g,C]),[T,z]=(0,y.useMemo)(()=>{if(!i)return[0,g.length-1];let p=r+k,m=r+n,v=g.length-1,M=ht(C+1,v);if(p>=m)return[M,M];let G=M;for(;G<v;){let{left:Q,width:U}=D.get(g[G]);if(Q+U>p)break;G++}let H=G;for(;H<v;){let{left:Q,width:U}=D.get(g[H]);if(Q+U>=m)break;H++}let V=Bt(M,G-1),te=ht(v,H+1);return[V,te]},[D,g,C,r,k,n,i]);return{columns:g,colSpanColumns:E,colOverscanStartIdx:T,colOverscanEndIdx:z,templateColumns:S,layoutCssVars:c,headerRowsCount:R,lastFrozenColumnIndex:C,totalFrozenColumnWidth:k}}function er(e,t,o){if(o<e.level&&(e.level=o),e.parent!==void 0){let{parent:n}=e;n.idx===-1&&(n.idx=t),n.colSpan+=1,er(n,t,o-1)}}var Ze=typeof window>"u"?y.useEffect:y.useLayoutEffect;function Ui(e,t,o,n,r,i,a,s,f,d){let b=(0,y.useRef)(r),h=e.length===t.length,x=h&&r!==b.current,g=[...o],E=[];for(let{key:c,idx:k,width:D}of t)typeof D=="string"&&(x||!a.has(c))&&!i.has(c)&&(g[k]=D,E.push(c));let C=g.join(" ");Ze(()=>{b.current=r,R(E)});function R(c){c.length!==0&&f(k=>{let D=new Map(k),T=!1;for(let z of c){let p=On(n,z);T||=p!==k.get(z),p===void 0?D.delete(z):D.set(z,p)}return T?D:k})}function S(c,k){let{key:D}=c,T=[...o],z=[];for(let{key:m,idx:v,width:M}of t)if(D===m){let G=typeof k=="number"?`${k}px`:k;T[v]=G}else h&&typeof M=="string"&&!i.has(m)&&(T[v]=M,z.push(m));n.current.style.gridTemplateColumns=T.join(" ");let p=typeof k=="number"?k:On(n,D);(0,mt.flushSync)(()=>{s(m=>{let v=new Map(m);return v.set(D,p),v}),R(z)}),d?.(c.idx,p)}return{gridTemplateColumns:C,handleColumnResize:S}}function On(e,t){let o=`[data-measuring-cell-key="${CSS.escape(t)}"]`;return e.current?.querySelector(o)?.getBoundingClientRect().width}function Ji(){let e=(0,y.useRef)(null),[t,o]=(0,y.useState)(1),[n,r]=(0,y.useState)(1),[i,a]=(0,y.useState)(0);return Ze(()=>{let{ResizeObserver:s}=window;if(s==null)return;let{clientWidth:f,clientHeight:d,offsetWidth:b,offsetHeight:h}=e.current,{width:x,height:g}=e.current.getBoundingClientRect(),E=h-d,C=x-b+f,R=g-E;o(C),r(R),a(E);let S=new s(c=>{let k=c[0].contentBoxSize[0],{clientHeight:D,offsetHeight:T}=e.current;(0,mt.flushSync)(()=>{o(k.inlineSize),r(k.blockSize),a(T-D)})});return S.observe(e.current),()=>{S.disconnect()}},[]),[e,t,n,i]}function ge(e){let t=(0,y.useRef)(e);(0,y.useEffect)(()=>{t.current=e});let o=(0,y.useCallback)((...n)=>{t.current(...n)},[]);return e&&o}function Xt(e){let[t,o]=(0,y.useState)(!1);t&&!e&&o(!1);function n(i){i.target!==i.currentTarget&&o(!0)}return{tabIndex:e&&!t?0:-1,childTabIndex:e?0:-1,onFocus:e?n:void 0}}function qi({columns:e,colSpanColumns:t,rows:o,topSummaryRows:n,bottomSummaryRows:r,colOverscanStartIdx:i,colOverscanEndIdx:a,lastFrozenColumnIndex:s,rowOverscanStartIdx:f,rowOverscanEndIdx:d}){let b=(0,y.useMemo)(()=>{if(i===0)return 0;let h=i,x=(g,E)=>E!==void 0&&g+E>i?(h=g,!0):!1;for(let g of t){let E=g.idx;if(E>=h||x(E,ye(g,s,{type:"HEADER"})))break;for(let C=f;C<=d;C++){let R=o[C];if(x(E,ye(g,s,{type:"ROW",row:R})))break}if(n!=null){for(let C of n)if(x(E,ye(g,s,{type:"SUMMARY",row:C})))break}if(r!=null){for(let C of r)if(x(E,ye(g,s,{type:"SUMMARY",row:C})))break}}return h},[f,d,o,n,r,i,s,t]);return(0,y.useMemo)(()=>{let h=[];for(let x=0;x<=a;x++){let g=e[x];x<b&&!g.frozen||h.push(g)}return h},[b,a,e])}function Yi({rows:e,rowHeight:t,clientHeight:o,scrollTop:n,enableVirtualization:r}){let{totalRowHeight:i,gridTemplateRows:a,getRowTop:s,getRowHeight:f,findRowIdx:d}=(0,y.useMemo)(()=>{if(typeof t=="number")return{totalRowHeight:t*e.length,gridTemplateRows:` repeat(${e.length}, ${t}px)`,getRowTop:R=>R*t,getRowHeight:()=>t,findRowIdx:R=>Vn(R/t)};let x=0,g=" ",E=e.map(R=>{let S=t(R),c={top:x,height:S};return g+=`${S}px `,x+=S,c}),C=R=>Bt(0,ht(e.length-1,R));return{totalRowHeight:x,gridTemplateRows:g,getRowTop:R=>E[C(R)].top,getRowHeight:R=>E[C(R)].height,findRowIdx(R){let S=0,c=E.length-1;for(;S<=c;){let k=S+Vn((c-S)/2),D=E[k].top;if(D===R)return k;if(D<R?S=k+1:D>R&&(c=k-1),S>c)return c}return 0}}},[t,e]),b=0,h=e.length-1;if(r){let g=d(n),E=d(n+o);b=Bt(0,g-4),h=ht(e.length-1,E+4)}return{rowOverscanStartIdx:b,rowOverscanEndIdx:h,totalRowHeight:i,gridTemplateRows:a,getRowTop:s,getRowHeight:f,findRowIdx:d}}var ji="c1w9bbhr7-0-0-beta-47",Zi="c1creorc7-0-0-beta-47",ea=`rdg-cell-drag-handle ${ji}`;function ta({gridRowStart:e,rows:t,column:o,columnWidth:n,maxColIdx:r,isLastRow:i,selectedPosition:a,latestDraggedOverRowIdx:s,isCellEditable:f,onRowsChange:d,onFill:b,onClick:h,setDragging:x,setDraggedOverRowIdx:g}){let{idx:E,rowIdx:C}=a;function R(T){if(T.preventDefault(),T.buttons!==1)return;x(!0),window.addEventListener("mouseover",z),window.addEventListener("mouseup",p);function z(m){m.buttons!==1&&p()}function p(){window.removeEventListener("mouseover",z),window.removeEventListener("mouseup",p),x(!1),S()}}function S(){let T=s.current;if(T===void 0)return;let z=C<T?C+1:T,p=C<T?T+1:C;k(z,p),g(void 0)}function c(T){T.stopPropagation(),k(C+1,t.length)}function k(T,z){let p=t[C],m=[...t],v=[];for(let M=T;M<z;M++)if(f({rowIdx:M,idx:E})){let G=b({columnKey:o.key,sourceRow:p,targetRow:t[M]});G!==t[M]&&(m[M]=G,v.push(M))}v.length>0&&d?.(m,{indexes:v,column:o})}function D(){let T=o.colSpan?.({type:"ROW",row:t[C]})??1,{insetInlineStart:z,...p}=bt(o,T),m="calc(var(--rdg-drag-handle-size) * -0.5 + 1px)",v=o.idx+T-1===r;return{...p,gridRowStart:e,marginInlineEnd:v?void 0:m,marginBlockEnd:i?void 0:m,insetInlineStart:z?`calc(${z} + ${n}px + var(--rdg-drag-handle-size) * -0.5 - 1px)`:void 0}}return(0,P.jsx)("div",{style:D(),className:Le(ea,o.frozen&&Zi),onClick:h,onMouseDown:R,onDoubleClick:c})}var oa="cis5rrm7-0-0-beta-47";function na({column:e,colSpan:t,row:o,rowIdx:n,onRowChange:r,closeEditor:i,onKeyDown:a,navigate:s}){let f=(0,y.useRef)(void 0),d=e.editorOptions?.commitOnOutsideClick!==!1,b=ge(()=>{g(!0,!1)});(0,y.useEffect)(()=>{if(!d)return;function S(){f.current=requestAnimationFrame(b)}return addEventListener("mousedown",S,{capture:!0}),()=>{removeEventListener("mousedown",S,{capture:!0}),h()}},[d,b]);function h(){cancelAnimationFrame(f.current)}function x(S){if(a){let c=pt(S);if(a({mode:"EDIT",row:o,column:e,rowIdx:n,navigate(){s(S)},onClose:g},c),c.isGridDefaultPrevented())return}S.key==="Escape"?g():S.key==="Enter"?g(!0):yi(S)&&s(S)}function g(S=!1,c=!0){S?r(o,!0,c):i(c)}function E(S,c=!1){r(S,c,c)}let{cellClass:C}=e,R=$t(e,"rdg-editor-container",typeof C=="function"?C(o):C,!e.editorOptions?.displayCellContent&&oa);return(0,P.jsx)("div",{role:"gridcell","aria-colindex":e.idx+1,"aria-colspan":t,"aria-selected":!0,className:R,style:bt(e,t),onKeyDown:x,onMouseDownCapture:h,children:e.renderEditCell!=null&&(0,P.jsxs)(P.Fragment,{children:[e.renderEditCell({column:e,row:o,rowIdx:n,onRowChange:E,onClose:g}),e.editorOptions?.displayCellContent&&e.renderCell({column:e,row:o,rowIdx:n,isCellEditable:!0,tabIndex:-1,onRowChange:E})]})})}function ra({column:e,rowIdx:t,isCellSelected:o,selectCell:n}){let{tabIndex:r,onFocus:i}=Xt(o),{colSpan:a}=e,s=Yn(e,t),f=e.idx+1;function d(){n({idx:e.idx,rowIdx:t})}return(0,P.jsx)("div",{role:"columnheader","aria-colindex":f,"aria-colspan":a,"aria-rowspan":s,"aria-selected":o,tabIndex:r,className:Le(Kn,e.headerCellClass),style:{...Jn(e,t,s),gridColumnStart:f,gridColumnEnd:f+a},onFocus:i,onClick:d,children:e.name})}var ia="h44jtk67-0-0-beta-47",aa="hcgkhxz7-0-0-beta-47",sa=`rdg-header-sort-name ${aa}`;function la({column:e,sortDirection:t,priority:o}){return e.sortable?(0,P.jsx)(da,{sortDirection:t,priority:o,children:e.name}):e.name}function da({sortDirection:e,priority:t,children:o}){let n=Zn().renderSortStatus;return(0,P.jsxs)("span",{className:ia,children:[(0,P.jsx)("span",{className:sa,children:o}),(0,P.jsx)("span",{children:n({sortDirection:e,priority:t})})]})}var ca="c6l2wv17-0-0-beta-47",ua="c1kqdw7y7-0-0-beta-47",fa=`rdg-cell-resizable ${ua}`,ga="r1y6ywlx7-0-0-beta-47",pa="rdg-cell-draggable",ma="c1bezg5o7-0-0-beta-47",ha=`rdg-cell-dragging ${ma}`,ba="c1vc96037-0-0-beta-47",ya=`rdg-cell-drag-over ${ba}`;function wa({column:e,colSpan:t,rowIdx:o,isCellSelected:n,onColumnResize:r,onColumnsReorder:i,sortColumns:a,onSortColumnsChange:s,selectCell:f,shouldFocusGrid:d,direction:b,dragDropKey:h}){let[x,g]=(0,y.useState)(!1),[E,C]=(0,y.useState)(!1),R=b==="rtl",S=Yn(e,o),{tabIndex:c,childTabIndex:k,onFocus:D}=Xt(n),T=a?.findIndex(A=>A.columnKey===e.key),z=T!==void 0&&T>-1?a[T]:void 0,p=z?.direction,m=z!==void 0&&a.length>1?T+1:void 0,v=p&&!m?p==="ASC"?"ascending":"descending":void 0,{sortable:M,resizable:G,draggable:H}=e,V=$t(e,e.headerCellClass,M&&ca,G&&fa,H&&pa,x&&ha,E&&ya),te=e.renderHeaderCell??la;function Q(A){if(A.pointerType==="mouse"&&A.buttons!==1)return;A.preventDefault();let{currentTarget:J,pointerId:he}=A,Ee=J.parentElement,{right:St,left:kt}=Ee.getBoundingClientRect(),tt=R?A.clientX-kt:St-A.clientX,Ve=!1;function ot(Fe){let{width:Oe,right:Zt,left:nt}=Ee.getBoundingClientRect(),Be=R?Zt+tt-Fe.clientX:Fe.clientX+tt-nt;Be=qn(Be,e),Oe>0&&Be!==Oe&&r(e,Be)}function It(){Ve=!0,r(e,"max-content")}function Et(Fe){Ve||ot(Fe),J.removeEventListener("pointermove",ot),J.removeEventListener("dblclick",It),J.removeEventListener("lostpointercapture",Et)}J.setPointerCapture(he),J.addEventListener("pointermove",ot),J.addEventListener("dblclick",It),J.addEventListener("lostpointercapture",Et)}function U(A){if(s==null)return;let{sortDescendingFirst:J}=e;if(z===void 0){let he={columnKey:e.key,direction:J?"DESC":"ASC"};s(a&&A?[...a,he]:[he])}else{let he;if((J===!0&&p==="DESC"||J!==!0&&p==="ASC")&&(he={columnKey:e.key,direction:p==="ASC"?"DESC":"ASC"}),A){let Ee=[...a];he?Ee[T]=he:Ee.splice(T,1),s(Ee)}else s(he?[he]:[])}}function xe(A){f({idx:e.idx,rowIdx:o}),M&&U(A.ctrlKey||A.metaKey)}function et(A){D?.(A),d&&f({idx:0,rowIdx:o})}function Ut(A){(A.key===" "||A.key==="Enter")&&(A.preventDefault(),U(A.ctrlKey||A.metaKey))}function Jt(A){A.dataTransfer.setData(h,e.key),A.dataTransfer.dropEffect="move",g(!0)}function qt(){g(!1)}function Yt(A){A.preventDefault(),A.dataTransfer.dropEffect="move"}function jt(A){if(C(!1),A.dataTransfer.types.includes(h.toLowerCase())){let J=A.dataTransfer.getData(h.toLowerCase());J!==e.key&&(A.preventDefault(),i?.(J,e.key))}}function Qe(A){Bn(A)&&C(!0)}function Rt(A){Bn(A)&&C(!1)}let Te;return H&&(Te={draggable:!0,onDragStart:Jt,onDragEnd:qt,onDragOver:Yt,onDragEnter:Qe,onDragLeave:Rt,onDrop:jt}),(0,P.jsxs)("div",{role:"columnheader","aria-colindex":e.idx+1,"aria-colspan":t,"aria-rowspan":S,"aria-selected":n,"aria-sort":v,tabIndex:d?0:c,className:V,style:{...Jn(e,o,S),...bt(e,t)},onFocus:et,onClick:xe,onKeyDown:M?Ut:void 0,...Te,children:[te({column:e,sortDirection:p,priority:m,tabIndex:k}),G&&(0,P.jsx)("div",{className:ga,onClick:mi,onPointerDown:Q})]})}function Bn(e){let t=e.relatedTarget;return!e.currentTarget.contains(t)}var va="r1upfr807-0-0-beta-47",tr=`rdg-row ${va}`,xa="r190mhd37-0-0-beta-47",So="rdg-row-selected",Ca="r139qu9m7-0-0-beta-47",Ra="rdg-top-summary-row",Sa="rdg-bottom-summary-row",ka="h10tskcx7-0-0-beta-47",or=`rdg-header-row ${ka}`;function Ia({rowIdx:e,columns:t,onColumnResize:o,onColumnsReorder:n,sortColumns:r,onSortColumnsChange:i,lastFrozenColumnIndex:a,selectedCellIdx:s,selectCell:f,shouldFocusGrid:d,direction:b}){let h=(0,y.useId)(),x=[];for(let g=0;g<t.length;g++){let E=t[g],C=ye(E,a,{type:"HEADER"});C!==void 0&&(g+=C-1),x.push((0,P.jsx)(wa,{column:E,colSpan:C,rowIdx:e,isCellSelected:s===E.idx,onColumnResize:o,onColumnsReorder:n,onSortColumnsChange:i,sortColumns:r,selectCell:f,shouldFocusGrid:d&&g===0,direction:b,dragDropKey:h},E.key))}return(0,P.jsx)("div",{role:"row","aria-rowindex":e,className:Le(or,s===-1&&So),children:x})}var Ea=(0,y.memo)(Ia);function La({rowIdx:e,level:t,columns:o,selectedCellIdx:n,selectCell:r}){let i=[],a=new Set;for(let s of o){let{parent:f}=s;if(f!==void 0){for(;f.level>t&&f.parent!==void 0;)f=f.parent;if(f.level===t&&!a.has(f)){a.add(f);let{idx:d}=f;i.push((0,P.jsx)(ra,{column:f,rowIdx:e,isCellSelected:n===d,selectCell:r},d))}}}return(0,P.jsx)("div",{role:"row","aria-rowindex":e,className:or,children:i})}var Ta=(0,y.memo)(La),Na="c6ra8a37-0-0-beta-47",za=`rdg-cell-copied ${Na}`,Da="cq910m07-0-0-beta-47",Pa=`rdg-cell-dragged-over ${Da}`;function Ma({column:e,colSpan:t,isCellSelected:o,isCopied:n,isDraggedOver:r,row:i,rowIdx:a,onClick:s,onDoubleClick:f,onContextMenu:d,onRowChange:b,selectCell:h,...x}){let{tabIndex:g,childTabIndex:E,onFocus:C}=Xt(o),{cellClass:R}=e,S=$t(e,typeof R=="function"?R(i):R,n&&za,r&&Pa),c=_n(e,i);function k(m){h({rowIdx:a,idx:e.idx},m)}function D(m){if(s){let v=pt(m);if(s({row:i,column:e,selectCell:k},v),v.isGridDefaultPrevented())return}k()}function T(m){if(d){let v=pt(m);if(d({row:i,column:e,selectCell:k},v),v.isGridDefaultPrevented())return}k()}function z(m){if(f){let v=pt(m);if(f({row:i,column:e,selectCell:k},v),v.isGridDefaultPrevented())return}k(!0)}function p(m){b(e,m)}return(0,P.jsx)("div",{role:"gridcell","aria-colindex":e.idx+1,"aria-colspan":t,"aria-selected":o,"aria-readonly":!c||void 0,tabIndex:g,className:S,style:bt(e,t),onClick:D,onDoubleClick:z,onContextMenu:T,onFocus:C,...x,children:e.renderCell({column:e,row:i,rowIdx:a,isCellEditable:c,tabIndex:E,onRowChange:p})})}var Wa=(0,y.memo)(Ma);function Ha({className:e,rowIdx:t,gridRowStart:o,selectedCellIdx:n,isRowSelectionDisabled:r,isRowSelected:i,copiedCellIdx:a,draggedOverCellIdx:s,lastFrozenColumnIndex:f,row:d,viewportColumns:b,selectedCellEditor:h,onCellClick:x,onCellDoubleClick:g,onCellContextMenu:E,rowClass:C,setDraggedOverRowIdx:R,onMouseEnter:S,onRowChange:c,selectCell:k,...D},T){let z=ge((M,G)=>{c(M,t,G)});function p(M){R?.(t),S?.(M)}e=Le(tr,`rdg-row-${t%2===0?"even":"odd"}`,C?.(d,t),e,n===-1&&So);let m=[];for(let M=0;M<b.length;M++){let G=b[M],{idx:H}=G,V=ye(G,f,{type:"ROW",row:d});V!==void 0&&(M+=V-1);let te=n===H;te&&h?m.push(h):m.push((0,P.jsx)(Wa,{column:G,colSpan:V,row:d,rowIdx:t,isCopied:a===H,isDraggedOver:s===H,isCellSelected:te,onClick:x,onDoubleClick:g,onContextMenu:E,onRowChange:z,selectCell:k},G.key))}let v=(0,y.useMemo)(()=>({isRowSelected:i,isRowSelectionDisabled:r}),[r,i]);return(0,P.jsx)(Gi,{value:v,children:(0,P.jsx)("div",{role:"row",ref:T,className:e,onMouseEnter:p,style:Un(o),...D,children:m})})}var Aa=(0,y.memo)((0,y.forwardRef)(Ha));function Ga(e,t){return(0,P.jsx)(Aa,{...t},e)}function Qa({scrollToPosition:{idx:e,rowIdx:t},gridElement:o,setScrollToCellPosition:n}){let r=(0,y.useRef)(null);return Ze(()=>{Ot(r.current)}),Ze(()=>{function i(){n(null)}let a=new IntersectionObserver(i,{root:o,threshold:1});return a.observe(r.current),()=>{a.disconnect()}},[o,n]),(0,P.jsx)("div",{ref:r,style:{gridColumn:e===void 0?"1/-1":e+1,gridRow:t===void 0?"1/-1":t+2}})}var Va="a3ejtar7-0-0-beta-47",Fa=`rdg-sort-arrow ${Va}`;function Oa({sortDirection:e,priority:t}){return(0,P.jsxs)(P.Fragment,{children:[Ba({sortDirection:e}),$a({priority:t})]})}function Ba({sortDirection:e}){return e===void 0?null:(0,P.jsx)("svg",{viewBox:"0 0 12 8",width:"12",height:"8",className:Fa,"aria-hidden":!0,children:(0,P.jsx)("path",{d:e==="ASC"?"M0 8 6 0 12 8":"M0 0 6 8 12 0"})})}function $a({priority:e}){return e}var Xa="rnvodz57-0-0-beta-47",_a=`rdg ${Xa}`,Ka="vlqv91k7-0-0-beta-47",Ua=`rdg-viewport-dragging ${Ka}`,Ja="f1lsfrzw7-0-0-beta-47",qa="f1cte0lg7-0-0-beta-47",Ya="s8wc6fl7-0-0-beta-47";function ja({column:e,colSpan:t,row:o,rowIdx:n,isCellSelected:r,selectCell:i}){let{tabIndex:a,childTabIndex:s,onFocus:f}=Xt(r),{summaryCellClass:d}=e,b=$t(e,Ya,typeof d=="function"?d(o):d);function h(){i({rowIdx:n,idx:e.idx})}return(0,P.jsx)("div",{role:"gridcell","aria-colindex":e.idx+1,"aria-colspan":t,"aria-selected":r,tabIndex:a,className:b,style:bt(e,t),onClick:h,onFocus:f,children:e.renderSummaryCell?.({column:e,row:o,tabIndex:s})})}var Za=(0,y.memo)(ja),es="skuhp557-0-0-beta-47",ts="tf8l5ub7-0-0-beta-47",os=`rdg-summary-row ${es}`;function ns({rowIdx:e,gridRowStart:t,row:o,viewportColumns:n,top:r,bottom:i,lastFrozenColumnIndex:a,selectedCellIdx:s,isTop:f,selectCell:d,"aria-rowindex":b}){let h=[];for(let x=0;x<n.length;x++){let g=n[x],E=ye(g,a,{type:"SUMMARY",row:o});E!==void 0&&(x+=E-1);let C=s===g.idx;h.push((0,P.jsx)(Za,{column:g,colSpan:E,row:o,rowIdx:e,isCellSelected:C,selectCell:d},g.key))}return(0,P.jsx)("div",{role:"row","aria-rowindex":b,className:Le(tr,`rdg-row-${e%2===0?"even":"odd"}`,os,f?`${Ra} ${ts}`:Sa,s===-1&&So),style:{...Un(t),"--rdg-summary-row-top":r!==void 0?`${r}px`:void 0,"--rdg-summary-row-bottom":i!==void 0?`${i}px`:void 0},children:h})}var $n=(0,y.memo)(ns);function rs(e,t){let{columns:o,rows:n,topSummaryRows:r,bottomSummaryRows:i,rowKeyGetter:a,onRowsChange:s,rowHeight:f,headerRowHeight:d,summaryRowHeight:b,selectedRows:h,isRowSelectionDisabled:x,onSelectedRowsChange:g,sortColumns:E,onSortColumnsChange:C,defaultColumnOptions:R,onCellClick:S,onCellDoubleClick:c,onCellContextMenu:k,onCellKeyDown:D,onSelectedCellChange:T,onScroll:z,onColumnResize:p,onColumnsReorder:m,onFill:v,onCopy:M,onPaste:G,enableVirtualization:H,renderers:V,className:te,style:Q,rowClass:U,direction:xe,role:et,"aria-label":Ut,"aria-labelledby":Jt,"aria-describedby":qt,"aria-rowcount":Yt,"data-testid":jt}=e,Qe=Zn(),Rt=et??"grid",Te=f??35,A=d??(typeof Te=="number"?Te:35),J=b??(typeof Te=="number"?Te:35),he=V?.renderRow??Qe?.renderRow??Ga,Ee=V?.renderSortStatus??Qe?.renderSortStatus??Oa,St=V?.renderCheckbox??Qe?.renderCheckbox??Di,kt=V?.noRowsFallback??Qe?.noRowsFallback,tt=H??!0,Ve=xe??"ltr",[ot,It]=(0,y.useState)(0),[Et,Fe]=(0,y.useState)(0),[Oe,Zt]=(0,y.useState)(()=>new Map),[nt,Be]=(0,y.useState)(()=>new Map),[$e,Lo]=(0,y.useState)(null),[To,Rr]=(0,y.useState)(!1),[rt,Sr]=(0,y.useState)(void 0),[Lt,No]=(0,y.useState)(null),zo=(0,y.useCallback)(l=>Oe.get(l.key)??nt.get(l.key)??l.width,[nt,Oe]),[Xe,Do,Po,kr]=Ji(),{columns:ne,colSpanColumns:Mo,lastFrozenColumnIndex:be,headerRowsCount:Me,colOverscanStartIdx:Ir,colOverscanEndIdx:Wo,templateColumns:Er,layoutCssVars:Lr,totalFrozenColumnWidth:Tr}=Ki({rawColumns:o,defaultColumnOptions:R,getColumnWidth:zo,scrollLeft:Et,viewportWidth:Do,enableVirtualization:tt}),it=r?.length??0,_e=i?.length??0,Ho=it+_e,Ke=Me+it,eo=Me-1,fe=-Ke,Tt=fe+eo,We=n.length+_e-1,[I,Ue]=(0,y.useState)(()=>({idx:-1,rowIdx:fe-1,mode:"SELECT"})),to=(0,y.useRef)(I),Ao=(0,y.useRef)(rt),Go=(0,y.useRef)(-1),Nt=(0,y.useRef)(null),zt=(0,y.useRef)(!1),oo=Rt==="treegrid",no=Me*A,Qo=Ho*J,Dt=Po-no-Qo,ro=h!=null&&g!=null,Vo=Ve==="rtl",Nr=Vo?"ArrowRight":"ArrowLeft",Fo=Vo?"ArrowLeft":"ArrowRight",Oo=Yt??Me+n.length+Ho,zr=(0,y.useMemo)(()=>({renderCheckbox:St,renderSortStatus:Ee}),[St,Ee]),Dr=(0,y.useMemo)(()=>{let l=!1,u=!1;if(a!=null&&h!=null&&h.size>0){for(let L of n)if(h.has(a(L))?l=!0:u=!0,l&&u)break}return{isRowSelected:l&&!u,isIndeterminate:l&&u}},[n,h,a]),{rowOverscanStartIdx:at,rowOverscanEndIdx:st,totalRowHeight:io,gridTemplateRows:Pr,getRowTop:Bo,getRowHeight:Mr,findRowIdx:$o}=Yi({rows:n,rowHeight:Te,clientHeight:Dt,scrollTop:ot,enableVirtualization:tt}),Ne=qi({columns:ne,colSpanColumns:Mo,colOverscanStartIdx:Ir,colOverscanEndIdx:Wo,lastFrozenColumnIndex:be,rowOverscanStartIdx:at,rowOverscanEndIdx:st,rows:n,topSummaryRows:r,bottomSummaryRows:i}),{gridTemplateColumns:Wr,handleColumnResize:Hr}=Ui(ne,Ne,Er,Xe,Do,Oe,nt,Zt,Be,p),Ar=oo?-1:0,Je=ne.length-1,ao=co(I),Pt=Jo(I),Gr=A+io+Qo+kr,Qr=ge(Hr),Vr=ge(m),Fr=ge(C),Or=ge(S),Br=ge(c),$r=ge(k),Xr=ge(Ur),_r=ge(_o),Kr=ge(Mt),so=ge(lt),Xo=ge(({idx:l,rowIdx:u})=>{lt({rowIdx:fe+u-1,idx:l})});Ze(()=>{if(!ao||Co(I,to.current)){to.current=I;return}to.current=I,I.idx===-1&&(Nt.current.focus({preventScroll:!0}),Ot(Nt.current))}),Ze(()=>{zt.current&&(zt.current=!1,Yo())}),(0,y.useImperativeHandle)(t,()=>({element:Xe.current,scrollToCell({idx:l,rowIdx:u}){let L=l!==void 0&&l>be&&l<ne.length?l:void 0,N=u!==void 0&&qe(u)?u:void 0;(L!==void 0||N!==void 0)&&No({idx:L,rowIdx:N})},selectCell:lt}));let lo=(0,y.useCallback)(l=>{Sr(l),Ao.current=l},[]);function Ur(l){if(!g)return;xo(a);let u=new Set(h);for(let L of n){if(x?.(L)===!0)continue;let N=a(L);l.checked?u.add(N):u.delete(N)}g(u)}function _o(l){if(!g)return;xo(a);let{row:u,checked:L,isShiftClick:N}=l;if(x?.(u)===!0)return;let F=new Set(h),K=a(u),q=Go.current,j=n.indexOf(u);if(Go.current=j,L?F.add(K):F.delete(K),N&&q!==-1&&q!==j&&q<n.length){let de=Li(j-q);for(let Ce=q+de;Ce!==j;Ce+=de){let Re=n[Ce];x?.(Re)!==!0&&(L?F.add(a(Re)):F.delete(a(Re)))}}g(F)}function Jr(l){let{idx:u,rowIdx:L,mode:N}=I;if(N==="EDIT")return;if(D&&qe(L)){let j=n[L],de=pt(l);if(D({mode:"SELECT",row:j,column:ne[u],rowIdx:L,selectCell:lt},de),de.isGridDefaultPrevented())return}if(!(l.target instanceof Element))return;let F=l.target.closest(".rdg-cell")!==null,K=oo&&l.target===Nt.current;if(!F&&!K)return;let{keyCode:q}=l;if(Pt&&(G!=null||M!=null)&&Ro(l)){if(q===67){if(window.getSelection()?.isCollapsed===!1)return;Yr();return}if(q===86){jr();return}}switch(l.key){case"Escape":Lo(null);return;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"Tab":case"Home":case"End":case"PageUp":case"PageDown":qo(l);break;default:Zr(l);break}}function qr(l){let{scrollTop:u,scrollLeft:L}=l.currentTarget;(0,mt.flushSync)(()=>{It(u),Fe(Ti(L))}),z?.(l)}function Mt(l,u,L){if(typeof s!="function"||L===n[u])return;let N=[...n];N[u]=L,s(N,{indexes:[u],column:l})}function Ko(){I.mode==="EDIT"&&Mt(ne[I.idx],I.rowIdx,I.row)}function Yr(){let{idx:l,rowIdx:u}=I,L=n[u],N=ne[l].key;Lo({row:L,columnKey:N}),M?.({sourceRow:L,sourceColumnKey:N})}function jr(){if(!G||!s||$e===null||!Wt(I))return;let{idx:l,rowIdx:u}=I,L=ne[l],N=n[u],F=G({sourceRow:$e.row,sourceColumnKey:$e.columnKey,targetRow:N,targetColumnKey:L.key});Mt(L,u,F)}function Zr(l){if(!Pt)return;let u=n[I.rowIdx],{key:L,shiftKey:N}=l;if(ro&&N&&L===" "){xo(a);let F=a(u);_o({row:u,checked:!h.has(F),isShiftClick:!1}),l.preventDefault();return}Wt(I)&&bi(l)&&Ue(({idx:F,rowIdx:K})=>({idx:F,rowIdx:K,mode:"EDIT",row:u,originalRow:u}))}function Uo(l){return l>=Ar&&l<=Je}function qe(l){return l>=0&&l<n.length}function co({idx:l,rowIdx:u}){return u>=fe&&u<=We&&Uo(l)}function ei({idx:l,rowIdx:u}){return qe(u)&&l>=0&&l<=Je}function Jo({idx:l,rowIdx:u}){return qe(u)&&Uo(l)}function Wt(l){return ei(l)&&xi({columns:ne,rows:n,selectedPosition:l})}function lt(l,u){if(!co(l))return;Ko();let L=n[l.rowIdx],N=Co(I,l);u&&Wt(l)?Ue({...l,mode:"EDIT",row:L,originalRow:L}):N?Ot(Xn(Xe.current)):(zt.current=!0,Ue({...l,mode:"SELECT"})),T&&!N&&T({rowIdx:l.rowIdx,row:L,column:ne[l.idx]})}function ti(l,u,L){let{idx:N,rowIdx:F}=I,K=ao&&N===-1;switch(l){case"ArrowUp":return{idx:N,rowIdx:F-1};case"ArrowDown":return{idx:N,rowIdx:F+1};case Nr:return{idx:N-1,rowIdx:F};case Fo:return{idx:N+1,rowIdx:F};case"Tab":return{idx:N+(L?-1:1),rowIdx:F};case"Home":return K?{idx:N,rowIdx:fe}:{idx:0,rowIdx:u?fe:F};case"End":return K?{idx:N,rowIdx:We}:{idx:Je,rowIdx:u?We:F};case"PageUp":{if(I.rowIdx===fe)return I;let q=Bo(F)+Mr(F)-Dt;return{idx:N,rowIdx:q>0?$o(q):0}}case"PageDown":{if(I.rowIdx>=n.length)return I;let q=Bo(F)+Dt;return{idx:N,rowIdx:q<io?$o(q):n.length-1}}default:return I}}function qo(l){let{key:u,shiftKey:L}=l,N="NONE";if(u==="Tab"){if(Si({shiftKey:L,maxColIdx:Je,minRowIdx:fe,maxRowIdx:We,selectedPosition:I})){Ko();return}N="CHANGE_ROW"}l.preventDefault();let F=Ro(l),K=ti(u,F,L);if(Co(I,K))return;let q=Ri({moveUp:u==="ArrowUp",moveNext:u===Fo||u==="Tab"&&!L,columns:ne,colSpanColumns:Mo,rows:n,topSummaryRows:r,bottomSummaryRows:i,minRowIdx:fe,mainHeaderRowIdx:Tt,maxRowIdx:We,lastFrozenColumnIndex:be,cellNavigationMode:N,currentPosition:I,nextPosition:K,isCellWithinBounds:co});lt(q)}function oi(l){if(rt===void 0)return;let{rowIdx:u}=I;return(u<rt?u<l&&l<=rt:u>l&&l>=rt)?I.idx:void 0}function Yo(){let l=Xn(Xe.current);if(l===null)return;Ot(l),(l.querySelector('[tabindex="0"]')??l).focus({preventScroll:!0})}function ni(){if(v==null||I.mode==="EDIT"||!Jo(I))return;let{idx:l,rowIdx:u}=I,L=ne[l];if(L.renderEditCell==null||L.editable===!1)return;let N=zo(L);return(0,P.jsx)(ta,{gridRowStart:Ke+u+1,rows:n,column:L,columnWidth:N,maxColIdx:Je,isLastRow:u===We,selectedPosition:I,isCellEditable:Wt,latestDraggedOverRowIdx:Ao,onRowsChange:s,onClick:Yo,onFill:v,setDragging:Rr,setDraggedOverRowIdx:lo})}function ri(l){if(I.rowIdx!==l||I.mode==="SELECT")return;let{idx:u,row:L}=I,N=ne[u],F=ye(N,be,{type:"ROW",row:L}),K=j=>{zt.current=j,Ue(({idx:de,rowIdx:Ce})=>({idx:de,rowIdx:Ce,mode:"SELECT"}))},q=(j,de,Ce)=>{de?(0,mt.flushSync)(()=>{Mt(N,I.rowIdx,j),K(Ce)}):Ue(Re=>({...Re,row:j}))};return n[I.rowIdx]!==I.originalRow&&K(!1),(0,P.jsx)(na,{column:N,colSpan:F,row:L,rowIdx:l,onRowChange:q,closeEditor:K,onKeyDown:D,navigate:qo},N.key)}function dt(l){let u=I.idx===-1?void 0:ne[I.idx];return u!==void 0&&I.rowIdx===l&&!Ne.includes(u)?I.idx>Wo?[...Ne,u]:[...Ne.slice(0,be+1),u,...Ne.slice(be+1)]:Ne}function ii(){let l=[],{idx:u,rowIdx:L}=I,N=Pt&&L<at?at-1:at,F=Pt&&L>st?st+1:st;for(let K=N;K<=F;K++){let q=K===at-1||K===st+1,j=q?L:K,de=Ne,Ce=u===-1?void 0:ne[u];Ce!==void 0&&(q?de=[Ce]:de=dt(j));let Re=n[j],ai=Ke+j+1,uo=j,fo=!1;typeof a=="function"&&(uo=a(Re),fo=h?.has(uo)??!1),l.push(he(uo,{"aria-rowindex":Ke+j+1,"aria-selected":ro?fo:void 0,rowIdx:j,row:Re,viewportColumns:de,isRowSelectionDisabled:x?.(Re)??!1,isRowSelected:fo,onCellClick:Or,onCellDoubleClick:Br,onCellContextMenu:$r,rowClass:U,gridRowStart:ai,copiedCellIdx:$e!==null&&$e.row===Re?ne.findIndex(si=>si.key===$e.columnKey):void 0,selectedCellIdx:L===j?u:void 0,draggedOverCellIdx:oi(j),setDraggedOverRowIdx:To?lo:void 0,lastFrozenColumnIndex:be,onRowChange:Kr,selectCell:so,selectedCellEditor:ri(j)}))}return l}(I.idx>Je||I.rowIdx>We)&&(Ue({idx:-1,rowIdx:fe-1,mode:"SELECT"}),lo(void 0));let Ht=`repeat(${Me}, ${A}px)`;it>0&&(Ht+=` repeat(${it}, ${J}px)`),n.length>0&&(Ht+=Pr),_e>0&&(Ht+=` repeat(${_e}, ${J}px)`);let jo=I.idx===-1&&I.rowIdx!==fe-1;return(0,P.jsxs)("div",{role:Rt,"aria-label":Ut,"aria-labelledby":Jt,"aria-describedby":qt,"aria-multiselectable":ro?!0:void 0,"aria-colcount":ne.length,"aria-rowcount":Oo,className:Le(_a,te,To&&Ua),style:{...Q,scrollPaddingInlineStart:I.idx>be||Lt?.idx!==void 0?`${Tr}px`:void 0,scrollPaddingBlock:qe(I.rowIdx)||Lt?.rowIdx!==void 0?`${no+it*J}px ${_e*J}px`:void 0,gridTemplateColumns:Wr,gridTemplateRows:Ht,"--rdg-header-row-height":`${A}px`,"--rdg-scroll-height":`${Gr}px`,...Lr},dir:Ve,ref:Xe,onScroll:qr,onKeyDown:Jr,"data-testid":jt,children:[(0,P.jsxs)(Hi,{value:zr,children:[(0,P.jsx)($i,{value:Xr,children:(0,P.jsxs)(Oi,{value:Dr,children:[Array.from({length:eo},(l,u)=>(0,P.jsx)(Ta,{rowIdx:u+1,level:-eo+u,columns:dt(fe+u),selectedCellIdx:I.rowIdx===fe+u?I.idx:void 0,selectCell:Xo},u)),(0,P.jsx)(Ea,{rowIdx:Me,columns:dt(Tt),onColumnResize:Qr,onColumnsReorder:Vr,sortColumns:E,onSortColumnsChange:Fr,lastFrozenColumnIndex:be,selectedCellIdx:I.rowIdx===Tt?I.idx:void 0,selectCell:Xo,shouldFocusGrid:!ao,direction:Ve})]})}),n.length===0&&kt?kt:(0,P.jsxs)(P.Fragment,{children:[r?.map((l,u)=>{let L=Me+1+u,N=Tt+1+u,F=I.rowIdx===N,K=no+J*u;return(0,P.jsx)($n,{"aria-rowindex":L,rowIdx:N,gridRowStart:L,row:l,top:K,bottom:void 0,viewportColumns:dt(N),lastFrozenColumnIndex:be,selectedCellIdx:F?I.idx:void 0,isTop:!0,selectCell:so},u)}),(0,P.jsx)(Vi,{value:_r,children:ii()}),i?.map((l,u)=>{let L=Ke+n.length+u+1,N=n.length+u,F=I.rowIdx===N,K=Dt>io?Po-J*(i.length-u):void 0,q=K===void 0?J*(i.length-1-u):void 0;return(0,P.jsx)($n,{"aria-rowindex":Oo-_e+u+1,rowIdx:N,gridRowStart:L,row:l,top:K,bottom:q,viewportColumns:dt(N),lastFrozenColumnIndex:be,selectedCellIdx:F?I.idx:void 0,isTop:!1,selectCell:so},u)})]})]}),ni(),vi(Ne),oo&&(0,P.jsx)("div",{ref:Nt,tabIndex:jo?0:-1,className:Le(Ja,jo&&[xa,be!==-1&&Ca],!qe(I.rowIdx)&&qa),style:{gridRowStart:I.rowIdx+Ke+1}}),Lt!==null&&(0,P.jsx)(Qa,{scrollToPosition:Lt,setScrollToCellPosition:No,gridElement:Xe.current})]})}function Xn(e){return e.querySelector(':scope > [role="row"] > [tabindex="0"]')}function Co(e,t){return e.idx===t.idx&&e.rowIdx===t.rowIdx}var nr=(0,y.forwardRef)(rs);var is="g1yxluv37-0-0-beta-47",Fs=`rdg-group-row ${is}`;var as="t7vyx3i7-0-0-beta-47",Os=`rdg-text-editor ${as}`;O();$();B();var ze=W(Se());var ko=(0,ze.kea)([(0,ze.path)(["data-warehouse","editor","outputPaneLogic"]),(0,ze.actions)({setActiveTab:e=>({tab:e})}),(0,ze.reducers)({activeTab:["results",{setActiveTab:(e,{tab:t})=>t}]})]);O();$();B();var Ae=W(Se());O();$();B();var Io=W(Y());function yt({children:e}){return(0,Io.jsx)("div",{className:"relative w-full overflow-auto",children:(0,Io.jsx)("div",{className:"flex-1 absolute top-0 left-0 right-0 bottom-0",children:e})})}O();$();B();var we=W(Se());var rr=(0,we.kea)([(0,we.path)(["data-warehouse","editor","outputPaneTabs","infoTabLogic"]),(0,we.props)({}),(0,we.key)(e=>e.codeEditorKey),(0,we.connect)(e=>({values:[le({key:e.codeEditorKey}),["metadata"],Qt,["posthogTablesMap","dataWarehouseTablesMap"],ce,["dataWarehouseSavedQueryMap"]]})),(0,we.selectors)({sourceTableItems:[e=>[e.metadata,e.dataWarehouseSavedQueryMap],(e,t)=>e?e.table_names?.map(o=>{let n=t[o];return n?{name:o,type:"table",view_id:n.id,status:n.status,last_run_at:n.last_run_at||"never"}:{name:o,type:"source",status:void 0,last_run_at:void 0}})||[]:[]]})]);var _=W(Y()),ss=[{value:"never",label:" No resync"},{value:"5min",label:" Resync every 5 mins"},{value:"30min",label:" Resync every 30 mins"},{value:"1hour",label:" Resync every 1 hour"},{value:"6hour",label:" Resync every 6 hours"},{value:"12hour",label:" Resync every 12 hours"},{value:"24hour",label:" Resync Daily"},{value:"7day",label:" Resync Weekly"},{value:"30day",label:" Resync Monthly"}];function ir({codeEditorKey:e}){let{sourceTableItems:t}=(0,Ae.useValues)(rr({codeEditorKey:e})),{editingView:o}=(0,Ae.useValues)(le),{runDataWarehouseSavedQuery:n}=(0,Ae.useActions)(le),{dataWarehouseSavedQueryMapById:r,updatingDataWarehouseSavedQuery:i}=(0,Ae.useValues)(ce),{updateDataWarehouseSavedQuery:a}=(0,Ae.useActions)(ce),s=o?r[o.id]:null;return(0,_.jsx)(yt,{children:(0,_.jsxs)("div",{className:"flex flex-col flex-1 p-4 gap-4",children:[(0,_.jsxs)("div",{children:[(0,_.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,_.jsx)("h3",{className:"mb-0",children:"Materialization"}),(0,_.jsx)(ut,{type:"warning",children:"BETA"})]}),(0,_.jsx)("div",{children:s?.sync_frequency||s?.last_run_at?(0,_.jsxs)("div",{children:[s?.last_run_at?`Last run at ${ct(s?.last_run_at)}`:(0,_.jsx)("div",{children:(0,_.jsx)("span",{children:"Materialization scheduled"})}),(0,_.jsxs)("div",{className:"flex gap-4 mt-2",children:[(0,_.jsx)(oe,{loading:s?.status==="Running",disabledReason:s?.status==="Running"?"Query is already running":!1,onClick:()=>o&&n(o.id),type:"secondary",children:"Sync now"}),(0,_.jsx)(dn,{className:"h-9",disabledReason:s?.status==="Running"?"Query is already running":!1,value:o&&r[o.id]?.sync_frequency||"never",onChange:f=>{o&&f&&a({id:o.id,sync_frequency:f,types:[[]],lifecycle:"update"})},loading:i,options:ss})]})]}):(0,_.jsxs)("div",{children:[(0,_.jsx)("p",{children:"Materialized views are a way to pre-compute data in your data warehouse. This allows you to run queries faster and more efficiently."}),(0,_.jsx)(oe,{onClick:()=>o&&a({id:o.id,sync_frequency:"24hour",types:[[]],lifecycle:"create"}),type:"primary",disabledReason:o?void 0:"You must save the view first",loading:i,children:"Materialize"})]})})]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{children:"Columns"}),(0,_.jsx)("p",{children:"Columns that are available in the materialized view."})]}),(0,_.jsx)(ft,{columns:[{key:"name",title:"Name",render:(f,d)=>d.name},{key:"type",title:"Type",render:(f,d)=>d.type},{key:"schema_valid",title:"Schema Valid",render:(f,d)=>(0,_.jsx)(ut,{type:d.schema_valid?"success":"danger",children:d.schema_valid?"Yes":"No"})}],dataSource:s?.columns||[]}),(0,_.jsxs)("div",{children:[(0,_.jsx)("h3",{children:"Dependencies"}),(0,_.jsx)("p",{children:"Dependencies are tables that this query uses. See when a source or materialized table was last run."})]}),(0,_.jsx)(ft,{columns:[{key:"Name",title:"Name",render:(f,{name:d})=>d},{key:"Type",title:"Type",render:(f,{type:d})=>d},{key:"Status",title:"Status",render:(f,{type:d,status:b})=>d==="source"?(0,_.jsx)(po,{title:"This is a source table, so it doesn't have a status",children:(0,_.jsx)("span",{className:"text-secondary",children:"N/A"})}):b},{key:"Last run at",title:"Last run at",render:(f,{type:d,last_run_at:b})=>d==="source"?(0,_.jsx)(po,{title:"This is a source table, so it is never run",children:(0,_.jsx)("span",{className:"text-secondary",children:"N/A"})}):ct(b)}],dataSource:t})]})})}O();$();B();var wt=W(Se());O();$();B();var sr=W(Y());function ls({pref:e,className:t="",children:o}){return(0,sr.jsx)("div",{ref:e,className:`flex w-[200px] px-4 py-3 justify-center items-center space-between gap-1 bg-primary border border-black border-2 rounded-lg ${t}`,children:o})}var ar=ls;O();$();B();var dr=W(go()),pe=W(He()),Ge=W(Y()),ds=300,cs=400,us=e=>{let t={};e.forEach(n=>{t[n.nodeId]={...n,depth:-1}});let o=(n,r)=>{let i=t[n];i&&(i.depth=r,i.leaf.forEach(a=>{t[a]&&o(a,r+1)}))};return e.forEach(n=>{t[n.nodeId].depth===-1&&o(n.nodeId,0)}),Object.values(t)},fs=e=>{e.sort((a,s)=>a.depth-s.depth);let o=[],n=[],r=(a,s=0)=>{if(n.includes(a))return s;n.push(a);let f=e.find(h=>h.nodeId===a);if(!f)return s;let d={...f,position:{x:50+f.depth*cs,y:50+s*ds}};o.push(d);let b=s;return f.leaf.filter(h=>!h.includes("_joined")).forEach((h,x)=>{r(h,s+x),b=Math.max(b,s+x)}),b},i=0;return e.forEach(a=>{a.depth===0&&(i=r(a.nodeId,i)+1)}),o},lr=(e,t)=>{if(!t)return{...e,left:null,right:null};let{x:o,y:n}=e.position,{width:r,height:i}=t.getBoundingClientRect();return{...e,left:{x:o,y:n+i/2},right:{x:o+r,y:n+i/2}}},gs=(e,t)=>{if(!e.right||!t.left)return[];let o=[];return o.push({from:e.right,to:t.left}),o},ps=(e,t)=>{let o=t.reduce((a,s)=>(a[s.nodeId]=s,a),{}),n=(a,s=new Set)=>{if(s.has(a))return[];s.add(a);let f=o[a];if(!f)return[];let d=e.find(x=>x?.id===a);if(!d)return[];let b=[],h=lr(f,d);for(let x of f.leaf){let g=o[x],E=e.find(C=>C?.id===x);if(g&&E){let C=lr(g,E);b.push(...gs(h,C))}b.push(...n(x,s))}return b},r=[],i=new Set;for(let a of t)i.has(a.nodeId)||r.push(...n(a.nodeId,i));return r};function cr({nodes:e,renderNode:t}){let o=(0,pe.useRef)(null),[n,r]=(0,pe.useState)(!1),[i,a]=(0,pe.useState)({x:0,y:0}),[s,f]=(0,pe.useState)({x:0,y:0}),d=(0,pe.useRef)(Array(e.length).fill(null)),[b,h]=(0,pe.useState)([]),[x,g]=(0,pe.useState)([]);(0,pe.useEffect)(()=>{let c=us(e),k=fs(c);h(k)},[e,i]),(0,pe.useEffect)(()=>{let c=[...b],k=ps([...d.current],c);g(k)},[b]);let E=(c,k,D)=>{c.fillStyle="#000000",c.imageSmoothingEnabled=!0;let T=.5,z=10;for(let p=i.x%z;p<k;p+=z)for(let m=i.y%z;m<D;m+=z)c.fillRect(p,m,T,T)};(0,pe.useEffect)(()=>{let c=o.current;if(!c)return;let k=c.getContext("2d");if(!k)return;let{width:D,height:T}=c.getBoundingClientRect();c.width=D,c.height=T,E(k,D,T);let z=()=>{if(c){let{width:p,height:m}=c.getBoundingClientRect();c.width=p,c.height=m;let v=c.getContext("2d");v&&E(v,p,m)}};return window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)},[i,b]);let C=c=>{r(!0),f({x:c.clientX-i.x,y:c.clientY-i.y})},R=c=>{if(!n)return;let k={x:c.clientX-s.x,y:c.clientY-s.y};a(k)},S=()=>{r(!1)};return(0,Ge.jsxs)("div",{className:"w-full h-full relative",children:[(0,Ge.jsx)("canvas",{ref:o,onMouseDown:C,onMouseMove:R,onMouseUp:S,onMouseLeave:S,className:(0,dr.clsx)("w-full h-full absolute inset-0",n?"cursor-grabbing":"cursor-grab")}),(0,Ge.jsx)("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",children:x.map((c,k)=>{let D=c.from.x+i.x+(c.to.x-c.from.x)/3,T=c.from.y+i.y,z=c.to.x+i.x-(c.to.x-c.from.x)/3,p=c.to.y+i.y;return(0,Ge.jsx)("path",{d:`M ${c.from.x+i.x} ${c.from.y+i.y} 
                               C ${D} ${T}, 
                                 ${z} ${p}, 
                                 ${c.to.x+i.x} ${c.to.y+i.y}`,stroke:"var(--text-3000)",strokeWidth:"2",fill:"none"},k)})}),b.map((c,k)=>(0,Ge.jsx)("div",{className:"absolute",style:{left:`${c.position.x+i.x}px`,top:`${c.position.y+i.y}px`},children:t(c,D=>{d.current[k]=D,d.current[k]?.setAttribute("id",c.nodeId)})},c.nodeId))]})}O();$();B();var ee=W(Se()),ur=W(ci());var _t=(0,ee.kea)([(0,ee.path)(["data-warehouse","editor","outputPaneTabs","lineageTabLogic"]),(0,ee.props)({}),(0,ee.key)(e=>e.codeEditorKey),(0,ee.actions)({loadNodes:!0,traverseAncestors:(e,t)=>({viewId:e,level:t}),setNodes:e=>({nodes:e})}),(0,ee.connect)(e=>({values:[le({key:e.codeEditorKey}),["metadata"],Qt,["posthogTablesMap","viewsMapById","dataWarehouseTablesMapById"],ce,["dataWarehouseSavedQueryMap"]],actions:[le({key:e.codeEditorKey}),["runQuery"],ce,["loadDataWarehouseSavedQueries"]]})),(0,ee.reducers)({nodeMap:[{},{setNodes:(e,{nodes:t})=>t}]}),(0,ee.listeners)(({actions:e,values:t})=>({loadNodes:async()=>{let o={},n=async(r,i)=>{if(!o[r]?.savedQueryId)return;let a=await Mn.dataWarehouseSavedQueries.ancestors(r,i);for(let s of a.ancestors)o[s]={nodeId:s,name:t.viewsMapById[s]?.name||t.dataWarehouseTablesMapById[s]?.name||s,savedQueryId:t.viewsMapById[s]?.id,leaf:[...o[s]?.leaf||[],r]},await n(s,1)};t.sources.forEach(r=>{r&&(o[r]={nodeId:r,name:r,savedQueryId:void 0,leaf:[]})});for(let r of t.views)r&&(o[r.id]={nodeId:r.id,name:r.name,savedQueryId:r.id,leaf:[]},await n(r.id,1));e.setNodes(o)}})),(0,ur.subscriptions)(({actions:e})=>({metadata:()=>{e.loadNodes()}})),(0,ee.selectors)({views:[e=>[e.metadata,e.dataWarehouseSavedQueryMap],(e,t)=>e?e.table_names?.map(o=>{let n=t[o];if(n)return n}).filter(Boolean)||[]:[]],sources:[e=>[e.metadata,e.dataWarehouseSavedQueryMap],(e,t)=>e?e.table_names?.map(o=>{if(!t[o])return o}).filter(Boolean)||[]:[]],allNodes:[e=>[e.nodeMap],e=>[...Object.values(e)]]}),(0,ee.events)(({cache:e,actions:t})=>({afterMount:()=>{e.pollingInterval||(e.pollingInterval=setInterval(t.loadDataWarehouseSavedQueries,1e4))},beforeUnmount:()=>{clearInterval(e.pollingInterval)}}))]);var me=W(Y());function fr(){let{allNodes:e}=(0,wt.useValues)(_t),{dataWarehouseSavedQueryMapById:t}=(0,wt.useValues)(ce),{runDataWarehouseSavedQuery:o}=(0,wt.useActions)(ce);return(0,me.jsx)("div",{className:"flex flex-1 relative bg-dark z-0",children:(0,me.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:(0,me.jsx)(cr,{nodes:e,renderNode:(r,i)=>(0,me.jsx)(ar,{pref:i,children:(0,me.jsxs)("div",{className:"flex flex-col max-w-full",children:[(0,me.jsxs)("div",{className:"flex flex-wrap justify-between gap-2",children:[(0,me.jsx)("div",{className:"font-bold break-all",children:r.name}),r.savedQueryId&&(0,me.jsx)(oe,{type:"primary",size:"xsmall",onClick:()=>r.savedQueryId&&o(r.savedQueryId),children:"Run"})]}),r.savedQueryId&&t[r.savedQueryId]?.status&&(0,me.jsx)("div",{className:"text-xs mt-2 max-w-full",children:(0,me.jsx)(ut,{type:t[r.savedQueryId]?.status&&Wn[t[r.savedQueryId].status]||"default",className:"break-words",children:t[r.savedQueryId]?.status})}),r.savedQueryId&&t[r.savedQueryId]?.last_run_at&&(0,me.jsx)("span",{className:"text-xs mt-2 max-w-full break-words",children:`Last calculated ${ct(t[r.savedQueryId]?.last_run_at)}`})]})})})})})}var w=W(Y());function ms({isOpen:e,onClose:t,row:o,columns:n}){if(!o)return(0,w.jsx)(w.Fragment,{});let r=n.map(i=>({column:i,value:o[i]===null?(0,w.jsx)("span",{className:"text-muted",children:"null"}):typeof o[i]=="object"?(0,w.jsx)("pre",{className:"whitespace-pre-wrap break-all m-0 font-mono",children:JSON.stringify(o[i],null,2)}):(0,w.jsx)("span",{className:"whitespace-pre-wrap break-all font-mono",children:String(o[i])})}));return(0,w.jsx)(sn,{title:"Row Details",isOpen:e,onClose:t,width:800,children:(0,w.jsx)("div",{className:"max-h-[70vh] overflow-y-auto px-2",children:(0,w.jsx)(ft,{dataSource:r,columns:[{title:"Column",dataIndex:"column",className:"font-semibold max-w-xs"},{title:"Value",dataIndex:"value",className:"px-4"}]})})})}function pr(){let{activeTab:e}=(0,ue.useValues)(ko),{setActiveTab:t}=(0,ue.useActions)(ko),{sourceQuery:o,exportContext:n,editorKey:r,metadataLoading:i}=(0,ue.useValues)(le),{saveAsInsight:a,setSourceQuery:s}=(0,ue.useActions)(le),{isDarkModeOn:f}=(0,ue.useValues)(un),{response:d,responseLoading:b,responseError:h,queryId:x,pollResponse:g}=(0,ue.useValues)(gt),{visualizationType:E,queryCancelled:C}=(0,ue.useValues)(Ye),{toggleChartSettingsPanel:R}=(0,ue.useActions)(Ye),{featureFlags:S}=(0,ue.useValues)(Gt),c=(0,De.useMemo)(()=>"SQLEditorScene",[]),k=(0,De.useMemo)(()=>{let m=d?.types;return d?.columns?.map((v,M)=>{let G=m?.[M]?.[1],te=Math.max(v.length,...d.results.map(U=>{let xe=U[M];return typeof xe=="string"?xe.length:xe===null?0:xe.toString().length}))>100?600:void 0;return G&&G.indexOf("Bool")!==-1?{key:v,name:v,resizable:!0,width:te,renderCell:U=>U.row[v]===null?null:U.row[v].toString()}:{...{key:v,name:v,resizable:!0,width:te},renderCell:U=>U.row[v]}})??[]},[d]),D=(0,De.useMemo)(()=>d?.results?d?.results?.map((m,v)=>{let M={__index:v};return d.columns.forEach((G,H)=>{typeof m[H]=="object"&&m[H]!==null?M[G]=JSON.stringify(m[H]):M[G]=m[H]}),M}):[],[d]),[T,z]=(0,De.useState)(null),p=(0,De.useCallback)(m=>{z(m.row)},[]);return(0,w.jsxs)("div",{className:"flex flex-col w-full flex-1 bg-primary",children:[(0,w.jsxs)("div",{className:"flex flex-row justify-between align-center py-2 px-4 w-full h-[55px]",children:[(0,w.jsx)(cn,{activeKey:e,onChange:m=>t(m),tabs:[{key:"results",label:"Results"},{key:"visualization",label:"Visualization"},...S[At.DATA_MODELING]?[{key:"info",label:(0,w.jsxs)("span",{className:"flex flex-row items-center gap-2",children:["Info ",i?(0,w.jsx)(ho,{}):null]})},{key:"lineage",label:(0,w.jsxs)("span",{className:"flex flex-row items-center gap-2",children:["Lineage ",i?(0,w.jsx)(ho,{}):null]})}]:[]]}),(0,w.jsxs)("div",{className:"flex gap-2",children:[e==="results"&&n&&(0,w.jsx)(yn,{disabledReason:E!="ActionsTable"&&"Only table results are exportable",type:"secondary",items:[{export_format:"text/csv",export_context:n},{export_format:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",export_context:n}]}),e==="visualization"&&(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("div",{className:"flex justify-between flex-wrap",children:[(0,w.jsx)("div",{className:"flex items-center"}),(0,w.jsx)("div",{className:"flex items-center",children:(0,w.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,w.jsx)(Nn,{}),(0,w.jsx)(oe,{type:"secondary",icon:(0,w.jsx)(tn,{}),onClick:()=>R(),tooltip:"Visualization settings"}),(0,w.jsx)(oe,{type:"primary",onClick:()=>a(),children:"Create insight"})]})})]})})]})]}),(0,w.jsx)("div",{className:"flex flex-1 relative bg-dark",children:(0,w.jsx)(ue.BindLogic,{logic:_t,props:{codeEditorKey:r},children:(0,w.jsx)(bs,{activeTab:e,responseError:h,responseLoading:b,response:d,sourceQuery:o,queryCancelled:C,columns:k,rows:D,isDarkModeOn:f,vizKey:c,setSourceQuery:s,exportContext:n,saveAsInsight:a,queryId:x,pollResponse:g,editorKey:r,onRowClick:p})})}),(0,w.jsxs)("div",{className:"flex justify-between px-2 border-t",children:[(0,w.jsx)("div",{children:d?(0,w.jsx)(Rn,{}):(0,w.jsx)(w.Fragment,{})}),(0,w.jsx)(xn,{})]}),(0,w.jsx)(ms,{isOpen:!!T,onClose:()=>z(null),row:T,columns:d?.columns||[]})]})}function hs(e){let{query:t,visualizationType:o,showEditingUI:n,response:r,responseLoading:i,isChartSettingsPanelOpen:a}=(0,ue.useValues)(Ye),s=null;return!n&&(!r||i)?s=(0,w.jsx)("div",{className:"flex flex-col flex-1 justify-center items-center bg-surface-primary h-full",children:(0,w.jsx)(mn,{})}):o==="ActionsTable"?s=(0,w.jsx)(Cn,{uniqueKey:e.uniqueKey,query:t,context:e.context,cachedResults:e.cachedResults}):o==="ActionsLineGraph"||o==="ActionsBar"||o==="ActionsAreaGraph"||o==="ActionsStackedBar"?s=(0,w.jsx)(Ln,{}):o==="BoldNumber"&&(s=(0,w.jsx)(wn,{})),(0,w.jsx)("div",{className:"DataVisualization h-full hide-scrollbar flex flex-1 gap-2",children:(0,w.jsx)("div",{className:"relative w-full flex flex-col gap-4 flex-1",children:(0,w.jsxs)("div",{className:"flex flex-1 flex-row gap-4 overflow-scroll hide-scrollbar",children:[a&&(0,w.jsx)("div",{children:(0,w.jsx)(Tn,{})}),(0,w.jsx)("div",{className:(0,Eo.default)("w-full h-full flex-1 overflow-auto"),children:s})]})})})}var gr=({responseError:e,sourceQuery:t,queryCancelled:o,response:n})=>(0,w.jsx)("div",{className:(0,Eo.default)("flex-1 absolute top-0 left-0 right-0 bottom-0 overflow-scroll"),children:(0,w.jsx)(bn,{query:t,excludeDetail:!0,title:o?"The query was cancelled":n&&"error"in n?n.error:e})}),bs=({activeTab:e,responseError:t,responseLoading:o,response:n,sourceQuery:r,queryCancelled:i,columns:a,rows:s,isDarkModeOn:f,vizKey:d,setSourceQuery:b,exportContext:h,saveAsInsight:x,queryId:g,pollResponse:E,editorKey:C,onRowClick:R})=>e==="results"?t?(0,w.jsx)(gr,{responseError:t,sourceQuery:r,queryCancelled:i,response:n}):o?(0,w.jsx)("div",{className:"flex flex-1 p-2 w-full justify-center items-center",children:(0,w.jsx)(hn,{queryId:g,pollResponse:E,renderEmptyStateAsSkeleton:!0})}):n?(0,w.jsx)(yt,{children:(0,w.jsx)(nr,{className:f?"rdg-dark h-full":"rdg-light h-full",columns:a,rows:s,onCellClick:R})}):(0,w.jsx)("div",{className:"flex flex-1 justify-center items-center",children:(0,w.jsx)("span",{className:"text-secondary mt-3",children:"Query results will appear here"})}):e==="visualization"?t?(0,w.jsx)(gr,{responseError:t,sourceQuery:r,queryCancelled:i,response:n}):n?(0,w.jsx)("div",{className:"flex-1 absolute top-0 left-0 right-0 bottom-0 px-4 py-1 hide-scrollbar",children:(0,w.jsx)(hs,{uniqueKey:d,query:r,setQuery:b,context:{},cachedResults:void 0,exportContext:h,onSaveInsight:x})}):(0,w.jsx)("div",{className:"flex flex-1 justify-center items-center",children:(0,w.jsx)("span",{className:"text-secondary mt-3",children:"Query results will be visualized here"})}):e==="info"?(0,w.jsx)(ir,{codeEditorKey:C}):e==="lineage"?(0,w.jsx)(fr,{}):null;O();$();B();var mr=W(Se());var Ie=W(Y());function hr(e){let{queryPaneHeight:t,queryPaneResizerProps:o}=(0,mr.useValues)(Ft);return(0,Ie.jsx)(Ie.Fragment,{children:(0,Ie.jsxs)("div",{className:"relative flex flex-col w-full bg-primary",style:{height:`${t}px`},ref:o.containerRef,children:[(0,Ie.jsx)("div",{className:"flex-1",children:(0,Ie.jsx)(gn,{children:({height:n,width:r})=>(0,Ie.jsx)(fn,{language:"hogQL",value:e.queryInput,sourceQuery:e.sourceQuery,height:n,width:r,...e.codeEditorProps,options:{minimap:{enabled:!1},wordWrap:"on",scrollBeyondLastLine:!1,automaticLayout:!0,fixedOverflowWidgets:!0,suggest:{showInlineDetails:!0},quickSuggestionsDelay:300}})})}),(0,Ie.jsx)(vn,{...o})]})})}O();$();B();var yr=W(go()),Ct=W(He());O();$();B();var vt=W(He()),xt=W(Y()),ys=({value:e,onChange:t,onKeyDown:o,onBlur:n,autoFocus:r,handleRename:i})=>{let a=(0,vt.useRef)(null),s=(0,vt.useRef)(null);return(0,vt.useEffect)(()=>{if(!a.current||!s.current)return;let d=s.current.offsetWidth;a.current.style.width=d+"px"},[e]),(0,xt.jsxs)("div",{className:"relative inline-block",children:[(0,xt.jsx)("span",{ref:s,className:"pointer-events-none absolute invisible whitespace-pre","aria-hidden":"true",children:e}),(0,xt.jsx)("input",{ref:a,className:"bg-transparent border-none focus:outline-none p-0",value:e,onChange:d=>{t(d),i()},onKeyDown:o,onBlur:n,autoFocus:r})]})},br=ys;var ve=W(Y());function wr({models:e,onClear:t,onClick:o,onAdd:n,onRename:r,activeModelUri:i}){return(0,ve.jsxs)("div",{className:"flex flex-row w-full overflow-scroll hide-scrollbar h-10 pt-1",children:[e.map(a=>(0,ve.jsx)(ws,{model:a,onClear:e.length>1?t:void 0,onClick:o,active:i?.uri.path===a.uri.path,onRename:r},a.uri.path)),(0,ve.jsx)(oe,{onClick:()=>n(),icon:(0,ve.jsx)(nn,{fontSize:14})})]})}function ws({model:e,active:t,onClear:o,onClick:n,onRename:r}){let[i,a]=(0,Ct.useState)(()=>e.name||vo),[s,f]=(0,Ct.useState)(!1);(0,Ct.useEffect)(()=>{a(e.view?.name||e.name||vo)},[e.view?.name]);let d=()=>{f(!1),r(e,i)};return(0,ve.jsxs)("div",{onClick:()=>n?.(e),className:(0,yr.default)("space-y-px rounded-t p-1 flex border-b-2 flex-row items-center gap-1 hover:bg-surface-primary cursor-pointer",t?"bg-surface-primary border-b-2 !border-brand-yellow":"bg-surface-secondary border-transparent",o?"pl-3 pr-2":"px-3"),children:[s?(0,ve.jsx)(br,{value:i,onChange:b=>a(b.target.value),onBlur:d,autoFocus:!0,handleRename:()=>r(e,i),onKeyDown:b=>{b.key==="Enter"?d():b.key==="Escape"&&f(!1)}}):(0,ve.jsx)("div",{onDoubleClick:()=>{e.view||f(!s)},className:"flex-grow text-left whitespace-pre",children:i}),o&&(0,ve.jsx)(oe,{onClick:b=>{b.stopPropagation(),o(e)},size:"xsmall",icon:(0,ve.jsx)(an,{})})]})}var X=W(Y());function Cr(){let[e,t]=(0,xr.useState)(null),[o,n]=e??[],r=`hogQLQueryEditor/${vr.router.values.location.pathname}`,{featureFlags:i}=(0,re.useValues)(Gt),a=le({key:r,monaco:o,editor:n}),{allTabs:s,activeModelUri:f,queryInput:d,editingView:b,sourceQuery:h,isValidView:x}=(0,re.useValues)(a),{renameTab:g,selectTab:E,deleteTab:C,createTab:R,setQueryInput:S,runQuery:c,setError:k,setIsValidView:D,setMetadata:T,setMetadataLoading:z,saveAsView:p,setSourceQuery:m}=(0,re.useActions)(a),{response:v}=(0,re.useValues)(gt({key:je,query:h.source,autoLoad:!1})),{updatingDataWarehouseSavedQuery:M}=(0,re.useValues)(ce),{updateDataWarehouseSavedQuery:G}=(0,re.useActions)(ce),H={key:je,query:h,dashboardId:void 0,dataNodeCollectionId:je,insightMode:"edit",loadPriority:void 0,cachedResults:void 0,variablesOverride:void 0,setQuery:m},V={query:h.source,key:je,cachedResults:void 0,loadPriority:void 0,dataNodeCollectionId:je,variablesOverride:void 0,autoLoad:!1},te={key:H.key,readOnly:!1,queryInput:d};return(0,X.jsx)(re.BindLogic,{logic:gt,props:V,children:(0,X.jsx)(re.BindLogic,{logic:Ye,props:H,children:(0,X.jsx)(re.BindLogic,{logic:En,props:{key:H.key},children:(0,X.jsx)(re.BindLogic,{logic:wo,props:te,children:(0,X.jsx)(re.BindLogic,{logic:zn,props:{key:H.key},children:(0,X.jsxs)("div",{className:"flex flex-1 flex-col h-full overflow-hidden",children:[(0,X.jsx)("div",{className:"overflow-x-auto px-1",children:(0,X.jsx)(wr,{models:s,onClick:E,onClear:C,onAdd:R,onRename:g,activeModelUri:f})}),b&&(0,X.jsx)("div",{className:"h-5 bg-warning-highlight",children:(0,X.jsxs)("span",{className:"text-xs",children:["Editing ",b.last_run_at?"materialized view":"view",' "',b.name,'"']})}),(0,X.jsxs)("div",{className:"flex flex-row justify-start align-center w-full ml-2 mr-2",children:[(0,X.jsx)(oe,{onClick:()=>c(),icon:(0,X.jsx)(on,{color:"var(--success)"}),type:"tertiary",size:"xsmall",children:"Run"}),(0,X.jsx)(bo,{vertical:!0}),b?(0,X.jsx)(oe,{onClick:()=>G({id:b.id,query:h.source,types:v?.types??[]}),disabledReason:M?"Saving...":"",icon:(0,X.jsx)(mo,{}),type:"tertiary",size:"xsmall",children:"Update view"}):(0,X.jsx)(oe,{onClick:()=>p(),disabledReason:x?"":"Some fields may need an alias",icon:(0,X.jsx)(mo,{}),type:"tertiary",size:"xsmall",children:"Save as view"}),i[At.INSIGHT_VARIABLES]&&(0,X.jsx)(bo,{vertical:!0}),(0,X.jsx)(Dn,{buttonProps:{type:"tertiary",size:"xsmall"}})]}),(0,X.jsx)(vs,{}),(0,X.jsx)(hr,{queryInput:d,sourceQuery:h.source,promptError:null,codeEditorProps:{queryKey:r,onChange:Q=>{S(Q??"")},onMount:(Q,U)=>{t([U,Q])},onPressCmdEnter:(Q,U)=>{Q&&U==="selection"?c(Q):c()},onError:(Q,U)=>{k(Q),D(U)},onMetadata:Q=>{T(Q)},onMetadataLoading:Q=>{z(Q)}}}),(0,X.jsx)(re.BindLogic,{logic:le,props:{key:r,monaco:o,editor:n},children:(0,X.jsx)(xs,{})})]})})})})})})}function vs(){let{variablesForInsight:e}=(0,re.useValues)(wo);return e.length?(0,X.jsx)("div",{className:"py-2 px-4",children:(0,X.jsx)(Pn,{})}):(0,X.jsx)(X.Fragment,{})}function xs(){let{cacheLoading:e}=(0,re.useValues)(le);return e?null:(0,X.jsx)(pr,{})}var Z=W(Y());function Gc(){let e=(0,Kt.useRef)(null),t=(0,Kt.useRef)(null),o=(0,Kt.useRef)(null);return(0,Z.jsxs)(Pe.BindLogic,{logic:Ft,props:{editorSceneRef:e,navigatorRef:t,sourceNavigatorResizerProps:{containerRef:t,logicKey:"source-navigator",placement:"right"},queryPaneResizerProps:{containerRef:o,logicKey:"query-pane",placement:"bottom"}},children:[(0,Z.jsxs)("div",{className:"w-full h-full flex flex-row overflow-hidden",ref:e,children:[(0,Z.jsx)(Cs,{}),(0,Z.jsx)(Cr,{})]}),(0,Z.jsx)(kn,{})]})}var Cs=()=>{let{sidebarOverlayOpen:e}=(0,Pe.useValues)(Vt),t={identifier:"SQLEditor",label:"SQL editor",icon:(0,Z.jsx)(rn,{}),logic:Hn};return(0,Z.jsx)(An,{navbarItem:t,sidebarOverlay:(0,Z.jsx)(Rs,{}),sidebarOverlayProps:{isOpen:e}})},Rs=()=>{let{setSidebarOverlayOpen:e}=(0,Pe.useActions)(Vt),{sidebarOverlayTreeItems:t,selectedSchema:o}=(0,Pe.useValues)(Vt),{toggleJoinTableModal:n,selectSourceTable:r}=(0,Pe.useActions)(In);return(0,Z.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Z.jsxs)("header",{className:"flex flex-row items-center h-10 border-b shrink-0 p-1 gap-2",children:[(0,Z.jsx)(oe,{size:"small",icon:(0,Z.jsx)(Zo,{}),onClick:()=>e(!1)}),o?.name&&(0,Z.jsx)(pn,{className:"font-mono",tooltipMessage:null,description:"schema",iconStyle:{color:"var(--text-secondary)"},explicitValue:o?.name,children:o?.name}),(0,Z.jsx)(ln,{items:[{label:"Add join",onClick:()=>{o&&(r(o.name),n())}}],children:(0,Z.jsx)("div",{className:"absolute right-1 flex",children:(0,Z.jsx)(oe,{size:"small",noPadding:!0,icon:(0,Z.jsx)(en,{})})})})]}),(0,Z.jsx)("div",{className:"overflow-y-auto flex-1",children:(0,Z.jsx)(Sn,{items:t})})]})};export{Gc as EditorScene};
//# sourceMappingURL=/static/EditorScene-X7FTOVIO.js.map
