import{a as pe,b as Pt}from"/static/chunk-336DAFEI.js";import{a as Et}from"/static/chunk-LZ4U35M5.js";import{$j as It,Ah as ht,Cd as st,Ce as mt,Dn as Vt,Do as xe,Eh as xt,Ek as Gt,Eo as Fe,Fk as kt,Gb as je,Hc as et,Id as nt,Ik as Wt,Io as wt,Ld as rt,Lm as Ue,Mb as Oe,Mm as he,Nd as lt,Nm as Lt,Oh as Ft,Ok as Tt,Pe as Ve,Qa as _e,Qd as be,Sa as T,Sb as Ke,Sd as N,Ta as D,Un as Zt,Wd as Le,Wj as Nt,Xc as tt,Yc as ot,Yi as ie,a as Z,ae as at,ah as Ze,b as w,bh as J,ch as bt,ck as St,dc as $e,ed as it,ee as ct,fk as Rt,gb as De,gk as Ct,h as Te,hb as Me,ik as I,jc as qe,ko as Ut,l as Qe,lo as Bt,m as ve,ob as Ye,pe as dt,pg as pt,qg as gt,r as b,rg as ut,s as de,se as O,ub as ze,vg as ft,wb as He,wg as yt,x as me,yg as vt}from"/static/chunk-RFJTZKD6.js";import{F as oe,a as We,lb as Xe,wc as Ae}from"/static/chunk-3UDJFOQH.js";import{d as l,e as u,g as f,j as y}from"/static/chunk-SJXEOBQC.js";u();y();f();var _=l(Z());u();y();f();var ge=l(Te()),Ie=l(Z());var q=l(We());u();y();f();var se=l(Z());u();y();f();var Y=l(Z());u();y();f();var U=l(Z());var go=1e4,M=(0,U.kea)([(0,U.path)(["lib","components","AiFilter","aiFilterLogicType"]),(0,U.props)({}),(0,U.actions)({setMessages:e=>({messages:e}),setInput:e=>({input:e}),setIsLoading:e=>({isLoading:e}),handleAi:e=>({newMessages:e}),handleReset:()=>({}),handleSend:()=>({})}),(0,U.reducers)({messages:[[],{setMessages:(e,{messages:t})=>t}],input:["",{setInput:(e,{input:t})=>t}],isLoading:[!1,{setIsLoading:(e,{isLoading:t})=>t}]}),(0,U.listeners)(({actions:e,values:t,props:i})=>({handleSend:()=>{w.capture("ai_filter_send");let o=[...t.messages,{role:"user",content:t.input}];e.setMessages(o),e.handleAi(o),e.setInput("")},handleAi:async({newMessages:o})=>{e.setIsLoading(!0);try{let c=new Promise((g,v)=>{setTimeout(()=>v(new Error("Request timed out")),go)}),n=wt.recordings.aiFilters(o),d=await Promise.race([n,c]);d.hasOwnProperty("result")&&(d.result==="filter"&&(i.setFilters(d.data),w.capture("ai_filter_success")),e.setMessages([...o,{role:"assistant",content:d.result==="filter"?JSON.stringify(d.data):d.data.question}]))}catch{e.setMessages([...o,{role:"assistant",content:"Sorry, I was unable to process your request. Please try again."}]),w.capture("ai_filter_error")}e.setIsLoading(!1)},handleReset:()=>{e.setMessages([]),i.resetFilters(),w.capture("ai_filter_reset")}}))]);var R=l(b());function Jt(){let e=(0,Y.useMountedLogic)(I),{setFilters:t,resetFilters:i}=(0,Y.useActions)(e),o=M({setFilters:t,resetFilters:i}),{messages:c,input:n,isLoading:d}=(0,Y.useValues)(o),{setInput:g,handleSend:v,handleReset:E}=(0,Y.useActions)(o),{dataProcessingAccepted:B}=(0,Y.useValues)(Gt);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("div",{className:"w-[min(44rem,100%)] relative",children:[(0,R.jsx)(mt,{value:n,onChange:C=>g(C),placeholder:d?"Thinking\u2026":c.length===0?"Show me recordings of people who ...":"Ask follow-up",onPressEnter:()=>{n&&v()},minRows:1,maxRows:10,className:"p-3",autoFocus:!0,disabled:d}),(0,R.jsx)("div",{className:"absolute top-0 bottom-0 flex items-center right-2",children:(0,R.jsx)(kt,{placement:"right-end",middleware:[_e(-12)],showArrow:!0,children:(0,R.jsx)(N,{type:c.length===0?"primary":"secondary",onClick:v,tooltip:"Let's go!",disabled:d||n.length===0||!B,size:"small",icon:(0,R.jsx)(De,{})})})})]}),(0,R.jsx)("span",{className:"text-xs text-muted-alt",children:"* Max AI currently only knows about PostHog default properties added by our SDKs. For your custom properties, use the filters box below."}),c.length>0&&(0,R.jsx)("div",{children:(0,R.jsx)(N,{icon:(0,R.jsx)(ot,{}),onClick:E,disabled:d,type:"tertiary",size:"xsmall",children:"Start over"})})]})}u();y();f();var X=l(b());function Xt(){return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)("div",{className:"flex",children:(0,X.jsx)(ht,{className:"w-20 h-20"})}),(0,X.jsxs)("div",{className:"text-center mb-3",children:[(0,X.jsx)("h2",{className:"text-2xl font-bold mb-2 text-balance",children:"Chat with your recordings"}),(0,X.jsx)("div",{className:"text-secondary text-balance",children:"I'm Max, here to help you to find recordings matching your needs."})]})]})}u();y();f();var At=l(Z());var Ne=l(b());function Qt(){let e=M(),{setInput:t}=(0,At.useActions)(e);return(0,Ne.jsx)("div",{className:"flex items-center justify-center flex-wrap gap-x-2 gap-y-1.5 w-[min(48rem,100%)]",children:["Show me recordings of people who visited sign up page in the last 24 hours","Show me recordings of people who are frustrated","Show me recordings of people who are facing bugs"].map(o=>(0,Ne.jsx)(N,{className:"mb-1",type:"secondary",size:"xsmall",sideIcon:(0,Ne.jsx)(Me,{}),onClick:()=>t(o),children:o},o))})}u();y();f();var K=l(Z());var h=l(b());function _t(){let e=(0,K.useMountedLogic)(I),{setFilters:t,resetFilters:i}=(0,K.useActions)(e),o=M({setFilters:t,resetFilters:i}),{messages:c,isLoading:n}=(0,K.useValues)(o),{user:d}=(0,K.useValues)(Fe);return(0,h.jsx)(h.Fragment,{children:(c.length>0||n)&&(0,h.jsxs)("div",{className:"w-[min(44rem,100%)] relative",children:[c.filter(g=>g.role!=="system").map((g,v)=>(0,h.jsx)("div",{className:" my-2",children:g.role==="user"?(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"relative flex gap-2 flex-row-reverse ml-10 items-center",children:[(0,h.jsx)(T,{placement:"right",title:"You",children:(0,h.jsx)(ie,{user:{...d,hedgehog_config:void 0},size:"lg",className:"mt-1 border"})}),(0,h.jsx)("div",{className:"border py-2 px-3 rounded-lg bg-surface-primary font-medium",children:(0,h.jsx)(Ve,{children:g.content})})]})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"relative flex gap-2 mr-10 items-center",children:[(0,h.jsx)(T,{placement:"left",title:"Max",children:(0,h.jsx)(ie,{user:{hedgehog_config:{...d?.hedgehog_config,use_as_profile:!0}},size:"lg",className:"mt-1 border"})}),(0,h.jsx)("div",{className:"border py-2 px-3 rounded-lg bg-surface-primary font-medium",children:(0,h.jsx)(Ve,{children:g.content.length>0&&g.content[0]==="{"?"Done! Filters have been updated":g.content})})]})})},v)),n&&(0,h.jsxs)("div",{className:"relative flex gap-2 mr-10 items-center",children:[(0,h.jsx)(T,{placement:"left",title:"Max",children:(0,h.jsx)(ie,{user:{hedgehog_config:{...d?.hedgehog_config,use_as_profile:!0}},size:"lg",className:"mt-1 border"})}),(0,h.jsxs)("div",{className:"border py-2 px-3 rounded-lg bg-surface-primary font-medium",children:["Thinking...",(0,h.jsx)(be,{})]})]})]})})}var $=l(b());function Dt({isExpanded:e}){let t=(0,se.useMountedLogic)(I),{setFilters:i,resetFilters:o}=(0,se.useActions)(t),c=M({setFilters:i,resetFilters:o}),{messages:n}=(0,se.useValues)(c);return(0,$.jsxs)("div",{className:"relative flex flex-col gap-3 px-4 items-center grow justify-center",children:[n.length===0&&(0,$.jsx)(Xt,{}),(0,$.jsx)(_t,{}),e&&(0,$.jsx)(Jt,{}),n.length===0&&(0,$.jsx)(Qt,{})]})}u();y();f();var z=l(Z()),ne=(0,z.kea)([(0,z.path)(["scenes","session-recordings","playlist","playlistLogicType"]),(0,z.actions)({setIsExpanded:e=>({isExpanded:e})}),(0,z.reducers)({isExpanded:[!1,{setIsExpanded:(e,{isExpanded:t})=>t}]})]);var r=l(b()),Mt=100;function zt({title:e,notebooksHref:t,loading:i,embedded:o=!1,activeItemId:c,content:n,sections:d,headerActions:g,footerActions:v,filterActions:E,onScrollListEdge:B,listEmptyState:C,selectInitialItem:j,onSelect:ae,onChangeSections:F,"data-attr":V}){let ee=d.filter(m=>"items"in m)?.find(m=>m.items.length>0)?.items[0],[ye,Re]=(0,q.useState)(j&&ee?ee.id:null),Pe=(0,q.useRef)(null),{ref:Ce,size:ce}=nt({0:"small",750:"medium"}),{isExpanded:te}=(0,Ie.useValues)(ne),{setIsExpanded:S}=(0,Ie.useActions)(ne),P=m=>{Re(m.id),ae?.(m)},io=d.filter(m=>m.initiallyOpen).map(m=>m.key),[so,no]=(0,q.useState)(io),ro=m=>{no(m),F?.(m)},Ge=c===void 0?ye:c,lo=d.filter(m=>"items"in m).flatMap(m=>m.items).find(m=>m.id===Ge)||null,ke=(0,q.useRef)(0),ao=(0,q.useRef)(null),co=m=>{if(m.currentTarget.scrollTop>ke.current){let po=m.currentTarget.scrollTop+m.currentTarget.clientHeight;m.currentTarget.scrollHeight-po<Mt&&B?.("bottom")}m.currentTarget.scrollTop<ke.current&&m.currentTarget.scrollTop<Mt&&B?.("top"),ke.current=m.currentTarget.scrollTop},Je=d.length,mo=d.filter(m=>"items"in m).flatMap(m=>m.items).length;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:(0,ge.default)("w-full mb-8",{hidden:!te}),children:[(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(N,{icon:(0,r.jsx)(st,{}),onClick:()=>{S(!1),w.capture("ai_filter_close")}})}),(0,r.jsx)(Dt,{isExpanded:te})]}),(0,r.jsxs)("div",{className:(0,ge.default)("flex flex-col w-full gap-2 h-full",{"xl:flex-row":!0}),children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 xl:max-w-80",children:[(0,r.jsx)(de,{href:t,children:E}),(0,r.jsx)("div",{ref:Ce,"data-attr":V,className:(0,ge.default)("Playlist w-full min-w-60 min-h-96",{"Playlist--wide":ce!=="small","Playlist--embedded":o}),children:(0,r.jsx)("div",{ref:Pe,className:"Playlist__list flex flex-col relative overflow-hidden h-full w-full",children:(0,r.jsxs)("div",{className:"flex flex-col relative w-full bg-bg-light overflow-hidden h-full Playlist__list",children:[(0,r.jsx)(de,{href:t,children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"shrink-0 bg-bg-3000 relative flex justify-between items-center gap-0.5 whitespace-nowrap border-b",children:[e&&(0,r.jsx)(uo,{title:e,count:mo}),g]}),(0,r.jsx)(rt,{loading:i})]})}),(0,r.jsx)("div",{className:"overflow-y-auto flex-1",onScroll:co,ref:ao,children:Je>1?(0,r.jsx)(at,{defaultActiveKeys:so,panels:d.map(m=>({key:m.key,header:m.title??"",content:(0,r.jsx)(Yt,{section:m,loading:!!i,setActiveItemId:P,activeItemId:Ge,emptyState:C}),className:"p-0"})),onChange:ro,multiple:!0,embedded:!0,size:"small"}):Je===1?(0,r.jsx)(Yt,{section:d[0],loading:!!i,setActiveItemId:P,activeItemId:Ge,emptyState:C}):i?(0,r.jsx)(Ht,{}):C}),(0,r.jsx)("div",{className:"shrink-0 relative flex justify-between items-center gap-0.5 whitespace-nowrap",children:v})]})})})]}),(0,r.jsx)("div",{className:(0,ge.default)("Playlist h-full min-h-96 w-full min-w-96 lg:min-w-[560px] order-first xl:order-none",{"Playlist--wide":ce!=="small","Playlist--embedded":o}),children:n&&(0,r.jsxs)("div",{className:"Playlist__main h-full",children:[" ",typeof n=="function"?n({activeItem:lo}):n]})})]})]})}var uo=({title:e,count:t})=>(0,r.jsx)("div",{className:"flex items-center gap-0.5",children:e&&(0,r.jsxs)("span",{className:"flex flex-1 gap-1 items-center",children:[(0,r.jsx)("span",{className:"font-bold uppercase text-xxs tracking-wide",children:e}),(0,r.jsx)(T,{placement:"bottom",title:(0,r.jsxs)(r.Fragment,{children:["Showing ",t," results.",(0,r.jsx)("br",{}),"Scrolling to the bottom or the top of the list will load older or newer results respectively."]}),children:(0,r.jsxs)("span",{className:"rounded py-1 px-2 bg-border-light font-semibold select-none text-xxs",children:[Math.min(999,t),"+"]})})]})});function Yt({section:e,loading:t,activeItemId:i,setActiveItemId:o,emptyState:c}){return"content"in e?(0,r.jsx)(r.Fragment,{children:e.content}):"items"in e&&e.items.length?(0,r.jsx)(fo,{...e,onClick:o,activeItemId:i}):t?(0,r.jsx)(Ht,{}):c}function fo({items:e,render:t,footer:i,onClick:o,activeItemId:c}){return(0,r.jsxs)(r.Fragment,{children:[e.length>0?e.map(n=>(0,r.jsx)("div",{className:"border-b",onClick:()=>o(n),children:t({item:n,isActive:n.id===c})},n.id)):null,i]})}var Ht=()=>(0,r.jsx)(r.Fragment,{children:Ae(5).map(e=>(0,r.jsxs)("div",{className:"p-4 space-y-2",children:[(0,r.jsx)(O,{className:"w-1/2 h-4"}),(0,r.jsx)(O,{className:"w-1/3 h-4"})]},e))});u();y();f();var Be=l(Te()),A=l(Z());var ue=l(We());u();y();f();var Se=l(We());u();y();f();var Ot=l(b());function jt({onChange:e,value:t,onChangeEventDescription:i}){return(0,Ot.jsx)(dt,{"data-attr":"duration-type-selector",onChange:o=>{w.capture(i||"session recording duration type filter changed",{durationChoice:o}),e(o||"all")},options:[{label:"total duration",value:"duration"},{label:"active duration",value:"active_seconds"},{label:"inactive duration",value:"inactive_seconds"}],size:"small",value:t||"duration"})}var H=l(b()),yo={duration:"",active_seconds:"active ",inactive_seconds:"inactive "},vo=(e,t)=>{let i=e.operator==="gt"?">":"<",o=gt(e.value||0),c=yo[t],n=o.timeValue===1?o.unit.slice(0,-1):o.unit;return`${i} ${o.timeValue||0} ${c}${n}`};function Kt({recordingDurationFilter:e,durationTypeFilter:t,onChange:i,size:o,type:c}){let[n,d]=(0,Se.useState)(!1),g=(0,Se.useMemo)(()=>vo(e,t),[e,t]);return(0,H.jsx)(lt,{visible:n,placement:"bottom-start",fallbackPlacements:["bottom-end"],onClickOutside:()=>d(!1),overlay:(0,H.jsxs)("div",{className:"flex gap-2",children:[(0,H.jsx)(ft,{operator:e.operator,operators:["gt","lt"],onChange:v=>i({...e,operator:v},t),className:"flex-1"}),(0,H.jsx)(ut,{onChange:v=>i({...e,value:v},t),value:e.value||void 0}),(0,H.jsx)(jt,{onChange:v=>i(e,v),value:t})]}),children:(0,H.jsx)(N,{type:c??"secondary",size:o??"small",onClick:()=>{d(!0)},children:g})})}var p=l(b()),$t=({filters:e,setFilters:t,resetFilters:i,totalFiltersCount:o,className:c,allowReplayHogQLFilters:n=!1,allowReplayFlagsFilters:d=!1})=>{(0,A.useMountedLogic)(Ft),(0,A.useMountedLogic)(vt);let g=e.duration[0],[v,E]=(0,ue.useState)(!1),{isExpanded:B}=(0,A.useValues)(ne),{setIsExpanded:C}=(0,A.useActions)(ne),j=["replay","events","event_properties","actions","cohorts","person_properties","session_properties"];n&&j.push("hogql_expression"),d&&j.push("event_feature_flags");function ae(){let{user:F}=(0,A.useValues)(Fe);return(0,p.jsx)(ie,{user:{hedgehog_config:{...F?.hedgehog_config,use_as_profile:!0}},size:"md",className:"border bg-bg-light -scale-x-100"})}return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"flex justify-center relative gap-2",children:[(0,p.jsxs)(N,{className:"flex-1",type:"secondary",icon:(0,p.jsx)(Ke,{}),sideIcon:(0,p.jsx)(ze,{className:v?"rotate-180":""}),onClick:()=>{E(!v)},children:["Filters"," ",o&&o>0?(0,p.jsx)(me.Number,{count:o}):null]}),(0,p.jsx)(Wt,{flag:oe.RECORDINGS_AI_FILTER,children:(0,p.jsx)(N,{type:"secondary",icon:(0,p.jsx)(ae,{}),onClick:()=>{C(!B),w.capture("ai_filter_open"),B||E(!0)},children:"Help"})})]}),(0,p.jsx)("div",{className:(0,Be.default)("flex justify-center relative border-r border-l rounded-b overflow-hidden transition-all duration-200",v?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"),children:(0,p.jsxs)("div",{className:(0,Be.default)("divide-y bg-surface-primary rounded-b w-full",c),children:[(0,p.jsx)("div",{className:"flex items-center my-2",children:(0,p.jsx)(Tt,{value:e.filter_group.type,onChange:F=>{let V=e.filter_group.values;V.length===1&&(V=[{...V[0],type:F}]),t({filter_group:{type:F,values:V}})},topLevelFilter:!0,suffix:["filter","filters"],size:"xsmall"})}),(0,p.jsxs)("div",{className:"flex justify-between px-2 py-2 flex-wrap gap-1",children:[(0,p.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,p.jsx)(pt,{dateFrom:e.date_from??"-3d",dateTo:e.date_to,onChange:(F,V)=>{t({date_from:F,date_to:V})},dateOptions:[{key:"Custom",values:[]},{key:"Last 24 hours",values:["-24h"]},{key:"Last 3 days",values:["-3d"]},{key:"Last 7 days",values:["-7d"]},{key:"Last 30 days",values:["-30d"]},{key:"All time",values:["-90d"]}],dropdownPlacement:"bottom-start",size:"xsmall"}),(0,p.jsx)(Kt,{onChange:(F,V)=>{t({duration:[{...F,key:V}]})},recordingDurationFilter:g,durationTypeFilter:g.key,pageKey:"session-recordings",size:"xsmall"})]}),(0,p.jsx)("div",{children:(0,p.jsx)(Pt,{size:"xsmall",filters:e,onChange:F=>t({filter_test_accounts:F.filter_test_accounts})})})]}),(0,p.jsxs)("div",{className:"flex flex-wrap gap-2 p-2",children:[(0,p.jsx)(pe,{rootKey:"session-recordings",group:e.filter_group,taxonomicGroupTypes:j,onChange:F=>t({filter_group:F}),children:(0,p.jsx)(qt,{size:"xsmall"})}),i&&(o??0)>0&&(0,p.jsx)(N,{type:"tertiary",size:"xsmall",onClick:i,icon:(0,p.jsx)(tt,{}),children:"Reset"})]})]})})]})},qt=({size:e="small"})=>{let{filterGroup:t}=(0,A.useValues)(Ze),{replaceGroupValue:i,removeGroupValue:o}=(0,A.useActions)(Ze),[c,n]=(0,ue.useState)(!1);return(0,ue.useEffect)(()=>{n(!0)},[]),(0,p.jsx)(p.Fragment,{children:t.values.map((d,g)=>Nt(d)?(0,p.jsxs)(pe.Group,{index:g,group:d,children:[(0,p.jsx)(qt,{size:e}),(0,p.jsx)(pe.AddFilterButton,{size:e,type:"secondary"})]},g):(0,p.jsx)(pe.Value,{index:g,filter:d,onRemove:()=>o(g),onChange:v=>i(g,v),initiallyOpen:c,metadataSource:{kind:"RecordingsQuery"}},g))})};u();y();f();var we=l(Te()),fe=l(Z());var s=l(b());function ho({recordingDuration:e}){if(e===void 0)return(0,s.jsx)("div",{className:"flex text-secondary text-xs",children:"-"});let t=Xe(e),[i,o,c]=t.split(":");return(0,s.jsxs)("div",{className:"flex text-secondary text-xs",children:[i!="00"&&(0,s.jsxs)("span",{children:[i,":"]}),(0,s.jsxs)("span",{children:[o,":",c]})]})}function xo({iconClassNames:e,errorCount:t}){return t===void 0?(0,s.jsx)("div",{className:"flex items-center flex-1 justify-end font-semibold",children:"-"}):(0,s.jsxs)("div",{className:"flex items-center flex-1 space-x-1 justify-end font-semibold",children:[(0,s.jsx)(Ye,{className:e}),(0,s.jsx)("span",{children:t})]})}var Fo=["$geoip_country_code","$browser","$device_type","$os"],No=["$geoip_country_code","$device_type","$os_name"];function Io(e,t){let i=e&&Object.keys(e).length>0?e:t?.person?.properties||{},o=i.$device_type||i.$initial_device_type;return(o==="Mobile"?No:Fo).flatMap(n=>{let d=n==="$device_type"?o:i[n],g=n==="$geoip_country_code"?Zt(i):d;return{property:n,value:d,label:g}}).filter(n=>!!n.value)}function So({recordingProperties:e,loading:t,iconClassNames:i}){return(0,s.jsx)("div",{className:"flex space-x-1 ph-no-capture",children:t?(0,s.jsx)(O,{className:"w-16 h-3"}):e.map(({property:o,value:c,label:n})=>(0,s.jsx)(T,{title:n,children:(0,s.jsx)(Ut,{className:i,property:o,value:c})},o))})}function Ro(e){let t=e.startUrl?.replace(/https?:\/\//g,"").split(/[?|#]/)[0];return(0,s.jsx)("span",{className:"flex overflow-hidden text-secondary text-xs",children:(0,s.jsx)("span",{title:`First URL: ${e.startUrl}`,className:"truncate",children:t})})}function Co(){let{featureFlags:e}=(0,fe.useValues)(ve),i=e[oe.SAVED_NOT_PINNED]==="test"?"saved":"pinned";return(0,s.jsx)(T,{placement:"top-end",title:(0,s.jsxs)(s.Fragment,{children:["This recording is ",i," to this list."]}),children:(0,s.jsx)(et,{className:"text-sm text-orange shrink-0"})})}function Go(){return(0,s.jsx)(T,{title:"This recording is still ongoing - we received data within the last 5 minutes.",children:(0,s.jsx)(qe,{className:"animate-[pulse_1s_ease-out_infinite] text-primary-3000"})})}function ko(){return(0,s.jsx)(T,{title:"Indicates the recording has not been watched yet",children:(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary-3000","aria-label":"unwatched-recording-label"})})}function Wo(e,t){return t==="active_seconds"?e.active_seconds:t==="inactive_seconds"?e.inactive_seconds:e.recording_duration}function Ee({recording:e,isActive:t,onClick:i,pinned:o}){let{playlistTimestampFormat:c}=(0,fe.useValues)(J),{filters:n}=(0,fe.useValues)(I),{recordingPropertiesById:d,recordingPropertiesLoading:g}=(0,fe.useValues)(St),v=d[e.id],E=!v&&g,B=Io(v,e),C="text-secondary shrink-0";return(0,s.jsx)(de,{href:xe.replaySingle(e.id),children:(0,s.jsxs)("div",{className:(0,we.default)("SessionRecordingPreview flex overflow-hidden cursor-pointer py-0.5 px-1 text-xs",t&&"SessionRecordingPreview--active"),onClick:()=>i?.(),children:[(0,s.jsxs)("div",{className:"grow overflow-hidden space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between space-x-0.5",children:[(0,s.jsx)("div",{className:"flex overflow-hidden font-medium text-link ph-no-capture",children:(0,s.jsx)("span",{className:"truncate",children:xt(e.person)})}),c==="relative"?(0,s.jsx)(bt,{className:"overflow-hidden text-ellipsis text-xs text-secondary shrink-0",time:e.start_time,placement:"right"}):(0,s.jsx)(Vt,{startTime:e.start_time,timestampFormat:c})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center space-x-0.5",children:[(0,s.jsxs)("div",{className:"flex space-x-2 text-secondary text-sm",children:[(0,s.jsx)(So,{recordingProperties:B,iconClassNames:C,loading:E}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(T,{className:"flex items-center",title:"Clicks",children:(0,s.jsxs)("span",{className:"space-x-0.5",children:[(0,s.jsx)(je,{className:C}),(0,s.jsx)("span",{children:e.click_count})]})}),(0,s.jsx)(T,{className:"flex items-center",title:"Key presses",children:(0,s.jsxs)("span",{className:"space-x-0.5",children:[(0,s.jsx)($e,{className:C}),(0,s.jsx)("span",{children:e.keypress_count})]})})]})]}),n.order==="console_error_count"?(0,s.jsx)(xo,{iconClassNames:C,errorCount:e.console_error_count}):(0,s.jsx)(ho,{recordingDuration:Wo(e,n.order||Rt)})]}),(0,s.jsx)(Ro,{startUrl:e.start_url})]}),(0,s.jsxs)("div",{className:(0,we.default)("min-w-6 flex flex-col space-x-0.5 items-center",e.ongoing||o?"mt-1":"mt-2"),children:[e.ongoing?(0,s.jsx)(Go,{}):null,o?(0,s.jsx)(Co,{}):null,e.viewed?null:(0,s.jsx)(ko,{})]})]},e.id)})}function tn(){return(0,s.jsxs)("div",{className:"p-4 space-y-2",children:[(0,s.jsx)(O,{className:"w-1/2 h-4"}),(0,s.jsx)(O,{className:"w-1/3 h-4"})]})}u();y();f();var re=l(Z());var L=l(b()),Q={start_time:"Latest",activity_score:"Activity",console_error_count:"Errors",duration:"Total duration",active_seconds:"Activity",inactive_seconds:"Inactivity",click_count:"Clicks",keypress_count:"Keystrokes",mouse_activity_count:"Mouse activity"};function To({filters:e,setFilters:t}){return(0,L.jsx)(he,{highlightWhenActive:!1,items:[{label:Q.start_time,onClick:()=>t({order:"start_time"}),active:e.order==="start_time"},{label:Q.activity_score,onClick:()=>t({order:"activity_score"}),active:e.order==="activity_score"},{label:Q.console_error_count,onClick:()=>t({order:"console_error_count"}),active:e.order==="console_error_count"},{label:"Longest",items:[{label:Q.duration,onClick:()=>t({order:"duration"}),active:e.order==="duration"},{label:Q.active_seconds,onClick:()=>t({order:"active_seconds"}),active:e.order==="active_seconds"},{label:Q.inactive_seconds,onClick:()=>t({order:"inactive_seconds"}),active:e.order==="inactive_seconds"}]},{label:"Most active",items:[{label:Q.click_count,onClick:()=>t({order:"click_count"}),active:e.order==="click_count"},{label:Q.keypress_count,onClick:()=>t({order:"keypress_count"}),active:e.order==="keypress_count"},{label:Q.mouse_activity_count,onClick:()=>t({order:"mouse_activity_count"}),active:e.order==="mouse_activity_count"}]}],icon:(0,L.jsx)(it,{className:"text-lg"}),label:Q[e.order||"start_time"]})}function eo(){let{hideViewedRecordings:e,playlistTimestampFormat:t}=(0,re.useValues)(J),{setHideViewedRecordings:i,setPlaylistTimestampFormat:o}=(0,re.useActions)(J);return(0,L.jsxs)(Ue,{border:"top",children:[(0,L.jsx)(Lt,{active:e,title:"Hide viewed recordings",label:"Hide viewed recordings",onClick:()=>i(!e)}),(0,L.jsx)(he,{highlightWhenActive:!1,items:[{label:"UTC",onClick:()=>o("utc"),active:t==="utc"},{label:"Device",onClick:()=>o("device"),active:t==="device"},{label:"Relative",onClick:()=>o("relative"),active:t==="relative"}],icon:(0,L.jsx)(He,{}),label:It[t]})]})}function to({filters:e,setFilters:t}){let{autoplayDirection:i,playbackMode:o}=(0,re.useValues)(J),{setAutoplayDirection:c,setPlaybackMode:n}=(0,re.useActions)(J);return(0,L.jsxs)(Ue,{border:"none",className:"justify-between",children:[e&&t?(0,L.jsxs)("span",{className:"text-xs font-normal inline-flex items-center ml-2",children:["Sort by: ",(0,L.jsx)(To,{filters:e,setFilters:t})]}):null,(0,L.jsx)(he,{items:[{label:"Autoplay",items:[{label:"Off",onClick:()=>c(null),active:!i},{label:"Newer recordings",onClick:()=>c("newer"),active:i==="newer"},{label:"Older recordings",onClick:()=>c("older"),active:i==="older"}]},{label:"Playback mode",items:[{label:"Recordings",onClick:()=>n("recording"),active:o==="recording"},{label:"Waterfall",onClick:()=>n("waterfall"),active:o==="waterfall"}]}],icon:(0,L.jsx)(Oe,{className:"rotate-90"})})]})}u();y();f();var le=l(Z());var x=l(b()),oo=()=>{let{hideViewedRecordings:e}=(0,le.useValues)(J),{setHideViewedRecordings:t}=(0,le.useActions)(J),{otherRecordings:i}=(0,le.useValues)(I),{setShowSettings:o}=(0,le.useActions)(I);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h3",{className:"title align-center text-secondary mb-0",children:"No matching recordings"}),(0,x.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,x.jsx)("p",{className:"text-secondary description m-0",children:"Recordings may not be found for a variety of reasons including:"}),(0,x.jsxs)("ul",{className:"space-y-1",children:[(0,x.jsx)("h5",{children:"All recording sources:"}),i.length>0&&e&&(0,x.jsxs)("li",{children:["Viewed recordings hidden."," ",(0,x.jsx)(D,{onClick:()=>{o(!0),t(!1)},children:"Toggle option"})]}),(0,x.jsx)("li",{children:(0,x.jsx)(D,{to:"https://posthog.com/docs/session-replay/data-retention",target:"_blank",children:"They are outside the retention period"})}),(0,x.jsx)(ct,{dashed:!0}),(0,x.jsx)("h5",{children:"Web recordings"}),(0,x.jsx)("li",{children:(0,x.jsx)(D,{to:"https://posthog.com/docs/session-replay/troubleshooting#4-adtracking-blockers",target:"_blank",children:"An ad blocker prevented recording"})}),(0,x.jsx)("li",{children:(0,x.jsx)(D,{to:"https://posthog.com/docs/session-replay/troubleshooting#1-authorized-domains-for-recordings",target:"_blank",children:"Your domain is not authorized"})})]})]})]})};var a=l(b());function _n({showContent:e=!0,...t}){let i={...t,autoPlay:t.autoPlay??!0},o=I(i),{filters:c,pinnedRecordings:n,matchingEventsMatchType:d,sessionRecordingsResponseLoading:g,otherRecordings:v,activeSessionRecordingId:E,hasNext:B,allowFlagsFilters:C,allowHogQLFilters:j,totalFiltersCount:ae}=(0,_.useValues)(o),{maybeLoadSessionRecordings:F,setSelectedRecordingId:V,setFilters:ee,resetFilters:ye}=(0,_.useActions)(o),{featureFlags:Re}=(0,_.useValues)(ve),Ce=Re[oe.SAVED_NOT_PINNED]==="test"?"Saved":"Pinned",ce=Qe(),te=[];return n.length&&te.push({key:"pinned",title:(0,a.jsxs)("div",{className:"flex flex-row space-x-1 items-center",children:[(0,a.jsxs)("span",{children:[Ce," recordings"]}),(0,a.jsx)(me.Number,{count:n.length,status:"muted",size:"small"})]}),items:n,render:({item:S,isActive:P})=>(0,a.jsx)(Ee,{recording:S,isActive:P,pinned:!0}),initiallyOpen:!0}),te.push({key:"other",title:(0,a.jsxs)("div",{className:"flex flex-row space-x-1 items-center",children:[(0,a.jsx)("span",{children:"Results"}),(0,a.jsx)(me.Number,{count:v.length,status:"muted",size:"small"})]}),items:v,initiallyOpen:!n.length,render:({item:S,isActive:P})=>(0,a.jsx)(Ee,{recording:S,isActive:P,pinned:!1}),footer:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"h-10 flex items-center justify-center gap-2 text-secondary",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(be,{textColored:!0})," Loading older recordings"]}):B?(0,a.jsx)(N,{onClick:()=>F("older"),children:"Load more"}):"No more results"})})}),(0,a.jsx)(_.BindLogic,{logic:I,props:i,children:(0,a.jsx)("div",{className:"h-full space-y-2",children:(0,a.jsx)(zt,{"data-attr":"session-recordings-playlist",notebooksHref:xe.replay("home",c),embedded:!!ce,sections:te,headerActions:(0,a.jsx)(to,{filters:c,setFilters:ee}),footerActions:(0,a.jsx)(eo,{}),filterActions:ce?null:(0,a.jsx)($t,{resetFilters:ye,filters:c,setFilters:ee,totalFiltersCount:ae,className:"border-b",allowReplayHogQLFilters:j,allowReplayFlagsFilters:C}),loading:g,onScrollListEdge:S=>{F(S==="top"?"newer":"older")},listEmptyState:(0,a.jsx)(Lo,{}),onSelect:S=>V(S.id),activeItemId:E,content:({activeItem:S})=>e&&S?(0,a.jsx)(Bt,{playerKey:t.logicKey??"playlist",sessionRecordingId:S.id,matchingEventsMatchType:d,playlistLogic:o,noBorder:!0,pinned:!!n.find(P=>P.id===S.id),setPinned:t.onPinnedChange?P=>{S.id&&t.onPinnedChange?.(S,P)}:void 0}):(0,a.jsx)("div",{className:"mt-20",children:(0,a.jsx)(Et,{title:"No recording selected",description:"Please select a recording from the list on the left",buttonText:"Learn more about recordings",buttonTo:"https://posthog.com/docs/user-guides/recordings"})})})})})}var Lo=()=>{let{filters:e,sessionRecordingsAPIErrored:t,unusableEventsInFilter:i}=(0,_.useValues)(I),{setFilters:o}=(0,_.useActions)(I);return(0,a.jsx)("div",{className:"p-3 text-sm text-secondary",children:t?(0,a.jsx)(Le,{type:"error",children:"Error while trying to load recordings."}):i.length?(0,a.jsx)(Vo,{unusableEventsInFilter:i}):(0,a.jsx)("div",{className:"flex flex-col items-center space-y-2",children:e.date_from===Ct.date_from?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"No matching recordings found"}),(0,a.jsx)(N,{type:"secondary","data-attr":"expand-replay-listing-from-default-seven-days-to-twenty-one",onClick:()=>o({date_from:"-30d"}),children:"Search over the last 30 days"})]}):(0,a.jsx)(oo,{})})})},Vo=e=>(0,a.jsxs)(Le,{type:"warning",children:[(0,a.jsx)("p",{children:"Cannot use these events to filter for session recordings:"}),(0,a.jsx)("li",{className:"my-1",children:e.unusableEventsInFilter.map(t=>(0,a.jsxs)("span",{children:['"',t,'"']},t))}),(0,a.jsxs)("p",{children:["Events have to have a ",(0,a.jsx)(yt,{value:"$session_id"})," to be used to filter recordings. This is added automatically by"," ",(0,a.jsx)(D,{to:"https://posthog.com/docs/libraries/js",target:"_blank",children:"the Web SDK"}),","," ",(0,a.jsx)(D,{to:"https://posthog.com/docs/libraries",target:"_blank",children:"and the Mobile SDKs (Android, iOS, React Native and Flutter)"})]})]});export{$t as a,Ee as b,tn as c,_n as d};
//# sourceMappingURL=/static/chunk-NUJQT2B6.js.map
