import{e as Z,g as K,j as V}from"/static/chunk-SJXEOBQC.js";Z();V();K();function q(f){throw new Error('Could not dynamically require "'+f+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var X={};X.assign=function(b){for(var d,h=1;h<arguments.length;h++){d=Object(arguments[h]);for(var F in d)Object.prototype.hasOwnProperty.call(d,F)&&(b[F]=d[F])}return b};function $(f,b){var d={};return b.forEach(function(h){Object.prototype.hasOwnProperty.call(f,h)&&(d[h]=f[h])}),d}function ot(f){return $(f,["alpha","unsharpAmount","unsharpRadius","unsharpThreshold","cancelToken"])}X.pick=$;X.pick_pica_resize_options=ot;var tt={exports:{}};(function(f,b){(function(d){f.exports=d()})(function(){return function(){function d(h,F,g){function v(r,n){if(!F[r]){if(!h[r]){var a=typeof q=="function"&&q;if(!n&&a)return a(r,!0);if(e)return e(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var u=F[r]={exports:{}};h[r][0].call(u.exports,function(A){var c=h[r][1][A];return v(c||A)},u,u.exports,d,h,F,g)}return F[r].exports}for(var e=typeof q=="function"&&q,t=0;t<g.length;t++)v(g[t]);return v}return d}()({1:[function(d,h,F){var g=d("multimath"),v=d("./mm_unsharp_mask"),e=d("./mm_resize");function t(r){var n=r||[],a={js:n.indexOf("js")>=0,wasm:n.indexOf("wasm")>=0};g.call(this,a),this.features={js:a.js,wasm:a.wasm&&this.has_wasm()},this.use(v),this.use(e)}t.prototype=Object.create(g.prototype),t.prototype.constructor=t,t.prototype.resizeAndUnsharp=function(n,a){var i=this.resize(n,a);return n.unsharpAmount&&this.unsharp_mask(i,n.toWidth,n.toHeight,n.unsharpAmount,n.unsharpRadius,n.unsharpThreshold),i},h.exports=t},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(d,h,F){function g(a){return a<0?0:a>255?255:a}function v(a){return a>=0?a:0}function e(a,i,u,A,c,s){var p,_,I,m,x,D,R,Q,y,M,C,P=0,U=0;for(y=0;y<A;y++){for(x=0,M=0;M<c;M++){for(D=s[x++],R=s[x++],Q=P+D*4|0,p=_=I=m=0;R>0;R--)C=s[x++],m=m+C*a[Q+3]|0,I=I+C*a[Q+2]|0,_=_+C*a[Q+1]|0,p=p+C*a[Q]|0,Q=Q+4|0;i[U+3]=v(m>>7),i[U+2]=v(I>>7),i[U+1]=v(_>>7),i[U]=v(p>>7),U=U+A*4|0}U=(y+1)*4|0,P=(y+1)*u*4|0}}function t(a,i,u,A,c,s){var p,_,I,m,x,D,R,Q,y,M,C,P=0,U=0;for(y=0;y<A;y++){for(x=0,M=0;M<c;M++){for(D=s[x++],R=s[x++],Q=P+D*4|0,p=_=I=m=0;R>0;R--)C=s[x++],m=m+C*a[Q+3]|0,I=I+C*a[Q+2]|0,_=_+C*a[Q+1]|0,p=p+C*a[Q]|0,Q=Q+4|0;p>>=7,_>>=7,I>>=7,m>>=7,i[U+3]=g(m+8192>>14),i[U+2]=g(I+8192>>14),i[U+1]=g(_+8192>>14),i[U]=g(p+8192>>14),U=U+A*4|0}U=(y+1)*4|0,P=(y+1)*u*4|0}}function r(a,i,u,A,c,s){var p,_,I,m,x,D,R,Q,y,M,C,P,U=0,H=0;for(M=0;M<A;M++){for(D=0,C=0;C<c;C++){for(R=s[D++],Q=s[D++],y=U+R*4|0,p=_=I=m=0;Q>0;Q--)P=s[D++],x=a[y+3],m=m+P*x|0,I=I+P*a[y+2]*x|0,_=_+P*a[y+1]*x|0,p=p+P*a[y]*x|0,y=y+4|0;I=I/255|0,_=_/255|0,p=p/255|0,i[H+3]=v(m>>7),i[H+2]=v(I>>7),i[H+1]=v(_>>7),i[H]=v(p>>7),H=H+A*4|0}H=(M+1)*4|0,U=(M+1)*u*4|0}}function n(a,i,u,A,c,s){var p,_,I,m,x,D,R,Q,y,M,C,P=0,U=0;for(y=0;y<A;y++){for(x=0,M=0;M<c;M++){for(D=s[x++],R=s[x++],Q=P+D*4|0,p=_=I=m=0;R>0;R--)C=s[x++],m=m+C*a[Q+3]|0,I=I+C*a[Q+2]|0,_=_+C*a[Q+1]|0,p=p+C*a[Q]|0,Q=Q+4|0;p>>=7,_>>=7,I>>=7,m>>=7,m=g(m+8192>>14),m>0&&(p=p*255/m|0,_=_*255/m|0,I=I*255/m|0),i[U+3]=m,i[U+2]=g(I+8192>>14),i[U+1]=g(_+8192>>14),i[U]=g(p+8192>>14),U=U+A*4|0}U=(y+1)*4|0,P=(y+1)*u*4|0}}h.exports={convolveHor:e,convolveVert:t,convolveHorWithPre:r,convolveVertWithPre:n}},{}],3:[function(d,h,F){h.exports="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"},{}],4:[function(d,h,F){h.exports={name:"resize",fn:d("./resize"),wasm_fn:d("./resize_wasm"),wasm_src:d("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(d,h,F){var g=d("./resize_filter_gen"),v=d("./convolve"),e=v.convolveHor,t=v.convolveVert,r=v.convolveHorWithPre,n=v.convolveVertWithPre;function a(u,A,c){for(var s=3,p=A*c*4|0;s<p;){if(u[s]!==255)return!0;s=s+4|0}return!1}function i(u,A,c){for(var s=3,p=A*c*4|0;s<p;)u[s]=255,s=s+4|0}h.exports=function(A){var c=A.src,s=A.width,p=A.height,_=A.toWidth,I=A.toHeight,m=A.scaleX||A.toWidth/A.width,x=A.scaleY||A.toHeight/A.height,D=A.offsetX||0,R=A.offsetY||0,Q=A.dest||new Uint8Array(_*I*4),y=typeof A.filter>"u"?"mks2013":A.filter,M=g(y,s,_,m,D),C=g(y,p,I,x,R),P=new Uint16Array(_*p*4);return a(c,s,p)?(r(c,P,s,p,_,M),n(P,Q,p,_,I,C)):(e(c,P,s,p,_,M),t(P,Q,p,_,I,C),i(Q,_,I)),Q}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(d,h,F){var g=d("./resize_filter_info"),v=14;function e(t){return Math.round(t*((1<<v)-1))}h.exports=function(r,n,a,i,u){var A=g.filter[r].fn,c=1/i,s=Math.min(1,i),p=g.filter[r].win/s,_,I,m,x,D,R,Q,y,M,C,P,U,H,S,o,E,l,B=Math.floor((p+1)*2),w=new Int16Array((B+2)*a),O=0,k=!w.subarray||!w.set;for(_=0;_<a;_++){for(I=(_+.5)*c+u,m=Math.max(0,Math.floor(I-p)),x=Math.min(n-1,Math.ceil(I+p)),D=x-m+1,R=new Float32Array(D),Q=new Int16Array(D),y=0,M=m,C=0;M<=x;M++,C++)P=A((M+.5-I)*s),y+=P,R[C]=P;for(U=0,C=0;C<R.length;C++)H=R[C]/y,U+=H,Q[C]=e(H);for(Q[a>>1]+=e(1-U),S=0;S<Q.length&&Q[S]===0;)S++;if(S<Q.length){for(o=Q.length-1;o>0&&Q[o]===0;)o--;if(E=m+S,l=o-S+1,w[O++]=E,w[O++]=l,!k)w.set(Q.subarray(S,o+1),O),O+=l;else for(C=S;C<=o;C++)w[O++]=Q[C]}else w[O++]=0,w[O++]=0}return w}},{"./resize_filter_info":7}],7:[function(d,h,F){var g={box:{win:.5,fn:function(e){return e<0&&(e=-e),e<.5?1:0}},hamming:{win:1,fn:function(e){if(e<0&&(e=-e),e>=1)return 0;if(e<11920929e-14)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},lanczos2:{win:2,fn:function(e){if(e<0&&(e=-e),e>=2)return 0;if(e<11920929e-14)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},lanczos3:{win:3,fn:function(e){if(e<0&&(e=-e),e>=3)return 0;if(e<11920929e-14)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}},mks2013:{win:2.5,fn:function(e){return e<0&&(e=-e),e>=2.5?0:e>=1.5?-.125*(e-2.5)*(e-2.5):e>=.5?.25*(4*e*e-11*e+7):1.0625-1.75*e*e}}};h.exports={filter:g,f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(d,h,F){var g=d("./resize_filter_gen");function v(a,i,u){for(var A=3,c=i*u*4|0;A<c;){if(a[A]!==255)return!0;A=A+4|0}return!1}function e(a,i,u){for(var A=3,c=i*u*4|0;A<c;)a[A]=255,A=A+4|0}function t(a){return new Uint8Array(a.buffer,0,a.byteLength)}var r=!0;try{r=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function n(a,i,u){if(r){i.set(t(a),u);return}for(var A=u,c=0;c<a.length;c++){var s=a[c];i[A++]=s&255,i[A++]=s>>8&255}}h.exports=function(i){var u=i.src,A=i.width,c=i.height,s=i.toWidth,p=i.toHeight,_=i.scaleX||i.toWidth/i.width,I=i.scaleY||i.toHeight/i.height,m=i.offsetX||0,x=i.offsetY||0,D=i.dest||new Uint8Array(s*p*4),R=typeof i.filter>"u"?"mks2013":i.filter,Q=g(R,A,s,_,m),y=g(R,c,p,I,x),M=0,C=Math.max(u.byteLength,D.byteLength),P=this.__align(M+C),U=c*s*4*2,H=this.__align(P+U),S=this.__align(H+Q.byteLength),o=S+y.byteLength,E=this.__instance("resize",o),l=new Uint8Array(this.__memory.buffer),B=new Uint32Array(this.__memory.buffer),w=new Uint32Array(u.buffer);B.set(w),n(Q,l,H),n(y,l,S);var O=E.exports.convolveHV||E.exports._convolveHV;v(u,A,c)?O(H,S,P,A,c,s,p,1):(O(H,S,P,A,c,s,p,0),e(D,s,p));var k=new Uint32Array(D.buffer);return k.set(new Uint32Array(this.__memory.buffer,0,p*s)),D}},{"./resize_filter_gen":6}],9:[function(d,h,F){h.exports={name:"unsharp_mask",fn:d("./unsharp_mask"),wasm_fn:d("./unsharp_mask_wasm"),wasm_src:d("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(d,h,F){var g=d("glur/mono16");function v(e,t,r){for(var n=t*r,a=new Uint16Array(n),i,u,A,c,s=0;s<n;s++)i=e[4*s],u=e[4*s+1],A=e[4*s+2],c=i>=u&&i>=A?i:u>=A&&u>=i?u:A,a[s]=c<<8;return a}h.exports=function(t,r,n,a,i,u){var A,c,s,p,_;if(!(a===0||i<.5)){i>2&&(i=2);var I=v(t,r,n),m=new Uint16Array(I);g(m,r,n,i);for(var x=a/100*4096+.5|0,D=u<<8,R=r*n,Q=0;Q<R;Q++)A=I[Q],p=A-m[Q],Math.abs(p)>=D&&(c=A+(x*p+2048>>12),c=c>65280?65280:c,c=c<0?0:c,A=A!==0?A:1,s=(c<<12)/A|0,_=Q*4,t[_]=t[_]*s+2048>>12,t[_+1]=t[_+1]*s+2048>>12,t[_+2]=t[_+2]*s+2048>>12)}}},{"glur/mono16":18}],11:[function(d,h,F){h.exports=function(v,e,t,r,n,a){if(!(r===0||n<.5)){n>2&&(n=2);var i=e*t,u=i*4,A=i*2,c=i*2,s=Math.max(e,t)*4,p=8*4,_=0,I=u,m=I+A,x=m+c,D=x+c,R=D+s,Q=this.__instance("unsharp_mask",u+A+c*2+s+p,{exp:Math.exp}),y=new Uint32Array(v.buffer),M=new Uint32Array(this.__memory.buffer);M.set(y);var C=Q.exports.hsv_v16||Q.exports._hsv_v16;C(_,I,e,t),C=Q.exports.blurMono16||Q.exports._blurMono16,C(I,m,x,D,R,e,t,n),C=Q.exports.unsharp||Q.exports._unsharp,C(_,_,I,m,e,t,r,a),y.set(new Uint32Array(this.__memory.buffer,0,i))}}},{}],12:[function(d,h,F){h.exports="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"},{}],13:[function(d,h,F){var g=100;function v(e,t){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=t||2e3}v.prototype.acquire=function(){var e=this,t;return this.available.length!==0?t=this.available.pop():(t=this.create(),t.id=this.lastId++,t.release=function(){return e.release(t)}),this.acquired[t.id]=t,t},v.prototype.release=function(e){var t=this;delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return t.gc()},g))},v.prototype.gc=function(){var e=this,t=Date.now();this.available=this.available.filter(function(r){return t-r.lastUsed>e.idle?(r.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return e.gc()},g):this.timeoutId=0},h.exports=v},{}],14:[function(d,h,F){var g=2;h.exports=function(e,t,r,n,a,i){var u=r/e,A=n/t,c=(2*i+g+1)/a;if(c>.5)return[[r,n]];var s=Math.ceil(Math.log(Math.min(u,A))/Math.log(c));if(s<=1)return[[r,n]];for(var p=[],_=0;_<s;_++){var I=Math.round(Math.pow(Math.pow(e,s-_-1)*Math.pow(r,_+1),1/s)),m=Math.round(Math.pow(Math.pow(t,s-_-1)*Math.pow(n,_+1),1/s));p.push([I,m])}return p}},{}],15:[function(d,h,F){var g=1e-5;function v(t){var r=Math.round(t);return Math.abs(t-r)<g?r:Math.floor(t)}function e(t){var r=Math.round(t);return Math.abs(t-r)<g?r:Math.ceil(t)}h.exports=function(r){var n=r.toWidth/r.width,a=r.toHeight/r.height,i=v(r.srcTileSize*n)-2*r.destTileBorder,u=v(r.srcTileSize*a)-2*r.destTileBorder;if(i<1||u<1)throw new Error("Internal error in pica: target tile width/height is too small.");var A,c,s,p,_,I,m=[],x;for(p=0;p<r.toHeight;p+=u)for(s=0;s<r.toWidth;s+=i)A=s-r.destTileBorder,A<0&&(A=0),_=s+i+r.destTileBorder-A,A+_>=r.toWidth&&(_=r.toWidth-A),c=p-r.destTileBorder,c<0&&(c=0),I=p+u+r.destTileBorder-c,c+I>=r.toHeight&&(I=r.toHeight-c),x={toX:A,toY:c,toWidth:_,toHeight:I,toInnerX:s,toInnerY:p,toInnerWidth:i,toInnerHeight:u,offsetX:A/n-v(A/n),offsetY:c/a-v(c/a),scaleX:n,scaleY:a,x:v(A/n),y:v(c/a),width:e(_/n),height:e(I/a)},m.push(x);return m}},{}],16:[function(d,h,F){function g(v){return Object.prototype.toString.call(v)}h.exports.isCanvas=function(e){var t=g(e);return t==="[object HTMLCanvasElement]"||t==="[object OffscreenCanvas]"||t==="[object Canvas]"},h.exports.isImage=function(e){return g(e)==="[object HTMLImageElement]"},h.exports.isImageBitmap=function(e){return g(e)==="[object ImageBitmap]"},h.exports.limiter=function(e){var t=0,r=[];function n(){t<e&&r.length&&(t++,r.shift()())}return function(i){return new Promise(function(u,A){r.push(function(){i().then(function(c){u(c),t--,n()},function(c){A(c),t--,n()})}),n()})}},h.exports.cib_quality_name=function(e){switch(e){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},h.exports.cib_support=function(e){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var t=e(100,100);return createImageBitmap(t,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(r){var n=r.width===10;return r.close(),t=null,n})}).catch(function(){return!1})},h.exports.worker_offscreen_canvas_support=function(){return new Promise(function(e,t){if(typeof OffscreenCanvas>"u"){e(!1);return}function r(i){if(typeof createImageBitmap>"u"){i.postMessage(!1);return}Promise.resolve().then(function(){var u=new OffscreenCanvas(10,10),A=u.getContext("2d");return A.rect(0,0,1,1),createImageBitmap(u,0,0,1,1)}).then(function(){return i.postMessage(!0)},function(){return i.postMessage(!1)})}var n=btoa("(".concat(r.toString(),")(self);")),a=new Worker("data:text/javascript;base64,".concat(n));a.onmessage=function(i){return e(i.data)},a.onerror=t}).then(function(e){return e},function(){return!1})},h.exports.can_use_canvas=function(e){var t=!1;try{var r=e(2,1),n=r.getContext("2d"),a=n.createImageData(2,1);a.data[0]=12,a.data[1]=23,a.data[2]=34,a.data[3]=255,a.data[4]=45,a.data[5]=56,a.data[6]=67,a.data[7]=255,n.putImageData(a,0,0),a=null,a=n.getImageData(0,0,2,1),a.data[0]===12&&a.data[1]===23&&a.data[2]===34&&a.data[3]===255&&a.data[4]===45&&a.data[5]===56&&a.data[6]===67&&a.data[7]===255&&(t=!0)}catch{}return t},h.exports.cib_can_use_region=function(){return new Promise(function(e){if(typeof createImageBitmap>"u"){e(!1);return}var t=new Image;t.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",t.onload=function(){createImageBitmap(t,0,0,t.width,t.height).then(function(r){r.width===t.width&&r.height===t.height?e(!0):e(!1)},function(){return e(!1)})},t.onerror=function(){return e(!1)}})}},{}],17:[function(d,h,F){h.exports=function(){var g=d("./mathlib"),v;onmessage=function(t){var r=t.data.opts;if(!r.src&&r.srcBitmap){var n=new OffscreenCanvas(r.width,r.height),a=n.getContext("2d");a.drawImage(r.srcBitmap,0,0),r.src=a.getImageData(0,0,r.width,r.height).data,n.width=n.height=0,n=null,r.srcBitmap.close(),r.srcBitmap=null}v||(v=new g(t.data.features));var i=v.resizeAndUnsharp(r);postMessage({data:i},[i.buffer])}}},{"./mathlib":1}],18:[function(d,h,F){var g,v,e,t,r,n,a,i;function u(s){s<.5&&(s=.5);var p=Math.exp(.726*.726)/s,_=Math.exp(-p),I=Math.exp(-2*p),m=(1-_)*(1-_)/(1+2*p*_-I);return g=m,v=m*(p-1)*_,e=m*(p+1)*_,t=-m*I,r=2*_,n=-I,a=(g+v)/(1-r-n),i=(e+t)/(1-r-n),new Float32Array([g,v,e,t,r,n,a,i])}function A(s,p,_,I,m,x){var D,R,Q,y,M,C,P,U,H,S,o,E,l,B;for(H=0;H<x;H++){for(C=H*m,P=H,U=0,D=s[C],M=D*I[6],y=M,o=I[0],E=I[1],l=I[4],B=I[5],S=0;S<m;S++)R=s[C],Q=R*o+D*E+y*l+M*B,M=y,y=Q,D=R,_[U]=y,U++,C++;for(C--,U--,P+=x*(m-1),D=s[C],M=D*I[7],y=M,R=D,o=I[2],E=I[3],S=m-1;S>=0;S--)Q=R*o+D*E+y*l+M*B,M=y,y=Q,D=R,R=s[C],p[P]=_[U]+y,C--,U--,P-=x}}function c(s,p,_,I){if(I){var m=new Uint16Array(s.length),x=new Float32Array(Math.max(p,_)),D=u(I);A(s,m,x,D,p,_),A(m,s,x,D,_,p)}}h.exports=c},{}],19:[function(d,h,F){var g=d("object-assign"),v=d("./lib/base64decode"),e=d("./lib/wa_detect"),t={js:!0,wasm:!0};function r(n){if(!(this instanceof r))return new r(n);var a=g({},t,n||{});if(this.options=a,this.__cache={},this.__init_promise=null,this.__modules=a.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}r.prototype.has_wasm=e,r.prototype.use=function(n){return this.__modules[n.name]=n,this.options.wasm&&this.has_wasm()&&n.wasm_fn?this[n.name]=n.wasm_fn:this[n.name]=n.fn,this},r.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var n=this;return this.__init_promise=Promise.all(Object.keys(n.__modules).map(function(a){var i=n.__modules[a];return!n.options.wasm||!n.has_wasm()||!i.wasm_fn||n.__wasm[a]?null:WebAssembly.compile(n.__base64decode(i.wasm_src)).then(function(u){n.__wasm[a]=u})})).then(function(){return n}),this.__init_promise},r.prototype.__base64decode=v,r.prototype.__reallocate=function(a){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(a/(64*1024))}),this.__memory;var i=this.__memory.buffer.byteLength;return i<a&&this.__memory.grow(Math.ceil((a-i)/(64*1024))),this.__memory},r.prototype.__instance=function(a,i,u){if(i&&this.__reallocate(i),!this.__wasm[a]){var A=this.__modules[a];this.__wasm[a]=new WebAssembly.Module(this.__base64decode(A.wasm_src))}if(!this.__cache[a]){var c={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[a]=new WebAssembly.Instance(this.__wasm[a],{env:g(c,u||{})})}return this.__cache[a]},r.prototype.__align=function(a,i){i=i||8;var u=a%i;return a+(u?i-u:0)},h.exports=r},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(d,h,F){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";h.exports=function(e){for(var t=e.replace(/[\r\n=]/g,""),r=t.length,n=new Uint8Array(r*3>>2),a=0,i=0,u=0;u<r;u++)u%4===0&&u&&(n[i++]=a>>16&255,n[i++]=a>>8&255,n[i++]=a&255),a=a<<6|g.indexOf(t.charAt(u));var A=r%4*6;return A===0?(n[i++]=a>>16&255,n[i++]=a>>8&255,n[i++]=a&255):A===18?(n[i++]=a>>10&255,n[i++]=a>>2&255):A===12&&(n[i++]=a>>4&255),n}},{}],21:[function(d,h,F){var g;h.exports=function(){if(typeof g<"u"||(g=!1,typeof WebAssembly>"u"))return g;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e),r=new WebAssembly.Instance(t,{});return r.exports.test(4)!==0&&(g=!0),g}catch{}return g}},{}],22:[function(d,h,F){var g=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;function t(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function r(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var a={},i=0;i<10;i++)a["_"+String.fromCharCode(i)]=i;var u=Object.getOwnPropertyNames(a).map(function(c){return a[c]});if(u.join("")!=="0123456789")return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach(function(c){A[c]=c}),Object.keys(Object.assign({},A)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}h.exports=r()?Object.assign:function(n,a){for(var i,u=t(n),A,c=1;c<arguments.length;c++){i=Object(arguments[c]);for(var s in i)v.call(i,s)&&(u[s]=i[s]);if(g){A=g(i);for(var p=0;p<A.length;p++)e.call(i,A[p])&&(u[A[p]]=i[A[p]])}}return u}},{}],23:[function(d,h,F){var g=arguments[3],v=arguments[4],e=arguments[5],t=JSON.stringify;h.exports=function(r,n){for(var a,i=Object.keys(e),u=0,A=i.length;u<A;u++){var c=i[u],s=e[c].exports;if(s===r||s&&s.default===r){a=c;break}}if(!a){a=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var p={},u=0,A=i.length;u<A;u++){var c=i[u];p[c]=c}v[a]=["function(require,module,exports){"+r+"(self); }",p]}var _=Math.floor(Math.pow(16,8)*Math.random()).toString(16),I={};I[a]=a,v[_]=["function(require,module,exports){var f = require("+t(a)+");(f.default ? f.default : f)(self);}",I];var m={};x(_);function x(C){m[C]=!0;for(var P in v[C][1]){var U=v[C][1][P];m[U]||x(U)}}var D="("+g+")({"+Object.keys(m).map(function(C){return t(C)+":["+v[C][0]+","+t(v[C][1])+"]"}).join(",")+"},{},["+t(_)+"])",R=window.URL||window.webkitURL||window.mozURL||window.msURL,Q=new Blob([D],{type:"text/javascript"});if(n&&n.bare)return Q;var y=R.createObjectURL(Q),M=new Worker(y);return M.objectURL=y,M}},{}],"/index.js":[function(d,h,F){function g(o,E){return n(o)||r(o,E)||e(o,E)||v()}function v(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(o,E){if(o){if(typeof o=="string")return t(o,E);var l=Object.prototype.toString.call(o).slice(8,-1);if(l==="Object"&&o.constructor&&(l=o.constructor.name),l==="Map"||l==="Set")return Array.from(o);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return t(o,E)}}function t(o,E){(E==null||E>o.length)&&(E=o.length);for(var l=0,B=new Array(E);l<E;l++)B[l]=o[l];return B}function r(o,E){var l=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(l!=null){var B=[],w=!0,O=!1,k,G;try{for(l=l.call(o);!(w=(k=l.next()).done)&&(B.push(k.value),!(E&&B.length===E));w=!0);}catch(L){O=!0,G=L}finally{try{!w&&l.return!=null&&l.return()}finally{if(O)throw G}}return B}}function n(o){if(Array.isArray(o))return o}var a=d("object-assign"),i=d("webworkify"),u=d("./lib/mathlib"),A=d("./lib/pool"),c=d("./lib/utils"),s=d("./lib/worker"),p=d("./lib/stepper"),_=d("./lib/tiler"),I=d("./lib/mm_resize/resize_filter_info"),m={},x=!1;try{typeof navigator<"u"&&navigator.userAgent&&(x=navigator.userAgent.indexOf("Safari")>=0)}catch{}var D=1;typeof navigator<"u"&&(D=Math.min(navigator.hardwareConcurrency||1,4));var R={tile:1024,concurrency:D,features:["js","wasm","ww"],idle:2e3,createCanvas:function(E,l){var B=document.createElement("canvas");return B.width=E,B.height=l,B}},Q={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},y=!1,M=!1,C=!1,P=!1,U=!1;function H(){return{value:i(s),destroy:function(){if(this.value.terminate(),typeof window<"u"){var E=window.URL||window.webkitURL||window.mozURL||window.msURL;E&&E.revokeObjectURL&&this.value.objectURL&&E.revokeObjectURL(this.value.objectURL)}}}}function S(o){if(!(this instanceof S))return new S(o);this.options=a({},R,o||{});var E="lk_".concat(this.options.concurrency);this.__limit=m[E]||c.limiter(this.options.concurrency),m[E]||(m[E]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}S.prototype.init=function(){var o=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),y=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?M=!0:this.debug("ImageBitmap does not support .close(), disabled"));var E=this.options.features.slice();if(E.indexOf("all")>=0&&(E=["cib","wasm","js","ww"]),this.__requested_features=E,this.__mathlib=new u(E),E.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var l=d("webworkify")(function(){});l.terminate(),this.features.ww=!0;var B="wp_".concat(JSON.stringify(this.options));m[B]?this.__workersPool=m[B]:(this.__workersPool=new A(H,this.options.idle),m[B]=this.__workersPool)}catch{}var w=this.__mathlib.init().then(function(L){a(o.features,L.features)}),O;M?O=c.cib_support(this.options.createCanvas).then(function(L){if(o.features.cib&&E.indexOf("cib")<0){o.debug("createImageBitmap() resize supported, but disabled by config");return}E.indexOf("cib")>=0&&(o.features.cib=L)}):O=Promise.resolve(!1),C=c.can_use_canvas(this.options.createCanvas);var k;M&&y&&E.indexOf("ww")!==-1?k=c.worker_offscreen_canvas_support():k=Promise.resolve(!1),k=k.then(function(L){P=L});var G=c.cib_can_use_region().then(function(L){U=L});return this.__initPromise=Promise.all([w,O,k,G]).then(function(){return o}),this.__initPromise},S.prototype.__invokeResize=function(o,E){var l=this;return E.__mathCache=E.__mathCache||{},Promise.resolve().then(function(){return l.features.ww?new Promise(function(B,w){var O=l.__workersPool.acquire();E.cancelToken&&E.cancelToken.catch(function(G){return w(G)}),O.value.onmessage=function(G){O.release(),G.data.err?w(G.data.err):B(G.data)};var k=[];o.src&&k.push(o.src.buffer),o.srcBitmap&&k.push(o.srcBitmap),O.value.postMessage({opts:o,features:l.__requested_features,preload:{wasm_nodule:l.__mathlib.__}},k)}):{data:l.__mathlib.resizeAndUnsharp(o,E.__mathCache)}})},S.prototype.__extractTileData=function(o,E,l,B,w){if(this.features.ww&&P&&(c.isCanvas(E)||U))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(B.srcImageBitmap||E,o.x,o.y,o.width,o.height).then(function(G){return w.srcBitmap=G,w});if(c.isCanvas(E))return B.srcCtx||(B.srcCtx=E.getContext("2d")),this.debug("Get tile pixel data"),w.src=B.srcCtx.getImageData(o.x,o.y,o.width,o.height).data,w;this.debug("Draw tile imageBitmap/image to temporary canvas");var O=this.options.createCanvas(o.width,o.height),k=O.getContext("2d");return k.globalCompositeOperation="copy",k.drawImage(B.srcImageBitmap||E,o.x,o.y,o.width,o.height,0,0,o.width,o.height),this.debug("Get tile pixel data"),w.src=k.getImageData(0,0,o.width,o.height).data,O.width=O.height=0,w},S.prototype.__landTileData=function(o,E,l){var B;if(this.debug("Convert raw rgba tile result to ImageData"),E.bitmap)return l.toCtx.drawImage(E.bitmap,o.toX,o.toY),null;if(y)B=new ImageData(new Uint8ClampedArray(E.data),o.toWidth,o.toHeight);else if(B=l.toCtx.createImageData(o.toWidth,o.toHeight),B.data.set)B.data.set(E.data);else for(var w=B.data.length-1;w>=0;w--)B.data[w]=E.data[w];return this.debug("Draw tile"),x?l.toCtx.putImageData(B,o.toX,o.toY,o.toInnerX-o.toX,o.toInnerY-o.toY,o.toInnerWidth+1e-5,o.toInnerHeight+1e-5):l.toCtx.putImageData(B,o.toX,o.toY,o.toInnerX-o.toX,o.toInnerY-o.toY,o.toInnerWidth,o.toInnerHeight),null},S.prototype.__tileAndResize=function(o,E,l){var B=this,w={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},O=function(G){return B.__limit(function(){if(l.canceled)return l.cancelToken;var L={width:G.width,height:G.height,toWidth:G.toWidth,toHeight:G.toHeight,scaleX:G.scaleX,scaleY:G.scaleY,offsetX:G.offsetX,offsetY:G.offsetY,filter:l.filter,unsharpAmount:l.unsharpAmount,unsharpRadius:l.unsharpRadius,unsharpThreshold:l.unsharpThreshold};return B.debug("Invoke resize math"),Promise.resolve(L).then(function(j){return B.__extractTileData(G,o,l,w,j)}).then(function(j){return B.debug("Invoke resize math"),B.__invokeResize(j,l)}).then(function(j){return l.canceled?l.cancelToken:(w.srcImageData=null,B.__landTileData(G,j,w))})})};return Promise.resolve().then(function(){if(w.toCtx=E.getContext("2d"),c.isCanvas(o))return null;if(c.isImageBitmap(o))return w.srcImageBitmap=o,w.isImageBitmapReused=!0,null;if(c.isImage(o))return M?(B.debug("Decode image via createImageBitmap"),createImageBitmap(o).then(function(k){w.srcImageBitmap=k}).catch(function(k){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(l.canceled)return l.cancelToken;B.debug("Calculate tiles");var k=_({width:l.width,height:l.height,srcTileSize:B.options.tile,toWidth:l.toWidth,toHeight:l.toHeight,destTileBorder:l.__destTileBorder}),G=k.map(function(j){return O(j)});function L(j){j.srcImageBitmap&&(j.isImageBitmapReused||j.srcImageBitmap.close(),j.srcImageBitmap=null)}return B.debug("Process tiles"),Promise.all(G).then(function(){return B.debug("Finished!"),L(w),E},function(j){throw L(w),j})})},S.prototype.__processStages=function(o,E,l,B){var w=this;if(B.canceled)return B.cancelToken;var O=o.shift(),k=g(O,2),G=k[0],L=k[1],j=o.length===0,W;j||I.q2f.indexOf(B.filter)<0?W=B.filter:B.filter==="box"?W="box":W="hamming",B=a({},B,{toWidth:G,toHeight:L,filter:W});var z;return j||(z=this.options.createCanvas(G,L)),this.__tileAndResize(E,j?l:z,B).then(function(){return j?l:(B.width=G,B.height=L,w.__processStages(o,z,l,B))}).then(function(At){return z&&(z.width=z.height=0),At})},S.prototype.__resizeViaCreateImageBitmap=function(o,E,l){var B=this,w=E.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(o,{resizeWidth:l.toWidth,resizeHeight:l.toHeight,resizeQuality:c.cib_quality_name(I.f2q[l.filter])}).then(function(O){if(l.canceled)return l.cancelToken;if(!l.unsharpAmount)return w.drawImage(O,0,0),O.close(),w=null,B.debug("Finished!"),E;B.debug("Unsharp result");var k=B.options.createCanvas(l.toWidth,l.toHeight),G=k.getContext("2d");G.drawImage(O,0,0),O.close();var L=G.getImageData(0,0,l.toWidth,l.toHeight);return B.__mathlib.unsharp_mask(L.data,l.toWidth,l.toHeight,l.unsharpAmount,l.unsharpRadius,l.unsharpThreshold),w.putImageData(L,0,0),k.width=k.height=0,L=G=k=w=null,B.debug("Finished!"),E})},S.prototype.resize=function(o,E,l){var B=this;this.debug("Start resize...");var w=a({},Q);if(isNaN(l)?l&&(w=a(w,l)):w=a(w,{quality:l}),w.toWidth=E.width,w.toHeight=E.height,w.width=o.naturalWidth||o.width,w.height=o.naturalHeight||o.height,Object.prototype.hasOwnProperty.call(w,"quality")){if(w.quality<0||w.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(w.quality));w.filter=I.q2f[w.quality]}if(E.width===0||E.height===0)return Promise.reject(new Error("Invalid output size: ".concat(E.width,"x").concat(E.height)));w.unsharpRadius>2&&(w.unsharpRadius=2),w.canceled=!1,w.cancelToken&&(w.cancelToken=w.cancelToken.then(function(k){throw w.canceled=!0,k},function(k){throw w.canceled=!0,k}));var O=3;return w.__destTileBorder=Math.ceil(Math.max(O,2.5*w.unsharpRadius|0)),this.init().then(function(){if(w.canceled)return w.cancelToken;if(B.features.cib){if(I.q2f.indexOf(w.filter)>=0)return B.__resizeViaCreateImageBitmap(o,E,w);B.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!C){var k=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw k.code="ERR_GET_IMAGE_DATA",k}var G=p(w.width,w.height,w.toWidth,w.toHeight,B.options.tile,w.__destTileBorder);return B.__processStages(G,o,E,w)})},S.prototype.resizeBuffer=function(o){var E=this,l=a({},Q,o);if(Object.prototype.hasOwnProperty.call(l,"quality")){if(l.quality<0||l.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(l.quality));l.filter=I.q2f[l.quality]}return this.init().then(function(){return E.__mathlib.resizeAndUnsharp(l)})},S.prototype.toBlob=function(o,E,l){return E=E||"image/png",new Promise(function(B){if(o.toBlob){o.toBlob(function(L){return B(L)},E,l);return}if(o.convertToBlob){B(o.convertToBlob({type:E,quality:l}));return}for(var w=atob(o.toDataURL(E,l).split(",")[1]),O=w.length,k=new Uint8Array(O),G=0;G<O;G++)k[G]=w.charCodeAt(G);B(new Blob([k],{type:E}))})},S.prototype.debug=function(){},h.exports=S},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")})})(tt);var N={},et={exports:{}};(function(f){function b(e,t){var r=new Error(e);return r.code=t,r}function d(e){for(var t=e.toString(16).toUpperCase(),r=2-t.length;r>0;r--)t="0"+t;return"0x"+t}function h(e){try{return unescape(encodeURIComponent(e))}catch{return e}}function F(e){try{return decodeURIComponent(escape(e))}catch{return e}}function g(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function v(e,t,r){this.input=e.subarray(t,r),this.start=t;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw b("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}v.prototype.each=function(e){this.aborted=!1;var t=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:t}];this.ifds_to_read.length>0&&!this.aborted;){var r=this.ifds_to_read.shift();r.offset&&this.scan_ifd(r.id,r.offset,e)}},v.prototype.filter=function(e){var t={};t.ifd0={id:0,entries:[]},this.each(function(i){e(i)===!1&&!i.is_subifd_link||i.is_subifd_link&&i.count!==1&&i.format!==4||(t["ifd"+i.ifd]||(t["ifd"+i.ifd]={id:i.ifd,entries:[]}),t["ifd"+i.ifd].entries.push(i))}),delete t.ifd1;var r=8;Object.keys(t).forEach(function(i){r+=2,t[i].entries.forEach(function(u){r+=12+(u.data_length>4?Math.ceil(u.data_length/2)*2:0)}),r+=4}),this.output=new Uint8Array(r),this.output[0]=this.output[1]=(this.big_endian?"M":"I").charCodeAt(0),this.write_uint16(2,42);var n=8,a=this;if(this.write_uint32(4,n),Object.keys(t).forEach(function(i){t[i].written_offset=n;var u=n,A=u+2+t[i].entries.length*12+4;n=A,a.write_uint16(u,t[i].entries.length),t[i].entries.sort(function(s,p){return s.tag-p.tag}).forEach(function(s,p){var _=u+2+p*12;a.write_uint16(_,s.tag),a.write_uint16(_+2,s.format),a.write_uint32(_+4,s.count),s.is_subifd_link?t["ifd"+s.tag]&&(t["ifd"+s.tag].link_offset=_+8):s.data_length<=4?a.output.set(a.input.subarray(s.data_offset-a.start,s.data_offset-a.start+4),_+8):(a.write_uint32(_+8,n),a.output.set(a.input.subarray(s.data_offset-a.start,s.data_offset-a.start+s.data_length),n),n+=Math.ceil(s.data_length/2)*2)});var c=t["ifd"+(t[i].id+1)];c&&(c.link_offset=A-4)}),Object.keys(t).forEach(function(i){t[i].written_offset&&t[i].link_offset&&a.write_uint32(t[i].link_offset,t[i].written_offset)}),this.output.length!==n)throw b("internal error: incorrect buffer size allocated");return this.output},v.prototype.read_uint16=function(e){var t=this.input;if(e+2>t.length)throw b("unexpected EOF","EBADDATA");return this.big_endian?t[e]*256+t[e+1]:t[e]+t[e+1]*256},v.prototype.read_uint32=function(e){var t=this.input;if(e+4>t.length)throw b("unexpected EOF","EBADDATA");return this.big_endian?t[e]*16777216+t[e+1]*65536+t[e+2]*256+t[e+3]:t[e]+t[e+1]*256+t[e+2]*65536+t[e+3]*16777216},v.prototype.write_uint16=function(e,t){var r=this.output;this.big_endian?(r[e]=t>>>8&255,r[e+1]=t&255):(r[e]=t&255,r[e+1]=t>>>8&255)},v.prototype.write_uint32=function(e,t){var r=this.output;this.big_endian?(r[e]=t>>>24&255,r[e+1]=t>>>16&255,r[e+2]=t>>>8&255,r[e+3]=t&255):(r[e]=t&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255)},v.prototype.is_subifd_link=function(e,t){return e===0&&t===34665||e===0&&t===34853||e===34665&&t===40965},v.prototype.exif_format_length=function(e){switch(e){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},v.prototype.exif_format_read=function(e,t){var r;switch(e){case 1:case 2:return r=this.input[t],r;case 6:return r=this.input[t],r|(r&128)*33554430;case 3:return r=this.read_uint16(t),r;case 8:return r=this.read_uint16(t),r|(r&32768)*131070;case 4:return r=this.read_uint32(t),r;case 9:return r=this.read_uint32(t),r|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},v.prototype.scan_ifd=function(e,t,r){var n=this.read_uint16(t);t+=2;for(var a=0;a<n;a++){var i=this.read_uint16(t),u=this.read_uint16(t+2),A=this.read_uint32(t+4),c=this.exif_format_length(u),s=A*c,p=s<=4?t+8:this.read_uint32(t+8),_=!1;if(p+s>this.input.length)throw b("unexpected EOF","EBADDATA");for(var I=[],m=p,x=0;x<A;x++,m+=c){var D=this.exif_format_read(u,m);if(D===null){I=null;break}I.push(D)}if(Array.isArray(I)&&u===2){try{I=F(String.fromCharCode.apply(null,I))}catch{I=null}I&&I[I.length-1]==="\0"&&(I=I.slice(0,-1))}this.is_subifd_link(e,i)&&Array.isArray(I)&&Number.isInteger(I[0])&&I[0]>0&&(this.ifds_to_read.push({id:i,offset:I[0]}),_=!0);var R={is_big_endian:this.big_endian,ifd:e,tag:i,format:u,count:A,entry_offset:t+this.start,data_length:s,data_offset:p+this.start,value:I,is_subifd_link:_};if(r(R)===!1){this.aborted=!0;return}t+=12}e===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(t)})},f.exports.is_jpeg=function(e){return e.length>=4&&e[0]===255&&e[1]===216&&e[2]===255},f.exports.jpeg_segments_each=function(e,t){if(!g(e))throw b("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if(typeof t!="function")throw b("Invalid argument (on_segment), Function expected","EINVAL");if(!f.exports.is_jpeg(e))throw b("Unknown file format","ENOTJPEG");for(var r=0,n=e.length,a=!1;;){var i,u;if(r+1>=n)throw b("Unexpected EOF","EBADDATA");var A=e[r],c=e[r+1];if(A===255&&c===255)i=255,u=1;else if(A===255&&c!==0){if(i=c,u=2,!(208<=i&&i<=217||i===1)){if(r+3>=n)throw b("Unexpected EOF","EBADDATA");if(u+=e[r+2]*256+e[r+3],u<2)throw b("Invalid segment length","EBADDATA");if(r+u-1>=n)throw b("Unexpected EOF","EBADDATA")}a&&(i>=208&&i<=215||(a=!1)),i===218&&(a=!0)}else if(a)for(var s=r+1;;s++){if(s>=n)throw b("Unexpected EOF","EBADDATA");if(e[s]===255){if(s+1>=n)throw b("Unexpected EOF","EBADDATA");if(e[s+1]!==0){i=0,u=s-r;break}}}else throw b("Unexpected byte at segment start: "+d(A)+" (offset "+d(r)+")","EBADDATA");if(t({code:i,offset:r,length:u})===!1||i===217)break;r+=u}},f.exports.jpeg_segments_filter=function(e,t){if(!g(e))throw b("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if(typeof t!="function")throw b("Invalid argument (on_segment), Function expected","EINVAL");var r=[],n=0;f.exports.jpeg_segments_each(e,function(u){var A=t(u);if(g(A))r.push({data:A}),n+=A.length;else if(Array.isArray(A))A.filter(g).forEach(function(s){r.push({data:s}),n+=s.length});else if(A!==!1){var c={start:u.offset,end:u.offset+u.length};r.length>0&&r[r.length-1].end===c.start?r[r.length-1].end=c.end:r.push(c),n+=u.length}});var a=new Uint8Array(n),i=0;return r.forEach(function(u){var A=u.data||e.subarray(u.start,u.end);a.set(A,i),i+=A.length}),a},f.exports.jpeg_exif_tags_each=function(e,t){if(!g(e))throw b("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if(typeof t!="function")throw b("Invalid argument (on_exif_entry), Function expected","EINVAL");f.exports.jpeg_segments_each(e,function(r){if(r.code===218)return!1;if(r.code===225&&r.length>=10&&e[r.offset+4]===69&&e[r.offset+5]===120&&e[r.offset+6]===105&&e[r.offset+7]===102&&e[r.offset+8]===0&&e[r.offset+9]===0)return new v(e,r.offset+10,r.offset+r.length).each(t),!1})},f.exports.jpeg_exif_tags_filter=function(e,t){if(!g(e))throw b("Invalid argument (jpeg_bin), Uint8Array expected","EINVAL");if(typeof t!="function")throw b("Invalid argument (on_exif_entry), Function expected","EINVAL");var r=!1;return f.exports.jpeg_segments_filter(e,function(n){if(!r&&(n.code===218&&(r=!0),n.code===225&&n.length>=10&&e[n.offset+4]===69&&e[n.offset+5]===120&&e[n.offset+6]===105&&e[n.offset+7]===102&&e[n.offset+8]===0&&e[n.offset+9]===0)){var a=new v(e,n.offset+10,n.offset+n.length).filter(t);if(!a)return!1;var i=new Uint8Array(10);return i.set(e.slice(n.offset,n.offset+10)),i[2]=a.length+8>>>8&255,i[3]=a.length+8&255,r=!0,[i,a]}})},f.exports.jpeg_add_comment=function(e,t){var r=!1,n=0;return f.exports.jpeg_segments_filter(e,function(a){if(n++,!(n===1&&a.code===216)&&!(n===2&&a.code===224)&&!r){t=h(t);var i=new Uint8Array(5+t.length),u=0;return i[u++]=255,i[u++]=254,i[u++]=t.length+3>>>8&255,i[u++]=t.length+3&255,t.split("").forEach(function(A){i[u++]=A.charCodeAt(0)&255}),i[u++]=0,r=!0,[i,e.subarray(a.offset,a.offset+a.length)]}})}})(et);var Y=et.exports;function rt(f){return this._getUint8Array(f.blob).then(function(b){if(f.is_jpeg=Y.is_jpeg(b),!f.is_jpeg)return Promise.resolve(f);f.orig_blob=f.blob;try{var d,h;if(Y.jpeg_exif_tags_each(b,function(g){if(g.ifd===0&&g.tag===274&&Array.isArray(g.value))return f.orientation=g.value[0]||1,d=g.is_big_endian,h=g.data_offset,!1}),h){var F=d?new Uint8Array([0,1]):new Uint8Array([1,0]);f.blob=new Blob([b.slice(0,h),F,b.slice(h+2)],{type:"image/jpeg"})}}catch{}return f})}function at(f){if(!f.is_jpeg)return Promise.resolve(f);var b=f.orientation-1;if(!b)return Promise.resolve(f);var d;b&4?d=this.pica.options.createCanvas(f.out_canvas.height,f.out_canvas.width):d=this.pica.options.createCanvas(f.out_canvas.width,f.out_canvas.height);var h=d.getContext("2d");return h.save(),b&1&&h.transform(-1,0,0,1,d.width,0),b&2&&h.transform(-1,0,0,-1,d.width,d.height),b&4&&h.transform(0,1,1,0,0,0),h.drawImage(f.out_canvas,0,0),h.restore(),f.out_canvas.width=f.out_canvas.height=0,f.out_canvas=d,Promise.resolve(f)}function it(f){return f.is_jpeg?Promise.all([this._getUint8Array(f.blob),this._getUint8Array(f.out_blob)]).then(function(b){var d=b[0],h=b[1];if(!Y.is_jpeg(d))return Promise.resolve(f);var F=[];return Y.jpeg_segments_each(d,function(g){if(g.code===218)return!1;F.push(g)}),F=F.filter(function(g){return g.code===226?!1:g.code>=224&&g.code<240||g.code===254}).map(function(g){return d.slice(g.offset,g.offset+g.length)}),f.out_blob=new Blob([h.slice(0,2)].concat(F).concat([h.slice(20)]),{type:"image/jpeg"}),f}):Promise.resolve(f)}function st(f){f.before("_blob_to_image",rt),f.after("_transform",at),f.after("_create_blob",it)}N.jpeg_patch_exif=rt;N.jpeg_rotate_canvas=at;N.jpeg_attach_orig_segments=it;N.assign=st;var J=X,nt=tt.exports;function T(f){if(!(this instanceof T))return new T(f);f=f||{},this.pica=f.pica||nt({}),this.initialized=!1,this.utils=J}T.prototype.use=function(f){var b=[this].concat(Array.prototype.slice.call(arguments,1));return f.apply(f,b),this};T.prototype.init=function(){this.use(N.assign)};T.prototype.toBlob=function(f,b){var d=J.assign({max:1/0},b),h={blob:f,opts:d};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(h).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(this._create_blob).then(function(F){return F.out_canvas.width=F.out_canvas.height=0,F.out_blob})};T.prototype.toCanvas=function(f,b){var d=J.assign({max:1/0},b),h={blob:f,opts:d};return this.initialized||(this.init(),this.initialized=!0),Promise.resolve(h).then(this._blob_to_image).then(this._calculate_size).then(this._transform).then(this._cleanup).then(function(F){return F.out_canvas})};T.prototype.before=function(f,b){if(!this[f])throw new Error('Method "'+f+'" does not exist');if(typeof b!="function")throw new Error('Invalid argument "fn", function expected');var d=this[f],h=this;return this[f]=function(F){return b.call(h,F).then(function(g){return d.call(h,g)})},this};T.prototype.after=function(f,b){if(!this[f])throw new Error('Method "'+f+'" does not exist');if(typeof b!="function")throw new Error('Invalid argument "fn", function expected');var d=this[f],h=this;return this[f]=function(F){return d.call(h,F).then(function(g){return b.call(h,g)})},this};T.prototype._blob_to_image=function(f){var b=window.URL||window.webkitURL||window.mozURL||window.msURL;return f.image=document.createElement("img"),f.image_url=b.createObjectURL(f.blob),f.image.src=f.image_url,new Promise(function(d,h){f.image.onerror=function(){h(new Error("ImageBlobReduce: failed to create Image() from blob"))},f.image.onload=function(){d(f)}})};T.prototype._calculate_size=function(f){var b=f.opts.max/Math.max(f.image.width,f.image.height);return b>1&&(b=1),f.transform_width=Math.max(Math.round(f.image.width*b),1),f.transform_height=Math.max(Math.round(f.image.height*b),1),f.scale_factor=b,Promise.resolve(f)};T.prototype._transform=function(f){f.out_canvas=this.pica.options.createCanvas(f.transform_width,f.transform_height),f.transform_width=null,f.transform_height=null;var b={alpha:f.blob.type==="image/png"};return this.utils.assign(b,this.utils.pick_pica_resize_options(f.opts)),this.pica.resize(f.image,f.out_canvas,b).then(function(){return f})};T.prototype._cleanup=function(f){f.image.src="",f.image=null;var b=window.URL||window.webkitURL||window.mozURL||window.msURL;return b.revokeObjectURL&&b.revokeObjectURL(f.image_url),f.image_url=null,Promise.resolve(f)};T.prototype._create_blob=function(f){return this.pica.toBlob(f.out_canvas,f.blob.type).then(function(b){return f.out_blob=b,f})};T.prototype._getUint8Array=function(f){return f.arrayBuffer?f.arrayBuffer().then(function(b){return new Uint8Array(b)}):new Promise(function(b,d){var h=new FileReader;h.readAsArrayBuffer(f),h.onload=function(){b(new Uint8Array(h.result))},h.onerror=function(){d(new Error("ImageBlobReduce: failed to load data from input blob")),h.abort()},h.onabort=function(){d(new Error("ImageBlobReduce: failed to load data from input blob (aborted)"))}})};T.pica=nt;var ht=T;export{ht as default};
/*! Bundled license information:

image-blob-reduce/dist/image-blob-reduce.esm.mjs:
  (*! image-blob-reduce 4.1.0 https://github.com/nodeca/image-blob-reduce @license MIT *)
  (*!
  
  pica
  https://github.com/nodeca/pica
  
  *)
*/
//# sourceMappingURL=/static/image-blob-reduce.esm-2UWJH52M.js.map
