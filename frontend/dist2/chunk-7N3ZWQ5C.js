import{a as U}from"/static/chunk-ONCHN4RU.js";import{c as J}from"/static/chunk-Y35PDO57.js";import{Ae as _,Do as F,Io as X,Pg as E,Sa as C,Ta as M,Za as O,Zm as R,a as f,f as K,hg as A,ie as P,le as S,ng as B,r as b,re as w,tn as j,ve as I,ze as N}from"/static/chunk-TW5IU73S.js";import{d as r,e as c,g as p,j as u}from"/static/chunk-SJXEOBQC.js";c();u();p();var l=r(f());c();u();p();var n=r(f()),z=r(O());var d=(0,n.kea)([(0,n.path)(["products","messaging","frontend","functionsTableLogic"]),(0,n.props)({}),(0,n.key)(e=>e.type??"destination"),(0,n.connect)({values:[A,["currentProjectId"]]}),(0,n.actions)({deleteHogFunction:e=>({hogFunction:e}),setFilters:e=>({filters:e}),resetFilters:!0}),(0,n.reducers)({filters:[{},{setFilters:(e,{filters:t})=>({...e,...t}),resetFilters:()=>({})}]}),(0,z.loaders)(({props:e,values:t,actions:s})=>({hogFunctions:[[],{loadHogFunctions:async()=>(await X.hogFunctions.list({types:[e.type??"destination"]})).results,deleteHogFunction:async({hogFunction:a})=>(await B({endpoint:`projects/${t.currentProjectId}/hog_functions`,object:{id:a.id,name:a.name},callback:m=>{m&&s.loadHogFunctions()}}),t.hogFunctions.filter(m=>m.id!==a.id))}]})),(0,n.selectors)({loading:[e=>[e.hogFunctionsLoading],e=>e],hogFunctionsFuse:[e=>[e.hogFunctions],e=>new w(e||[],{keys:["name","description"],threshold:.3})],filteredHogFunctions:[e=>[e.filters,e.hogFunctions,e.hogFunctionsFuse],(e,t,s)=>{let{search:a}=e;return a?s.search(a).map(m=>m.item):t}]}),(0,n.afterMount)(({actions:e})=>{e.loadHogFunctions()})]);var o=r(b());function W(){let{filters:e}=(0,l.useValues)(d),{setFilters:t}=(0,l.useActions)(d);return(0,o.jsx)("div",{className:"space-y-2",children:(0,o.jsx)("div",{className:"flex items-center gap-2",children:(0,o.jsx)(P,{type:"search",placeholder:"Search...",value:e.search??"",onChange:s=>t({search:s})})})})}function ge({type:e}){let{hogFunctions:t,filteredHogFunctions:s,loading:a}=(0,l.useValues)(d({type:e})),{deleteHogFunction:m,resetFilters:D}=(0,l.useActions)(d({type:e}));return(0,o.jsx)(l.BindLogic,{logic:d,props:{type:e},children:(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)(W,{}),(0,o.jsx)(N,{dataSource:s,size:"small",loading:a,columns:[{title:"App",width:0,render:function(h,i){return(0,o.jsx)(j,{src:i.icon_url,size:"small"})}},{title:"Name",sticky:!0,sorter:!0,key:"name",dataIndex:"name",render:function(h,i){return(0,o.jsx)(E,{to:R(i.type,i.id,i.template?.id),title:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(C,{title:"Click to update configuration, view metrics, and more",children:(0,o.jsx)("span",{children:i.name})})}),description:i.description})}},J(),{title:"Status",key:"enabled",sorter:T=>T.enabled?1:-1,width:0,render:function(h,i){return(0,o.jsx)(U,{hogFunction:i})}},{width:0,render:function(h,i){return(0,o.jsx)(I,{overlay:(0,o.jsx)(S,{items:[{label:"Delete",status:"danger",onClick:()=>m(i)}]})})}}],emptyState:t.length===0&&!a?"Nothing found":(0,o.jsxs)(o.Fragment,{children:["Nothing matches filters. ",(0,o.jsx)(M,{onClick:()=>D(),children:"Clear filters"})," "]})})]})})}c();u();p();var L=r(f());c();u();p();var g=r(f()),y=r(K());var x=(0,g.kea)([(0,g.path)(["products","messaging","frontend","messagingTabsLogic"]),(0,g.actions)({setTab:(e,t=!1)=>({tab:e,fromUrl:t})}),(0,g.reducers)({currentTab:["broadcasts",{setTab:(e,{tab:t})=>t}]}),(0,y.actionToUrl)(({values:e})=>({setTab:({fromUrl:t})=>{if(!t)return{broadcasts:F.messagingBroadcasts(),providers:F.messagingProviders()}[e.currentTab]??F.messagingBroadcasts()}})),(0,y.urlToAction)(({actions:e,values:t})=>({"/messaging/:tab":({tab:s})=>{s!==t.currentTab&&e.setTab(s,!0)},"/messaging/:tab/*":({tab:s})=>{s!==t.currentTab&&e.setTab(s,!0)}}))]);var V=r(b());function xe(){let{currentTab:e}=(0,L.useValues)(x),{setTab:t}=(0,L.useActions)(x);return(0,V.jsx)(_,{activeKey:e,onChange:s=>t(s),tabs:[{key:"broadcasts",label:"Broadcasts"},{key:"providers",label:"Providers"}]})}export{ge as a,xe as b};
//# sourceMappingURL=/static/chunk-7N3ZWQ5C.js.map
