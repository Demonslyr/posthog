import{a as ln,c as hs,d as bs,e as Ss}from"/static/chunk-G6ENRSAD.js";import{a as vs,b as Cs}from"/static/chunk-YLWX37ZH.js";import{a as fr}from"/static/chunk-HFSFMFXT.js";import{a as xn}from"/static/chunk-FCOMHTD6.js";import{a as mi}from"/static/chunk-ZDFMFKTJ.js";import{a as ci}from"/static/chunk-TF53AUIP.js";import{a as ys}from"/static/chunk-7IEEMZ6G.js";import{a as Ft}from"/static/chunk-LYVLXNIU.js";import{a as fs}from"/static/chunk-5QZ3UKWA.js";import{a as sn}from"/static/chunk-SSCAQKOK.js";import{a as gr}from"/static/chunk-XXTLNI2H.js";import{a as cs}from"/static/chunk-Z3ZSBYIV.js";import{e as an,g as ls}from"/static/chunk-VVSLW35Y.js";import{a as ps}from"/static/chunk-OYAHDROG.js";import{a as us}from"/static/chunk-DYVMG6MY.js";import{b as ds,d as ms}from"/static/chunk-OKGJSIGC.js";import{$a as He,$d as kn,$e as Oo,Ac as ga,Ae as ii,Af as Ia,Am as ts,Ap as gs,Bd as Bt,Bf as Aa,Bg as Ko,Bi as eo,Bm as Nn,Ca as ia,Cd as Ct,Ce as on,Cf as ir,Db as ti,Df as Ra,Dk as Ya,Do as ye,Eb as da,Ef as Na,En as is,Eo as B,Fe as Sa,Ff as xa,Fn as rs,Gf as Ma,Gk as $a,Gm as ns,Gn as rn,Hf as Ea,Hk as Za,Id as ba,If as Pa,Ii as Ha,Ik as li,In as as,Io as j,Ip as Je,Jk as Qa,Jn as St,Jo as di,Kk as Ka,Ko as h,L as vt,La as ra,Lf as Da,Lh as Va,Mb as Kt,Mf as Ba,Mi as et,Nf as An,O as Qr,Oe as Lo,Of as rr,Oh as Ja,Oi as si,Om as ce,Pb as ma,Pe as La,Pf as ar,Pg as nn,Qd as qt,Qf as Oa,R as Kr,Rf as sr,S as qr,Sa as be,Sc as ze,Sd as u,Se as _a,Ta as D,Te as Ta,Tf as X,Vd as we,Wd as fe,We as tn,Wi as dr,Xa as aa,Xc as fa,Xd as V,Xe as Qo,Ye as ka,Yh as ai,Yi as _o,Za as Dt,Ze as ri,_e as ee,_h as cr,_l as qa,a as I,ae as va,af as Ye,b as Do,bf as tr,bi as Xa,c as Nd,ca as ea,cc as So,ce as $,ch as lr,co as pr,da as oa,de as K,di as ja,ee as Bo,ei as Wa,f as or,fc as pa,fe as ie,fg as Fa,g as xd,gb as sa,ge as wn,gg as Ua,h as Sn,hg as xo,ib as la,ie as U,ig as Rn,io as ur,je as Be,kc as Tn,ke as en,ki as qo,m as Zo,ma as oi,mi as Ga,mo as ss,na as ta,oe as In,pe as ve,qm as es,r as f,sa as na,sb as ca,se as ao,ta as Ln,tb as _n,tc as ua,td as ke,te as Ca,ue as Ve,ug as za,ve as ni,vm as os,xd as ya,xm as mr,yd as ha,yf as wa,yl as Ot,ze as ae,zf as nr}from"/static/chunk-RFJTZKD6.js";import{Ca as Gr,F as bo,Ha as vo,Ja as No,K as er,Ka as Hr,L as Vr,M as Jr,Ua as Yr,V as Xr,Wa as bt,X as jr,a as ne,kb as Pt,na as Wr,tc as $r,v as ro,y as zr,yc as Zr,za as Qt}from"/static/chunk-3UDJFOQH.js";import{b as Rd,d as a,e as c,g as d,j as m}from"/static/chunk-SJXEOBQC.js";var Fs=Rd((pu,Os)=>{"use strict";c();m();d();var Dd="Expected a function",Ds=NaN,Bd="[object Symbol]",Od=/^\s+|\s+$/g,Fd=/^[-+]0x[0-9a-f]+$/i,Ud=/^0b[01]+$/i,zd=/^0o[0-7]+$/i,Vd=parseInt,Jd=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Xd=typeof self=="object"&&self&&self.Object===Object&&self,jd=Jd||Xd||Function("return this")(),Wd=Object.prototype,Gd=Wd.toString,Hd=Math.max,Yd=Math.min,yr=function(){return jd.Date.now()};function $d(e,o,t){var n,i,r,s,l,g,p=0,b=!1,S=!1,_=!0;if(typeof e!="function")throw new TypeError(Dd);o=Bs(o)||0,hr(t)&&(b=!!t.leading,S="maxWait"in t,r=S?Hd(Bs(t.maxWait)||0,o):r,_="trailing"in t?!!t.trailing:_);function y(Ce){var Ao=n,lt=i;return n=i=void 0,p=Ce,s=e.apply(lt,Ao),s}function C(Ce){return p=Ce,l=setTimeout(Y,o),b?y(Ce):s}function P(Ce){var Ao=Ce-g,lt=Ce-p,Te=o-Ao;return S?Yd(Te,r-lt):Te}function E(Ce){var Ao=Ce-g,lt=Ce-p;return g===void 0||Ao>=o||Ao<0||S&&lt>=r}function Y(){var Ce=yr();if(E(Ce))return de(Ce);l=setTimeout(Y,P(Ce))}function de(Ce){return l=void 0,_&&n?y(Ce):(n=i=void 0,s)}function _e(){l!==void 0&&clearTimeout(l),p=0,n=g=i=l=void 0}function qe(){return l===void 0?s:de(yr())}function Po(){var Ce=yr(),Ao=E(Ce);if(n=arguments,i=this,g=Ce,Ao){if(l===void 0)return C(g);if(S)return l=setTimeout(Y,o),y(g)}return l===void 0&&(l=setTimeout(Y,o)),s}return Po.cancel=_e,Po.flush=qe,Po}function hr(e){var o=typeof e;return!!e&&(o=="object"||o=="function")}function Zd(e){return!!e&&typeof e=="object"}function Qd(e){return typeof e=="symbol"||Zd(e)&&Gd.call(e)==Bd}function Bs(e){if(typeof e=="number")return e;if(Qd(e))return Ds;if(hr(e)){var o=typeof e.valueOf=="function"?e.valueOf():e;e=hr(o)?o+"":o}if(typeof e!="string")return e===0?e:+e;e=e.replace(Od,"");var t=Ud.test(e);return t||zd.test(e)?Vd(e.slice(2),t?2:8):Fd.test(e)?Ds:+e}Os.exports=$d});c();m();d();var fd=a(Sn()),Yt=a(I()),yd=a(or());var hd=a(ne());c();m();d();var yo=a(I());c();m();d();c();m();d();var _s=a(f());function Ls(){return(0,_s.jsx)(ps,{logicKey:"error-tracking",type:"internal_destination",subTemplateId:"error-tracking",filters:{events:[{id:"$error_tracking_issue_created",type:"events"}]}})}c();m();d();var _t=a(I());var Mn=a(ne());c();m();d();var ot=a(I()),Ts=a(He()),ks=a(Dt());var Lt=(0,ot.kea)([(0,ot.path)(["scenes","error-tracking","errorTrackingSymbolSetLogic"]),(0,ot.actions)({setUploadSymbolSetId:e=>({id:e})}),(0,ot.reducers)({uploadSymbolSetId:[null,{setUploadSymbolSetId:(e,{id:o})=>o}]}),(0,ks.loaders)(({values:e})=>({symbolSets:[[],{loadSymbolSets:async()=>(await j.errorTracking.symbolSets()).results,deleteSymbolSet:async o=>(await j.errorTracking.deleteSymbolSet(o),[...e.symbolSets].filter(n=>n.id!==o))}]})),(0,ot.selectors)({breadcrumbs:[()=>[],()=>[{key:"ErrorTracking",name:"Error tracking",path:ye.errorTracking()},{key:"ErrorTrackingConfiguration",name:"Configuration"}]],validSymbolSets:[e=>[e.symbolSets],e=>e.filter(o=>!!o.storage_ptr)],missingSymbolSets:[e=>[e.symbolSets],e=>e.filter(o=>!o.storage_ptr)]}),(0,Ts.forms)(({values:e,actions:o})=>({uploadSymbolSet:{defaults:{minified:[],sourceMap:[]},submit:async({minified:t,sourceMap:n})=>{if(t.length<1||n.length<1){we.error("Please select both a minified file and a source map file");return}let i=t[0],r=n[0],s=e.uploadSymbolSetId;if(s==null)return;let l=new FormData;l.append("minified",i),l.append("source_map",r),await j.errorTracking.updateSymbolSet(s,l),o.setUploadSymbolSetId(null),o.loadSymbolSets(),o.resetUploadSymbolSet(),we.success("Source map uploaded")}}}))]);c();m();d();var pi=a(I()),ws=a(He());var Ee=a(f()),Is=()=>{let{setUploadSymbolSetId:e}=(0,pi.useActions)(Lt),{uploadSymbolSetId:o,isUploadSymbolSetSubmitting:t,uploadSymbolSet:n}=(0,pi.useValues)(Lt),i=()=>e(null);return(0,Ee.jsx)($,{title:"",onClose:i,isOpen:!!o,simple:!0,children:(0,Ee.jsxs)(ws.Form,{logic:Lt,formKey:"uploadSymbolSet",className:"gap-1",enableFormOnSubmit:!0,children:[(0,Ee.jsx)($.Header,{children:(0,Ee.jsx)("h3",{children:"Upload javscript symbol set"})}),(0,Ee.jsxs)($.Content,{className:"space-y-2",children:[(0,Ee.jsx)(X,{name:"minified",children:(0,Ee.jsx)(wn,{accept:"text/javascript",multiple:!1,callToAction:(0,Ee.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 border border-dashed rounded p-4 w-full",children:[(0,Ee.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,Ee.jsx)(Ln,{className:"text-2xl"})," Add minified source"]}),(0,Ee.jsx)("div",{children:"Drag and drop your minified source file here or click to open the file browser."})]})})}),(0,Ee.jsx)(X,{name:"sourcemap",children:(0,Ee.jsx)(wn,{accept:"*",multiple:!1,callToAction:(0,Ee.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-2 border border-dashed rounded p-4 w-full",children:[(0,Ee.jsxs)("span",{className:"flex items-center gap-2 font-semibold",children:[(0,Ee.jsx)(Ln,{className:"text-2xl"})," Add source map"]}),(0,Ee.jsx)("div",{children:"Drag and drop your source map here or click to open the file browser."})]})})})]}),(0,Ee.jsxs)($.Footer,{children:[(0,Ee.jsx)(u,{type:"secondary",onClick:i,children:"Cancel"}),(0,Ee.jsx)(u,{disabledReason:n.minified.length<1?"Upload a minified source":n.sourceMap.length<1?"Upload a source map":void 0,type:"primary",status:"alt",htmlType:"submit",loading:t,children:"Upload"})]})]})})};var Fe=a(f());function Rs(){let e=Lt(),{missingSymbolSets:o,validSymbolSets:t}=(0,_t.useValues)(e),{loadSymbolSets:n}=(0,_t.useActions)(e);return(0,Mn.useEffect)(()=>{n()},[n]),(0,Fe.jsxs)("div",{className:"space-y-4",children:[(0,Fe.jsx)("p",{children:"Source maps are required to demangle any minified code in your exception stack traces. PostHog automatically retrieves source maps where possible."}),(0,Fe.jsx)("p",{children:"Cases where it was not possible are listed below. Source maps can be uploaded retroactively but changes will only apply to all future exceptions ingested."}),o.length>0&&(0,Fe.jsx)(As,{id:"missing",dataSource:o,pageSize:5,missing:!0}),(t.length>0||o.length===0)&&(0,Fe.jsx)(As,{id:"valid",dataSource:t,pageSize:10}),(0,Fe.jsx)(Is,{})]})}var As=({id:e,dataSource:o,pageSize:t,missing:n})=>{let{symbolSetsLoading:i}=(0,_t.useValues)(Lt),{deleteSymbolSet:r,setUploadSymbolSetId:s}=(0,_t.useActions)(Lt),l=[{title:n&&"Missing symbol sets",dataIndex:"ref"},{title:"Created At",dataIndex:"created_at",render:g=>Pt(g)},{dataIndex:"id",render:(g,{id:p})=>(0,Fe.jsxs)("div",{className:"flex justify-end space-x-1",children:[(0,Fe.jsx)(u,{type:n?"primary":"secondary",size:"xsmall",tooltip:n?"Upload symbol set":"Replace symbol set",icon:n?(0,Fe.jsx)(ha,{}):(0,Fe.jsx)(fa,{}),onClick:()=>s(p),className:"py-1",children:n&&"Upload"}),(0,Fe.jsx)(u,{type:"secondary",size:"xsmall",tooltip:"Delete symbol set",icon:(0,Fe.jsx)(ke,{}),onClick:()=>K.open({title:"Delete symbol set",description:"Are you sure you want to delete this symbol set?",secondaryButton:{type:"secondary",children:"Cancel"},primaryButton:{type:"primary",onClick:()=>r(p),children:"Delete"}}),className:"py-1"})]})}];return n&&l.splice(1,0,{title:"Failure reason",dataIndex:"failure_reason"}),(0,Fe.jsx)(ae,{id:e,showHeader:n,pagination:{pageSize:t},columns:l,loading:i,dataSource:o,expandable:{noIndent:!0,expandedRowRender:function(p){return(0,Fe.jsx)(Md,{symbolSet:p})}}})},Md=({symbolSet:e})=>{let{stackFrameRecords:o}=(0,_t.useValues)(pr),{loadForSymbolSet:t}=(0,_t.useActions)(pr),[n,i]=(0,Mn.useState)("contents");(0,Mn.useEffect)(()=>{t(e.id)},[t,e]);let r=Object.values(o).filter(s=>s.symbol_set_ref==e.ref);return(0,Fe.jsx)(va,{size:"small",panels:r.map(({id:s,raw_id:l,contents:g,context:p})=>({key:s,header:l,className:"py-0",content:(0,Fe.jsx)(ii,{activeKey:n,onChange:i,tabs:[{key:"contents",label:"Contents",content:(0,Fe.jsx)(ur,{src:g,name:null})},p&&{key:"context",label:"Context",content:(0,Fe.jsx)(ur,{src:p,name:null})}]})})),embedded:!0})};c();m();d();var yi=a(I());var hi=a(ne());var Xo=a(f()),ui=1,gi=120,fi=10;function Ns(){let{updateCurrentTeam:e}=(0,yi.useActions)(h),{currentTeam:o}=(0,yi.useValues)(h),t=o?.modifiers?.bounceRateDurationSeconds??o?.default_modifiers?.bounceRateDurationSeconds,[n,i]=(0,hi.useState)(t??fi),r=l=>{Number.isNaN(l)&&(l=void 0),e({modifiers:{...o?.modifiers,bounceRateDurationSeconds:l}})},s=hi.default.useRef(null);return(0,Xo.jsxs)(Xo.Fragment,{children:[(0,Xo.jsxs)("p",{children:["Choose how long a user can stay on a page, in seconds, before the session is not a bounce. Leave blank to use the default of ",fi," seconds, or set a custom value between"," ",ui," second and ",gi," seconds inclusive."]}),(0,Xo.jsx)(U,{type:"number",min:ui,max:gi,value:n??null,onChange:l=>{l==null||Number.isNaN(l)?i(fi):i(l)},inputRef:s,suffix:(0,Xo.jsx)(u,{size:"small",noPadding:!0,icon:(0,Xo.jsx)(Ct,{}),tooltip:"Clear input",onClick:l=>{l.stopPropagation(),i(fi),s.current?.focus()}})}),(0,Xo.jsx)("div",{className:"mt-4",children:(0,Xo.jsx)(u,{type:"primary",onClick:()=>r(n),disabledReason:n===t?"No changes to save":n==null?void 0:isNaN(n)?"Invalid number":n<ui?`Duration must be at least ${ui} second`:n>gi?`Duration must be less than ${gi} seconds`:void 0,children:"Save"})})]})}c();m();d();var En=a(I());var xs=a(ne());var Re=a(f()),Ed=[{value:"count_pageviews",label:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("div",{children:"Counts pageviews"}),(0,Re.jsxs)("div",{className:"text-secondary",children:["This is the default. Counts ",(0,Re.jsx)("code",{children:"$pageview"})," events in a session as part of the bounce rate calculation."]})]})},{value:"uniq_urls",label:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("div",{children:"Counts unique urls visited"}),(0,Re.jsx)("div",{className:"text-secondary",children:"Counts the number of unique url visited as part of the bounce rate calculation"})]})},{value:"uniq_page_screen_autocaptures",label:(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("div",{children:"Use uniqUpTo"}),(0,Re.jsxs)("div",{className:"text-secondary",children:["Uses the ",(0,Re.jsx)("code",{children:"uniqUpTo"})," function to count if the total unique pageviews + screen events + autocaptures is &gte; 2"]})]})}];function Ms(){let{updateCurrentTeam:e}=(0,En.useActions)(h),{currentTeam:o}=(0,En.useValues)(h),{reportBounceRatePageViewModeUpdated:t}=(0,En.useActions)(Je),n=o?.modifiers?.bounceRatePageViewMode??o?.default_modifiers?.bounceRatePageViewMode??"count_pageviews",[i,r]=(0,xs.useState)(n),s=l=>{e({modifiers:{...o?.modifiers,bounceRatePageViewMode:l}}),t(l)};return(0,Re.jsxs)(Re.Fragment,{children:[(0,Re.jsx)("p",{children:"Choose how pageviews are counted, as part of the bounce rate calculation. Note that other factors are taken into account, e.g. the number of autocaptures, and the session duration."}),(0,Re.jsx)(qo,{value:i,onChange:r,options:Ed}),(0,Re.jsx)("div",{className:"mt-4",children:(0,Re.jsx)(u,{type:"primary",onClick:()=>s(i),disabledReason:i===n?"No changes to save":void 0,children:"Save"})})]})}c();m();d();var bi=a(I());var Es=a(ne());var $e=a(f()),Pd=[{value:2,label:(0,$e.jsx)($e.Fragment,{children:(0,$e.jsx)("div",{children:"Stateful"})})},{value:1,label:(0,$e.jsx)($e.Fragment,{children:(0,$e.jsx)("div",{children:"Stateless"})})},{value:0,label:(0,$e.jsx)($e.Fragment,{children:(0,$e.jsx)("div",{children:"Disabled"})})}];function Ps(){let{updateCurrentTeam:e}=(0,bi.useActions)(h),{currentTeam:o}=(0,bi.useValues)(h),t=o?.cookieless_server_hash_mode??0,[n,i]=(0,Es.useState)(t),r=s=>{e({cookieless_server_hash_mode:s})};return(0,$e.jsxs)($e.Fragment,{children:[(0,$e.jsx)("p",{children:"Use a cookieless server-side hash mode to hash user data. This is an experimental feature preview and may result in dropped events."}),(0,$e.jsx)(qo,{value:n,onChange:i,options:Pd}),(0,$e.jsx)("div",{className:"mt-4",children:(0,$e.jsx)(u,{type:"primary",onClick:()=>r(n),disabledReason:n===t?"No changes to save":void 0,children:"Save"})})]})}c();m();d();var Pn=a(I());c();m();d();var Us=a(Fs()),zs=a(fs()),Se=a(ne()),vi=a(Nd()),q=a(f()),cn=()=>{};function Vs({initialItems:e,renderContainerItem:o,renderChildItem:t,createNewChildItem:n,createNewContainerItem:i,renderAddChildItem:r,renderAddContainerItem:s,renderAdditionalControls:l,onChange:g}){let[p,b]=(0,Se.useState)(()=>{let R={};return e.forEach(F=>{R[F.id]=F}),R}),[S,_]=(0,Se.useState)(null),y=!0,[C,P]=(0,Se.useState)(Object.keys(p)),[E,Y]=(0,Se.useState)(null),de=(0,Se.useRef)(null),_e=(0,Se.useRef)(!1),qe=Ia(nr(xa),nr(Ma)),Po=E?C.includes(E):!1,Ce=(0,Se.useMemo)(()=>g?(0,Us.default)(g,200,{trailing:!0}):void 0,[g]),Ao=(0,Se.useRef)(e);(0,Se.useEffect)(()=>{let R=C.map(F=>p[F]);(0,zs.default)(R,Ao.current)||(Ao.current=R,Ce?.(R))},[C,p,Ce]);let lt=(0,Se.useCallback)(R=>{if(E&&E in p)return ir({...R,droppableContainers:R.droppableContainers.filter(me=>me.id in p)});let F=Na(R),Q=F.length>0?F:Ra(R),he=Aa(Q,"id");if(he!=null){if(he in p){let me=p[he].items;me&&me.length>0&&(he=ir({...R,droppableContainers:R.droppableContainers.filter(Ge=>Ge.id!==he&&me.some(ht=>ht.id===Ge.id))})[0]?.id)}return de.current=he,[{id:he}]}return _e.current&&(de.current=E),de.current?[{id:de.current}]:[]},[E,p]),Te=R=>R in p?R:Object.keys(p).find(F=>p[F].items?.some(Q=>Q.id===R)),Ro=R=>{for(let F in p){let Q=p[F].items?.find(he=>he.id===R);if(Q)return Q}},vd=R=>{let F=Te(R);if(!F)return-1;let Q=p[F].items;return Q?Q.findIndex(he=>he.id===R):-1},Cd=()=>{S&&b(S),Y(null),_(null)};return(0,Se.useEffect)(()=>{requestAnimationFrame(()=>{_e.current=!1})},[p]),(0,q.jsxs)(Pa,{sensors:qe,collisionDetection:lt,measuring:{droppable:{strategy:Ea.Always}},onDragStart:({active:R})=>{Y(R.id),_(p)},onDragOver:({active:R,over:F})=>{let Q=F?.id,he=R.id in p;if(Q!=null)if(he){let me=Te(Q);if(!me)return;E!==me&&P(Ge=>{let ht=Ge.indexOf(R.id),ct=Ge.indexOf(me);return An(Ge,ht,ct)})}else{let me=Te(Q),Ge=Te(R.id);if(!me||!Ge)return;let ht=p[Ge],ct=p[me];Ge!==me?b(Ho=>{let ho=Ho[Ge].items||[],Yo=Ho[me].items||[],$t=Yo.findIndex($o=>$o.id===Q),Ur=ho.findIndex($o=>$o.id===R.id),Zt;if(Q in Ho)Zt=Yo.length+1;else{let Ad=F&&R.rect.current.translated&&R.rect.current.translated.top>F.rect.top+F.rect.height?1:0;Zt=$t>=0?$t+Ad:Yo.length+1}_e.current=!0;let Ki={...ht,items:ho.filter($o=>$o.id!==R.id)},qi={...ct,items:[...Yo.slice(0,Zt),ho[Ur],...Yo.slice(Zt,Yo.length)]};return{...Ho,[Ge]:Ki,[me]:qi}}):Q!==R.id&&b(Ho=>{let ho=Ho[me].items||[],Yo=ho.findIndex($o=>$o.id===Q),$t=ho.findIndex($o=>$o.id===R.id),Zt=F&&R.rect.current.translated&&R.rect.current.translated.top>F.rect.top+F.rect.height?1:0,Ki=An(ho,$t,Yo+Zt),qi={...ct,items:Ki};return{...Ho,[me]:qi}})}},onDragEnd:({active:R,over:F})=>{R.id in p&&F?.id&&P(Ge=>{let ht=Ge.indexOf(R.id),ct=Ge.indexOf(F.id);return An(Ge,ht,ct)});let Q=Te(R.id);if(!Q){Y(null);return}let he=F?.id;if(he==null){Y(null);return}let me=Te(he);if(me){let Ge=p[me].items||[],ct=(p[Q].items||[]).findIndex(ho=>ho.id===R.id),Ho=Ge.findIndex(ho=>ho.id===he);ct!==Ho&&b(ho=>{let Yo=ho[me].items||[],$t={...ho[me],items:An(Yo,ct,Ho)};return{...ho,[me]:$t}})}Y(null)},onDragCancel:Cd,children:[(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsx)(ar,{items:C,strategy:rr,children:C.map(R=>(0,q.jsx)(tm,{items:p[R].items||[],onRemove:()=>_d(R),renderContainerItem:o,containerItemId:R,item:p[R],onAddChild:kd,updateContainerItem:wd,renderAddChildItem:r,children:(0,q.jsx)(ar,{items:p[R].items||[],strategy:rr,children:(p[R].items||[]).map((F,Q)=>(0,q.jsx)(em,{disabled:Po,id:F.id,index:Q,handle:y,containerId:R,getIndex:vd,renderChildItem:t,updateChildItem:Id,onRemove:Td,item:F},F.id))})},R))}),(0,q.jsxs)("div",{className:"px-[calc(1.5rem+1px)] flex flex-row justify-end space-x-2",children:[s?s({onAddContainer:Fr}):(0,q.jsx)(u,{onClick:Fr,fullWidth:!1,type:"primary",children:"Add container"}),l?l():null]})]}),(0,vi.createPortal)((0,q.jsx)(Ba,{dropAnimation:Kd,children:E?C.includes(E)?Ld(E):Sd(E):null}),document.body)]});function Sd(R){let F=Ro(R);return F?(0,q.jsx)(br,{childItemId:R,dragOverlay:!0,renderChildItem:t,item:F,updateChildItem:cn,onRemove:cn}):null}function Ld(R){let F=p[R];return F?(0,q.jsx)(Js,{containerItemId:R,renderContainerItem:o,item:F,onAddChild:cn,updateContainerItem:cn,children:(p[R].items||[]).map(Q=>(0,q.jsx)(br,{childItemId:Q.id,renderChildItem:t,item:Q,updateChildItem:cn,onRemove:cn},Q.id))}):null}function _d(R){P(F=>F.filter(Q=>Q!==R))}function Td(R){b(F=>{let Q=Te(R);if(!Q)return F;let he=F[Q];return{...F,[Q]:{...he,items:he.items?.filter(me=>me.id!==R)}}})}function Fr(){let R=i();(0,vi.unstable_batchedUpdates)(()=>{P(F=>[...F,R.id]),b(F=>({...F,[R.id]:R}))})}function kd(R){let F=n();b(Q=>{let he=Q[R];return{...Q,[R]:{...he,items:[...he.items||[],F]}}})}function wd(R){b(F=>({...F,[R.id]:R}))}function Id(R){let F=Te(R.id);F&&b(Q=>{let he=Q[F];return{...Q,[F]:{...he,items:(he.items||[]).map(me=>me.id===R.id?R:me)}}})}}var Kd={sideEffects:Da({styles:{active:{opacity:"0.4"}}})},qd=e=>Oa({...e,wasDragging:!0});function em({disabled:e,id:o,index:t,handle:n,renderChildItem:i,updateChildItem:r,onRemove:s,item:l}){let{setNodeRef:g,setActivatorNodeRef:p,listeners:b,isDragging:S,isSorting:_,transform:y,transition:C}=sr({id:o}),P=om();return(0,q.jsx)(br,{ref:e?void 0:g,childItemId:o,isDragging:S,sorting:_,handleProps:n?{ref:p}:void 0,index:t,transition:C,transform:y,fadeIn:S&&!P,listeners:b,renderChildItem:i,updateChildItem:r,onRemove:s,item:l})}function om(){let[e,o]=(0,Se.useState)(!1);return(0,Se.useEffect)(()=>{let t=setTimeout(()=>o(!0),500);return()=>clearTimeout(t)},[]),e}function tm({children:e,disabled:o,items:t,style:n,containerItemId:i,...r}){let{attributes:s,isDragging:l,listeners:g,setNodeRef:p,transition:b,transform:S}=sr({id:i,data:{type:"container",children:t},animateLayoutChanges:qd});return(0,q.jsx)(Js,{ref:o?void 0:p,isDragging:l,transform:wa.Translate.toString(S),transition:b,handleProps:{...s,...g},containerItemId:i,...r,children:e})}var Js=(0,Se.forwardRef)(function({children:o,handleProps:t,onClick:n,onRemove:i,onAddChild:r,containerItemId:s,placeholder:l,style:g,isDragging:p,transform:b,transition:S,renderContainerItem:_,updateContainerItem:y,item:C,renderAddChildItem:P,...E},Y){return(0,q.jsxs)(n?"button":"div",{...E,className:`flex flex-col p-4 bg-surface-primary border rounded overflow-hidden space-y-2 ${p?"opacity-40":""}`,style:{transform:b,transition:S},ref:Y,onClick:n,tabIndex:n?0:void 0,children:[(0,q.jsxs)("div",{className:"flex flex-row justify-between px-2 space-x-2 items-start",children:[(0,q.jsx)(js,{...t}),(0,q.jsx)("div",{className:"flex-1 self-stretch",children:_?_(C,{updateContainerItem:y}):(0,q.jsx)("div",{className:"h-full flex flex-row items-center",children:(0,q.jsxs)("span",{children:["Container ",s]})})}),(0,q.jsx)(Xs,{onClick:i})]}),l?o:(0,q.jsx)("ul",{className:"space-y-2",children:o}),(0,q.jsx)("div",{className:"flex flex-row justify-end px-2 mb-2 space-x-2",children:P?P(C,{onAddChild:r}):(0,q.jsx)(u,{onClick:i?()=>r(C.id):void 0,fullWidth:!1,type:"secondary",children:"Add child"})})]})}),br=Se.default.memo(Se.default.forwardRef(function({color:o,dragOverlay:t,isDragging:n,disabled:i,fadeIn:r,handleProps:s,height:l,index:g,listeners:p,onRemove:b,sorting:S,style:_,transition:y,transform:C,childItemId:P,wrapperStyle:E,renderChildItem:Y,updateChildItem:de,item:_e,...qe},Po){return(0,Se.useEffect)(()=>{if(t)return document.body.style.cursor="grabbing",()=>{document.body.style.cursor=""}},[t]),(0,q.jsx)("li",{ref:Po,className:`flex p-[calc(0.5rem-1px)] bg-surface-primary border rounded overflow-hidden ${n?"opacity-40":""}`,children:(0,q.jsxs)("div",{"data-cypress":"draggable-item",...qe,tabIndex:void 0,className:"flex flex-row justify-between w-full space-x-2 items-start",children:[(0,q.jsx)(js,{...s,...p}),(0,q.jsx)("div",{className:"flex-1 self-stretch",children:Y?Y(_e,{updateChildItem:de}):(0,q.jsx)("div",{className:"h-full flex flex-row items-center",children:(0,q.jsxs)("span",{children:["Item ",P]})})}),(0,q.jsx)(Xs,{onClick:()=>b(_e.id)})]})})}));function Xs(e){return(0,q.jsx)(u,{type:"secondary",fullWidth:!1,status:"danger",size:"small",...e,children:(0,q.jsx)(ke,{})})}var js=(0,Se.forwardRef)(function(o,t){return(0,q.jsx)(u,{type:"tertiary",fullWidth:!1,ref:t,size:"small",...o,className:"self-start",children:(0,q.jsx)("div",{children:(0,q.jsx)(ra,{})})})});var Gs=a(fs()),Dn=a(ne());var pe=a(f()),im=[{label:"All",value:"AND"},{label:"Any",value:"OR"}],rm=[{label:"Referring domain",value:"referring_domain"},{label:"UTM Source",value:"utm_source"},{label:"UTM Medium",value:"utm_medium"},{label:"UTM Campaign",value:"utm_campaign"},{label:"URL",value:"url"},{label:"Hostname",value:"hostname"},{label:"Pathname",value:"pathname"}],am=Object.values(_a).map(e=>({label:Hr[e],value:e})),sm=e=>["is_set","is_not_set"].includes(e),lm={exact:"exact",is_not:"is_not",is_set:"is_set",is_not_set:"is_not_set",icontains:"icontains",not_icontains:"not_icontains",regex:"regex",not_regex:"not_regex"};function cm(e){switch(e){case"referring_domain":return"$entry_referring_domain";case"utm_source":return"$entry_utm_source";case"utm_medium":return"$entry_utm_medium";case"utm_campaign":return"$entry_utm_campaign";case"url":return"$entry_url";case"hostname":return"$entry_hostname";case"pathname":return"$entry_pathname";default:throw new $r(e)}}var Ws=e=>(e??[]).map(o=>({id:o.id||Qt(),channel_type:o.channel_type,combiner:o.combiner,items:(o.items||[]).map(t=>({id:t.id||Qt(),key:t.key,op:t.op,value:t.value})).filter(t=>t.key&&t.op&&t.value)})).filter(o=>o.channel_type&&o.items.length>0);function Hs(){let{updateCurrentTeam:e}=(0,Pn.useActions)(h),{currentTeam:o}=(0,Pn.useValues)(h),{reportCustomChannelTypeRulesUpdated:t}=(0,Pn.useActions)(Je),[n,i]=(0,Dn.useState)(()=>Ws(o?.modifiers?.customChannelTypeRules??o?.default_modifiers?.customChannelTypeRules)),[r,s]=(0,Dn.useState)(n),l=(0,Dn.useMemo)(()=>{let g=new Set([...r.map(p=>p.channel_type),...Object.values(Ta)]);return Array.from(g).filter(Boolean).map(p=>({label:p,key:p}))},[r]);return(0,pe.jsxs)("div",{children:[(0,pe.jsxs)("p",{children:["You can create custom channel types by defining rules that match incoming events. The first matching rule is used, and if no rule matches (or if none are defined) then the"," ",(0,pe.jsx)(D,{to:"https://posthog.com/docs/data/channel-type#channel-type-calculation",children:"default channel type"})," ","is used."]}),(0,pe.jsxs)("p",{children:["To debug, try the"," ",(0,pe.jsx)(D,{to:ye.sessionAttributionExplorer(),target:"_blank",children:"session attribution explorer tool"})]}),(0,pe.jsx)(dm,{handleChange:s,initialCustomChannelTypeRules:r,channelTypeOptions:l,onSave:()=>{e({modifiers:{customChannelTypeRules:Ws(r)}}),t(r.length),i(r)},isSaveDisabled:(0,Gs.default)(r,n)})]})}function dm({handleChange:e,initialCustomChannelTypeRules:o,channelTypeOptions:t,isSaveDisabled:n,onSave:i}){return(0,pe.jsx)(Vs,{initialItems:o,renderContainerItem:(r,{updateContainerItem:s})=>(0,pe.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,pe.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,pe.jsx)("span",{children:"Set Channel type to"}),(0,pe.jsx)(Ve,{className:"flex-1",mode:"single",allowCustomValues:!0,value:[r.channel_type],onChange:l=>s({...r,channel_type:l[0]}),options:t,placeholder:"Enter a channel type name"})]}),r.items.length>0?(0,pe.jsx)("div",{children:r.items.length==1?"when this condition is met":(0,pe.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,pe.jsx)("span",{children:"When"}),(0,pe.jsx)(ve,{value:r.combiner,options:im,onChange:l=>s({...r,combiner:l})}),(0,pe.jsx)("span",{children:"conditions are met"})]})}):null]}),renderChildItem:(r,{updateChildItem:s})=>(0,pe.jsxs)("div",{className:"w-full space-y-2",children:[(0,pe.jsxs)("div",{className:"flex flex-row space-x-2",children:[(0,pe.jsx)(ve,{value:r.key,options:rm,onChange:l=>s({...r,key:l})}),(0,pe.jsx)(ve,{value:r.op,options:am,onChange:l=>s({...r,op:l})})]}),sm(r.op)?null:(0,pe.jsx)(za,{propertyKey:cm(r.key),type:"session",onSet:l=>{s({...r,value:l})},operator:lm[r.op],value:r.value,placeholder:"Enter a value"},r.key)]}),renderAddChildItem:(r,{onAddChild:s})=>(0,pe.jsx)(u,{type:"primary",onClick:()=>s(r.id),icon:(0,pe.jsx)(ze,{}),children:"Add condition"}),renderAddContainerItem:({onAddContainer:r})=>(0,pe.jsx)(u,{type:"primary",onClick:r,icon:(0,pe.jsx)(ze,{}),children:"Add rule"}),renderAdditionalControls:()=>(0,pe.jsx)(u,{onClick:i,disabledReason:n?"No changes to save":void 0,type:"primary",children:"Save custom channel type rules"}),createNewContainerItem:()=>({id:Qt(),items:[{id:Qt(),key:"referring_domain",op:"exact",value:[]}],channel_type:"",combiner:"AND"}),createNewChildItem:()=>({id:Qt(),key:"referring_domain",op:"exact",value:[]}),onChange:e})}c();m();d();var Bn=a(I());var dt=a(f());function Ys(){let{userLoading:e}=(0,Bn.useValues)(B),{currentTeam:o}=(0,Bn.useValues)(h),{updateCurrentTeam:t}=(0,Bn.useActions)(h);return(0,dt.jsxs)(dt.Fragment,{children:[(0,dt.jsx)("p",{children:"A dead click is a click that doesn't result in any action. E.g. an image that looks like a button. Your user clicks it, nothing happens, they get frustrated and close the tab, and you missed a sale."}),(0,dt.jsx)("p",{children:"We track clicks that aren't followed by a scroll, text selection change, or DOM mutation and report them so you can see where your users are getting stuck."}),(0,dt.jsx)("div",{className:"space-y-2",children:(0,dt.jsx)(V,{id:"posthog-deadclicks-switch",onChange:n=>{t({capture_dead_clicks:n}),Do.capture("dead_clicks_autocapture_toggled",{isEnabled:n})},checked:!!o?.capture_dead_clicks,disabled:e,label:"Enable dead clicks autocapture",bordered:!0})})]})}c();m();d();var vr=a(I()),$s=a(He());var mt=a(f());function Zs(){let{currentProject:e,currentProjectLoading:o}=(0,vr.useValues)(xo),{isLoading:t,isUpdating:n}=(0,vr.useValues)(gr);return(0,mt.jsxs)($s.Form,{logic:gr,formKey:"coreMemoryForm",enableFormOnSubmit:!0,className:"w-full space-y-4",children:[o||t?(0,mt.jsxs)("div",{className:"gap-2 flex flex-col",children:[(0,mt.jsx)(ao,{className:"h-6 w-32"}),(0,mt.jsx)(ao,{className:"h-16"})]}):(0,mt.jsx)(X,{name:"text",label:"Max\u2019s memory",children:(0,mt.jsx)(on,{id:"product-description-textarea",placeholder:`What's should Max know about ${e?e.name:"your company or this product"}?`,maxLength:1e4,maxRows:5})}),(0,mt.jsx)(u,{type:"primary",htmlType:"submit",disabledReason:!e||t?"Loading project and memory...":void 0,loading:n,children:"Save memory"})]})}c();m();d();var On=a(I());var Qs=a(ne());var oo=a(f()),mm=[{value:"inner",label:(0,oo.jsxs)(oo.Fragment,{children:[(0,oo.jsx)("div",{children:"Does an inner join"}),(0,oo.jsx)("div",{className:"text-secondary",children:"This is the default. You want this one unless you know what you are doing."})]})},{value:"left",label:(0,oo.jsxs)(oo.Fragment,{children:[(0,oo.jsx)("div",{children:"Does a left join."}),(0,oo.jsx)("div",{className:"text-secondary",children:"Experimental mode for personless events "})]})}];function Ks(){let{updateCurrentTeam:e}=(0,On.useActions)(h),{currentTeam:o}=(0,On.useValues)(h),{reportPersonsJoinModeUpdated:t}=(0,On.useActions)(Je),n=o?.modifiers?.personsJoinMode??o?.default_modifiers?.personsJoinMode??"inner",[i,r]=(0,Qs.useState)(n),s=l=>{e({modifiers:{...o?.modifiers,personsJoinMode:l}}),t(l)};return(0,oo.jsxs)(oo.Fragment,{children:[(0,oo.jsx)("p",{children:"Choose how persons are joined to events. Do not change this setting unless you know what you are doing."}),(0,oo.jsx)(qo,{value:i,onChange:r,options:mm}),(0,oo.jsx)("div",{className:"mt-4",children:(0,oo.jsx)(u,{type:"primary",onClick:()=>s(i),disabledReason:i===n?"No changes to save":void 0,children:"Save"})})]})}c();m();d();var Fn=a(I());var qs=a(ne());var Ne=a(f()),pm=[{value:"person_id_override_properties_on_events",label:(0,Ne.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:["Use person properties from the time of the event",(0,Ne.jsx)(ie,{children:"RECOMMENDED"})]}),description:(0,Ne.jsxs)(Ne.Fragment,{children:["Fast queries. If the person property is updated, query results on past data ",(0,Ne.jsx)("em",{children:"won't"})," change."]})},{value:"person_id_override_properties_joined",label:"Use person properties as of running the query",description:(0,Ne.jsxs)(Ne.Fragment,{children:["Slower queries. If the person property is updated, query results on past data ",(0,Ne.jsx)("em",{children:"will"})," change accordingly."]})},{value:"person_id_no_override_properties_on_events",label:"Use person IDs and person properties from the time of the event",description:(0,Ne.jsxs)(Ne.Fragment,{children:["Fastest queries,"," ",(0,Ne.jsx)("span",{className:"underline",children:"but funnels and unique user counts will be inaccurate"}),". If the person property is updated, query results on past data ",(0,Ne.jsx)("em",{children:"won't"})," change."]})}];function el(){let{updateCurrentTeam:e}=(0,Fn.useActions)(h),{reportPoEModeUpdated:o}=(0,Fn.useActions)(Je),{currentTeam:t}=(0,Fn.useValues)(h),n=t?.modifiers?.personsOnEventsMode??t?.default_modifiers?.personsOnEventsMode??"disabled",[i,r]=(0,qs.useState)(n),s=l=>{e({modifiers:{...t?.modifiers,personsOnEventsMode:l}}),Do.capture("user changed personsOnEventsMode setting",{personsOnEventsMode:l}),o(l)};return(0,Ne.jsxs)(Ne.Fragment,{children:[(0,Ne.jsxs)("p",{children:["Choose the behavior of person property filters. For the best performance,"," ",(0,Ne.jsx)("strong",{children:"we strongly recommend the first option."})," ",(0,Ne.jsx)(D,{to:"https://posthog.com/docs/how-posthog-works/queries#filtering-on-person-properties",target:"blank",children:"Learn about the details in our docs."})]}),(0,Ne.jsx)(qo,{value:i,onChange:r,options:pm}),(0,Ne.jsx)("div",{className:"mt-4",children:(0,Ne.jsx)(u,{type:"primary",onClick:()=>s(i),disabledReason:i===n?"No changes to save":void 0,children:"Save"})})]})}c();m();d();var ul=a(Sn()),ut=a(I()),gl=a(He());c();m();d();var so=a(I()),tl=a(He()),nl=a(xd());var ol={url:"",matching:"regex"};function Ci(e){return e=e.startsWith("^")?e.substring(1):e,e=e.endsWith("$")?e.substring(0,e.length-1):e,`^${e}$`}var pt=(0,so.kea)([(0,so.path)(["scenes","settings","project","replayTriggersLogic"]),(0,so.actions)({setUrlTriggerConfig:e=>({urlTriggerConfig:e}),addUrlTrigger:e=>({urlTriggerConfig:e}),removeUrlTrigger:e=>({index:e}),updateUrlTrigger:(e,o)=>({index:e,urlTriggerConfig:o}),setEditUrlTriggerIndex:e=>({originalIndex:e}),newUrlTrigger:!0,cancelProposingUrlTrigger:!0,setUrlBlocklistConfig:e=>({urlBlocklistConfig:e}),addUrlBlocklist:e=>({urlBlocklistConfig:e}),removeUrlBlocklist:e=>({index:e}),updateUrlBlocklist:(e,o)=>({index:e,urlBlocklistConfig:o}),setEditUrlBlocklistIndex:e=>({originalIndex:e}),newUrlBlocklist:!0,cancelProposingUrlBlocklist:!0,setEventTriggerConfig:e=>({eventTriggerConfig:e}),updateEventTriggerConfig:e=>({eventTriggerConfig:e})}),(0,so.connect)({values:[h,["currentTeam"]],actions:[h,["updateCurrentTeam"]]}),(0,so.reducers)({urlTriggerConfig:[null,{setUrlTriggerConfig:(e,{urlTriggerConfig:o})=>o,addUrlTrigger:(e,{urlTriggerConfig:o})=>[...e??[],o],updateUrlTrigger:(e,{index:o,urlTriggerConfig:t})=>(e??[]).map((n,i)=>i===o?t:n),removeUrlTrigger:(e,{index:o})=>(e??[]).filter((t,n)=>n!==o)}],editUrlTriggerIndex:[null,{setEditUrlTriggerIndex:(e,{originalIndex:o})=>o,removeUrlTrigger:(e,{index:o})=>e&&o<e?e-1:o===e?null:e,newUrlTrigger:()=>-1,updateUrlTrigger:()=>null,addUrlTrigger:()=>null,cancelProposingUrlTrigger:()=>null}],urlBlocklistConfig:[null,{setUrlBlocklistConfig:(e,{urlBlocklistConfig:o})=>o,addUrlBlocklist:(e,{urlBlocklistConfig:o})=>[...e??[],o],updateUrlBlocklist:(e,{index:o,urlBlocklistConfig:t})=>(e??[]).map((n,i)=>i===o?t:n),removeUrlBlocklist:(e,{index:o})=>(e??[]).filter((t,n)=>n!==o)}],editUrlBlocklistIndex:[null,{setEditUrlBlocklistIndex:(e,{originalIndex:o})=>o,removeUrlBlocklist:(e,{index:o})=>e&&o<e?e-1:o===e?null:e,newUrlBlocklist:()=>-1,updateUrlBlocklist:()=>null,addUrlBlocklist:()=>null}],eventTriggerConfig:[null,{setEventTriggerConfig:(e,{eventTriggerConfig:o})=>o,updateEventTriggerConfig:(e,{eventTriggerConfig:o})=>o}]}),(0,so.selectors)({remoteUrlTriggerConfig:[e=>[e.currentTeam],e=>e?.session_recording_url_trigger_config],isAddUrlTriggerConfigFormVisible:[e=>[e.editUrlTriggerIndex],e=>e===-1],urlTriggerToEdit:[e=>[e.urlTriggerConfig,e.editUrlTriggerIndex],(e,o)=>o===null||o===-1||!e?.[o]?ol:e[o]],remoteUrlBlocklistConfig:[e=>[e.currentTeam],e=>e?.session_recording_url_blocklist_config],isAddUrlBlocklistConfigFormVisible:[e=>[e.editUrlBlocklistIndex],e=>e===-1],urlBlocklistToEdit:[e=>[e.urlBlocklistConfig,e.editUrlBlocklistIndex],(e,o)=>o===null||o===-1||!e?.[o]?ol:e[o]]}),(0,nl.subscriptions)(({actions:e})=>({currentTeam:o=>{e.setUrlTriggerConfig(o?.session_recording_url_trigger_config??[]),e.setUrlBlocklistConfig(o?.session_recording_url_blocklist_config??[]),e.setEventTriggerConfig(o?.session_recording_event_trigger_config??[])}})),(0,tl.forms)(({values:e,actions:o})=>({proposedUrlTrigger:{defaults:{url:"",matching:"regex"},errors:({url:t})=>({url:t?void 0:"Must have a URL"}),submit:async({url:t,matching:n})=>{e.editUrlTriggerIndex!==null&&e.editUrlTriggerIndex>=0?o.updateUrlTrigger(e.editUrlTriggerIndex,{url:Ci(t),matching:n}):o.addUrlTrigger({url:Ci(t),matching:n})}},proposedUrlBlocklist:{defaults:{url:"",matching:"regex"},errors:({url:t})=>({url:t?void 0:"Must have a URL"}),submit:async({url:t,matching:n})=>{e.editUrlBlocklistIndex!==null&&e.editUrlBlocklistIndex>=0?o.updateUrlBlocklist(e.editUrlBlocklistIndex,{url:Ci(t),matching:n}):o.addUrlBlocklist({url:Ci(t),matching:n})}}})),(0,so.sharedListeners)(({values:e})=>({saveUrlTriggers:async()=>{await h.asyncActions.updateCurrentTeam({session_recording_url_trigger_config:e.urlTriggerConfig??[]})},saveUrlBlocklists:async()=>{await h.asyncActions.updateCurrentTeam({session_recording_url_blocklist_config:e.urlBlocklistConfig??[]})}})),(0,so.listeners)(({sharedListeners:e,actions:o,values:t})=>({setEditUrlTriggerIndex:()=>{o.setProposedUrlTriggerValue("url",t.urlTriggerToEdit.url),o.setProposedUrlTriggerValue("matching",t.urlTriggerToEdit.matching)},addUrlTrigger:e.saveUrlTriggers,removeUrlTrigger:e.saveUrlTriggers,updateUrlTrigger:e.saveUrlTriggers,submitProposedUrlTriggerSuccess:()=>{o.setEditUrlTriggerIndex(null),o.resetProposedUrlTrigger()},setEditUrlBlocklistIndex:()=>{o.setProposedUrlBlocklistValue("url",t.urlBlocklistToEdit.url),o.setProposedUrlBlocklistValue("matching",t.urlBlocklistToEdit.matching)},addUrlBlocklist:e.saveUrlBlocklists,removeUrlBlocklist:e.saveUrlBlocklists,updateUrlBlocklist:e.saveUrlBlocklists,submitProposedUrlBlocklistSuccess:()=>{o.setEditUrlBlocklistIndex(null),o.resetProposedUrlBlocklist()},updateEventTriggerConfig:async({eventTriggerConfig:n})=>{o.setEventTriggerConfig(n),await h.asyncActions.updateCurrentTeam({session_recording_event_trigger_config:n})}}))]);c();m();d();var sl=a(Sn()),Uo=a(I());c();m();d();var Si=a(I());c();m();d();var lo=a(I());var il=(0,lo.kea)([(0,lo.path)(["lib","components","InternalSurvey","internalMultipleChoiceSurveyLogicType"]),(0,lo.props)({}),(0,lo.key)(e=>e.surveyId),(0,lo.actions)({getSurveys:()=>({}),setSurvey:e=>({survey:e}),handleSurveys:e=>({surveys:e}),handleSurveyResponse:()=>({}),handleChoiceChange:(e,o)=>({choice:e,isAdded:o}),setShowThankYouMessage:e=>({showThankYouMessage:e}),setThankYouMessage:e=>({thankYouMessage:e}),setOpenChoice:e=>({openChoice:e})}),(0,lo.reducers)({survey:[null,{setSurvey:(e,{survey:o})=>o}],thankYouMessage:["Thank you for your feedback!",{setThankYouMessage:(e,{thankYouMessage:o})=>o}],showThankYouMessage:[!1,{setShowThankYouMessage:(e,{showThankYouMessage:o})=>o}],openChoice:[null,{setOpenChoice:(e,{openChoice:o})=>o}],surveyResponse:[[],{handleChoiceChange:(e,{choice:o,isAdded:t})=>t?[...e,o]:e.filter(n=>n!==o)}]}),(0,lo.listeners)(({actions:e,values:o,props:t})=>({setSurveyId:()=>{},handleSurveys:({surveys:n})=>{let i=n.find(r=>r.id===t.surveyId);i&&(Do.capture("survey shown",{$survey_id:t.surveyId}),e.setSurvey(i),i.appearance?.thankYouMessageHeader&&e.setThankYouMessage(i.appearance?.thankYouMessageHeader))},handleSurveyResponse:()=>{let n={$survey_id:t.surveyId,$survey_response:o.surveyResponse};o.openChoice&&n.$survey_response.push(o.openChoice),Do.capture("survey sent",n),e.setShowThankYouMessage(!0),setTimeout(()=>e.setSurvey(null),5e3)}})),(0,lo.afterMount)(({actions:e})=>{Do.getSurveys(o=>e.handleSurveys(o))})]);var to=a(f());function rl({surveyId:e}){let o=il({surveyId:e}),{survey:t,surveyResponse:n,showThankYouMessage:i,thankYouMessage:r,openChoice:s}=(0,Si.useValues)(o),{handleChoiceChange:l,handleSurveyResponse:g,setOpenChoice:p}=(0,Si.useActions)(o);return t?(0,to.jsx)("div",{className:"Popover Popover--padded Popover--appear-done Popover--enter-done my-4",children:(0,to.jsx)("div",{className:"Popover__box p-4",children:t.questions.map(b=>(0,to.jsxs)("div",{className:"text-sm",children:[i&&r,!i&&(0,to.jsxs)(to.Fragment,{children:[(0,to.jsx)("strong",{children:b.question}),b.type==="multiple_choice"&&(0,to.jsx)("ul",{className:"list-inside list-none mt-2",children:b.choices.map((S,_)=>_===b.choices.length-1&&b.hasOpenChoice?(0,to.jsxs)("div",{className:"mt-2",children:[S,(0,to.jsx)(on,{placeholder:"Please share any additional comments or feedback",onChange:p,value:s??"",className:"my-2"})]},S):(0,to.jsx)("li",{children:(0,to.jsx)(kn,{onChange:y=>l(S,y),label:S,className:"font-normal"})},S))}),(0,to.jsx)(u,{type:"primary",disabledReason:n.length===0&&s===null?"Please select at least one option":!1,onClick:g,children:b.buttonText??"Submit"})]})]},b.question))})}):(0,to.jsx)(to.Fragment,{})}var ll=a(ne());var v=a(f());function Un(e){let o=(0,v.jsxs)("div",{className:(0,sl.default)(e.supported?"bg-fill-success-highlight":"bg-fill-error-highlight","px-1 py-0.5",e.note&&"cursor-pointer"),children:[e.note?(0,v.jsx)(So,{}):e.supported?(0,v.jsx)(ca,{}):(0,v.jsx)(Ct,{})," ",e.label]});return e.note?(0,v.jsx)(be,{title:e.note,children:o}):o}function Fo(e){return(0,v.jsxs)("div",{className:"text-xs inline-flex flex-row bg-primary rounded items-center border overflow-hidden mb-2 w-fit",children:[(0,v.jsx)("span",{className:"px-1 py-0.5 font-semibold",children:"Supported platforms:"}),(0,v.jsx)(Bo,{vertical:!0,className:"h-full"}),(0,v.jsx)(Un,{note:bt(e.web)?e.web.note:void 0,label:"Web",supported:!!e.web}),(0,v.jsx)(Bo,{vertical:!0,className:"h-full"}),(0,v.jsx)(Un,{note:bt(e.android)?e.android.note:void 0,label:"Android",supported:!!e.android}),(0,v.jsx)(Bo,{vertical:!0,className:"h-full"}),(0,v.jsx)(Un,{note:bt(e.ios)?e.ios.note:void 0,label:"iOS",supported:!!e.ios}),(0,v.jsx)(Bo,{vertical:!0,className:"h-full"}),(0,v.jsx)(Un,{note:bt(e.reactNative)?e.reactNative.note:void 0,label:"React Native",supported:!!e.reactNative}),(0,v.jsx)(Bo,{vertical:!0,className:"h-full"}),(0,v.jsx)(Un,{note:bt(e.flutter)?e.flutter.note:void 0,label:"Flutter",supported:!!e.flutter})]})}function gm(){let{updateCurrentTeam:e}=(0,Uo.useActions)(h),{currentTeam:o}=(0,Uo.useValues)(h);return(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{children:"Log capture"}),(0,v.jsx)(Fo,{android:!0,ios:!1,flutter:!1,web:!0,reactNative:!0}),(0,v.jsx)("p",{children:"This setting controls if browser console logs will be captured as a part of recordings. The console logs will be shown in the recording player to help you debug any issues."}),(0,v.jsxs)("p",{children:["Log capture is also available for"," ",(0,v.jsx)(D,{to:"https://posthog.com/docs/session-replay/console-log-recording",target:"_blank",children:"Mobile session replay"})," ",", where they can be configured directly in code."]}),(0,v.jsx)(V,{"data-attr":"opt-in-capture-console-log-switch",onChange:t=>{e({capture_console_log_opt_in:t})},label:"Capture console logs",bordered:!0,checked:!!o?.capture_console_log_opt_in,disabledReason:o?.session_recording_opt_in?void 0:"Session replay must be enabled"})]})}function fm(){let{updateCurrentTeam:e}=(0,Uo.useActions)(h),{currentTeam:o}=(0,Uo.useValues)(h);return(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{children:"Canvas capture"}),(0,v.jsx)(Fo,{android:!1,ios:!1,flutter:{note:(0,v.jsx)(v.Fragment,{children:"If you're using the `canvaskit` renderer on Flutter Web, you must also enable canvas capture"})},web:!0,reactNative:!1}),(0,v.jsxs)("p",{children:["This setting controls if browser canvas elements will be captured as part of recordings."," ",(0,v.jsx)("b",{children:(0,v.jsx)("i",{children:"There is no way to mask canvas elements right now so please make sure they are free of PII."})})]}),(0,v.jsx)("p",{children:"Canvas capture is only available for JavaScript Web."}),(0,v.jsx)(V,{"data-attr":"opt-in-capture-canvas-switch",onChange:t=>{e({session_replay_config:{...o?.session_replay_config,record_canvas:t}})},label:(0,v.jsxs)("div",{className:"space-x-1",children:[(0,v.jsx)(ie,{type:"success",children:"New"}),(0,v.jsx)(Be,{children:"Capture canvas elements"})]}),bordered:!0,checked:o?.session_replay_config?!!o?.session_replay_config?.record_canvas:!1,disabledReason:o?.session_recording_opt_in?void 0:"Session replay must be enabled"})]})}function al(){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("p",{children:"We automatically scrub some sensitive information from network headers and request and response bodies."})," ",(0,v.jsxs)("p",{children:["If they could contain sensitive data, you should provide a function to mask the data when you initialise PostHog."," ",(0,v.jsx)(D,{to:"https://posthog.com/docs/session-replay/network-recording#sensitive-information",target:"blank",children:"Learn how to mask header and body values in our docs"})]})]})}function cl(){let{updateCurrentTeam:e}=(0,Uo.useActions)(h),{currentTeam:o}=(0,Uo.useValues)(h);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(Fo,{android:!0,ios:!0,flutter:!1,web:!0,reactNative:{note:(0,v.jsx)(v.Fragment,{children:"RN network capture is only supported on iOS"})}}),(0,v.jsx)("p",{children:"This setting controls if performance and network information will be captured alongside recordings. The network requests and timings will be shown in the recording player to help you debug any issues."}),(0,v.jsxs)("p",{children:["Network capture is also available for"," ",(0,v.jsx)(D,{to:"https://posthog.com/docs/session-replay/network-recording",target:"_blank",children:"Mobile session replay"})," ",", where they can be configured directly in code."]}),(0,v.jsx)(V,{"data-attr":"opt-in-capture-performance-switch",onChange:t=>{e({capture_performance_opt_in:t})},label:"Capture network performance",bordered:!0,checked:!!o?.capture_performance_opt_in,disabledReason:o?.session_recording_opt_in?void 0:"Session replay must be enabled"}),(0,v.jsxs)("div",{className:"mt-4",children:[(0,v.jsxs)("p",{children:["When network capture is enabled, we always capture network timings. Use these switches to choose whether to also capture headers and payloads of requests."," ",(0,v.jsx)(D,{to:"https://posthog.com/docs/session-replay/network-recording",target:"blank",children:"Learn how to mask header and payload values in our docs"})]}),(0,v.jsx)(fe,{type:"info",className:"mb-4",children:(0,v.jsx)(al,{})}),(0,v.jsx)(Fo,{android:!1,ios:!1,flutter:!1,web:!0,reactNative:!1}),(0,v.jsxs)("div",{className:"flex flex-row space-x-2",children:[(0,v.jsx)(V,{"data-attr":"opt-in-capture-network-headers-switch",onChange:t=>{e({session_recording_network_payload_capture_config:{...o?.session_recording_network_payload_capture_config,recordHeaders:t}})},label:"Capture headers",bordered:!0,checked:o?.session_recording_opt_in?!!o?.session_recording_network_payload_capture_config?.recordHeaders:!1,disabledReason:!o?.session_recording_opt_in||!o?.capture_performance_opt_in?"session and network performance capture must be enabled":void 0}),(0,v.jsx)(V,{"data-attr":"opt-in-capture-network-body-switch",onChange:t=>{t?K.open({maxWidth:"650px",title:"Network body capture",description:(0,v.jsx)(al,{}),primaryButton:{"data-attr":"network-payload-capture-accept-warning-and-enable",children:"Enable body capture",onClick:()=>{e({session_recording_network_payload_capture_config:{...o?.session_recording_network_payload_capture_config,recordBody:!0}})}}}):e({session_recording_network_payload_capture_config:{...o?.session_recording_network_payload_capture_config,recordBody:!1}})},label:"Capture body",bordered:!0,checked:o?.session_recording_opt_in?!!o?.session_recording_network_payload_capture_config?.recordBody:!1,disabledReason:!o?.session_recording_opt_in||!o?.capture_performance_opt_in?"session and network performance capture must be enabled":void 0})]})]})]})}function dl(){return(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)(Fo,{android:!1,ios:!1,flutter:!1,web:!0,reactNative:!1}),(0,v.jsx)("p",{children:"Use the settings below to restrict the domains where recordings will be captured. If no domains are selected, then there will be no domain restriction."}),(0,v.jsx)("p",{children:"Authorized domains is only available for JavaScript Web."}),(0,v.jsxs)("p",{children:["Domains and wildcard subdomains are allowed (e.g. ",(0,v.jsx)("code",{children:"https://*.example.com"}),"). However, wildcarded top-level domains cannot be used (for security reasons)."]}),(0,v.jsx)(mi,{type:"RECORDING_DOMAINS"})]})}function ml(){let{updateCurrentTeam:e}=(0,Uo.useActions)(h),{currentTeam:o}=(0,Uo.useValues)(h);if(!o)return null;let t={opt_in:!1,preferred_events:[],excluded_events:["$feature_flag_called"],included_event_properties:["elements_chain","$window_id","$current_url","$event_type"],important_user_properties:[]},i=(o.session_replay_config||{}).ai_config||t,r=b=>{e({session_replay_config:{ai_config:b}})},{opt_in:s,...l}=i,{opt_in:g,...p}=t;return(0,v.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,v.jsxs)("div",{children:[(0,v.jsxs)("p",{children:["We use several machine learning technologies to process sessions. Some of those are powered by"," ",(0,v.jsx)(D,{to:"https://openai.com/",target:"_blank",children:"OpenAI"}),". No data is sent to OpenAI without an explicit instruction to do so. If we do send data we only send the data selected below. ",(0,v.jsx)("strong",{children:"Data submitted is not used to train OpenAI's models"})]}),(0,v.jsx)(V,{checked:i.opt_in,onChange:b=>{r({...i,opt_in:b})},bordered:!0,label:"Opt in to enable AI processing"})]}),i.opt_in&&(0,v.jsxs)(v.Fragment,{children:[!Yr(l,p)&&(0,v.jsx)("div",{children:(0,v.jsx)(u,{type:"secondary",onClick:()=>r({...t,opt_in:!0}),children:"Reset config to default"})}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,v.jsx)(vt,{className:"text-lg"}),"Preferred events"]}),(0,v.jsx)("p",{children:"These events are treated as more interesting when generating a summary. We recommend you include events that represent value for your user"}),(0,v.jsx)(Ft,{onChange:b=>{r({...i,preferred_events:b})},selectedEvents:i.preferred_events||[],addElement:(0,v.jsx)(u,{size:"small",type:"secondary",icon:(0,v.jsx)(ze,{}),sideIcon:null,children:"Add event"})})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,v.jsx)(vt,{className:"text-lg"}),"Excluded events"]}),(0,v.jsx)("p",{children:"These events are never submitted even when they are present in the session."}),(0,v.jsx)(Ft,{onChange:b=>{r({...i,excluded_events:b})},selectedEvents:i.excluded_events||[],addElement:(0,v.jsx)(u,{size:"small",type:"secondary",icon:(0,v.jsx)(ze,{}),sideIcon:null,children:"Exclude event"})})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,v.jsx)(vt,{className:"text-lg"}),"Included event properties"]}),(0,v.jsx)("p",{children:"We always send the event name and timestamp. The only event data sent are values of the properties selected here."}),(0,v.jsx)(Ot,{taxonomicFilterGroup:"event_properties",sortable:!1,onChange:b=>{r({...i,included_event_properties:b})},selectedProperties:i.included_event_properties||[],addText:"Add property"})]}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,v.jsx)(vt,{className:"text-lg"}),"Important user properties"]}),(0,v.jsx)("p",{children:"We always send the first and last seen dates. The only user data sent are values of the properties selected here."}),(0,v.jsx)(Ot,{taxonomicFilterGroup:"person_properties",sortable:!1,onChange:b=>{r({...i,important_user_properties:b})},selectedProperties:i.important_user_properties||[],addText:"Add property"})]})]})]})}function pl(){let{updateCurrentTeam:e}=(0,Uo.useActions)(h),{currentTeam:o}=(0,Uo.useValues)(h),[t,n]=(0,ll.useState)(!1),i=r=>{e({session_recording_opt_in:r}),n(!r)};return(0,v.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,v.jsxs)("div",{children:[(0,v.jsx)(Fo,{android:!0,ios:!0,flutter:!0,web:!0,reactNative:!0}),(0,v.jsxs)("p",{children:["Watch recordings of how users interact with your web app to see what can be improved."," ",(0,v.jsx)(D,{to:"https://posthog.com/docs/user-guides/recordings?utm_campaign=session-recording&utm_medium=in-product",target:"_blank",children:"Check out our docs"})]}),(0,v.jsx)(V,{"data-attr":"opt-in-session-recording-switch",onChange:r=>{i(r)},label:"Record user sessions",bordered:!0,checked:!!o?.session_recording_opt_in}),t&&(0,v.jsx)(rl,{surveyId:jr})]}),(0,v.jsx)(gm,{}),(0,v.jsx)(fm,{})]})}var O=a(f());function fl({type:e,onCancel:o,isSubmitting:t}){let{addUrlTrigger:n,addUrlBlocklist:i}=(0,ut.useActions)(pt);return(0,O.jsxs)(gl.Form,{logic:pt,formKey:e==="trigger"?"proposedUrlTrigger":"proposedUrlBlocklist",enableFormOnSubmit:!0,className:"w-full flex flex-col border rounded items-center p-2 pl-4 bg-surface-primary gap-2",children:[(0,O.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,O.jsxs)(fe,{type:"info",className:"text-sm",children:["We always wrap the URL regex with anchors to avoid unexpected behavior (if you do not). This is because ",(0,O.jsx)("pre",{className:"inline",children:"https://example.com/"})," does not only match the homepage. You'd need ",(0,O.jsx)("pre",{className:"inline",children:"^https://example.com/$"})]}),(0,O.jsxs)(Be,{className:"w-full",children:["Matching regex:",(0,O.jsx)(X,{name:"url",className:"flex-1",children:(0,O.jsx)(U,{autoFocus:!0,placeholder:"Enter URL regex.","data-attr":"url-input"})})]})]}),(0,O.jsxs)("div",{className:"flex justify-between gap-2 w-full",children:[(0,O.jsx)("div",{children:(0,O.jsxs)(li,{flag:bo.RECORDINGS_AI_REGEX,children:[(0,O.jsx)($a,{onApply:r=>{try{let s={url:r,matching:"regex"};e==="trigger"?n(s):i(s)}catch{we.error("Failed to apply regex")}}}),(0,O.jsx)(Za,{})]})}),(0,O.jsxs)("div",{className:"flex gap-2",children:[(0,O.jsx)(u,{type:"secondary",onClick:o,children:"Cancel"}),(0,O.jsx)(u,{htmlType:"submit",type:"primary",disabledReason:t?"Saving url in progress":void 0,"data-attr":"url-save",children:"Save"})]})]})]})}function ym({trigger:e,index:o,type:t,editIndex:n,onEdit:i,onRemove:r}){return n===o?(0,O.jsx)("div",{className:"border rounded p-2 bg-surface-primary",children:(0,O.jsx)(fl,{type:t,onCancel:()=>i(-1),isSubmitting:!1})}):(0,O.jsxs)("div",{className:(0,ul.default)("border rounded flex items-center p-2 pl-4 bg-surface-primary"),children:[(0,O.jsxs)("span",{title:e.url,className:"flex-1 truncate",children:[(0,O.jsx)("span",{children:e.matching==="regex"?"Matches regex: ":""}),(0,O.jsx)("span",{children:e.url})]}),(0,O.jsxs)("div",{className:"Actions flex space-x-1 shrink-0",children:[(0,O.jsx)(u,{icon:(0,O.jsx)(ga,{}),onClick:()=>i(o),tooltip:"Edit",center:!0}),(0,O.jsx)(u,{icon:(0,O.jsx)(ke,{}),tooltip:`Remove URL ${t}`,center:!0,onClick:()=>{K.open({title:(0,O.jsxs)(O.Fragment,{children:["Remove URL ",t]}),description:`Are you sure you want to remove this URL ${t}?`,primaryButton:{status:"danger",children:"Remove",onClick:()=>r(o)},secondaryButton:{children:"Cancel"}})}})]})]})}function yl({type:e,title:o,description:t,...n}){return(0,O.jsxs)("div",{className:"flex flex-col space-y-2 mt-4",children:[(0,O.jsxs)("div",{className:"flex items-center gap-2 justify-between",children:[(0,O.jsx)(Be,{className:"text-base",children:o}),(0,O.jsx)(u,{onClick:n.onAdd,type:"secondary",icon:(0,O.jsx)(ze,{}),"data-attr":`session-replay-add-url-${e}`,children:"Add"})]}),(0,O.jsx)("p",{children:t}),n.isAddFormVisible&&(0,O.jsx)(fl,{type:e,onCancel:n.onCancel,isSubmitting:n.isSubmitting}),n.config?.map((i,r)=>(0,O.jsx)(ym,{trigger:i,index:r,type:e,editIndex:n.editIndex,onEdit:n.onEdit,onRemove:n.onRemove},`${i.url}-${i.matching}`))]})}function hm(){let{isAddUrlTriggerConfigFormVisible:e,urlTriggerConfig:o,editUrlTriggerIndex:t,isProposedUrlTriggerSubmitting:n}=(0,ut.useValues)(pt),{newUrlTrigger:i,removeUrlTrigger:r,setEditUrlTriggerIndex:s,cancelProposingUrlTrigger:l}=(0,ut.useActions)(pt);return(0,O.jsx)(yl,{type:"trigger",title:"Enable recordings when URL matches",description:"Adding a URL trigger means recording will only be started when the user visits a page that matches the URL.",isAddFormVisible:e,config:o,editIndex:t,isSubmitting:n,onAdd:i,onCancel:l,onEdit:s,onRemove:r})}function bm(){let{isAddUrlBlocklistConfigFormVisible:e,urlBlocklistConfig:o,editUrlBlocklistIndex:t,isProposedUrlBlocklistSubmitting:n}=(0,ut.useValues)(pt),{newUrlBlocklist:i,removeUrlBlocklist:r,setEditUrlBlocklistIndex:s,cancelProposingUrlBlocklist:l}=(0,ut.useActions)(pt);return(0,O.jsx)(yl,{type:"blocklist",title:"Pause recordings when URL matches",description:"Recording will be paused when the user visits a page that matches the URL.",isAddFormVisible:e,config:o,editIndex:t,isSubmitting:n,onAdd:i,onCancel:l,onEdit:s,onRemove:r})}function vm(){let{eventTriggerConfig:e}=(0,ut.useValues)(pt),{updateEventTriggerConfig:o}=(0,ut.useActions)(pt);return(0,O.jsxs)("div",{className:"flex flex-col space-y-2 mt-4",children:[(0,O.jsx)("div",{className:"flex items-center gap-2 justify-between",children:(0,O.jsx)(Be,{className:"text-base",children:"Event emitted"})}),(0,O.jsx)("p",{children:"Session recording will be started immediately before PostHog queues any of these events to be sent to the backend."}),(0,O.jsx)(Ft,{filterGroupTypes:["events"],onChange:t=>{o(t)},selectedEvents:e??[],addElement:(0,O.jsx)(u,{size:"small",type:"secondary",icon:(0,O.jsx)(ze,{}),sideIcon:null,children:"Add event"})})]})}function hl(){return(0,O.jsxs)("div",{className:"space-y-2",children:[(0,O.jsx)(Fo,{android:!1,ios:!1,flutter:!1,web:!0,reactNative:!1}),(0,O.jsx)("p",{children:"Use the settings below to control when recordings are started or paused. If no triggers are selected, then recordings will always start if enabled."}),(0,O.jsx)(hm,{}),(0,O.jsx)(bm,{}),(0,O.jsx)(vm,{})]})}c();m();d();var zn=a(I());var bl=a(ne());var Ze=a(f()),Cm=[{value:"auto",label:(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)("div",{children:"Auto"})})},{value:"v1",label:(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)("div",{children:"Version 1"})})},{value:"v2",label:(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)("div",{children:"Version 2"})})}];function vl(){let{updateCurrentTeam:e}=(0,zn.useActions)(h),{currentTeam:o}=(0,zn.useValues)(h),{reportSessionTableVersionUpdated:t}=(0,zn.useActions)(Je),n=o?.modifiers?.sessionTableVersion??o?.default_modifiers?.sessionTableVersion??"auto",[i,r]=(0,bl.useState)(n),s=l=>{e({modifiers:{...o?.modifiers,sessionTableVersion:l}}),t(l)};return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("p",{children:"Choose which version of the session table to use. V2 is faster, but requires uuidv7 session ids. Use auto unless you know what you're doing."}),(0,Ze.jsx)(qo,{value:i,onChange:r,options:Cm}),(0,Ze.jsx)("div",{className:"mt-4",children:(0,Ze.jsx)(u,{type:"primary",onClick:()=>s(i),disabledReason:i===n?"No changes to save":void 0,children:"Save"})})]})}c();m();d();var co=a(I());var J=a(f());function _i({metric:e}){let{userLoading:o}=(0,co.useValues)(B),{currentTeam:t}=(0,co.useValues)(h),{updateCurrentTeam:n}=(0,co.useActions)(h);return(0,J.jsx)(V,{label:`Capture ${e}`,bordered:!0,checked:t?.autocapture_web_vitals_allowed_metrics?t?.autocapture_web_vitals_allowed_metrics?.includes(e):!0,disabledReason:o?"Loading user":t?.autocapture_web_vitals_opt_in?null:"Enable web vitals autocapture to set allowed metrics",onChange:i=>{if(!t)return;let r=(t?.autocapture_web_vitals_allowed_metrics||["FCP","CLS","INP","LCP"])?.filter(s=>s!==e);n(i?{autocapture_web_vitals_allowed_metrics:[...r,e]}:{autocapture_web_vitals_allowed_metrics:[...r]})}})}function Cl(){let{userLoading:e}=(0,co.useValues)(B),{currentTeam:o}=(0,co.useValues)(h),{updateCurrentTeam:t}=(0,co.useActions)(h),{reportAutocaptureToggled:n}=(0,co.useActions)(Je);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("p",{children:["Automagically capture frontend events, such as any ",(0,J.jsx)("code",{children:"click"}),", ",(0,J.jsx)("code",{children:"change of input"}),", or submission associated with a ",(0,J.jsx)("code",{children:"button"}),", ",(0,J.jsx)("code",{children:"form"}),", ",(0,J.jsx)("code",{children:"input"}),","," ",(0,J.jsx)("code",{children:"select"}),", or ",(0,J.jsx)("code",{children:"textarea"}),", when using our web JavaScript SDK."]}),(0,J.jsxs)("p",{children:["Autocapture is also available for"," ",(0,J.jsx)(D,{to:"https://posthog.com/docs/libraries/react-native#autocapture",target:"_blank",children:"React Native"})," ","and"," ",(0,J.jsx)(D,{to:"https://posthog.com/docs/libraries/ios#autocapture",target:"_blank",children:"iOS"}),", where they can be configured directly in code."]}),(0,J.jsx)("div",{className:"space-y-2",children:(0,J.jsx)(V,{id:"posthog-autocapture-switch",onChange:i=>{t({autocapture_opt_out:!i}),n(!i)},checked:!o?.autocapture_opt_out,disabled:e,label:"Enable autocapture for web",bordered:!0})})]})}function Cr(){let{userLoading:e}=(0,co.useValues)(B),{currentTeam:o}=(0,co.useValues)(h),{updateCurrentTeam:t}=(0,co.useActions)(h),{reportAutocaptureExceptionsToggled:n}=(0,co.useActions)(Je);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("p",{children:"Captures frontend exceptions thrown on a customers using `onError` and `onUnhandledRejection` listeners in our web JavaScript SDK."}),(0,J.jsxs)("p",{children:["Autocapture is also available for our"," ",(0,J.jsx)(D,{to:"https://posthog.com/docs/libraries/react-native#autocapture",target:"_blank",children:"Python SDK"}),", where it can be configured directly in code."]}),(0,J.jsx)(V,{id:"posthog-autocapture-exceptions-switch",onChange:i=>{t({autocapture_exceptions_opt_in:i}),n(i)},checked:!!o?.autocapture_exceptions_opt_in,disabled:e,label:(0,J.jsxs)(J.Fragment,{children:["Enable exception autocapture ",(0,J.jsx)(ie,{children:"ALPHA"})]}),bordered:!0})]})}function Sl(){let{userLoading:e}=(0,co.useValues)(B),{currentTeam:o}=(0,co.useValues)(h),{updateCurrentTeam:t}=(0,co.useActions)(h);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("p",{children:["Since posthog-js version 1.141.2 you can enable"," ",(0,J.jsx)(D,{to:"https://github.com/GoogleChrome/web-vitals",target:"_blank",children:"Google Chrome's web vitals"})," ","collection. Web vitals events can be used in insights, and when web vitals capture is enabled it is used to enhance other parts of PostHog like web analytics and session replay."]}),(0,J.jsx)(V,{id:"posthog-autocapture-web-vitals-switch",onChange:n=>{t({autocapture_web_vitals_opt_in:n})},checked:!!o?.autocapture_web_vitals_opt_in,disabled:e,label:(0,J.jsxs)(J.Fragment,{children:["Enable web vitals autocapture ",(0,J.jsx)(ie,{children:"NEW"})]}),bordered:!0}),(0,J.jsx)(Bo,{}),(0,J.jsx)("p",{children:"You can choose which metrics to capture. By default, we capture all metrics."}),(0,J.jsxs)("div",{className:"inline-grid grid-cols-2 gap-2 xs:grid xs:w-full",children:[(0,J.jsx)(_i,{metric:"CLS"}),(0,J.jsx)(_i,{metric:"FCP"}),(0,J.jsx)(_i,{metric:"LCP"}),(0,J.jsx)(_i,{metric:"INP"})]})]})}c();m();d();var Ti=a(I());var xe=a(f());function Ll(){let{updateCurrentTeam:e}=(0,Ti.useActions)(h),{currentTeam:o,funnelCorrelationConfig:t}=(0,Ti.useValues)(h),n=(i,r,s)=>{if(o){let l={...t};i!==void 0&&(l.excluded_person_property_names=i),s!==void 0&&(l.excluded_event_property_names=s),r!==void 0&&(l.excluded_event_names=r),l&&JSON.stringify(l)!==JSON.stringify(t)&&e({correlation_config:l})}};return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)("p",{children:"Globally exclude events or properties that do not provide relevant signals for your conversions."}),(0,xe.jsx)(fe,{type:"info",children:"Correlation analysis can automatically surface relevant signals for conversion, and help you understand why your users dropped off and what makes them convert."}),o&&(0,xe.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,xe.jsxs)("div",{children:[(0,xe.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,xe.jsx)(Qr,{className:"text-lg"}),"Excluded person properties"]}),(0,xe.jsx)(Ot,{taxonomicFilterGroup:"person_properties",onChange:i=>n(i),selectedProperties:t.excluded_person_property_names||[],addText:"Add exclusion"})]}),(0,xe.jsxs)("div",{children:[(0,xe.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,xe.jsx)(vt,{className:"text-lg"}),"Excluded events"]}),(0,xe.jsx)(Ft,{onChange:i=>n(void 0,i),selectedEvents:t.excluded_event_names||[],addElement:(0,xe.jsx)(u,{size:"small",type:"secondary",icon:(0,xe.jsx)(ze,{}),sideIcon:null,children:"Add exclusion"})})]}),(0,xe.jsxs)("div",{children:[(0,xe.jsxs)("h3",{className:"flex items-center gap-2",children:[(0,xe.jsx)(vt,{className:"text-lg"}),"Excluded event properties"]}),(0,xe.jsx)("div",{className:"max-w-160",children:(0,xe.jsx)(Ve,{mode:"multiple",allowCustomValues:!0,onChange:i=>n(void 0,void 0,i),value:t.excluded_event_property_names||[]})})]})]})]})}c();m();d();var ki=a(I());var wi=a(ne());var no=a(f());function _l(){let{currentTeam:e,currentTeamLoading:o}=(0,ki.useValues)(h),{updateCurrentTeam:t}=(0,ki.useActions)(h),[n,i]=(0,wi.useState)([]);return(0,wi.useEffect)(()=>i(e?.data_attributes||[]),[e]),e?(0,no.jsxs)(no.Fragment,{children:[(0,no.jsxs)("p",{children:["Specify a list of"," ",(0,no.jsx)(D,{to:"https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes",children:"data attributes"})," ","used in your app. For example: ",(0,no.jsx)("code",{children:"data-attr, data-custom-id, data-myref-*"}),". These attributes will be used when using the toolbar and defining actions to match unique elements on your pages. You can use ",(0,no.jsx)("code",{children:"*"})," as a wildcard."]}),(0,no.jsxs)("p",{children:["For example, when creating an action on your CTA button, the best selector could be something like:"," ",(0,no.jsx)("code",{children:"div > form > button:nth-child(2)"}),". However all buttons in your app have a"," ",(0,no.jsx)("code",{children:"data-custom-id"})," attribute. If you allow it here, the selector for your button will instead be ",(0,no.jsx)("code",{children:"button[data-custom-id='cta-button']"}),"."]}),(0,no.jsxs)("div",{className:"space-y-4 max-w-160",children:[(0,no.jsx)(Ve,{mode:"multiple",allowCustomValues:!0,onChange:r=>i(r||[]),value:n,"data-attr":"data-attribute-select",placeholder:"data-attr, ...",loading:o,disabled:o}),(0,no.jsx)(u,{type:"primary",onClick:()=>t({data_attributes:n.map(r=>r.trim()).filter(r=>r)||[]}),children:"Save"})]})]}):(0,no.jsx)(ao,{})}c();m();d();var mn=a(I());c();m();d();var Ii=a(I()),kl=a(He());c();m();d();var tt=a(I()),Tl=a(He());var Sm={name:"",colors:[]},dn=(0,tt.kea)([(0,tt.path)(["scenes","settings","environment","dataColorThemesModalLogic"]),(0,tt.actions)({openModal:e=>({theme:e}),closeModal:!0,addColor:!0,duplicateColor:e=>({index:e}),removeColor:e=>({index:e})}),(0,tt.reducers)({isOpen:[!1,{openModal:()=>!0,closeModal:()=>!1}],theme:[{name:"",colors:[]},{addColor:e=>({...e,colors:[...e.colors||[],e.colors[e.colors.length-1]||"#1d4aff"]}),duplicateColor:(e,{index:o})=>({...e,colors:e.colors.flatMap((t,n)=>n===o?[t,t]:[t])}),removeColor:(e,{index:o})=>({...e,colors:e.colors.filter((t,n)=>n!==o)})}]}),(0,Tl.forms)(({actions:e})=>({theme:{defaults:Sm,submit:async({id:o,name:t,colors:n},i)=>{let r={name:t||"",colors:n||[]};i();try{let s=o?await j.dataColorThemes.update(o,r):await j.dataColorThemes.create(r);return we.success(s?"Theme saved.":"Theme created."),e.closeModal(),s}catch(s){if(s.data?.attr&&s.data?.detail){let l=s.data?.attr?.replace(/_/g," ");we.error(`Error saving data color theme: ${l}: ${s.data.detail}`)}else we.error("Error saving data color theme")}return r},errors:o=>({name:o?.name?void 0:"This field is required"})}})),(0,tt.listeners)(({actions:e})=>({openModal:({theme:o})=>{e.resetTheme(o)}}))]);var Pe=a(f());function wl(){let{theme:e,themeChanged:o,isOpen:t}=(0,Ii.useValues)(dn),{submitTheme:n,closeModal:i,addColor:r,duplicateColor:s,removeColor:l}=(0,Ii.useActions)(dn),g=e?.id==null,p=e?.is_global;return(0,Pe.jsx)($,{title:p?"Official theme":g?"Add theme":"Edit theme",onClose:i,isOpen:t,width:768,footer:p?(0,Pe.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,Pe.jsx)("span",{className:"italic text-secondary",children:"Official themes can't be edited."}),(0,Pe.jsx)(u,{type:"secondary",onClick:i,children:"Close"})]}):(0,Pe.jsx)(u,{type:"primary",onClick:n,children:"Save"}),hasUnsavedInput:o,children:(0,Pe.jsxs)(kl.Form,{logic:dn,formKey:"theme",className:"flex flex-col gap-2",children:[(0,Pe.jsx)(X,{name:"name",label:"Name",children:(0,Pe.jsx)(U,{placeholder:"My custom theme",autoFocus:g,disabled:p})}),(0,Pe.jsx)(Be,{children:"Colors"}),(0,Pe.jsx)(ae,{dataSource:e?.colors?.map((S,_)=>({name:`preset-${_+1}`,color:S,index:_})),columns:[{title:"",dataIndex:"color",key:"glyph",render:(S,{color:_})=>(0,Pe.jsx)(Ha,{color:_}),width:24},{title:"Name",dataIndex:"name",key:"name"},{title:"Color",dataIndex:"color",render:(S,{index:_})=>(0,Pe.jsx)(X,{name:["colors",_],children:(0,Pe.jsx)(U,{className:"max-w-20 font-mono",disabled:p})},_)},{title:"",key:"actions",width:24,render:(S,{index:_})=>p?null:(0,Pe.jsxs)("div",{className:"flex",children:[(0,Pe.jsx)(u,{onClick:()=>s(_),children:(0,Pe.jsx)(ti,{className:"text-lg"})}),(0,Pe.jsx)(u,{onClick:()=>l(_),children:(0,Pe.jsx)(ke,{className:"text-danger text-lg"})})]})}]}),!p&&(0,Pe.jsx)(u,{type:"secondary",className:"self-start",onClick:r,icon:(0,Pe.jsx)(ze,{className:"text-lg"}),children:"Add color"})]})})}c();m();d();var nt=a(I());var Sr=(0,nt.kea)([(0,nt.path)(["scenes","settings","environment","dataColorThemesLogic"]),(0,nt.connect)({values:[cr,["themes","themesLoading","defaultTheme","posthogTheme"]],actions:[dn,["openModal","submitThemeSuccess"],cr,["setThemes"]]}),(0,nt.actions)({selectTheme:e=>({id:e})}),(0,nt.listeners)(({values:e,actions:o})=>({selectTheme:({id:t})=>{if(!(e.themes==null||e.posthogTheme==null||t==null))if(t==="new"){let{id:n,name:i,is_global:r,...s}=e.posthogTheme;o.openModal(s)}else{let n=e.themes.find(i=>i.id===t);o.openModal(n)}},submitThemeSuccess:({theme:t})=>{if(e.themes.find(i=>i.id===t.id)!=null){let i=e.themes.map(r=>r.id===t.id?t:r);o.setThemes(i)}else o.setThemes([...e.themes,t])}}))]);var Mo=a(f());function Il(){let{themes:e,themesLoading:o,defaultTheme:t}=(0,mn.useValues)(Sr),{selectTheme:n}=(0,mn.useActions)(Sr),{currentTeamLoading:i}=(0,mn.useValues)(h),{updateCurrentTeam:r}=(0,mn.useActions)(h),s=e||[];return(0,Mo.jsx)(eo,{feature:"data_color_themes",children:(0,Mo.jsxs)("div",{className:"space-y-4",children:[(0,Mo.jsxs)("p",{children:["These themes can be used in insights. You can also set a default theme for all insights below. For more details, check out our"," ",(0,Mo.jsx)(D,{to:"https://posthog.com/docs/product-analytics/color-themes?utm_campaign=settings&utm_medium=in-product",target:"_blank",children:"docs"}),"."]}),(0,Mo.jsx)(ae,{loading:o,dataSource:s,columns:[{title:"Name",dataIndex:"name",key:"name",render:(l,g)=>(0,Mo.jsx)(nn,{onClick:()=>n(g.id),title:l})},{title:"Official",dataIndex:"is_global",key:"is_global",render:l=>l?(0,Mo.jsx)(la,{className:"text-success text-xl"}):null}]}),(0,Mo.jsx)(u,{type:"secondary",onClick:()=>n("new"),children:"Add theme"}),(0,Mo.jsx)(Be,{id:"default_theme",children:"Default theme"}),(0,Mo.jsx)(ve,{value:t?.id||null,onChange:l=>{let g=s.find(p=>p.id===l);K.open({title:`Change the default data theme to "${g.name}"?`,description:"This changes the default colors used when visualizing data in insights.",primaryButton:{children:"Change default theme",onClick:()=>r({default_data_theme:l})},secondaryButton:{children:"Cancel"}})},loading:o||i,options:s.map(l=>({value:l.id,label:l.name}))}),(0,Mo.jsx)(wl,{})]})})}c();m();d();c();m();d();var Ai=a(I());var Ut=a(f());function Al({inModal:e=!1}){let{updateCurrentTeam:o}=(0,Ai.useActions)(h),{currentTeam:t}=(0,Ai.useValues)(h);return(0,Ut.jsx)("div",{className:"space-y-4",children:(0,Ut.jsxs)("div",{className:"space-y-2",children:[(0,Ut.jsx)(V,{"data-attr":"default-flag-persistence-switch",onChange:n=>{o({flags_persistence_default:n})},label:"Enable flag persistence by default",bordered:!e,fullWidth:e,labelClassName:e?"text-base font-semibold":"",checked:!!t?.flags_persistence_default}),(0,Ut.jsxs)("p",{children:["When enabled, all new feature flags will have persistence enabled by default. This ensures consistent user experiences across authentication steps. Learn more in our"," ",(0,Ut.jsx)(D,{to:"https://posthog.com/docs/feature-flags/creating-feature-flags#persisting-feature-flags-across-authentication-steps",target:"_blank",children:"documentation"}),"."]})]})})}var Tt=a(f());function Rl(){return(0,Tt.jsxs)(Tt.Fragment,{children:[(0,Tt.jsxs)("p",{children:["Configure default behavior for feature flags. Flags can be managed on the"," ",(0,Tt.jsx)(D,{to:ye.featureFlags(),children:"feature flags page"}),"."]}),(0,Tt.jsx)(Al,{})]})}c();m();d();var Vn=a(I());c();m();d();var To=a(I());var Lr=(0,To.kea)([(0,To.path)(["scenes","project","Settings","groupAnalyticsConfigLogic"]),(0,To.connect)({values:[Rn,["groupTypes","groupTypesLoading"]],actions:[Rn,["updateGroupTypesMetadata"]]}),(0,To.actions)({setSingular:(e,o)=>({groupTypeIndex:e,value:o}),setPlural:(e,o)=>({groupTypeIndex:e,value:o}),reset:!0,save:!0}),(0,To.reducers)({singularChanges:[{},{setSingular:(e,{groupTypeIndex:o,value:t})=>({...e,[o]:t}),reset:()=>({}),updateGroupTypesMetadataSuccess:()=>({})}],pluralChanges:[{},{setPlural:(e,{groupTypeIndex:o,value:t})=>({...e,[o]:t}),reset:()=>({}),updateGroupTypesMetadataSuccess:()=>({})}]}),(0,To.selectors)({hasChanges:[e=>[e.singularChanges,e.pluralChanges],(e,o)=>Object.keys(e).length>0||Object.keys(o).length>0]}),(0,To.listeners)(({values:e,actions:o})=>({save:()=>{let{groupTypes:t,singularChanges:n,pluralChanges:i}=e,r=Array.from(t.values()).map(s=>{let l={...s};return n[s.group_type_index]&&(l.name_singular=n[s.group_type_index]),i[s.group_type_index]&&(l.name_plural=i[s.group_type_index]),l});o.updateGroupTypesMetadata(r)}}))]);var ko=a(f());function Nl(){let{groupTypes:e,groupTypesLoading:o,singularChanges:t,pluralChanges:n,hasChanges:i}=(0,Vn.useValues)(Lr),{setSingular:r,setPlural:s,reset:l,save:g}=(0,Vn.useActions)(Lr),{groupsAccessStatus:p}=(0,Vn.useValues)(Ua);if(p===3)return null;let b=[{title:"Group type",tooltip:"As used in code",dataIndex:"group_type",key:"name",render:function(_){return _}},{title:"Singular name",key:"singular",render:function(_,y){return(0,ko.jsx)(U,{value:t[y.group_type_index]||y.name_singular||y.group_type,onChange:C=>r(y.group_type_index,C)})}},{title:"Plural name",key:"plural",render:function(_,y){return(0,ko.jsx)(U,{value:n[y.group_type_index]||y.name_plural||`${y.group_type}(s)`,onChange:C=>s(y.group_type_index,C)})}}];return(0,ko.jsxs)(ko.Fragment,{children:[(0,ko.jsx)("p",{children:"This project has access to group analytics. Below you can configure how various group types are displayed throughout the app."}),p!==2&&(0,ko.jsxs)(fe,{type:"info",className:"mb-4",children:["Group types will show up here after you send your first event associated with a group. Take a look at"," ",(0,ko.jsx)(D,{to:"https://posthog.com/docs/product-analytics/group-analytics",target:"_blank",children:"this guide"}),"for more information on getting started."]}),(0,ko.jsx)(ae,{columns:b,dataSource:Array.from(e.values()),loading:o}),(0,ko.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,ko.jsx)(u,{type:"primary",disabledReason:!i&&"Make some changes before saving",onClick:g,children:"Save"}),(0,ko.jsx)(u,{disabledReason:!i&&"Revert any changes made",onClick:l,children:"Cancel"})]})]})}c();m();d();var pn=a(I());var gt=a(f());function xl(){let{userLoading:e}=(0,pn.useValues)(B),{currentTeam:o}=(0,pn.useValues)(h),{updateCurrentTeam:t}=(0,pn.useActions)(h),{reportHeatmapsToggled:n}=(0,pn.useActions)(Je);return(0,gt.jsxs)(gt.Fragment,{children:[(0,gt.jsxs)("p",{children:["If you use our JavaScript libraries, we can capture general clicks, mouse movements, and scrolling to create heatmaps. No additional events are created, and you can disable this at any time.",(0,gt.jsx)("br",{}),"Whereas Autocapture creates events whenever it can uniquely identify an interacted element, heatmaps are generated based on overall mouse or touch positions and are useful for understanding more general user behavior across your site."]}),(0,gt.jsx)("div",{className:"space-y-2",children:(0,gt.jsx)(V,{id:"posthog-heatmaps-switch",onChange:i=>{t({heatmaps_opt_in:i}),n(i)},checked:!!o?.heatmaps_opt_in,disabled:e,label:"Enable heatmaps for web",bordered:!0})})]})}c();m();d();var Ri=a(I());var kt=a(f());function Ml(){let{updateCurrentTeam:e}=(0,Ri.useActions)(h),{currentTeam:o,currentTeamLoading:t}=(0,Ri.useValues)(h);return(0,kt.jsxs)(kt.Fragment,{children:[(0,kt.jsx)("p",{children:"When comparing against a previous month or year, PostHog will use the same start and end dates as the current period by default. It might be desirable, however, to compare against the same day of the week instead of the same day to account for weekend seasonality. If that's the case for your analysis, you can enable this setting."}),(0,kt.jsx)("p",{children:"In practice, this means that an year comparison becomes a 52 week comparison, and a month comparison becomes a 4 week comparison."}),(0,kt.jsx)(V,{onChange:n=>{e({human_friendly_comparison_periods:n})},checked:!!o?.human_friendly_comparison_periods,disabled:t,label:"Use human friendly comparison periods",bordered:!0})]})}c();m();d();var El=a(I());var wt=a(f());function Pl(){let{preflight:e}=(0,El.useValues)(Ye);return e?.public_egress_ip_addresses?.length?(0,wt.jsxs)(wt.Fragment,{children:[(0,wt.jsx)("p",{children:"Whenever PostHog makes a call to an external service it will come from one of our static IP addresses. If you need to explicitly allowlist these IPs, you can do so by adding them to your firewall rules. This applies to all integrations such as webhooks, apps or batch exports."}),(0,wt.jsx)(Lo,{thing:"IP addresses allowlisting",children:e.public_egress_ip_addresses.join(` 
`)})]}):(0,wt.jsx)("div",{children:"Not supported"})}c();m();d();var Ni=a(I());var Bl=a(f());function Dl(){let{updateCurrentTeam:e}=(0,Ni.useActions)(h),{currentTeam:o,currentTeamLoading:t}=(0,Ni.useValues)(h);return(0,Bl.jsx)(V,{onChange:n=>{e({anonymize_ips:n})},checked:!!o?.anonymize_ips,disabled:t,label:"Discard client IP data",bordered:!0})}c();m();d();var Fl=a(Sn()),un=a(I()),Ul=a(He());var z=a(f()),Ol=3,_m={valid:"live",timed_out:"timed out"};function zl(){let{formState:e,proxyRecords:o,proxyRecordsLoading:t}=(0,un.useValues)(ln),{showForm:n,deleteRecord:i}=(0,un.useActions)(ln),r=ce({minimumAccessLevel:8,scope:"organization"}),s=o.length>=Ol,l=o.filter(p=>!!p.message),g=[{title:"Domain",dataIndex:"domain"},{title:"Status",dataIndex:"status",render:function(b){return b?(0,z.jsxs)("div",{className:(0,Fl.default)("space-x-1",b==="valid"?"text-success":b=="erroring"?"text-danger":"text-warning-dark"),children:[b==="issuing"&&(0,z.jsx)(qt,{}),(0,z.jsx)("span",{className:"capitalize",children:_m[b]||b}),b==="waiting"&&(0,z.jsx)(be,{title:"Waiting for DNS records to be created",children:(0,z.jsx)(So,{className:"cursor-pointer"})}),b==="timed_out"&&(0,z.jsx)(be,{title:"Timed out waiting for DNS records to be created. Please delete the record and try again",children:(0,z.jsx)(So,{className:"cursor-pointer"})})]}):(0,z.jsx)("span",{children:"Unknown"})}},{title:(0,z.jsx)("span",{className:"h-5"}),width:20,className:"flex justify-center",render:function(b,{id:S,status:_}){return _!="deleting"&&!r&&(0,z.jsx)(en,{items:[{label:"Delete",status:"danger",onClick:()=>{K.open({title:"Delete managed proxy",width:"20rem",content:"Are you sure you want to delete this managed proxy? This cannot be undone and if it is in use then events sent to the domain will not be processed.",primaryButton:{status:"danger",onClick:()=>i(S),children:"Delete"},secondaryButton:{children:"Cancel"}})}}],children:(0,z.jsx)(u,{size:"small",icon:(0,z.jsx)(Kt,{className:"text-secondary"})})})}}];return(0,z.jsx)(eo,{feature:"managed_reverse_proxy",children:(0,z.jsxs)("div",{className:"space-y-2",children:[l.map(p=>(0,z.jsx)(fe,{type:"warning",children:(0,z.jsx)(La,{children:`**${p.domain}**
 ${p.message}`})},p.id)),(0,z.jsx)(ae,{loading:o.length===0&&t,columns:g,dataSource:o,expandable:{expandedRowRender:p=>(0,z.jsx)(Tm,{record:p})}}),e==="collapsed"?s?(0,z.jsxs)(fe,{type:"info",children:["There is a maximum of ",Ol," records allowed per organization"]}):(0,z.jsx)("div",{className:"flex",children:(0,z.jsx)(u,{onClick:n,type:"primary",disabledReason:r,children:"Add managed proxy"})}):(0,z.jsx)(km,{})]})})}var Tm=({record:e})=>(0,z.jsx)("div",{className:"pb-4 pr-4",children:(0,z.jsx)(ii,{size:"small",activeKey:"cname",tabs:[{label:"CNAME",key:"cname",content:(0,z.jsx)(Lo,{language:"http",children:e.target_cname},e.id)}]})});function km(){let{formState:e,proxyRecordsLoading:o,proxyRecords:t}=(0,un.useValues)(ln),{collapseForm:n}=(0,un.useActions)(ln),i=t.filter(r=>r.status==="waiting");return(0,z.jsx)("div",{className:"bg-surface-primary rounded border px-5 py-4 space-y-2",children:e=="active"?(0,z.jsxs)(Ul.Form,{logic:ln,formKey:"createRecord",enableFormOnSubmit:!0,className:"w-full space-y-2",children:[(0,z.jsx)(X,{name:"domain",children:(0,z.jsx)(U,{autoFocus:!0,placeholder:"Enter a domain (e.g. ph.mydomain.com)","data-attr":"domain-input"})}),(0,z.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,z.jsx)(u,{type:"secondary",onClick:n,disabledReason:o?"Saving":void 0,children:"Cancel"}),(0,z.jsx)(u,{htmlType:"submit",type:"primary","data-attr":"domain-save",loading:o,children:"Add"})]})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"text-xl font-semibold leading-tight",children:"Almost there"}),(0,z.jsxs)("div",{children:["You need to set the following ",(0,z.jsx)("b",{children:"CNAME"})," records in your DNS provider:"]}),i.map(r=>(0,z.jsxs)("div",{className:"space-y-1",children:[(0,z.jsx)("span",{className:"font-semibold",children:r.domain}),(0,z.jsx)(Lo,{language:"http",children:r.target_cname},r.id)]},r.id)),(0,z.jsx)("div",{className:"flex justify-end",children:(0,z.jsx)(u,{onClick:n,type:"primary",children:"Done"})})]})})}c();m();d();var xi=a(I());var it=a(f());function Vl(){let{integrations:e,integrationsLoading:o}=(0,xi.useValues)(sn),{deleteIntegration:t}=(0,xi.useActions)(sn),n=e?.filter(r=>r.kind!=="slack"),i=r=>{K.open({title:`Do you want to disconnect from this ${r.kind} integration?`,description:"This cannot be undone. PostHog resources configured to use this integration will remain but will stop working.",primaryButton:{children:"Yes, disconnect",status:"danger",onClick:()=>t(r.id)},secondaryButton:{children:"No thanks"}})};return(0,it.jsxs)("div",{children:[(0,it.jsx)("p",{children:"All connected integrations are listed here. These integrations may be used for various purposes, such as data warehouse or pipeline destinations. To connect a new integration, visit the relevant product area."}),(0,it.jsx)("div",{className:"space-y-2",children:n?.length?n.map(r=>(0,it.jsx)(ci,{integration:r,suffix:(0,it.jsx)(u,{type:"secondary",status:"danger",onClick:()=>i(r),icon:(0,it.jsx)(ke,{}),children:"Disconnect"})},r.id)):o?(0,it.jsx)(ao,{className:"h-10"}):(0,it.jsx)("p",{children:"No integrations"})})]})}c();m();d();var Jn=a(I());var Jl=a(ne());var Ie=a(f()),wm=(e,o)=>o.reduce((t,n)=>Ya(n.regex??"")?t.replace(new RegExp(n.regex??"","gi"),n.alias??""):t,e);function Xl(){let[e,o]=(0,Jl.useState)(""),{updateCurrentTeam:t}=(0,Jn.useActions)(h),{currentTeam:n}=(0,Jn.useValues)(h),{hasAvailableFeature:i}=(0,Jn.useValues)(B),r=i("paths_advanced");if(!n)return null;if(!r)return(0,Ie.jsxs)("p",{children:["Advanced path cleaning is a premium feature. Check"," ",(0,Ie.jsx)(D,{to:"https://posthog.com/docs/product-analytics/paths#path-cleaning-rules",children:"our path cleaning rules documentation"})," ","to learn more about it."]});let s=wm(e,n.path_cleaning_filters??[]),l=Qa(s);return(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsxs)("p",{children:["Make your ",(0,Ie.jsx)(D,{to:qa.PATHS,children:"Paths"})," clearer by aliasing one or multiple URLs."," ",(0,Ie.jsxs)("i",{children:["Example: ",(0,Ie.jsx)("code",{children:"http://tenant-one.mydomain.com/accounts"})," and"," ",(0,Ie.jsx)("code",{children:"http://tenant-two.mydomain.com/accounts"})," can become a single ",(0,Ie.jsx)("code",{children:"/accounts"})," ","path."]})]}),(0,Ie.jsxs)("p",{children:["You can check"," ",(0,Ie.jsx)(D,{to:"https://posthog.com/docs/product-analytics/paths#path-cleaning-rules",children:"our path cleaning rules documentation"})," ","to learn more about it."]}),(0,Ie.jsx)("p",{children:"Each rule is composed of an alias and a regex pattern. Any pattern in a URL or event name that matches the regex will be replaced with the alias. Rules are applied in the order that they're listed."}),(0,Ie.jsx)("p",{children:"These will be applied in order. You can reorder them by dragging and dropping."}),(0,Ie.jsx)("p",{children:(0,Ie.jsx)("b",{children:"Rules that you set here will be applied before wildcarding and other regex replacement if path cleaning is switched on in Product and Web Analytics."})}),(0,Ie.jsx)(Ka,{filters:n.path_cleaning_filters,setFilters:g=>t({path_cleaning_filters:g})}),(0,Ie.jsx)("p",{className:"mt-4",children:"Wanna test what your cleaned path will look like? Try them out here."}),(0,Ie.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 items-center justify-center",children:[(0,Ie.jsx)(U,{value:e,onChange:o,placeholder:"Enter a path to test",size:"medium",className:"flex-1"}),"-->",(0,Ie.jsx)("span",{className:"inline-flex items-center justify-start p-2 font-mono text-xs flex-1 border rounded min-h-10",children:l})]})]})}c();m();d();var Mi=a(I());var Ei=a(ne());var jo=a(f());function jl(){let{currentTeam:e}=(0,Mi.useValues)(h),{updateCurrentTeam:o}=(0,Mi.useActions)(h),[t,n]=(0,Ei.useState)([]);return(0,Ei.useEffect)(()=>n(e?.person_display_name_properties||zr),[e]),e?(0,jo.jsxs)(jo.Fragment,{children:[(0,jo.jsxs)("p",{children:["Choose which properties of an identified Person will be used for their ",(0,jo.jsx)("b",{children:"Display Name"}),". The first property to be found on the Person will be used. Drag the items to re-order the priority."]}),(0,jo.jsxs)("div",{className:"space-y-4",children:[(0,jo.jsx)(Ot,{taxonomicFilterGroup:"person_properties",onChange:i=>n(i),selectedProperties:t||[],addText:"Add",sortable:!0}),(0,jo.jsx)(u,{type:"primary",onClick:()=>o({person_display_name_properties:t.map(i=>i.trim()).filter(i=>i)||[]}),children:"Save"})]})]}):(0,jo.jsx)(ao,{className:"w-1/2 h-4"})}c();m();d();var rt=a(I());c();m();d();var wo=a(I()),Wl=a(Dt());var _r=(0,wo.kea)([(0,wo.path)(["scenes","settings","project","sessionReplayIngestionControlLogic"]),(0,wo.actions)({selectFeatureFlag:e=>({flag:e})}),(0,wo.connect)({values:[h,["currentTeam"]],actions:[h,["updateCurrentTeam"]]}),(0,wo.reducers)({selectedFlag:[null,{selectFeatureFlag:(e,{flag:o})=>o}]}),(0,Wl.loaders)(({values:e})=>({featureFlag:{loadFeatureFlag:async()=>{if(e.linkedFeatureFlagId){let o=await j.featureFlags.get(e.linkedFeatureFlagId);return ls(o)}return null}}})),(0,wo.selectors)({linkedFeatureFlagId:[e=>[e.currentTeam],e=>e?.session_recording_linked_flag?.id||null],linkedFlag:[e=>[e.featureFlag,e.selectedFlag,e.currentTeam],(e,o,t)=>t?.session_recording_linked_flag?.id?o||e:null],flagHasVariants:[e=>[e.linkedFlag],e=>bt(e?.filters.multivariate)]}),(0,wo.afterMount)(({actions:e})=>{e.loadFeatureFlag()})]);var W=a(f());function Im(e){return e?[{label:"any",value:"any"},...e.variants.map(o=>({label:o.key,value:o.key}))]:[]}function Am(){let{updateCurrentTeam:e}=(0,rt.useActions)(h),{currentTeam:o}=(0,rt.useValues)(h),{hasAvailableFeature:t}=(0,rt.useValues)(B),n=t("replay_feature_flag_based_recording"),{linkedFlag:i,featureFlagLoading:r,flagHasVariants:s}=(0,rt.useValues)(_r),{selectFeatureFlag:l}=(0,rt.useActions)(_r);return n?(0,W.jsx)(W.Fragment,{children:(0,W.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,W.jsxs)(Be,{className:"text-base",children:["Enable recordings using feature flag ",r&&(0,W.jsx)(qt,{})]}),(0,W.jsx)(Fo,{web:!0,ios:!0,android:!0,reactNative:!0,flutter:!0}),(0,W.jsx)("p",{children:"Linking a flag means that recordings will only be collected for users who have the flag enabled."}),(0,W.jsxs)("div",{className:"flex flex-row justify-start",children:[(0,W.jsx)(cs,{value:o?.session_recording_linked_flag?.id??void 0,onChange:(g,p,b)=>{l(b),e({session_recording_linked_flag:{id:g,key:p,variant:null}})}}),o?.session_recording_linked_flag&&(0,W.jsx)(u,{className:"ml-2",icon:(0,W.jsx)(oi,{}),size:"small",type:"secondary",onClick:()=>e({session_recording_linked_flag:null}),title:"Clear selected flag"})]}),s&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Be,{className:"text-base",children:"Link to a specific flag variant"}),(0,W.jsx)(In,{className:"min-w-1/3",value:o?.session_recording_linked_flag?.variant??"any",options:Im(i?.filters.multivariate),onChange:g=>{i&&e({session_recording_linked_flag:{id:i?.id,key:i?.key,variant:g==="any"?null:g}})}}),(0,W.jsx)("p",{children:'This is a multi-variant flag. You can link to "any" variant of the flag, and recordings will start whenever the flag is enabled for a user.'}),(0,W.jsx)("p",{children:"Alternatively, you can link to a specific variant of the flag, and recordings will only start when the user has that specific variant enabled. Variant targeting support requires posthog-js v1.110.0 or greater"})]})]})}):null}function Gl(){let{updateCurrentTeam:e}=(0,rt.useActions)(h),{currentTeam:o}=(0,rt.useValues)(h),{hasAvailableFeature:t}=(0,rt.useValues)(B),n=t("session_replay_sampling"),i=t("replay_recording_duration_minimum");return(0,W.jsx)(eo,{feature:"session_replay_sampling",children:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("p",{children:["PostHog offers several tools to let you control the number of recordings you collect and which users you collect recordings for."," ",(0,W.jsx)(D,{to:"https://posthog.com/docs/session-replay/how-to-control-which-sessions-you-record",target:"blank",children:"Learn more in our docs."})]}),n&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,W.jsx)(Be,{className:"text-base",children:"Sampling"}),(0,W.jsx)(ve,{onChange:r=>{e({session_recording_sample_rate:r})},dropdownMatchSelectWidth:!1,options:[{label:"100% (no sampling)",value:"1.00"},{label:"95%",value:"0.95"},{label:"90%",value:"0.90"},{label:"85%",value:"0.85"},{label:"80%",value:"0.80"},{label:"75%",value:"0.75"},{label:"70%",value:"0.70"},{label:"65%",value:"0.65"},{label:"60%",value:"0.60"},{label:"55%",value:"0.55"},{label:"50%",value:"0.50"},{label:"45%",value:"0.45"},{label:"40%",value:"0.40"},{label:"35%",value:"0.35"},{label:"30%",value:"0.30"},{label:"25%",value:"0.25"},{label:"20%",value:"0.20"},{label:"15%",value:"0.15"},{label:"10%",value:"0.10"},{label:"5%",value:"0.05"},{label:"0% (replay disabled)",value:"0.00"}],value:typeof o?.session_recording_sample_rate=="string"?o?.session_recording_sample_rate:"1.00"})]}),(0,W.jsx)(Fo,{web:!0}),(0,W.jsx)("p",{children:"Use this setting to restrict the percentage of sessions that will be recorded. This is useful if you want to reduce the amount of data you collect. 100% means all sessions will be collected. 50% means roughly half of sessions will be collected."}),(0,W.jsx)("p",{children:"Sampling is only available for JavaScript Web."})]}),i&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,W.jsx)(Be,{className:"text-base",children:"Minimum session duration (seconds)"}),(0,W.jsx)(ve,{dropdownMatchSelectWidth:!1,onChange:r=>{e({session_recording_minimum_duration_milliseconds:r})},options:Xr,value:o?.session_recording_minimum_duration_milliseconds})]}),(0,W.jsx)(Fo,{web:!0}),(0,W.jsx)("p",{children:"Setting a minimum session duration will ensure that only sessions that last longer than that value are collected. This helps you avoid collecting sessions that are too short to be useful."}),(0,W.jsx)("p",{children:"Minimum session duration is only available for JavaScript Web."})]}),(0,W.jsx)(Am,{})]})})}c();m();d();var Xn=a(I());var Hl=a(ne());var re=a(f()),Rm=()=>({display_information:{name:"PostHog",description:"Product Insights right where you need them",background_color:"#f54e00"},features:{app_home:{home_tab_enabled:!1,messages_tab_enabled:!1,messages_tab_read_only_enabled:!0},bot_user:{display_name:"PostHog",always_online:!1},unfurl_domains:[window.location.hostname]},oauth_config:{redirect_urls:[`${window.location.origin.replace("http://","https://")}/integrations/slack/callback`],scopes:{bot:["channels:read","chat:write","groups:read","links:read","links:write"]}},settings:{event_subscriptions:{request_url:`${window.location.origin.replace("http://","https://")}/api/integrations/slack/events`,bot_events:["link_shared"]},org_deploy_enabled:!1,socket_mode_enabled:!1,token_rotation_enabled:!1}});function Yl(){let{slackIntegrations:e,slackAvailable:o}=(0,Xn.useValues)(sn),{deleteIntegration:t}=(0,Xn.useActions)(sn),[n,i]=(0,Hl.useState)(!1),{user:r}=(0,Xn.useValues)(B),s=l=>{K.open({title:"Do you want to disconnect from Slack?",description:"This cannot be undone. PostHog resources configured to use this Slack workspace will remain but will stop working.",primaryButton:{children:"Yes, disconnect",status:"danger",onClick:()=>{l&&t(l)}},secondaryButton:{children:"No thanks"}})};return(0,re.jsxs)("div",{children:[(0,re.jsxs)("p",{children:["Integrate with Slack directly to get more advanced options such as"," ",(0,re.jsx)("b",{children:"subscribing to an Insight or Dashboard"})," for regular reports to Slack channels of your choice. Guidance on integrating with Slack available"," ",(0,re.jsx)(D,{to:"https://posthog.com/docs/product-analytics/subscriptions#slack-subscriptions",children:"in our docs"}),"."]}),(0,re.jsxs)("div",{className:"space-y-2",children:[e?.map(l=>(0,re.jsx)(ci,{integration:l,suffix:(0,re.jsx)(u,{type:"secondary",status:"danger",onClick:()=>s(l.id),icon:(0,re.jsx)(ke,{}),children:"Disconnect"})},l.id)),(0,re.jsx)("div",{children:o?(0,re.jsx)(D,{to:j.integrations.authorizeUrl({kind:"slack"}),disableClientSideRouting:!0,children:(0,re.jsx)("img",{alt:"Connect to Slack workspace",height:"40",width:"139",src:"https://platform.slack-edge.com/img/add_to_slack.png",srcSet:"https://platform.slack-edge.com/img/add_to_slack.png 1x, https://platform.slack-edge.com/img/add_to_slack@2x.png 2x"})}):r?.is_staff?n?(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)("h5",{children:"To get started"}),(0,re.jsxs)("p",{children:[(0,re.jsxs)("ol",{children:[(0,re.jsx)("li",{children:"Copy the below Slack App Template"}),(0,re.jsxs)("li",{children:["Go to"," ",(0,re.jsx)(D,{to:"https://api.slack.com/apps",target:"_blank",children:"Slack Apps"})]}),(0,re.jsx)("li",{children:"Create an App using the provided template"}),(0,re.jsxs)("li",{children:[(0,re.jsx)(D,{to:ye.instanceSettings(),children:"Go to Instance Settings"})," and update the ",(0,re.jsx)("code",{children:'"SLACK_"'})," properties using the values from the"," ",(0,re.jsx)("b",{children:"App Credentials"})," section of your Slack Apps"]})]}),(0,re.jsx)(Lo,{language:"json",children:JSON.stringify(Rm(),null,2)})]})]}):(0,re.jsx)(re.Fragment,{children:(0,re.jsx)(u,{type:"secondary",onClick:()=>i(!0),children:"Show Instructions"})}):(0,re.jsx)("p",{className:"text-secondary",children:"This PostHog instance is not configured for Slack. Please contact the instance owner to configure it."})})]})]})}c();m();d();var At=a(f());function $l(){return(0,At.jsxs)(At.Fragment,{children:[(0,At.jsxs)("p",{children:["Get qualitative and quantitative data on how your users are doing. Surveys are found in the"," ",(0,At.jsx)(D,{to:ye.surveys(),children:"surveys page"}),"."]}),(0,At.jsx)(ys,{})]})}c();m();d();var po=a(I());c();m();d();var Xe=a(I());var zt=a(ne());c();m();d();var Qe=a(I()),Kl=a(Dt());c();m();d();var mo=a(I()),Zl=a(He()),Ql=a(Dt()),gn=a(or());var at=(0,mo.kea)([(0,mo.path)(["scenes","accessControl","roleBasedAccessControlLogic"]),(0,mo.connect)({values:[Oo,["sortedMembers"],h,["currentTeam"],B,["hasAvailableFeature"]],actions:[Oo,["ensureAllMembersLoaded"]]}),(0,mo.actions)({updateRoleBasedAccessControls:e=>({accessControls:e}),selectRoleId:e=>({roleId:e}),deleteRole:e=>({roleId:e}),removeMemberFromRole:(e,o)=>({role:e,roleMemberId:o}),addMembersToRole:(e,o)=>({role:e,members:o}),setEditingRoleId:e=>({roleId:e})}),(0,mo.reducers)({selectedRoleId:[null,{selectRoleId:(e,{roleId:o})=>o}],editingRoleId:[null,{setEditingRoleId:(e,{roleId:o})=>o}]}),(0,Ql.loaders)(({values:e})=>({roleBasedAccessControls:[null,{loadRoleBasedAccessControls:async()=>await j.get("api/projects/@current/global_access_controls"),updateRoleBasedAccessControls:async({accessControls:o})=>{for(let t of o)await j.put("api/projects/@current/global_access_controls",{...t});return e.roleBasedAccessControls}}],roles:[null,{loadRoles:async()=>(await j.roles.list())?.results||[],addMembersToRole:async({role:o,members:t})=>{if(!e.roles)return null;let n=await Promise.all(t.map(async i=>await j.roles.members.create(o.id,i)));return o.members=[...o.members,...n],[...e.roles]},removeMemberFromRole:async({role:o,roleMemberId:t})=>e.roles?(await j.roles.members.delete(o.id,t),o.members=o.members.filter(n=>n.id!==t),[...e.roles]):null,deleteRole:async({roleId:o})=>{let t=e.roles?.find(n=>n.id===o);return t?(await j.roles.delete(t.id),we.success(`Role "${t.name}" deleted`),e.roles?.filter(n=>n.id!==t.id)||[]):e.roles}}]})),(0,Zl.forms)(({values:e,actions:o})=>({editingRole:{defaults:{name:""},errors:({name:t})=>({name:t?null:"Please choose a name for the role"}),submit:async({name:t})=>{if(!e.editingRoleId)return;let n=null;e.editingRoleId==="new"?n=await j.roles.create(t):n=await j.roles.update(e.editingRoleId,{name:t}),o.loadRoles(),o.setEditingRoleId(null),o.selectRoleId(n.id)}}})),(0,mo.listeners)(({actions:e,values:o})=>({updateRoleBasedAccessControlsSuccess:()=>e.loadRoleBasedAccessControls(),loadRolesSuccess:()=>{gn.router.values.hashParams.role&&e.selectRoleId(gn.router.values.hashParams.role)},deleteRoleSuccess:()=>{e.loadRoles(),e.setEditingRoleId(null),e.selectRoleId(null)},setEditingRoleId:()=>{let t=o.roles?.find(n=>n.id===o.editingRoleId);e.resetEditingRole({name:t?.name||""})}})),(0,mo.selectors)({availableLevels:[e=>[e.roleBasedAccessControls],e=>e?.available_access_levels??[]],defaultAccessLevel:[e=>[e.roleBasedAccessControls],e=>e?.default_access_level??null],defaultResourceAccessControls:[e=>[e.roleBasedAccessControls],e=>({accessControlByResource:(e?.access_controls??[]).filter(n=>!n.role).reduce((n,i)=>({...n,[i.resource]:i}),{})})],rolesWithResourceAccessControls:[e=>[e.roles,e.roleBasedAccessControls,e.defaultResourceAccessControls],(e,o,t)=>{if(!e)return[];let n=o?.access_controls??[];return[t,...e.map(i=>{let r=n.filter(s=>s.role===i.id).reduce((s,l)=>({...s,[l.resource]:l}),{});return{role:i,accessControlByResource:r}})]}],resources:[()=>[],()=>["feature_flag","dashboard","insight","notebook"]],canEditRoleBasedAccessControls:[e=>[e.roleBasedAccessControls],e=>e?.user_can_edit_access_levels??null]}),(0,mo.afterMount)(({actions:e,values:o})=>{o.hasAvailableFeature("role_based_access")&&(e.loadRoles(),e.loadRoleBasedAccessControls(),e.ensureAllMembersLoaded())}),(0,gn.actionToUrl)(({values:e})=>({selectRoleId:()=>{let{currentLocation:o}=gn.router.values;return[o.pathname,o.searchParams,{...o.hashParams,role:e.selectedRoleId??void 0}]}}))]);var Vo=(0,Qe.kea)([(0,Qe.props)({}),(0,Qe.key)(e=>`${e.resource}-${e.resource_id}`),(0,Qe.path)(e=>["scenes","accessControl","accessControlLogic",e]),(0,Qe.connect)({values:[Oo,["sortedMembers"],h,["currentTeam"],at,["roles"],Ko,["guardAvailableFeature"]],actions:[Oo,["ensureAllMembersLoaded"]]}),(0,Qe.actions)({updateAccessControl:e=>({accessControl:e}),updateAccessControlDefault:e=>({level:e}),updateAccessControlRoles:e=>({accessControls:e}),updateAccessControlMembers:e=>({accessControls:e})}),(0,Kl.loaders)(({values:e})=>({accessControls:[null,{loadAccessControls:async()=>{try{return await j.get(e.endpoint)}catch{return{access_controls:[],available_access_levels:["none","viewer","editor"],user_access_level:"none",default_access_level:"none",user_can_edit_access_levels:!1}}},updateAccessControlDefault:async({level:o})=>(await j.put(e.endpoint,{access_level:o}),Do.capture("access control default access level changed",{resource:e.resource,access_level:o,old_access_level:e.accessControlDefault?.access_level}),e.accessControls),updateAccessControlRoles:async({accessControls:o})=>{for(let{role:t,level:n}of o){await j.put(e.endpoint,{role:t,access_level:n});let i=e.accessControlRoles.find(r=>r.role===t);Do.capture("access control role access level changed",{resource:e.resource,action:i?n===null?"removed":"changed":"added",role:t,access_level:n,old_access_level:i?.access_level})}return e.accessControls},updateAccessControlMembers:async({accessControls:o})=>{for(let{member:t,level:n}of o){await j.put(e.endpoint,{organization_member:t,access_level:n});let i=e.accessControlMembers.find(r=>r.organization_member===t);Do.capture("access control member access level changed",{resource:e.resource,action:i?n===null?"removed":"changed":"added",member:t,access_level:n,old_access_level:i?.access_level})}return e.accessControls}}]})),(0,Qe.listeners)(({actions:e})=>({updateAccessControlDefaultSuccess:()=>e.loadAccessControls(),updateAccessControlRolesSuccess:()=>e.loadAccessControls(),updateAccessControlMembersSuccess:()=>e.loadAccessControls()})),(0,Qe.selectors)({resource:[()=>[(e,o)=>o],e=>e.resource],endpoint:[()=>[(e,o)=>o],e=>e.resource==="project"?"api/projects/@current/access_controls":`api/projects/@current/${e.resource}s/${e.resource_id}/access_controls`],humanReadableResource:[()=>[(e,o)=>o],e=>e.resource.replace(/_/g," ")],availableLevelsWithNone:[e=>[e.accessControls],e=>e?.available_access_levels??[]],availableLevels:[e=>[e.availableLevelsWithNone],e=>e.filter(o=>o!=="none")],canEditAccessControls:[e=>[e.accessControls],e=>e?.user_can_edit_access_levels??null],accessControlDefaultLevel:[e=>[e.accessControls],e=>e?.default_access_level??null],accessControlDefaultOptions:[e=>[e.availableLevelsWithNone,(o,t)=>t.resource],e=>e.map(t=>({value:t,label:t==="none"?"No access":Gr(t)}))],accessControlDefault:[e=>[e.accessControls,e.accessControlDefaultLevel],(e,o)=>e?.access_controls?.find(n=>!n.organization_member&&!n.role)??{access_level:o}],organizationAdmins:[e=>[e.sortedMembers],e=>e?.filter(o=>o.level>=8)??[]],organizationAdminsAsAccessControlMembers:[e=>[e.organizationAdmins],e=>e.map(o=>({organization_member:o.id,access_level:"admin",created_by:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),resource:"organization"}))],accessControlMembers:[e=>[e.accessControls,e.organizationAdminsAsAccessControlMembers],(e,o)=>{let t=(e?.access_controls||[]).filter(n=>!!n.organization_member).filter(n=>!o.some(i=>i.organization_member===n.organization_member));return o.concat(t)}],accessControlRoles:[e=>[e.accessControls],e=>(e?.access_controls||[]).filter(o=>!!o.role)],rolesById:[e=>[e.roles],e=>Object.fromEntries((e||[]).map(o=>[o.id,o]))],addableRoles:[e=>[e.roles,e.accessControlRoles],(e,o)=>e?e.filter(t=>!o.find(n=>n.role===t.id)):[]],membersById:[e=>[e.sortedMembers],e=>Object.fromEntries((e||[]).map(o=>[o.id,o]))],addableMembers:[e=>[e.sortedMembers,e.accessControlMembers,e.organizationAdmins],(e,o,t)=>e?e.filter(n=>!o.find(i=>i.organization_member===n.id)&&!t.find(i=>i.id===n.id)):[]]}),(0,Qe.afterMount)(({actions:e})=>{e.loadAccessControls(),e.ensureAllMembersLoaded()})]);var x=a(f());function ql(e){let{canEditAccessControls:o,humanReadableResource:t}=(0,Xe.useValues)(Vo(e)),n=`this ${t}`;return(0,x.jsx)(Xe.BindLogic,{logic:Vo,props:e,children:(0,x.jsxs)("div",{className:"space-y-6",children:[o===!1?(0,x.jsxs)(fe,{type:"warning",children:[(0,x.jsx)("b",{children:"Permission required"}),(0,x.jsx)("br",{}),"You don't have permission to edit access controls for ",n,". You must be the"," ",(0,x.jsx)("i",{children:"creator of it"}),", a ",(0,x.jsx)("i",{children:"Project admin"}),", or an ",(0,x.jsx)("i",{children:"Organization admin"}),"."]}):null,(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("h3",{children:["Default access to ",n]}),(0,x.jsx)(Nm,{})]}),(0,x.jsxs)(eo,{feature:"advanced_permissions",className:"space-y-6",children:[(0,x.jsx)(xm,{}),(0,x.jsx)(eo,{feature:"role_based_access",children:(0,x.jsx)(Mm,{})})]})]})})}function Nm(){let{accessControlDefault:e,accessControlDefaultOptions:o,accessControlsLoading:t,canEditAccessControls:n}=(0,Xe.useValues)(Vo),{updateAccessControlDefault:i}=(0,Xe.useActions)(Vo),{guardAvailableFeature:r}=(0,Xe.useValues)(Ko);return(0,x.jsx)(ve,{placeholder:"Loading...",value:e?.access_level??void 0,onChange:s=>{r("advanced_permissions",()=>{i(s)})},disabledReason:t?"Loading\u2026":n?void 0:"You cannot edit this",dropdownMatchSelectWidth:!1,options:o})}function xm(){let{user:e}=(0,Xe.useValues)(B),{membersById:o,addableMembers:t,accessControlMembers:n,accessControlsLoading:i,availableLevels:r,canEditAccessControls:s}=(0,Xe.useValues)(Vo),{updateAccessControlMembers:l}=(0,Xe.useAsyncActions)(Vo),{guardAvailableFeature:g}=(0,Xe.useValues)(Ko),[p,b]=(0,zt.useState)(!1);if(!e)return null;let S=y=>o[y.organization_member];return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,x.jsx)("h3",{className:"mb-0",children:"Members"}),(0,x.jsx)(u,{type:"primary",onClick:()=>b(!0),disabledReason:s?void 0:"You cannot edit this",children:"Add"})]}),(0,x.jsx)(ae,{columns:[{key:"user",title:"User",render:(y,C)=>(0,x.jsxs)("div",{className:"flex items-center gap-2",children:[(0,x.jsx)(_o,{user:S(C)?.user}),(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"font-medium mb-0",children:S(C)?.user.uuid==e.uuid?`${S(C)?.user.first_name} (you)`:S(C)?.user.first_name}),(0,x.jsx)("p",{className:"text-secondary mb-0",children:S(C)?.user.email})]})]}),sorter:(y,C)=>S(y)?.user.first_name.localeCompare(S(C)?.user.first_name)},{key:"level",title:"Level",width:0,render:function(C,{access_level:P,organization_member:E,resource:Y}){return Y==="organization"?(0,x.jsx)(be,{title:"Organization owners and admins have access to all resources in the organization",children:(0,x.jsx)(ie,{type:"muted",children:"Organization admin"})}):(0,x.jsx)("div",{className:"my-1",children:(0,x.jsx)(Tr,{size:"small",level:P,levels:r,onChange:de=>void l([{member:E,level:de}])})})}},{key:"remove",width:0,render:(y,{organization_member:C,resource:P})=>P==="organization"?null:(0,x.jsx)(ec,{subject:"member",onConfirm:()=>void l([{member:C,level:null}])})}],dataSource:n,loading:i})]}),(0,x.jsx)(oc,{modelOpen:p,setModelOpen:b,placeholder:"Search for team members to add\u2026",onAdd:async(y,C)=>{g("advanced_permissions")&&(await l(y.map(P=>({member:P,level:C}))),b(!1))},options:t.map(y=>({key:y.id,label:`${y.user.first_name} ${y.user.email}`,labelComponent:(0,x.jsx)(rs,{user:y.user})}))})]})}function Mm(){let{accessControlRoles:e,accessControlsLoading:o,addableRoles:t,rolesById:n,availableLevels:i,canEditAccessControls:r}=(0,Xe.useValues)(Vo),{updateAccessControlRoles:s}=(0,Xe.useAsyncActions)(Vo),{guardAvailableFeature:l}=(0,Xe.useValues)(Ko),[g,p]=(0,zt.useState)(!1);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"space-y-2",children:[(0,x.jsxs)("div",{className:"flex gap-2 items-center justify-between",children:[(0,x.jsx)("h3",{className:"mb-0",children:"Roles"}),(0,x.jsx)(u,{type:"primary",onClick:()=>p(!0),disabledReason:r?void 0:"You cannot edit this",children:"Add"})]}),(0,x.jsx)(ae,{columns:[{title:"Role",key:"role",width:0,render:(S,{role:_})=>(0,x.jsx)("span",{className:"whitespace-nowrap",children:(0,x.jsx)(nn,{to:ye.settings("organization-roles")+`#role=${_}`,title:n[_]?.name})})},{title:"Members",key:"members",render:(S,{role:_})=>(0,x.jsx)(si,{people:n[_]?.members?.map(y=>({email:y.user.email,name:y.user.first_name,title:`${y.user.first_name} <${y.user.email}>`}))??[]})},{title:"Level",key:"level",width:0,render:(S,{access_level:_,role:y})=>(0,x.jsx)("div",{className:"my-1",children:(0,x.jsx)(Tr,{size:"small",level:_,levels:i,onChange:C=>void s([{role:y,level:C}])})})},{key:"remove",width:0,render:(S,{role:_})=>(0,x.jsx)(ec,{subject:"role",onConfirm:()=>void s([{role:_,level:null}])})}],dataSource:e,loading:o})]}),(0,x.jsx)(oc,{modelOpen:g,setModelOpen:p,placeholder:"Search for roles to add\u2026",onAdd:async(S,_)=>{l("advanced_permissions")&&(await s(S.map(y=>({role:y,level:_}))),p(!1))},options:t.map(S=>({key:S.id,label:S.name}))})]})}function Tr(e){let{canEditAccessControls:o}=(0,Xe.useValues)(Vo);return(0,x.jsx)(ve,{size:e.size,placeholder:"Select level...",value:e.level,onChange:t=>e.onChange(t),disabledReason:o?void 0:"You cannot edit this",options:e.levels.map(t=>({value:t,label:vo(t??"")}))})}function ec({onConfirm:e,subject:o}){let{canEditAccessControls:t}=(0,Xe.useValues)(Vo);return(0,x.jsx)(u,{icon:(0,x.jsx)(ke,{}),size:"small",disabledReason:t?void 0:"You cannot edit this",onClick:()=>K.open({title:"Remove access",content:`Are you sure you want to remove this ${o}'s explicit access?`,primaryButton:{children:"Remove",status:"danger",onClick:()=>e()}})})}function oc(e){let{availableLevels:o,canEditAccessControls:t}=(0,Xe.useValues)(Vo),[n,i]=(0,zt.useState)([]),[r,s]=(0,zt.useState)(o[0]??null);(0,zt.useEffect)(()=>{s(o[0]??null)},[o]);let l=n.length&&r?()=>void e.onAdd(n,r).then(()=>{i([]),s(o[0]??null)}):void 0;return(0,x.jsx)($,{isOpen:e.modelOpen||!1,onClose:()=>e.setModelOpen(!1),title:"Add access",maxWidth:"30rem",description:"Allow other users or roles to access this resource",footer:(0,x.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,x.jsx)(u,{type:"secondary",onClick:()=>e.setModelOpen(!1),children:"Cancel"}),(0,x.jsx)(u,{type:"primary",onClick:l,disabledReason:t?l?void 0:"Please choose what you want to add and at what level":"You cannot edit this",children:"Add"})]}),children:(0,x.jsxs)("div",{className:"flex gap-2 items-center w-full",children:[(0,x.jsx)("div",{className:"min-w-[16rem] w-full",children:(0,x.jsx)(Ve,{placeholder:e.placeholder,value:n,onChange:g=>i(g),mode:"multiple",options:e.options,disabled:!t})}),(0,x.jsx)(Tr,{levels:o,level:r,onChange:s})]})})}c();m();d();var Vt=a(I()),tc=a(He());var je=a(f());function nc({disabledReason:e}){let{addableMembers:o,allMembersLoading:t,isAddMembersModalOpen:n}=(0,Vt.useValues)(St),{openAddMembersModal:i,closeAddMembersModal:r}=(0,Vt.useActions)(St),{currentTeam:s}=(0,Vt.useValues)(h),{guardAvailableFeature:l}=(0,Vt.useValues)(Ko),{hasAvailableFeature:g}=(0,Vt.useValues)(B);return(0,je.jsxs)(je.Fragment,{children:[(0,je.jsx)(u,{type:"primary","data-attr":"add-project-members-button",onClick:()=>l("advanced_permissions",()=>i(),{isGrandfathered:!g("advanced_permissions")&&s?.access_control}),icon:(0,je.jsx)(ze,{}),disabledReason:e,children:"Add members to project"}),(0,je.jsx)($,{title:"",onClose:r,isOpen:n,simple:!0,children:(0,je.jsxs)(tc.Form,{logic:St,formKey:"addMembers",enableFormOnSubmit:!0,children:[(0,je.jsx)($.Header,{children:(0,je.jsx)("h3",{children:`Adding members${s?.name?` to project ${s.name}`:""}`})}),(0,je.jsxs)($.Content,{className:"space-y-2",children:[(0,je.jsx)(X,{name:"userUuids",children:(0,je.jsx)(Ve,{mode:"multiple",placeholder:"Organization members",loading:t,options:rn(o.map(p=>p.user),"uuid")})}),(0,je.jsx)(X,{name:"level",label:"With project-specific access level",children:(0,je.jsx)(ve,{fullWidth:!0,options:ri.map(p=>({value:p,label:Qo.get(p)}))})})]}),(0,je.jsxs)($.Footer,{children:[(0,je.jsx)(u,{type:"secondary",onClick:r,children:"Cancel"}),(0,je.jsx)(u,{type:"primary","data-attr":"add-project-members-submit",htmlType:"submit",children:"Add members to project"})]})]})})]})}var se=a(f());function Em(e){let{user:o}=(0,po.useValues)(B),{currentTeam:t}=(0,po.useValues)(h),{changeUserAccessLevel:n}=(0,po.useActions)(St),i=di(t)?t.effective_membership_level:null;if(!o)return null;let r=e.organization_level>=8,s=Qo.get(e.level)??`unknown (${e.level})`,l=ri.filter(b=>!tn(i,o,e,b)),g=e.explicit_team_level?l.concat([e.explicit_team_level]):l,p=r?`This user is a member of the project implicitly due to being an organization ${s}.`:tn(i,o,e,l);return p?(0,se.jsx)(be,{title:p,children:(0,se.jsxs)(Ca,{className:"capitalize",children:[e.level===15&&(0,se.jsx)(da,{className:"mr-2"}),s]})}):(0,se.jsx)(ve,{dropdownMatchSelectWidth:!1,onChange:b=>{b!==null&&n(e.user,b)},options:g.map(b=>({value:b,disabled:b===e.explicit_team_level,label:b>e.level?Qo.get(b):Qo.get(b)})),value:e.explicit_team_level})}function Pm(e){let{user:o}=(0,po.useValues)(B),{currentTeam:t}=(0,po.useValues)(h),{removeMember:n}=(0,po.useActions)(St);if(!o)return null;function i(){K.open({title:`${e.user.uuid==o?.uuid?"Leave":`Remove ${e.user.first_name} (${e.user.email}) from`} project ${t?.name}?`,secondaryButton:{children:"Cancel"},primaryButton:{status:"danger",children:e.user.uuid==o?.uuid?"Leave":"Remove",onClick:()=>n({member:e})}})}let r=(t?.effective_membership_level&&t.effective_membership_level>=8||e.user.uuid===o.uuid)&&e.organization_level<as,s=e.user.uuid===o.uuid;return r?(0,se.jsx)(u,{status:"danger",onClick:i,"data-attr":"delete-team-membership",tooltip:s?"Leave project":"Remove from project",children:s?(0,se.jsx)(pa,{}):(0,se.jsx)(oi,{})}):null}function Dm(){let{user:e}=(0,po.useValues)(B),{allMembers:o,allMembersLoading:t}=(0,po.useValues)(St),n=ce({minimumAccessLevel:8,scope:"project"});return e?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("h3",{className:"flex justify-between items-center mt-4",children:["Members with Project Access",(0,se.jsx)(nc,{disabledReason:n})]}),(0,se.jsx)(ae,{columns:[{key:"user_profile_picture",render:function(s,l){return(0,se.jsx)(_o,{user:l.user})},width:32},{title:"Name",key:"user_first_name",render:(r,s)=>s.user.uuid==e.uuid?`${s.user.first_name} (you)`:s.user.first_name,sorter:(r,s)=>r.user.first_name.localeCompare(s.user.first_name)},{title:"Email",key:"user_email",render:(r,s)=>s.user.email,sorter:(r,s)=>r.user.email.localeCompare(s.user.email)},{title:"Level",key:"level",render:function(s,l){return Em(l)},sorter:(r,s)=>r.level-s.level},{title:"Joined\xA0At",dataIndex:"joined_at",key:"joined_at",render:(r,s)=>Pt(s.joined_at),sorter:(r,s)=>r.joined_at.localeCompare(s.joined_at)},{key:"actions",align:"center",render:function(s,l){return Pm(l)}}],dataSource:o,loading:t,"data-attr":"team-members-table"})]}):null}function ic(){let{currentOrganization:e,currentOrganizationLoading:o}=(0,po.useValues)(ee),{currentTeam:t,currentTeamLoading:n}=(0,po.useValues)(h),{migrateAccessControlVersion:i}=(0,po.useActions)(ee),{migrateAccessControlVersionLoading:r}=(0,po.useValues)(ee),{updateCurrentTeam:s}=(0,po.useActions)(h),{guardAvailableFeature:l}=(0,po.useValues)(Ko),g=ce({minimumAccessLevel:8}),p=ai("ROLE_BASED_ACCESS_CONTROL");return p&&t?.access_control_version==="v2"?(0,se.jsx)(ql,{resource:"project",resource_id:`${t?.id}`}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsxs)("p",{children:[p&&(0,se.jsx)(fe,{className:"mb-4",type:"warning",action:{children:"Upgrade now",onClick:()=>i(),loading:r},children:"You're eligible to upgrade to our new access control system. This will allow you to better manage access to your project and resources."}),t?.access_control?(0,se.jsxs)(se.Fragment,{children:["This project is"," ",(0,se.jsxs)("b",{children:[(0,se.jsx)(Tn,{style:{color:"var(--warning)",marginRight:5}}),"private"]}),". Only members listed below are allowed to access it."]}):(0,se.jsxs)(se.Fragment,{children:["This project is"," ",(0,se.jsxs)("b",{children:[(0,se.jsx)(ya,{style:{marginRight:5}}),"open"]}),". Any member of the organization can access it. To enable granular access control, make it private."]})]}),(0,se.jsx)(V,{onChange:b=>{b?l("advanced_permissions",()=>s({access_control:b})):s({access_control:b})},checked:!!t?.access_control,disabledReason:e?t?o?"Loading organization\u2026":n?"Loading project\u2026":g:"Project not loaded":"Organization not loaded",bordered:!0,label:"Make project private"}),t?.access_control&&(0,se.jsx)(Dm,{})]})}c();m();d();var fn=a(I());var wr=a(ne());c();m();d();var jn=a(I());var kr=a(ne());var Me=a(f());function Bm({isOpen:e,setIsOpen:o}){let{currentProject:t,projectBeingDeleted:n}=(0,jn.useValues)(xo),{deleteProject:i}=(0,jn.useActions)(xo),[r,s]=(0,kr.useState)(!1),l=!!t&&n?.id===t.id;return(0,Me.jsxs)($,{title:"Delete the project and its data?",onClose:l?void 0:()=>o(!1),footer:(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(u,{disabledReason:l&&"Deleting...",type:"secondary",onClick:()=>o(!1),children:"Cancel"}),(0,Me.jsx)(u,{type:"secondary",disabled:!r,loading:l,"data-attr":"delete-project-ok",status:"danger",onClick:t?()=>i(t):void 0,children:`Delete ${t?t.name:"the current project"}`})]}),isOpen:e,children:[(0,Me.jsxs)("p",{children:["Project deletion ",(0,Me.jsx)("b",{children:"cannot be undone"}),". You will lose all environments and their data,"," ",(0,Me.jsx)("b",{children:"including events"}),"."]}),(0,Me.jsxs)("p",{children:["Please type ",(0,Me.jsx)("strong",{children:t?t.name:"this project's name"})," to confirm."]}),(0,Me.jsx)(U,{type:"text",onChange:g=>{t&&s(g.toLowerCase()===t.name.toLowerCase())}})]})}function Pi(){let{currentProject:e}=(0,jn.useValues)(xo),[o,t]=(0,kr.useState)(!1),n=ce({minimumAccessLevel:8,scope:"project"});return(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("div",{className:"text-danger",children:(0,Me.jsxs)("div",{className:"mt-4",children:[!n&&(0,Me.jsxs)("p",{className:"text-danger",children:["This is ",(0,Me.jsx)("b",{children:"irreversible"}),". Please be certain."]}),(0,Me.jsxs)(u,{status:"danger",type:"secondary",onClick:()=>t(!0),"data-attr":"delete-project-button",icon:(0,Me.jsx)(ke,{}),disabledReason:n,children:["Delete ",e?.name||"the current project"]})]})}),(0,Me.jsx)(Bm,{isOpen:o,setIsOpen:t})]})}var Le=a(f());function Om({isOpen:e,setIsOpen:o}){let{currentTeam:t,teamBeingDeleted:n}=(0,fn.useValues)(h),{deleteTeam:i}=(0,fn.useActions)(h),[r,s]=(0,wr.useState)(!1),l=!!t&&n?.id===t.id;return(0,Le.jsxs)($,{title:"Delete the environment and its data?",onClose:l?void 0:()=>o(!1),footer:(0,Le.jsxs)(Le.Fragment,{children:[(0,Le.jsx)(u,{disabledReason:l&&"Deleting...",type:"secondary",onClick:()=>o(!1),children:"Cancel"}),(0,Le.jsx)(u,{type:"secondary",disabled:!r,loading:l,"data-attr":"delete-environment-ok",status:"danger",onClick:t?()=>i(t):void 0,children:`Delete ${t?t.name:"the current environment"}`})]}),isOpen:e,children:[(0,Le.jsxs)("p",{children:["Environment deletion ",(0,Le.jsx)("b",{children:"cannot be undone"}),". You will lose all data, ",(0,Le.jsx)("b",{children:"including events"}),"."]}),(0,Le.jsxs)("p",{children:["Please type ",(0,Le.jsx)("strong",{children:t?t.name:"this environment's name"})," to confirm."]}),(0,Le.jsx)(U,{type:"text",onChange:g=>{t&&s(g.toLowerCase()===t.name.toLowerCase())}})]})}function rc(){let{currentTeam:e}=(0,fn.useValues)(h),{featureFlags:o}=(0,fn.useValues)(Zo),[t,n]=(0,wr.useState)(!1),i=ce({minimumAccessLevel:8,scope:"project"});return o[bo.ENVIRONMENTS]?(0,Le.jsx)("i",{children:"Deletion of individual environments is coming soon."}):(0,Le.jsx)(Pi,{})}c();m();d();var Eo=a(I());c();m();d();var ac=a(I());var Di=a(ne()),ft=a(f());function sc({team:e}){let o=`posthog.init('${e?.api_token}',{api_host:'${Ga()}', loaded: () => alert('PostHog is now tracking events!')})`,t=`javascript:(function()%7Bif%20(window.posthog)%20%7Balert(%22Error%3A%20PostHog%20already%20is%20installed%20on%20this%20site%22)%7D%20else%20%7B!function(t%2Ce)%7Bvar%20o%2Cn%2Cp%2Cr%3Be.__SV%7C%7C(window.posthog%3De%2Ce._i%3D%5B%5D%2Ce.init%3Dfunction(i%2Cs%2Ca)%7Bfunction%20g(t%2Ce)%7Bvar%20o%3De.split(%22.%22)%3B2%3D%3Do.length%26%26(t%3Dt%5Bo%5B0%5D%5D%2Ce%3Do%5B1%5D)%2Ct%5Be%5D%3Dfunction()%7Bt.push(%5Be%5D.concat(Array.prototype.slice.call(arguments%2C0)))%7D%7D(p%3Dt.createElement(%22script%22)).type%3D%22text%2Fjavascript%22%2Cp.async%3D!0%2Cp.src%3Ds.api_host%2B%22%2Fstatic%2Farray.js%22%2C(r%3Dt.getElementsByTagName(%22script%22)%5B0%5D).parentNode.insertBefore(p%2Cr)%3Bvar%20u%3De%3Bfor(void%200!%3D%3Da%3Fu%3De%5Ba%5D%3D%5B%5D%3Aa%3D%22posthog%22%2Cu.people%3Du.people%7C%7C%5B%5D%2Cu.toString%3Dfunction(t)%7Bvar%20e%3D%22posthog%22%3Breturn%22posthog%22!%3D%3Da%26%26(e%2B%3D%22.%22%2Ba)%2Ct%7C%7C(e%2B%3D%22%20(stub)%22)%2Ce%7D%2Cu.people.toString%3Dfunction()%7Breturn%20u.toString(1)%2B%22.people%20(stub)%22%7D%2Co%3D%22capture%20identify%20alias%20people.set%20people.set_once%20set_config%20register%20register_once%20unregister%20opt_out_capturing%20has_opted_out_capturing%20opt_in_capturing%20reset%20isFeatureEnabled%20onFeatureFlags%22.split(%22%20%22)%2Cn%3D0%3Bn%3Co.length%3Bn%2B%2B)g(u%2Co%5Bn%5D)%3Be._i.push(%5Bi%2Cs%2Ca%5D)%7D%2Ce.__SV%3D1)%7D(document%2Cwindow.posthog%7C%7C%5B%5D)%3B${encodeURIComponent(o)}%7D%7D)()`,{reportBookmarkletDragged:n}=(0,ac.useActions)(Je),i=(0,Di.useRef)(null);return(0,Di.useEffect)(()=>{i.current?.setAttribute("href",t)},[i.current,t]),(0,ft.jsxs)(ft.Fragment,{children:[(0,ft.jsxs)("a",{ref:i,className:"w-full bg-primary-alt-highlight rounded-lg justify-center p-4 flex font-bold gap-2 items-center",onDragStart:n,children:[(0,ft.jsx)(na,{fontSize:"1.5rem"}),(0,ft.jsx)("span",{className:"text-base",children:"PostHog Bookmarklet"})]}),(0,ft.jsx)("p",{className:"text-center text-secondary font-medium mt-2",children:"Drag to your bookmarks. Do not click on this link. The bookmarklet only works for the current browser session."})]})}var mc=a(ne());c();m();d();var Wn=a(I());var Jt=a(f()),Ir=(e,o)=>`${e.replace(/\//g," / ").replace(/_/g," ")} (UTC${o===0?"\xB1":o>0?"+":"-"}${Math.abs(Math.floor(o))}:${(Math.abs(o%1)*60).toString().padStart(2,"0")})`;function lc(){let{preflight:e}=(0,Wn.useValues)(Ye),{currentTeam:o,timezone:t,currentTeamLoading:n}=(0,Wn.useValues)(h),{updateCurrentTeam:i}=(0,Wn.useActions)(h);if(!e?.available_timezones||!o)return(0,Jt.jsx)(ao,{className:"w-1/2 h-4"});let r=Object.entries(e.available_timezones).map(([s,l])=>({key:s,label:Ir(s,l)}));return(0,Jt.jsx)("div",{className:"max-w-160",children:(0,Jt.jsx)(Ve,{mode:"single",placeholder:"Select a time zone",loading:n,disabled:n,value:[o.timezone],popoverClassName:"z-[1000]",onChange:([s])=>{if(!e?.available_timezones)throw new Error("No timezones are available");let l=e.available_timezones[t],g=e.available_timezones[s];l===g?i({timezone:s}):K.open({title:`Change time zone to ${Ir(s,g)}?`,description:(0,Jt.jsxs)("p",{className:"max-w-120",children:["This time zone has an offset different from the current"," ",(0,Jt.jsx)("strong",{children:Ir(t,l)}),", so queries will need to be recalculated. There will be a difference in date-based time ranges, and in day/week/month buckets."]}),primaryButton:{children:"Change time zone",onClick:()=>i({timezone:s})},secondaryButton:{children:"Cancel"}})},options:r,"data-attr":"timezone-select"})})}c();m();d();var Bi=a(I());var dc=a(f());function cc(){let{currentTeam:e,currentTeamLoading:o}=(0,Bi.useValues)(h),{updateCurrentTeam:t}=(0,Bi.useActions)(h);return(0,dc.jsx)(ve,{value:e?.week_start_day||0,onChange:n=>{K.open({title:`Change the first day of the week to ${n===0?"Sunday":"Monday"}?`,description:"Queries grouped by week will need to be recalculated.",primaryButton:{children:"Change week definition",onClick:()=>t({week_start_day:n})},secondaryButton:{children:"Cancel"}})},loading:o,options:[{value:0,label:"Sunday"},{value:1,label:"Monday"}]})}var N=a(f());function pc(){let{currentTeam:e,currentTeamLoading:o}=(0,Eo.useValues)(h),{updateCurrentTeam:t}=(0,Eo.useActions)(h),{featureFlags:n}=(0,Eo.useValues)(Zo),[i,r]=(0,mc.useState)(e?.name||""),s=n[bo.ENVIRONMENTS]?"environment":"project";return(0,N.jsxs)("div",{className:"space-y-4 max-w-160",children:[(0,N.jsx)(U,{value:i,onChange:r,disabled:o}),(0,N.jsxs)(u,{type:"primary",onClick:()=>t({name:i}),disabled:!i||!e||i===e.name,loading:o,children:["Rename ",s]})]})}function uc(){let{currentTeam:e,currentTeamLoading:o}=(0,Eo.useValues)(h);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("p",{children:["PostHog's configurable web snippet allows you to (optionally) autocapture events, record user sessions, and more with no extra work. Place the following snippet in your website's HTML, ideally just above the"," ",(0,N.jsx)("code",{children:"</head>"})," tag."]}),(0,N.jsxs)("p",{children:["For more guidance, including on identifying users,"," ",(0,N.jsx)(D,{to:"https://posthog.com/docs/libraries/js",children:"see PostHog Docs"}),"."]}),o&&!e?(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)(ao,{className:"w-1/2 h-4"}),(0,N.jsx)(ao,{repeat:3})]}):(0,N.jsx)(hs,{}),(0,N.jsxs)(li,{flag:"remote-config",children:[(0,N.jsxs)("h3",{className:"mt-4 flex items-center gap-2",children:["Web Snippet V2 ",(0,N.jsx)(ie,{type:"warning",children:"Experimental"})]}),(0,N.jsx)("p",{children:"The V2 version of the snippet is more advanced and includes your project config automatically along with the PostHog JS code. This generally leads to faster load times and fewer calls needed before the SDK is fully functional."}),o&&!e?(0,N.jsxs)("div",{className:"space-y-4",children:[(0,N.jsx)(ao,{className:"w-1/2 h-4"}),(0,N.jsx)(ao,{repeat:3})]}):(0,N.jsx)(bs,{})]})]})}function gc(){let{currentTeam:e}=(0,Eo.useValues)(h),{featureFlags:o}=(0,Eo.useValues)(Zo),t=o[bo.ENVIRONMENTS]?"environment":"project";return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("p",{children:"Need to test PostHog on a live site without changing any code?"}),(0,N.jsxs)("p",{children:["Just drag the bookmarklet below to your bookmarks bar, open the website you want to test PostHog on and click it. This will enable our tracking, on the currently loaded page only. The data will show up in this ",t,"."]}),(0,N.jsx)("div",{children:di(e)&&(0,N.jsx)(sc,{team:e})})]})}function fc(){let{currentTeam:e,isTeamTokenResetAvailable:o}=(0,Eo.useValues)(h),{resetToken:t}=(0,Eo.useActions)(h),{currentOrganization:n}=(0,Eo.useValues)(ee),{preflight:i}=(0,Eo.useValues)(Ye),{featureFlags:r}=(0,Eo.useValues)(Zo),s=i?.region,l=()=>{K.open({title:`Reset ${g} API key?`,description:"This will invalidate the current API key and cannot be undone.",primaryButton:{children:"Reset",type:"primary",onClick:t},secondaryButton:{children:"Cancel",type:"secondary"}})},g=r[bo.ENVIRONMENTS]?"environment":"project";return(0,N.jsxs)("div",{className:"flex items-start gap-4 flex-wrap",children:[(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("h3",{id:"project-api-key",className:"min-w-[25rem]",children:[vo(g)," API key"]}),(0,N.jsxs)("p",{children:["You can use this write-only key in any one of"," ",(0,N.jsx)(D,{to:"https://posthog.com/docs/libraries",children:"our libraries"}),"."]}),(0,N.jsx)(Lo,{actions:o?(0,N.jsx)(u,{icon:(0,N.jsx)(ta,{}),noPadding:!0,onClick:l}):void 0,thing:`${g} API key`,children:e?.api_token||""}),(0,N.jsx)("p",{children:"Write-only means it can only create new events. It can't read events or any of your other data stored with PostHog, so it's safe to use in public apps."})]}),(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("h3",{id:"project-id",className:"min-w-[25rem]",children:[vo(g)," ID"]}),(0,N.jsxs)("p",{children:["You can use this ID to reference your ",g," in our"," ",(0,N.jsx)(D,{to:"https://posthog.com/docs/api",children:"API"}),"."]}),(0,N.jsx)(Lo,{thing:`${g} ID`,children:String(e?.id||"")})]}),s?(0,N.jsxs)("div",{className:"flex-1",children:[(0,N.jsxs)("h3",{id:"project-region",className:"min-w-[25rem]",children:[vo(g)," region"]}),(0,N.jsx)("p",{children:"This is the region where your PostHog data is hosted."}),(0,N.jsx)(Lo,{thing:`${g} region`,children:`${s} Cloud`})]}):null,s&&n&&e?(0,N.jsxs)("div",{className:"flex-1 max-w-full",children:[(0,N.jsx)("h3",{id:"debug-info",className:"min-w-[25rem]",children:"Debug information"}),(0,N.jsx)("p",{children:"Include this snippet when creating an issue (feature request or bug report) on GitHub."}),(0,N.jsx)(Lo,{compact:!0,thing:"debug info",children:ja(s,n,e,!1)})]}):null]})}function yc(){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("p",{children:"These settings affect how PostHog displays, buckets, and filters time-series data. You may need to refresh insights for new settings to apply."}),(0,N.jsxs)("div",{className:"space-y-2",children:[(0,N.jsx)(Be,{id:"timezone",children:"Time zone"}),(0,N.jsx)(lc,{}),(0,N.jsx)(Be,{id:"timezone",children:"Week starts on"}),(0,N.jsx)(cc,{})]})]})}function hc(){return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("p",{children:["These are the URLs where you can launch the"," ",(0,N.jsx)("b",{children:(0,N.jsx)(D,{to:ye.toolbarLaunch(),children:"Toolbar"})})]}),(0,N.jsxs)("p",{children:[(0,N.jsx)("b",{children:"Wildcards are not allowed"})," (example: ",(0,N.jsx)("code",{children:"https://*.example.com"}),"). The URL needs to be something concrete that can be launched."]}),(0,N.jsx)(mi,{type:"TOOLBAR_URLS",allowWildCards:!1})]})}c();m();d();var Rt=a(I());var te=a(f());function Fm(e,o){if(!e)return null;let t=["exact","icontains","regex","is_set","in"],n=[];for(let i of e.test_account_filters||[])"operator"in i&&i.operator&&t.includes(i.operator)&&n.push(i);return n.map(i=>i.type&&i.key?i.type==="cohort"?`Cohort ${o[i.value]?.name||i.value}`:aa(i.key,gs[i.type])||i.key:i.key)}function Um(){let{updateCurrentTeam:e}=(0,Rt.useActions)(h),{setTeamDefault:o}=(0,Rt.useActions)(Fa),{reportTestAccountFiltersUpdated:t}=(0,Rt.useActions)(Je),{currentTeam:n,currentTeamLoading:i,testAccountFilterFrequentMistakes:r}=(0,Rt.useValues)(h),{cohortsById:s}=(0,Rt.useValues)(Ja),l=Fm(n,s),{groupsTaxonomicTypes:g}=(0,Rt.useValues)(Rn),p=b=>{e({test_account_filters:b}),t(b)};return(0,te.jsxs)("div",{className:"mb-4 flex flex-col gap-2",children:[(0,te.jsxs)("div",{className:"mb-4 flex flex-col gap-2",children:[(0,te.jsx)(fe,{type:"info",children:'When filtering out internal users by person properties, like email, we recommend creating a Cohort with those properties, and then adding that cohort with a "not in" operator in your \u2018Filter out internal and test users\u2019 settings.'}),!!l&&l.length>0&&(0,te.jsxs)(fe,{type:"warning",className:"m-2",children:[(0,te.jsxs)("p",{children:["You've added an ",(0,te.jsx)("strong",{children:"inclusive"})," filter, which means only matching events will be included. Filters are normally ",(0,te.jsx)("strong",{children:"exclusive"}),", such as ",(0,te.jsx)("i",{children:"does not contain"}),", to filter out unwanted results."]}),(0,te.jsx)("p",{children:"Inclusive filters are currently set for the following properties: "}),(0,te.jsx)("ul",{className:"list-disc",children:l.map((b,S)=>(0,te.jsx)("li",{className:"ml-4",children:b},S))})]}),!!r&&r.length>0&&(0,te.jsxs)(fe,{type:"warning",className:"m-2",children:[(0,te.jsx)("p",{children:"Your filter contains a setting that is likely to exclude or include unexpected users."}),(0,te.jsx)("ul",{className:"list-disc",children:r.map(({key:b,type:S,fix:_},y)=>(0,te.jsxs)("li",{className:"ml-4",children:[b," is a ",S," property, but ",_,"."]},y))})]}),n&&(0,te.jsx)(Va,{pageKey:"testaccountfilters",propertyFilters:n?.test_account_filters,onChange:p,taxonomicGroupTypes:["event_properties","person_properties","event_feature_flags",...g,"cohorts","elements"]})]}),(0,te.jsx)(V,{onChange:b=>{e({test_account_filters_default_checked:b}),o(b)},checked:!!n?.test_account_filters_default_checked,disabled:i,label:"Enable this filter on all new insights",bordered:!0})]})}function bc(){return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("p",{children:["These filters apply only to queries when the toggle is enabled. Adding filters here does not prevent events or recordings being ingested."," ",(0,te.jsx)(D,{to:"https://posthog.com/tutorials/filter-internal-users",children:"Learn more in our docs"}),"."]}),(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("strong",{children:"Example filters"}),(0,te.jsxs)("ul",{className:"list-disc pl-4 mb-2",children:[(0,te.jsxs)("li",{children:['Add a cohort where "',(0,te.jsx)("strong",{children:"Email"})," does not contain ",(0,te.jsx)("strong",{children:"yourcompany.com"}),'" to exclude your team.']}),(0,te.jsxs)("li",{children:['Add "',(0,te.jsx)("strong",{children:"Host"})," does not contain ",(0,te.jsx)("strong",{children:"localhost"}),'" to exclude local environments.']})]})]}),(0,te.jsx)(Um,{})]})}c();m();d();var yn=a(I());var vc=a(ne());var io=a(f()),Cc=()=>{let{userGroups:e,userGroupsLoading:o}=(0,yn.useValues)(xn),{ensureAllGroupsLoaded:t,openGroupCreationForm:n}=(0,yn.useActions)(xn);return(0,vc.useEffect)(()=>{t()},[t]),(0,io.jsxs)("div",{className:"space-y-2",children:[(0,io.jsx)(ae,{size:"small",dataSource:e,loading:o,columns:[{title:"Team",dataIndex:"name",key:"name"},{key:"actions",render:(r,s)=>(0,io.jsx)(zm,{group:s})}],expandable:{noIndent:!0,rowExpandable:r=>r.members.length>0,expandedRowRender:r=>(0,io.jsx)(Vm,{groupId:r.id,members:r.members})}}),(0,io.jsx)(u,{onClick:n,size:"small",type:"primary",children:"Create group"})]})},zm=({group:e})=>{let{addMember:o,deleteUserGroup:t}=(0,yn.useActions)(xn);return(0,io.jsxs)("div",{className:"flex flex-row justify-end space-x-2",children:[(0,io.jsx)(en,{items:[{label:"Delete",status:"danger",onClick:()=>t(e.id)}],children:(0,io.jsx)(u,{icon:(0,io.jsx)(Kt,{}),size:"xsmall"})}),(0,io.jsx)(us,{excludedMembers:e.members.map(n=>n.id),onChange:n=>{n&&o({id:e.id,user:n})},value:null,allowNone:!1,defaultLabel:"Add member",type:"primary",size:"xsmall"})]})},Vm=({groupId:e,members:o})=>{let{removeMember:t}=(0,yn.useActions)(xn);return(0,io.jsx)(ae,{size:"small",showHeader:!1,dataSource:o,columns:[{title:"Members",key:"name",render:function(r,s){return(0,io.jsx)(_o,{user:s,showName:!0})}},{key:"actions",render:(i,r)=>(0,io.jsx)("div",{className:"flex flex-row justify-end",children:(0,io.jsx)(u,{onClick:()=>t({id:e,user:r}),icon:(0,io.jsx)(ua,{}),type:"secondary",status:"danger",size:"xsmall",children:"Remove"})})}],embedded:!0})};c();m();d();var Xt=a(I());var Oi=a(ne());c();m();d();var Nt=a(I()),Sc=a(Dt());function Jm(e){return e.replace(/\/*(?:posthog|slack)?\/?$/,"/slack")}var Ar=(0,Nt.kea)([(0,Nt.path)(["scenes","project","Settings","webhookIntegrationLogic"]),(0,Sc.loaders)(({actions:e})=>({testedWebhook:[null,{testWebhook:async o=>{if(o?.includes("discord.com/")&&(o=Jm(o)),o)try{let t=await j.create("api/user/test_slack_webhook",{webhook:o});if(t.success)return o;e.testWebhookFailure(t.error)}catch(t){e.testWebhookFailure(t.message)}return null}}],removedWebhook:[null,{removeWebhook:()=>(h.actions.updateCurrentTeam({slack_incoming_webhook:""}),null)}]})),(0,Nt.selectors)({loading:[e=>[e.testedWebhookLoading,h.selectors.currentTeamLoading],(e,o)=>e||o]}),(0,Nt.listeners)(()=>({testWebhookSuccess:({testedWebhook:e})=>{e&&h.actions.updateCurrentTeam({slack_incoming_webhook:e})},testWebhookFailure:({error:e})=>{we.error(vo(e))}}))]);var Ue=a(f());function Lc(){let[e,o]=(0,Oi.useState)(""),{testWebhook:t,removeWebhook:n}=(0,Xt.useActions)(Ar),{loading:i}=(0,Xt.useValues)(Ar),{currentTeam:r}=(0,Xt.useValues)(h),{featureFlags:s}=(0,Xt.useValues)(Zo),{openSupportForm:l}=(0,Xt.useActions)(Wa);return(0,Oi.useEffect)(()=>{r?.slack_incoming_webhook&&o(r?.slack_incoming_webhook)},[r]),s[bo.WEBHOOKS_DENYLIST]?(0,Ue.jsx)("div",{children:(0,Ue.jsxs)("p",{children:["Webhooks are currently not available for your organization."," ",(0,Ue.jsx)(D,{onClick:()=>l({kind:"support",target_area:"apps"}),children:"Contact support"})]})}):r?.slack_incoming_webhook?(0,Ue.jsxs)("div",{children:[(0,Ue.jsxs)("p",{children:["Send notifications when selected actions are performed by users.",(0,Ue.jsx)("br",{}),"Guidance on integrating with webhooks available in our docs,"," ",(0,Ue.jsx)(D,{to:"https://posthog.com/docs/webhooks/slack",children:"for Slack"})," and"," ",(0,Ue.jsx)(D,{to:"https://posthog.com/docs/webhooks/microsoft-teams",children:"for Microsoft Teams"}),". Discord is also supported."]}),(0,Ue.jsxs)("div",{className:"space-y-4 max-w-160",children:[(0,Ue.jsx)(U,{value:e,onChange:o,type:"url",placeholder:r?.slack_incoming_webhook?"":"integration disabled - enter URL, then Test & Save",disabled:i,onPressEnter:()=>t(e)}),(0,Ue.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ue.jsx)(u,{type:"primary",disabled:!e,onClick:p=>{p.preventDefault(),t(e)},loading:i,children:"Test & Save"}),(0,Ue.jsx)(u,{status:"danger",type:"secondary",onClick:p=>{p.preventDefault(),n(),o("")},disabled:!r?.slack_incoming_webhook,children:"Clear & Disable"})]})]})]}):(0,Ue.jsx)(Ue.Fragment,{children:(0,Ue.jsxs)("p",{children:["The Webhook integration has been replaced with our new"," ",(0,Ue.jsx)(D,{to:ye.pipeline("destinations"),children:"Pipeline Destinations"})," allowing you to create multiple, highly customizable webhook triggers based off of Actions or Events."]})})}c();m();d();var Gn=a(I());var Io=a(f());function Xm(e,o){let t=new URL(`/signup/${e}`,document.baseURI).href;return o.is_expired?(0,Io.jsx)("b",{children:"Expired \u2013 please recreate"}):(0,Io.jsx)(et,{"data-attr":"invite-link",description:"invite link",children:t})}function jm(e){return function(t,n){return(0,Io.jsx)(u,{title:"Cancel the invite","data-attr":"invite-delete",icon:(0,Io.jsx)(Ct,{}),status:"danger",onClick:()=>{n.is_expired?e(n):K.open({title:"Cancel invite",description:`Do you want to cancel the invite for ${n.target_email}?`,primaryButton:{children:"Yes, cancel invite",status:"danger",onClick:()=>e(n)},secondaryButton:{children:"No, keep invite"}})}})}}function _c(){let{invites:e,invitesLoading:o}=(0,Gn.useValues)(tr),{deleteInvite:t,showInviteModal:n}=(0,Gn.useActions)(tr),{preflight:i}=(0,Gn.useValues)(Ye),r=ce({minimumAccessLevel:8,scope:"organization"}),s=[{key:"user_profile_picture",render:function(g,p){return(0,Io.jsx)(_o,{user:{first_name:p.first_name,email:p.target_email}})},width:32},{title:"Invitee",dataIndex:"target_email",key:"target_email",render:function(g,p){return p.target_email?(0,Io.jsxs)("div",{className:"flex items-center",children:[p.target_email,p.first_name?` (${p.first_name})`:""]}):(0,Io.jsx)("i",{children:"no one"})},width:"20%"},{title:"Level",dataIndex:"level",render:function(g,p){return(0,Io.jsx)(ie,{"data-attr":"invite-membership-level",children:ro[p.level]})}},ms(),ds(),{title:"Invite Link",dataIndex:"id",key:"link",render:(l,g)=>Xm(g.id,g)},{title:"",key:"actions",width:24,render:r?void 0:jm(t)}];return(0,Io.jsxs)("div",{className:"space-y-4",children:[!i?.email_service_available&&(0,Io.jsx)(ss,{}),(0,Io.jsx)(ae,{dataSource:e,columns:s,rowKey:"id",loading:o,"data-attr":"invites-table",emptyState:"There are no outstanding invitations. You can invite another team member above."}),(0,Io.jsx)(u,{type:"primary",onClick:n,"data-attr":"invite-teammate-button",children:"Invite team member"})]})}c();m();d();var Jo=a(I());var Tc=a(ne());var H=a(f());function Wm(e,o){let{user:t}=(0,Jo.useValues)(B),{currentOrganization:n}=(0,Jo.useValues)(ee),{removeMember:i,changeMemberAccessLevel:r}=(0,Jo.useActions)(Oo);if(!t)return null;let s=n?.membership_level??-1,l=(s>=8&&o.level<=s||o.user.uuid===t.uuid)&&o.level!==15,g=n?n.membership_level:null,p=ka.filter(S=>!tn(g,t,o,S)),b=tn(g,t,o,p);return(0,H.jsx)(ni,{overlay:(0,H.jsxs)(H.Fragment,{children:[b?(0,H.jsx)("div",{children:b}):p.map(S=>(0,H.jsx)(u,{fullWidth:!0,onClick:_=>{if(_.preventDefault(),!t)throw Error;S===15?K.open({title:`Add additional owner to ${t.organization?.name}?`,description:`Please confirm that you would like to make ${No(o.user)} an owner of ${t.organization?.name}.`,primaryButton:{status:"danger",children:`Make ${No(o.user)} an owner`,onClick:()=>r(o,S)},secondaryButton:{children:"Cancel"}}):r(o,S)},"data-test-level":S,children:S===15?(0,H.jsx)(H.Fragment,{children:"Make owner"}):S>o.level?(0,H.jsxs)(H.Fragment,{children:["Upgrade to ",Qo.get(S)]}):(0,H.jsxs)(H.Fragment,{children:["Downgrade to ",Qo.get(S)]})},`${o.user.uuid}-level-${S}`)),l?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(Bo,{}),(0,H.jsx)(u,{status:"danger","data-attr":"delete-org-membership",onClick:()=>{if(!t)throw Error;K.open({title:`${o.user.uuid==t.uuid?"Leave":`Remove ${No(o.user)} from`} organization ${t.organization?.name}?`,primaryButton:{children:o.user.uuid==t.uuid?"Leave":"Remove",status:"danger",onClick:()=>i(o)},secondaryButton:{children:"Cancel"}})},fullWidth:!0,children:o.user.uuid!==t.uuid?"Remove from organization":"Leave organization"})]}):null]})})}function kc(){let{filteredMembers:e,membersLoading:o,search:t}=(0,Jo.useValues)(Oo),{currentOrganization:n}=(0,Jo.useValues)(ee),{preflight:i}=(0,Jo.useValues)(Ye),{user:r}=(0,Jo.useValues)(B),{setSearch:s,ensureAllMembersLoaded:l}=(0,Jo.useActions)(Oo),{updateOrganization:g}=(0,Jo.useActions)(ee),{openTwoFactorSetupModal:p}=(0,Jo.useActions)(Nn),b=ce({minimumAccessLevel:8});return(0,Tc.useEffect)(()=>{l()},[]),r?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(U,{type:"search",placeholder:"Search for members",value:t,onChange:s}),(0,H.jsx)(ae,{dataSource:e??[],columns:[{key:"user_profile_picture",render:function(y,C){return(0,H.jsx)(_o,{user:C.user})},width:32},{title:"Name",key:"user_name",render:(_,y)=>y.user.uuid==r.uuid?`${No(y.user)} (you)`:No(y.user),sorter:(_,y)=>No(_.user).localeCompare(No(y.user))},{title:"Email",key:"user_email",render:(_,y)=>(0,H.jsxs)(H.Fragment,{children:[y.user.email,!y.user.is_email_verified&&!y.has_social_auth&&i?.email_service_available&&(0,H.jsxs)(H.Fragment,{children:[" ",(0,H.jsx)(ie,{type:"highlight","data-attr":"pending-email-verification",children:"pending email verification"})]})]}),sorter:(_,y)=>_.user.email.localeCompare(y.user.email)},{title:"Level",dataIndex:"level",key:"level",render:function(y,C){return(0,H.jsx)(ie,{"data-attr":"membership-level",children:vo(Qo.get(C.level)??`unknown (${C.level})`)})},sorter:(_,y)=>_.level-y.level},{title:"2FA",dataIndex:"is_2fa_enabled",key:"is_2fa_enabled",render:function(y,C){return(0,H.jsx)(H.Fragment,{children:(0,H.jsx)(be,{title:C.user.uuid==r.uuid&&!C.is_2fa_enabled?"Click to setup 2FA for your account":"",children:(0,H.jsx)(ie,{onClick:C.user.uuid==r.uuid&&!C.is_2fa_enabled?()=>p():void 0,"data-attr":"2fa-enabled",type:C.is_2fa_enabled?"success":"warning",children:C.is_2fa_enabled?"2FA enabled":"2FA not enabled"})})})},sorter:(_,y)=>_.is_2fa_enabled!=y.is_2fa_enabled?1:0},{title:"Joined",dataIndex:"joined_at",key:"joined_at",render:function(y){return(0,H.jsx)("div",{className:"whitespace-nowrap",children:(0,H.jsx)(lr,{time:y})})},sorter:(_,y)=>_.joined_at.localeCompare(y.joined_at)},{title:"Last Logged In",dataIndex:"last_login",key:"last_login",render:function(y){return(0,H.jsx)("div",{className:"whitespace-nowrap",children:y?(0,H.jsx)(lr,{time:y}):"Never"})},sorter:(_,y)=>new Date(_.last_login??0).getTime()-new Date(y.last_login??0).getTime()},{key:"actions",width:0,render:Wm}],rowKey:"id",style:{marginTop:"1rem"},loading:o,"data-attr":"org-members-table",defaultSorting:{columnKey:"level",order:-1},pagination:{pageSize:50}}),(0,H.jsx)("h3",{className:"mt-4",children:"Two-factor authentication"}),(0,H.jsxs)(eo,{feature:"2fa_enforcement",children:[(0,H.jsx)("p",{children:"Require all organization members to use two-factor authentication."}),(0,H.jsx)(V,{label:"Enforce 2FA",bordered:!0,checked:!!n?.enforce_2fa,onChange:_=>g({enforce_2fa:_}),disabledReason:b})]})]}):null}c();m();d();var Fi=a(I());var Rr=a(f());function wc(){let{currentOrganization:e,currentOrganizationLoading:o}=(0,Fi.useValues)(ee),{updateOrganization:t}=(0,Fi.useActions)(ee),n=ce({minimumAccessLevel:8});return(0,Rr.jsx)("div",{className:"max-w-160",children:(0,Rr.jsx)(V,{label:"Enable PostHog AI data analysis features","data-attr":"organization-ai-enabled",onChange:i=>{t({is_ai_data_processing_approved:i})},checked:!!e?.is_ai_data_processing_approved,disabled:!!n||o,bordered:!0})})}c();m();d();var Hn=a(I());var Nr=a(ne());var De=a(f());function Gm({isOpen:e,setIsOpen:o}){let{currentOrganization:t,organizationBeingDeleted:n}=(0,Hn.useValues)(ee),{deleteOrganization:i}=(0,Hn.useActions)(ee),[r,s]=(0,Nr.useState)(!1),l=!!t&&n?.id===t.id;return(0,De.jsxs)($,{title:"Delete the entire organization?",onClose:l?void 0:()=>o(!1),footer:(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)(u,{disabled:l,type:"secondary",onClick:()=>o(!1),children:"Cancel"}),(0,De.jsx)(u,{type:"secondary",status:"danger",disabled:!r,loading:l,"data-attr":"delete-organization-ok",onClick:t?()=>i(t):void 0,children:`Delete ${t?t.name:"the current organization"}`})]}),isOpen:e,children:[(0,De.jsxs)("p",{children:["Organization deletion ",(0,De.jsx)("b",{children:"cannot be undone"}),". You will lose all data, ",(0,De.jsx)("b",{children:"including all events"}),", related to all projects within this organization."]}),(0,De.jsxs)("p",{children:["Please type"," ",(0,De.jsx)("strong",{children:t?t.name:"this organization's name"})," to confirm."]}),(0,De.jsx)(U,{type:"text",onChange:g=>{t&&s(g.toLowerCase()===t.name.toLowerCase())},"data-attr":"delete-organization-confirmation-input"})]})}function Ic(){let{currentOrganization:e}=(0,Hn.useValues)(ee),[o,t]=(0,Nr.useState)(!1),n=ce({minimumAccessLevel:15,scope:"organization"});return(0,De.jsxs)(De.Fragment,{children:[(0,De.jsxs)("div",{className:"text-danger",children:[!n&&(0,De.jsxs)("p",{className:"text-danger",children:["This is ",(0,De.jsx)("b",{children:"irreversible"}),". Please be certain."]}),(0,De.jsxs)(u,{status:"danger",type:"secondary",onClick:()=>t(!0),"data-attr":"delete-organization-button",icon:(0,De.jsx)(ke,{}),disabledReason:n,children:["Delete ",e?.name||"the current organization"]})]}),(0,De.jsx)(Gm,{isOpen:o,setIsOpen:t})]})}c();m();d();var Ui=a(I());var Ac=a(ne());var Yn=a(f());function Rc(){let{currentOrganization:e,currentOrganizationLoading:o}=(0,Ui.useValues)(ee),{updateOrganization:t}=(0,Ui.useActions)(ee),[n,i]=(0,Ac.useState)(e?.name||""),r=ce({minimumAccessLevel:8});return(0,Yn.jsxs)("div",{className:"max-w-160",children:[(0,Yn.jsx)(U,{className:"mb-4",value:n,onChange:i,disabled:!!r,"data-attr":"organization-name-input-settings"}),(0,Yn.jsx)(u,{type:"primary",onClick:s=>{s.preventDefault(),t({name:n})},disabledReason:r||(n?e?e.name===n?"Name unchanged":void 0:"Organization not loaded":"You must provide a name"),loading:o,children:"Rename organization"})]})}c();m();d();var zi=a(I());var xc=a(f());function Nc(){let{currentOrganization:e}=(0,zi.useValues)(ee),{updateOrganization:o}=(0,zi.useActions)(ee),t=ce({minimumAccessLevel:8});return(0,xc.jsx)(V,{"data-attr":"is-member-join-email-enabled-switch",onChange:n=>{o({is_member_join_email_enabled:n})},checked:!!e?.is_member_join_email_enabled,label:"Email all current members when a new member joins",disabledReason:e?t:"Organization not loaded",bordered:!0})}c();m();d();var Vi=a(I());var Mc=a(ne());var uo=a(f());function Ec(){let{currentOrganization:e,currentOrganizationLoading:o}=(0,Vi.useValues)(ee),{updateOrganization:t}=(0,Vi.useActions)(ee),[n,i]=(0,Mc.useState)(e?.logo_media_id||null),{setFilesToUpload:r,filesToUpload:s,uploading:l}=Xa({onUpload:(p,b,S)=>{i(S)},onError:p=>{we.error(`Error uploading image: ${p}`)}}),g=ce({minimumAccessLevel:8});return(0,uo.jsxs)("div",{className:"space-y-4",children:[(0,uo.jsx)(wn,{accept:"image/*",multiple:!1,onChange:r,loading:l,value:s,disabled:!!g,callToAction:(0,uo.jsxs)(uo.Fragment,{children:[(0,uo.jsxs)("div",{className:"relative",children:[(0,uo.jsx)(es,{name:e?.name||"?",entityId:e?.id||1,mediaId:n,size:"xlarge"}),n&&(0,uo.jsx)("div",{className:"absolute -inset-2 group",children:(0,uo.jsx)(u,{icon:(0,uo.jsx)(Ct,{}),onClick:p=>{i(null),p.preventDefault()},size:"small",tooltip:"Reset back to lettermark",tooltipPlacement:"right",noPadding:!0,className:"group-hover:flex hidden absolute right-0 top-0"})})]}),(0,uo.jsx)(Ln,{className:"text-2xl ml-1"}),(0,uo.jsxs)("div",{children:["Click or drag and drop to upload logo image",(0,uo.jsx)("br",{}),"(192x192 px or larger)"]})]})}),(0,uo.jsx)(u,{type:"primary",onClick:p=>{p.preventDefault(),t({logo_media_id:n})},disabledReason:g||(e?n===e.logo_media_id?"Logo unchanged":void 0:"Organization not loaded"),loading:o||l,children:"Save logo"})]})}c();m();d();c();m();d();var yt=a(I()),Ji=a(He());var Xi=a(ne());var Z=a(f());function Pc({noAccessControls:e}){let{rolesWithResourceAccessControls:o,rolesLoading:t,roleBasedAccessControlsLoading:n,resources:i,availableLevels:r,selectedRoleId:s,defaultAccessLevel:l}=(0,yt.useValues)(at),{updateRoleBasedAccessControls:g,selectRoleId:p,setEditingRoleId:b}=(0,yt.useActions)(at),S=e?[]:i.map(y=>({title:y.replace(/_/g," ")+"s",key:y,width:0,render:(C,{accessControlByResource:P,role:E})=>{let Y=P[y];return(0,Z.jsx)(ve,{size:"small",placeholder:"No override",className:"my-1 whitespace-nowrap",value:E?Y?.access_level:Y?.access_level??l,onChange:de=>g([{resource:y,role:E?.id??null,access_level:de}]),options:r.map(de=>({value:de,label:(0,Ji.capitalizeFirstLetter)(de??"")}))})}})),_=[{title:"Role",key:"role",width:0,render:(y,{role:C})=>(0,Z.jsx)("span",{className:"whitespace-nowrap",children:(0,Z.jsx)(nn,{onClick:C?()=>C.id===s?p(null):p(C.id):void 0,title:C?.name??"Default"})})},{title:"Members",key:"members",render:(y,{role:C})=>C?C.members.length?(0,Z.jsx)(si,{people:C.members.map(P=>({email:P.user.email,name:P.user.first_name,title:`${P.user.first_name} <${P.user.email}>`})),onClick:()=>C.id===s?p(null):p(C.id)}):"No members":"All members"},...S];return(0,Z.jsxs)("div",{className:"space-y-2",children:[(0,Z.jsx)("p",{children:"Use roles to group your organization members and assign them permissions."}),(0,Z.jsx)(eo,{feature:"role_based_access",children:(0,Z.jsxs)("div",{className:"space-y-2",children:[(0,Z.jsx)(ae,{columns:_,dataSource:o,loading:t||n,expandable:{isRowExpanded:({role:y})=>!!s&&y?.id===s,onRowExpand:({role:y})=>y?p(y.id):void 0,onRowCollapse:()=>p(null),expandedRowRender:({role:y})=>y?(0,Z.jsx)(Hm,{roleId:y?.id}):null,rowExpandable:({role:y})=>!!y}}),(0,Z.jsx)(u,{type:"primary",onClick:()=>b("new"),icon:(0,Z.jsx)(ze,{}),children:"Add a role"}),(0,Z.jsx)(Ym,{})]})})]})}function Hm({roleId:e}){let{user:o}=(0,yt.useValues)(B),{sortedMembers:t,roles:n,canEditRoleBasedAccessControls:i}=(0,yt.useValues)(at),{addMembersToRole:r,removeMemberFromRole:s,setEditingRoleId:l}=(0,yt.useActions)(at),[g,p]=(0,Xi.useState)([]),b=n?.find(y=>y.id===e),S=g.length?()=>{b&&r(b,g),p([])}:void 0,_=(0,Xi.useMemo)(()=>{let y=new Set(b?.members.map(C=>C.user.uuid));return t?.filter(C=>!y.has(C.user.uuid))??[]},[b?.members,t]);return b?(0,Z.jsxs)("div",{className:"my-2 pr-2 space-y-2",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2 justify-between min-h-10",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Z.jsx)("div",{className:"min-w-[16rem]",children:(0,Z.jsx)(Ve,{placeholder:"Search for members to add...",value:g,onChange:y=>p(y),mode:"multiple",disabled:!i,options:rn(_.map(y=>y.user),"uuid")})}),(0,Z.jsx)(u,{type:"primary",onClick:S,disabledReason:i?S?void 0:"Please select members to add":"You cannot edit this",children:"Add members"})]}),(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsx)(u,{type:"secondary",onClick:()=>l(b.id),disabledReason:i?void 0:"You cannot edit this",children:"Edit"})})]}),(0,Z.jsx)(ae,{columns:[{key:"user_profile_picture",render:function(C,P){return(0,Z.jsx)(_o,{user:P.user})},width:32},{title:"Name",key:"user_name",render:(y,C)=>C.user.uuid==o?.uuid?`${No(C.user)} (you)`:No(C.user),sorter:(y,C)=>No(y.user).localeCompare(No(C.user))},{title:"Email",key:"user_email",render:(y,C)=>(0,Z.jsx)(Z.Fragment,{children:C.user.email}),sorter:(y,C)=>y.user.email.localeCompare(C.user.email)},{key:"actions",width:0,render:(y,C)=>(0,Z.jsx)("div",{className:"flex items-center gap-2",children:(0,Z.jsx)(u,{status:"danger",size:"small",type:"tertiary",disabledReason:i?void 0:"You cannot edit this",onClick:()=>s(b,C.id),children:"Remove"})})}],dataSource:b.members})]}):null}function Ym(){let{editingRoleId:e}=(0,yt.useValues)(at),{setEditingRoleId:o,submitEditingRole:t,deleteRole:n}=(0,yt.useActions)(at),i=e!=="new",r=()=>{K.open({title:"Delete role",content:"Are you sure you want to delete this role? This action cannot be undone.",primaryButton:{children:"Delete permanently",onClick:()=>n(e),status:"danger"},secondaryButton:{children:"Cancel"}})};return(0,Z.jsx)(Ji.Form,{logic:at,formKey:"editingRole",enableFormOnSubmit:!0,children:(0,Z.jsx)($,{isOpen:!!e,onClose:()=>o(null),title:i?"Edit":"Create",footer:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"flex-1",children:i?(0,Z.jsx)(u,{type:"secondary",status:"danger",onClick:()=>r(),children:"Delete"}):null}),(0,Z.jsx)(u,{type:"secondary",onClick:()=>o(null),children:"Cancel"}),(0,Z.jsx)(u,{type:"primary",htmlType:"submit",onClick:t,children:i?"Save":"Create"})]}),children:(0,Z.jsx)(X,{label:"Role name",name:"name",children:(0,Z.jsx)(U,{placeholder:"Please enter a name...",autoFocus:!0})})})})}c();m();d();var jt=a(I());c();m();d();var $n=a(I());var Dc=a(ne());var ue=a(f());function Bc(){let{roleInFocus:e,createRoleModalShown:o,roleMembersToAdd:t,roleMembersInFocusLoading:n,addableMembers:i,rolesLoading:r,roleMembersInFocus:s}=(0,$n.useValues)(an),{setCreateRoleModalShown:l,setRoleMembersToAdd:g,createRole:p,deleteRoleMember:b,addRoleMembers:S,deleteRole:_}=(0,$n.useActions)(an),{isAdminOrOwner:y}=(0,$n.useValues)(ee),[C,P]=(0,Dc.useState)(""),E=!e,Y=()=>{l(!1),g([])},de=()=>{p(C),P("")};return(0,ue.jsxs)($,{onClose:Y,isOpen:o,title:E?"Create role":y?`Edit ${e.name} role`:`${e.name} role`,footer:r?(0,ue.jsx)(qt,{textColored:!0}):y?(0,ue.jsxs)("div",{className:"flex flex-row justify-between w-full",children:[(0,ue.jsx)("div",{children:!E&&(0,ue.jsx)(u,{htmlType:"submit",type:"secondary",status:"danger",onClick:()=>_(e),"data-attr":"role-delete-submit",children:"Delete role"})}),E&&(0,ue.jsx)(u,{type:"primary",onClick:de,children:"Save"})]}):void 0,children:[E&&(0,ue.jsxs)("div",{className:"mb-5",children:[(0,ue.jsx)("h5",{children:"Role Name"}),(0,ue.jsx)(U,{placeholder:"Product",autoFocus:!0,value:C,onChange:P})]}),y&&(0,ue.jsxs)("div",{className:"mb-5",children:[(0,ue.jsx)("h5",{children:"Members"}),(0,ue.jsxs)("div",{className:"flex gap-2",children:[(0,ue.jsx)("div",{className:"flex-1",children:(0,ue.jsx)(Ve,{placeholder:"Search for team members to add\u2026",value:t,loading:n,onChange:_e=>g(_e),mode:"multiple","data-attr":"subscribed-emails",options:rn(i,"uuid")})}),!E&&(0,ue.jsx)(u,{type:"primary",loading:n,disabled:t.length===0,onClick:()=>S({role:e,membersToAdd:t}),children:"Add"})]})]}),!E&&(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)("h5",{children:"Role Members"}),s.length>0?(0,ue.jsx)("div",{className:"mt-2 pb-2 rounded overflow-y-auto max-h-80",children:s.map(_e=>(0,ue.jsx)($m,{member:_e,deleteMember:qe=>b({roleMemberUuid:qe}),isAdminOrOwner:!!y},_e.id))}):(0,ue.jsx)("div",{className:"text-secondary mb-2",children:"No members added yet"})]})]})}function $m({member:e,deleteMember:o,isAdminOrOwner:t}){let{user:n}=e;return(0,ue.jsxs)("div",{className:"flex items-center justify-between mt-2 h-8",children:[(0,ue.jsx)(_o,{user:n,size:"md",showName:!0}),t&&o&&(0,ue.jsx)(u,{icon:(0,ue.jsx)(ke,{}),onClick:()=>o(e.id),tooltip:"Remove user from role",type:"tertiary",size:"small"})]})}c();m();d();function Oc(e){switch(e){case"feature flags":return"flag";default:return"resource"}}var ge=a(f());function Fc(){let{resourceRolesAccess:e,organizationResourcePermissionsLoading:o}=(0,jt.useValues)(fr),{updatePermission:t}=(0,jt.useActions)(fr),{roles:n,rolesLoading:i}=(0,jt.useValues)(an),{setRoleInFocus:r,openCreateRoleModal:s}=(0,jt.useActions)(an),{isAdminOrOwner:l}=(0,jt.useValues)(ee),g=ce({minimumAccessLevel:8,scope:"organization"}),p=[{key:"role",title:"",width:150,render:function(S,_){return(0,ge.jsx)(ge.Fragment,{children:_.name=="organization_default"?(0,ge.jsx)("b",{children:"All users by default"}):(0,ge.jsx)(u,{noPadding:!0,onClick:()=>r(_),children:_.name})})}},...e.flatMap(b=>{let S=Object.keys(b)[0];return[{key:"view",title:(0,ge.jsx)(be,{title:"View defaults cannot be changed",children:(0,ge.jsxs)("div",{className:"text-center",children:[S," ",(0,ge.jsx)("br",{})," View"]})}),align:"center",render:function(){return(0,ge.jsx)("div",{className:"flex justify-center",children:(0,ge.jsx)(kn,{defaultChecked:!0,disabled:!0,color:"gray"})})}},{key:"edit",title:(0,ge.jsx)(is,{icon:(0,ge.jsx)(be,{title:`You can extend permissions on a per ${Oc(S)} basis.`,children:(0,ge.jsx)(So,{})}),children:(0,ge.jsxs)(ge.Fragment,{children:[S," ",(0,ge.jsx)("br",{})," Edit"]})}),align:"center",render:function(y,C){return(0,ge.jsx)("div",{className:"flex justify-center",children:(0,ge.jsx)(kn,{onChange:P=>{t(P,C,b[S].id,S)},checked:b[`${S}`][C.name]>=37,disabled:!l,color:l?"":"gray"})})}}]})];return(0,ge.jsx)(eo,{feature:"role_based_access",children:(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{className:"flex flex-row justify-between items-center mb-4",children:(0,ge.jsx)("div",{className:"text-secondary",children:"Edit organizational default permission levels for PostHog resources. Use roles to apply permissions to specific sets of users."})}),(0,ge.jsx)(ae,{columns:p,loading:i||o,dataSource:[{name:"organization_default"},...n]}),(0,ge.jsx)(u,{type:"primary",onClick:s,className:"mt-4","data-attr":"create-role-button",disabledReason:g,children:"Create role"}),(0,ge.jsx)(Bc,{})]})})}var xr=a(f());function Uc(){return ai("ROLE_BASED_ACCESS_CONTROL")?(0,xr.jsx)(Pc,{noAccessControls:!0}):(0,xr.jsx)(Fc,{})}c();m();d();var Wt=a(I());c();m();d();var ji=a(I());var Mr=a(ne());c();m();d();var go=a(I()),zc=a(He()),Vc=a(Dt());var Co=(0,go.kea)([(0,go.path)(["scenes","organization","verifiedDomainsLogic"]),(0,go.connect)({values:[ee,["currentOrganization"]],logic:[B]}),(0,go.actions)({replaceDomain:e=>({domain:e}),setAddModalShown:e=>({shown:e}),setConfigureSAMLModalId:e=>({id:e}),setVerifyModal:e=>({id:e})}),(0,go.reducers)({verifiedDomains:[[],{replaceDomain:(e,{domain:o})=>{let t=[...e.filter(({id:n})=>n!==o.id),o];return t.sort((n,i)=>n.domain.localeCompare(i.domain)),t}}],addModalShown:[!1,{setAddModalShown:(e,{shown:o})=>o,addVerifiedDomainSuccess:()=>!1}],configureSAMLModalId:[null,{setConfigureSAMLModalId:(e,{id:o})=>o}],verifyModal:[null,{setVerifyModal:(e,{id:o})=>o}]}),(0,Vc.loaders)(({values:e,actions:o})=>({verifiedDomains:[[],{loadVerifiedDomains:async()=>(await j.get(`api/organizations/${e.currentOrganization?.id}/domains`)).results,addVerifiedDomain:async t=>[await j.create(`api/organizations/${e.currentOrganization?.id}/domains`,{domain:t}),...e.verifiedDomains],deleteVerifiedDomain:async t=>(await j.delete(`api/organizations/${e.currentOrganization?.id}/domains/${t}`),[...e.verifiedDomains.filter(n=>n.id!==t)])}],updatingDomain:[!1,{updateDomain:async t=>{let n=await j.update(`api/organizations/${e.currentOrganization?.id}/domains/${t.id}`,{...t,id:void 0});return we.success("Domain updated successfully! Changes will take immediately."),o.replaceDomain(n),!1},verifyDomain:async()=>{let t=await j.create(`api/organizations/${e.currentOrganization?.id}/domains/${e.verifyModal}/verify`);return t.is_verified?we.success("Domain verified successfully."):we.warning("We could not verify your domain yet. DNS propagation may take up to 72 hours. Please try again later."),o.replaceDomain(t),o.setVerifyModal(null),!1}}]})),(0,go.listeners)(({actions:e,values:o})=>({setConfigureSAMLModalId:({id:t})=>{let n=o.verifiedDomains.find(({id:i})=>i===t);if(t&&n){let{saml_acs_url:i,saml_entity_id:r,saml_x509_cert:s}=n;e.setSamlConfigValues({saml_acs_url:i,saml_entity_id:r,saml_x509_cert:s,id:t})}}})),(0,go.selectors)({domainBeingVerified:[e=>[e.verifiedDomains,e.verifyModal],(e,o)=>o&&e.find(({id:t})=>t===o)||null],isSSOEnforcementAvailable:[()=>[B.selectors.hasAvailableFeature],e=>e("sso_enforcement")],isSAMLAvailable:[()=>[B.selectors.hasAvailableFeature],e=>e("saml")]}),(0,go.afterMount)(({actions:e})=>e.loadVerifiedDomains()),(0,zc.forms)(({actions:e,values:o})=>({samlConfig:{defaults:{},errors:t=>({saml_acs_url:t.saml_acs_url&&!t.saml_acs_url.match(Jr)?"Please enter a valid URL, including https://":void 0}),submit:async(t,n)=>{let{id:i,...r}=t;if(!i)return;let s=await j.update(`api/organizations/${o.currentOrganization?.id}/domains/${t.id}`,{...r});n(),e.replaceDomain(s),e.setConfigureSAMLModalId(null),e.setSamlConfigValues({}),we.success(`SAML configuration for ${s.domain} updated successfully.`)}}}))]);var hn=a(f());function Jc(){let{addModalShown:e,verifiedDomainsLoading:o}=(0,ji.useValues)(Co),{setAddModalShown:t,addVerifiedDomain:n}=(0,ji.useActions)(Co),[i,r]=(0,Mr.useState)(""),[s,l]=(0,Mr.useState)(!1),g=!i||!i.match(Vr),p=()=>{r(""),l(!1)},b=()=>{t(!1),p()},S=()=>{l(!0),g||(n(i),p())};return(0,hn.jsxs)($,{onClose:b,isOpen:e,title:"Add authentication domain",footer:(0,hn.jsx)(u,{type:"primary",disabled:i===""||s&&g||o,onClick:S,children:"Add domain"}),children:[(0,hn.jsx)(U,{placeholder:"posthog.com",autoFocus:!0,value:i,onChange:r,onPressEnter:S}),s&&g&&(0,hn.jsx)("span",{className:"text-danger text-xs",children:"Please enter a valid domain or subdomain name (e.g. my.posthog.com)"})]})}c();m();d();var Zn=a(I()),Xc=a(He());var Ae=a(f());function jc(){let{configureSAMLModalId:e,isSamlConfigSubmitting:o,samlConfig:t}=(0,Zn.useValues)(Co),{setConfigureSAMLModalId:n}=(0,Zn.useActions)(Co),{preflight:i}=(0,Zn.useValues)(Ye),r=i?.site_url??window.location.origin,s=t.saml_acs_url&&t.saml_entity_id&&t.saml_x509_cert;return(0,Ae.jsx)($,{onClose:()=>{n(null)},isOpen:!!e,title:"",simple:!0,children:(0,Ae.jsxs)(Xc.Form,{logic:Co,formKey:"samlConfig",enableFormOnSubmit:!0,className:"LemonModal__layout ",children:[(0,Ae.jsx)($.Header,{children:(0,Ae.jsx)("h3",{children:"Configure SAML authentication and provisioning"})}),(0,Ae.jsxs)($.Content,{className:"space-y-2",children:[(0,Ae.jsx)("p",{children:(0,Ae.jsx)(D,{to:"https://posthog.com/docs/data/sso#setting-up-saml",target:"_blank",targetBlankIcon:!0,children:"Read the docs"})}),(0,Ae.jsx)(X,{label:"ACS Consumer URL",name:"_ACSConsumerUrl",children:(0,Ae.jsx)(et,{children:`${r}/complete/saml/`})}),(0,Ae.jsx)(X,{label:"RelayState",name:"_RelayState",children:(0,Ae.jsx)(et,{children:e||"unknown"})}),(0,Ae.jsx)(X,{label:"Audience / Entity ID",name:"_Audience",children:(0,Ae.jsx)(et,{children:r})}),(0,Ae.jsx)(X,{name:"saml_acs_url",label:"SAML ACS URL",children:(0,Ae.jsx)(U,{className:"ph-ignore-input",placeholder:"Your IdP's ACS or single sign-on URL."})}),(0,Ae.jsx)(X,{name:"saml_entity_id",label:"SAML Entity ID",children:(0,Ae.jsx)(U,{className:"ph-ignore-input",placeholder:"Entity ID provided by your IdP."})}),(0,Ae.jsx)(X,{name:"saml_x509_cert",label:"SAML X.509 Certificate",children:(0,Ae.jsx)(on,{className:"ph-ignore-input",minRows:10,placeholder:`Enter the public certificate of your IdP. Keep all line breaks.
-----BEGIN CERTIFICATE-----
MIICVjCCAb+gAwIBAgIBADANBgkqhkiG9w0BAQ0FADBIMQswCQYDVQQGEwJ1czEL
-----END CERTIFICATE-----`})}),!s&&(0,Ae.jsx)(fe,{type:"info",children:"SAML will not be enabled unless you enter all attributes above. However you can still settings as draft."})]}),(0,Ae.jsx)($.Footer,{children:(0,Ae.jsx)(u,{loading:o,type:"primary",htmlType:"submit",children:"Save settings"})})]})})}c();m();d();var Wc=a(I());var Wi=a(f());function Gc({value:e,loading:o,onChange:t,samlAvailable:n,disabledReason:i}){let{preflight:r}=(0,Wc.useValues)(Ye);if(!r)return null;let s=Object.keys(r.available_social_auth_providers),l=[{value:"",label:"Don't enforce"}];return s.forEach(g=>{l.push({value:g,label:er[g],disabledReason:r.available_social_auth_providers[g]?void 0:"This provider is not configured.",icon:(0,Wi.jsx)(mr,{provider:g,className:"w-4 h-4"})})}),l.push({value:"saml",label:er.saml,disabledReason:n?void 0:"This provider is not configured.",icon:(0,Wi.jsx)(mr,{provider:"saml",className:"w-4 h-4"})}),(0,Wi.jsx)(ve,{value:e,options:l,loading:o,disabledReason:o?"Cannot change while loading":i,fullWidth:!0,onChange:t})}c();m();d();var Gi=a(I());var le=a(f());function Hc(){let{domainBeingVerified:e,updatingDomainLoading:o}=(0,Gi.useValues)(Co),{setVerifyModal:t,verifyDomain:n}=(0,Gi.useActions)(Co),i=`_posthog-challenge.${e?.domain}.`;return(0,le.jsx)($,{isOpen:!!e,onClose:()=>t(null),title:"Verify your domain",description:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(ie,{className:"uppercase",children:e?.domain||""}),(0,le.jsx)("p",{children:"To verify your domain, you need to add a record to your DNS zone."})]}),footer:(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(u,{type:"secondary",onClick:()=>t(null),children:"Verify later"}),(0,le.jsx)(u,{type:"primary",disabled:o,onClick:n,children:"Verify"})]}),children:(0,le.jsx)("div",{children:(0,le.jsxs)("ol",{children:[(0,le.jsx)("li",{children:"Sign in to your DNS provider."}),(0,le.jsxs)("li",{children:["Add the following ",(0,le.jsx)("b",{children:"TXT"})," record.",(0,le.jsxs)("div",{className:"my-4 space-y-2",children:[(0,le.jsx)(X.Pure,{label:"Name",children:(0,le.jsxs)("div",{className:"flex items-center gap-2",children:[(0,le.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:i}),(0,le.jsx)(et,{explicitValue:i,selectable:!0})]})}),(0,le.jsx)(X.Pure,{label:"Value or content",children:(0,le.jsxs)("div",{className:"flex items-center gap-2",children:[(0,le.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:e?.verification_challenge}),e&&(0,le.jsx)(et,{explicitValue:e.verification_challenge,selectable:!0})]})}),(0,le.jsx)(X.Pure,{label:"TTL",children:(0,le.jsxs)("div",{className:"flex items-center gap-2",children:[(0,le.jsx)("div",{className:"border rounded p-2 h-10 flex-1",children:"Default or 3600"}),(0,le.jsx)(et,{explicitValue:"3600",selectable:!0})]})})]})]}),(0,le.jsx)("li",{children:"Press verify below."})]})})})}var M=a(f()),bn={marginRight:4,fontSize:"1.15em",paddingTop:2};function Yc(){let{verifiedDomainsLoading:e,updatingDomainLoading:o}=(0,Wt.useValues)(Co),{setAddModalShown:t}=(0,Wt.useActions)(Co),n=ce({minimumAccessLevel:8,scope:"organization"});return(0,M.jsxs)(eo,{feature:"automatic_provisioning",children:[(0,M.jsx)("p",{children:"Enable users to sign up automatically with an email address on verified domains and enforce SSO for accounts under your domains."}),(0,M.jsx)(Zm,{}),(0,M.jsx)(u,{type:"primary",onClick:()=>t(!0),className:"mt-4",disabledReason:e||o?"loading...":n,children:"Add domain"})]})}function Zm(){let{verifiedDomains:e,verifiedDomainsLoading:o,currentOrganization:t,updatingDomainLoading:n,isSSOEnforcementAvailable:i,isSAMLAvailable:r}=(0,Wt.useValues)(Co),{updateDomain:s,deleteVerifiedDomain:l,setVerifyModal:g,setConfigureSAMLModalId:p}=(0,Wt.useActions)(Co),{preflight:b}=(0,Wt.useValues)(Ye),S=ce({minimumAccessLevel:8,scope:"organization"}),_=[{key:"domain",title:"Domain name",dataIndex:"domain",render:function(C,{domain:P}){return(0,M.jsx)(ie,{children:P})}},...b?.cloud?[{key:"is_verified",title:(0,M.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,M.jsx)("span",{children:"Verification"}),(0,M.jsx)(be,{title:"Verification (through DNS) is required to use domains for authentication (e.g. SAML or enforce SSO).",children:(0,M.jsx)(So,{})})]}),render:function(C,{is_verified:P,verified_at:E}){return P?(0,M.jsxs)("div",{className:"flex items-center text-success",children:[(0,M.jsx)(_n,{style:bn})," Verified"]}):E?(0,M.jsxs)("div",{className:"flex items-center text-danger",children:[(0,M.jsx)(ea,{style:bn})," Verification expired"]}):(0,M.jsxs)("div",{className:"flex items-center text-warning",children:[(0,M.jsx)(Bt,{style:bn})," Pending verification"]})}}]:[],{key:"jit_provisioning_enabled",title:(0,M.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,M.jsx)("span",{children:"Automatic provisioning"}),(0,M.jsx)(be,{title:`Enables just-in-time provisioning. If a user logs in with SSO with an email address on this domain an account will be created in ${t?.name||"this organization"} if it does not exist.`,children:(0,M.jsx)(So,{})})]}),render:function(C,{jit_provisioning_enabled:P,id:E,is_verified:Y}){return Y?(0,M.jsx)("div",{className:"flex items-center",children:(0,M.jsx)(V,{checked:P,disabled:n||!Y,disabledReason:S,onChange:de=>s({id:E,jit_provisioning_enabled:de}),label:(0,M.jsx)("span",{className:"font-normal",children:P?"Enabled":"Disabled"})})}):(0,M.jsx)("i",{className:"text-secondary",children:"Verify domain to enable automatic provisioning"})}},{key:"sso_enforcement",title:(0,M.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,M.jsx)("span",{children:"Enforce SSO"}),(0,M.jsx)(be,{title:"Require users with email addresses on this domain to always log in using a specific SSO provider.",children:(0,M.jsx)(So,{})})]}),render:function(C,{sso_enforcement:P,is_verified:E,id:Y,has_saml:de},_e){return i?E?(0,M.jsx)(Gc,{value:P,loading:n,onChange:qe=>s({id:Y,sso_enforcement:qe}),samlAvailable:de,disabledReason:S}):(0,M.jsx)("i",{className:"text-secondary",children:"Verify domain to enable"}):_e===0?(0,M.jsxs)(D,{to:ye.organizationBilling(),className:"flex items-center",children:[(0,M.jsx)(Tn,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SSO enforcement"]}):(0,M.jsx)(M.Fragment,{})}},{key:"saml",title:"SAML",render:function(C,{is_verified:P,saml_acs_url:E,saml_entity_id:Y,saml_x509_cert:de,has_saml:_e},qe){return r?P?(0,M.jsx)(M.Fragment,{children:_e?(0,M.jsxs)("div",{className:"flex items-center text-success",children:[(0,M.jsx)(_n,{style:bn})," SAML enabled"]}):E||Y||de?(0,M.jsxs)("div",{className:"flex items-center text-warning",children:[(0,M.jsx)(Bt,{style:bn})," SAML partially configured"]}):(0,M.jsxs)("div",{className:"flex items-center",children:[(0,M.jsx)(qr,{style:bn})," SAML not set up"]})}):(0,M.jsx)("i",{className:"text-secondary",children:"Verify domain to enable"}):qe===0?(0,M.jsxs)(D,{to:ye.organizationBilling(),className:"flex items-center",children:[(0,M.jsx)(Tn,{style:{color:"var(--warning)",marginLeft:4}})," Upgrade to enable SAML"]}):(0,M.jsx)(M.Fragment,{})}},{key:"verify",width:32,align:"center",render:function(C,{is_verified:P,id:E}){return P?(0,M.jsx)(M.Fragment,{}):(0,M.jsx)(u,{type:"primary",onClick:()=>g(E),disabledReason:S,children:"Verify"})}},{key:"actions",width:32,align:"center",render:function(C,{is_verified:P,id:E,domain:Y}){return(0,M.jsx)(ni,{overlay:(0,M.jsxs)(M.Fragment,{children:[P&&(0,M.jsx)(u,{onClick:()=>p(E),fullWidth:!0,disabledReason:S||(r?void 0:"Upgrade to enable SAML"),children:"Configure SAML"}),(0,M.jsx)(u,{status:"danger",onClick:()=>K.open({title:`Remove ${Y}?`,description:"This cannot be undone. If you have SAML configured or SSO enforced,it will be immediately disabled.",primaryButton:{status:"danger",children:"Remove domain",onClick:()=>l(E)},secondaryButton:{children:"Cancel"}}),fullWidth:!0,icon:(0,M.jsx)(ke,{}),disabledReason:S,children:"Remove domain"})]})})}}];return(0,M.jsxs)("div",{children:[(0,M.jsx)(ae,{dataSource:e,columns:_,loading:o,rowKey:"id",emptyState:"You haven't registered any authentication domains yet."}),(0,M.jsx)(Jc,{}),(0,M.jsx)(jc,{}),(0,M.jsx)(Hc,{})]})}c();m();d();var vn=a(I());var Hi=a(ne());var Oe=a(f());function Qm({isOpen:e,setIsOpen:o,organization:t}){let{currentProject:n,projectBeingMovedLoading:i}=(0,vn.useValues)(xo),{moveProject:r}=(0,vn.useActions)(xo),[s,l]=(0,Hi.useState)(!1);return(0,Oe.jsxs)($,{title:"Move the project to another organization?",onClose:i?void 0:()=>o(!1),closable:!i,maxWidth:"30rem",footer:(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)(u,{disabledReason:i&&"Moving...",type:"secondary",onClick:()=>o(!1),children:"Cancel"}),(0,Oe.jsx)(u,{type:"secondary",disabled:!s,loading:i,"data-attr":"move-project-ok",status:"danger",onClick:n?()=>r(n,t.id):void 0,children:`Move ${n?n.name:"the current project"}`})]}),isOpen:e,children:[(0,Oe.jsx)("p",{children:"Moving a project will mean all original organization members will lose access including via things like API keys unless they also are part of the new organization."}),(0,Oe.jsxs)("p",{children:["Please type ",(0,Oe.jsx)("strong",{children:n?n.name:"this project's name"})," to confirm."]}),(0,Oe.jsx)(U,{type:"text",onChange:g=>{n&&l(g.toLowerCase()===n.name.toLowerCase())}})]})}function Er(){let{currentProject:e}=(0,vn.useValues)(xo),{otherOrganizations:o}=(0,vn.useValues)(B),[t,n]=(0,Hi.useState)(!1),i=ce({minimumAccessLevel:8,scope:"project"}),[r,s]=(0,Hi.useState)(null);return(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsxs)("p",{children:["Move ",(0,Oe.jsx)("b",{children:e?.name})," to another organization?"]}),(0,Oe.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Oe.jsx)(ve,{options:o.map(l=>({label:l.name,value:l.id})),placeholder:"Select target organization",onChange:l=>{let g=o.find(p=>p.id===l);s(g||null)},value:r?.id}),(0,Oe.jsxs)(u,{status:"danger",type:"secondary",onClick:()=>n(!0),"data-attr":"move-project-button",icon:(0,Oe.jsx)(sa,{}),disabledReason:i??(r===null&&"Please select the target organization"),children:["Move ",e?.name||"the current project"]})]}),r&&(0,Oe.jsx)(Qm,{isOpen:t,setIsOpen:n,organization:r})]})}c();m();d();var Yi=a(I()),$c=a(ne());var Qn=a(f());function Zc(){let{currentProject:e,currentProjectLoading:o}=(0,Yi.useValues)(xo),{updateCurrentProject:t}=(0,Yi.useActions)(xo),[n,i]=(0,$c.useState)(e?.name||"");return(0,Qn.jsxs)("div",{className:"space-y-4 max-w-160",children:[(0,Qn.jsx)(U,{value:n,onChange:i,disabled:o}),(0,Qn.jsx)(u,{type:"primary",onClick:()=>t({name:n}),disabled:!n||!e||n===e.name,loading:o,children:"Rename project"})]})}c();m();d();var Kc=a(I()),qc=a(He());c();m();d();var xt=a(I()),Qc=a(He());var Pr=(0,xt.kea)([(0,xt.path)(["scenes","me","settings","changePasswordLogic"]),(0,xt.connect)({values:[B,["user"]]}),(0,Qc.forms)(({values:e,actions:o})=>({changePassword:{defaults:{},errors:({current_password:t,password:n})=>({current_password:(!e.user||e.user.has_password)&&!t?"Please enter your current password":void 0,password:n?e.validatedPassword.feedback:"Please enter your password to continue"}),submit:async({password:t,current_password:n},i)=>{await i(150);try{await j.update("api/users/@me/",{current_password:n,password:t}),o.resetChangePassword({password:"",current_password:""}),we.success("Password changed")}catch(r){o.setChangePasswordManualErrors({[r.attr]:r.detail})}}}})),(0,xt.selectors)({validatedPassword:[e=>[e.changePassword],({password:e})=>vs(e)]})]);var Wo=a(f());function ed(){let{validatedPassword:e,isChangePasswordSubmitting:o}=(0,Kc.useValues)(Pr);return(0,Wo.jsxs)(qc.Form,{logic:Pr,formKey:"changePassword",enableFormOnSubmit:!0,className:"space-y-4 max-w-160",children:[(0,Wo.jsx)(X,{name:"current_password",label:"Current Password",children:(0,Wo.jsx)(U,{autoComplete:"current-password",type:"password",className:"ph-ignore-input",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})}),(0,Wo.jsx)(X,{name:"password",label:(0,Wo.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,Wo.jsx)("span",{children:"Password"}),(0,Wo.jsx)(Cs,{validatedPassword:e})]}),children:(0,Wo.jsx)(U,{autoComplete:"current-password",type:"password",className:"ph-ignore-input",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})}),(0,Wo.jsx)(u,{type:"primary",htmlType:"submit",loading:o,children:"Change password"})]})}c();m();d();var $i=a(I());var st=a(f());function od(){let{hedgehogConfig:e}=(0,$i.useValues)(dr),{patchHedgehogConfig:o}=(0,$i.useActions)(dr);return(0,st.jsxs)(st.Fragment,{children:[(0,st.jsxs)("div",{className:"flex gap-2",children:[(0,st.jsx)(V,{label:"Enabled hedgehog mode","data-attr":"hedgehog-mode-switch",onChange:t=>o({enabled:t}),checked:e.enabled,bordered:!0}),(0,st.jsx)(V,{label:"Use as profile picture","data-attr":"hedgehog-profile-picture",onChange:t=>o({use_as_profile:t}),checked:e.use_as_profile,bordered:!0})]}),(0,st.jsx)("div",{className:"mt-4 p-2 border rounded bg-surface-primary",children:(0,st.jsx)(os,{})})]})}c();m();d();var Zi=a(I());var Cn=a(f());function td(){let{user:e,userLoading:o}=(0,Zi.useValues)(B),{updateUser:t}=(0,Zi.useActions)(B);return(0,Cn.jsxs)("div",{children:[(0,Cn.jsx)("p",{children:"PostHog uses PostHog (unsurprisingly!) to capture information about how people are using the product. We believe that product analytics is crucial to making PostHog the most useful it can be, for everyone."}),(0,Cn.jsx)("p",{children:"We also understand there are many reasons why people don't want to or aren't allowed to send this usage data. If you would like to anonymize your personal usage data, just tick the box below."}),(0,Cn.jsx)(V,{label:"Anonymize my data","data-attr":"anonymize-data-collection",onChange:n=>t({anonymize_data:n}),checked:e?.anonymize_data??!1,disabled:o,bordered:!0})]})}c();m();d();var ad=a(Sn()),Et=a(I()),sd=a(He());var Qi=a(ne());c();m();d();var fo=a(I()),nd=a(He()),id=a(Dt()),Gt=a(or());var Ke=a(f()),Dr=10,Kn=[{value:"local_evaluation",label:"Local feature flag evaluation",scopes:["feature_flag:read"]},{value:"zapier",label:"Zapier integration",scopes:["action:read","query:read","project:read","organization:read","user:read","webhook:write"]},{value:"analytics",label:"Performing analytics queries",scopes:["query:read"]},{value:"project_management",label:"Project & user management",scopes:["project:write","organization:read","organization_member:write"]},{value:"all_access",label:"All access",scopes:["*"]}],rd=[{key:"action"},{key:"activity_log"},{key:"annotation"},{key:"batch_export"},{key:"cohort"},{key:"dashboard"},{key:"dashboard_template"},{key:"early_access_feature"},{key:"event_definition"},{key:"experiment"},{key:"export"},{key:"feature_flag"},{key:"group"},{key:"insight"},{key:"query",disabledActions:["write"]},{key:"notebook"},{key:"organization",disabledWhenProjectScoped:!0},{key:"organization_member",disabledWhenProjectScoped:!0,warnings:{write:(0,Ke.jsxs)(Ke.Fragment,{children:["This scope can be used to invite users to your organization,",(0,Ke.jsx)("br",{}),"effectively ",(0,Ke.jsx)("strong",{children:"allowing access to other scopes via the added user"}),"."]})}},{key:"person"},{key:"plugin"},{key:"project",warnings:{write:"This scope can be used to create or modify projects, including settings about how data is ingested."}},{key:"property_definition"},{key:"session_recording"},{key:"session_recording_playlist"},{key:"sharing_configuration"},{key:"subscription"},{key:"survey"},{key:"user",disabledActions:["write"],warnings:{read:(0,Ke.jsxs)(Ke.Fragment,{children:["This scope allows you to retrieve your own user object.",(0,Ke.jsx)("br",{}),"Note that the user object ",(0,Ke.jsx)("strong",{children:"lists all organizations and projects you're in"}),"."]})}},{key:"webhook",info:"Webhook configuration is currently only enabled for the Zapier integration."}],Mt=(0,fo.kea)([(0,fo.path)(["lib","components","PersonalAPIKeys","personalAPIKeysLogic"]),(0,fo.connect)({values:[B,["user"]]}),(0,fo.actions)({setEditingKeyId:e=>({id:e}),loadKeys:!0,createKeySuccess:e=>({key:e}),updateKey:e=>e,deleteKey:e=>({id:e}),setScopeRadioValue:(e,o)=>({key:e,action:o}),resetScopes:!0,loadAllTeams:!0}),(0,fo.reducers)({editingKeyId:[null,{setEditingKeyId:(e,{id:o})=>o}]}),(0,id.loaders)(({values:e})=>({keys:[[],{loadKeys:async()=>await j.personalApiKeys.list(),deleteKey:async({id:o})=>(await j.personalApiKeys.delete(o),e.keys.filter(t=>t.id!=o))}],allTeams:[null,{loadAllTeams:async()=>await j.loadPaginatedResults("api/projects")}]})),(0,nd.forms)(({values:e,actions:o})=>({editingKey:{defaults:{label:"",scopes:[],scoped_organizations:[],scoped_teams:[],access_type:void 0},errors:({label:t,access_type:n,scopes:i,scoped_organizations:r,scoped_teams:s})=>({label:t?void 0:"Your API key needs a label",scopes:i?.length?void 0:"Your API key needs at least one scope",access_type:n?void 0:"Select access mode",scoped_organizations:n==="organizations"&&!r?.length?"Select at least one organization":void 0,scoped_teams:n==="teams"&&!s?.length?"Select at least one project":void 0}),submit:async(t,n)=>{if(!e.editingKeyId)return;let i=e.editingKeyId==="new"?await j.personalApiKeys.create(t):await j.personalApiKeys.update(e.editingKeyId,t);n(),e.editingKeyId==="new"&&o.createKeySuccess(i),o.loadKeysSuccess([i].concat(e.keys.filter(r=>r.id!==e.editingKeyId))),o.setEditingKeyId(null)}}})),(0,fo.selectors)(()=>({formScopeRadioValues:[e=>[e.editingKey],e=>{let o={};return e.scopes.forEach(t=>{let[n,i]=t.split(":");o[n]=i}),o}],allAccessSelected:[e=>[e.editingKey],e=>e.scopes.includes("*")],allOrganizations:[e=>[e.user],e=>e?.organizations??[]]})),(0,fo.listeners)(({actions:e,values:o})=>({touchEditingKeyField:({key:t})=>{t==="label"&&o.editingKey.label.toLowerCase().includes("zapier")&&!o.editingKey.preset&&(e.setEditingKeyValue("preset","zapier"),e.setEditingKeyValue("access_type","all"))},setEditingKeyValue:async({name:t,value:n})=>{let i=Array.isArray(t)?t[0]:t;if(i==="preset"&&n){let r=Kn.find(s=>s.value===n);r&&e.setEditingKeyValue("scopes",r.scopes)}i==="scopes"&&o.editingKey.preset&&Kn.find(s=>s.value===o.editingKey.preset)?.scopes.join(",")!==n.join(",")&&e.setEditingKeyValue("preset",void 0),i==="access_type"&&(e.setEditingKeyValue("scoped_teams",[]),e.setEditingKeyValue("scoped_organizations",[]))},setEditingKeyId:async({id:t})=>{if(t){let n=o.keys.find(r=>r.id===t),i={label:n?.label??"",scopes:n?.scopes??[],preset:n?.scopes.includes("*")?"all_access":void 0,scoped_organizations:n?.scoped_organizations??[],scoped_teams:n?.scoped_teams??[],access_type:n?.scoped_organizations?.length?"organizations":n?.scoped_teams?.length?"teams":t!=="new"?"all":void 0};e.resetEditingKey(i)}},resetScopes:()=>{e.setEditingKeyValue("scopes",[])},setScopeRadioValue:({key:t,action:n})=>{let i=o.editingKey.scopes.filter(r=>!r.startsWith(t));n!=="none"&&i.push(`${t}:${n}`),e.setEditingKeyValue("scopes",i)},createKeySuccess:async({key:t})=>{let n=t.value;n&&K.open({title:"Personal API key ready",width:536,content:(0,Ke.jsxs)(Ke.Fragment,{children:[(0,Ke.jsxs)("p",{className:"mb-4",children:['You can now use key "',t.label,'" for authentication:']}),(0,Ke.jsx)(Lo,{className:"ph-no-capture",thing:"personal API key",children:n}),(0,Ke.jsxs)(fe,{type:"warning",className:"mt-4",children:["For security reasons the value above ",(0,Ke.jsx)("em",{children:"will never be shown again"}),".",(0,Ke.jsx)("br",{}),"Copy it to your destination right away."]})]})})},deleteKeySuccess:()=>{we.success("Personal API key deleted")}})),(0,Gt.urlToAction)(({actions:e})=>({[ye.settings("user-api-keys")]:(o,t)=>{let n=t.preset;if(n){let i=Kn.find(r=>r.value===n);i&&(e.setEditingKeyId("new"),e.setEditingKeyValues({preset:i.value,label:i.label,scopes:i.scopes}))}}})),(0,Gt.actionToUrl)(()=>({setEditingKeyId:({id:e})=>{if(!e)return[Gt.router.values.location.pathname,{},Gt.router.values.location.hash]}})),(0,fo.afterMount)(({actions:e})=>{e.loadAllTeams()})]);var L=a(f());function Km(){let{editingKeyId:e,isEditingKeySubmitting:o,editingKeyChanged:t,formScopeRadioValues:n,allAccessSelected:i,editingKey:r,allTeams:s,allTeamsLoading:l,allOrganizations:g}=(0,Et.useValues)(Mt),{setEditingKeyId:p,setScopeRadioValue:b,submitEditingKey:S,resetScopes:_}=(0,Et.useActions)(Mt),y=e==="new";return(0,L.jsx)(sd.Form,{logic:Mt,formKey:"editingKey",children:(0,L.jsx)($,{title:`${y?"Create":"Edit"} personal API key`,onClose:()=>p(null),isOpen:!!e,width:"40rem",hasUnsavedInput:t,footer:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(u,{type:"secondary",onClick:()=>p(null),children:"Cancel"}),(0,L.jsx)(u,{type:"primary",htmlType:"submit",loading:o,disabled:!t,onClick:()=>S(),children:y?"Create key":"Save key"})]}),children:(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(X,{name:"label",label:"Label",children:(0,L.jsx)(U,{placeholder:'For example "Reports bot" or "Zapier"',maxLength:40})}),(0,L.jsx)(X,{name:"access_type",className:"mt-4 mb-2",children:({value:C,onChange:P})=>(0,L.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,L.jsx)(Be,{children:"Organization & project access"}),(0,L.jsx)(In,{onChange:P,value:C,options:[{label:"All access",value:"all"},{label:"Organizations",value:"organizations"},{label:"Projects",value:"teams"}],size:"small"})]})}),r.access_type==="all"?(0,L.jsx)("p",{className:"mb-0",children:"This API key will allow access to all organizations and projects you're in."}):r.access_type==="organizations"?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{className:"mb-2",children:"This API key will only allow access to selected organizations and all project within them."}),(0,L.jsx)(X,{name:"scoped_organizations",children:(0,L.jsx)(Ve,{mode:"multiple","data-attr":"organizations",options:g.map(C=>({key:`${C.id}`,label:C.name,labelComponent:(0,L.jsx)(be,{title:(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"font-semibold",children:C.name}),(0,L.jsxs)("div",{className:"text-xs whitespace-nowrap",children:["ID: ",C.id]})]}),children:(0,L.jsx)("span",{className:"flex-1 font-semibold",children:C.name})})}))??[],placeholder:"Select organizations..."})})]}):r.access_type==="teams"?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{className:"mb-2",children:"This API key will only allow access to selected projects."}),(0,L.jsx)(X,{name:"scoped_teams",children:({value:C,onChange:P})=>(0,L.jsx)(Ve,{mode:"multiple","data-attr":"teams",value:C.map(E=>String(E)),onChange:E=>P(E.map(Y=>parseInt(Y))),options:s?.map(E=>({key:`${E.id}`,label:E.name,labelComponent:(0,L.jsx)(be,{title:(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"font-semibold",children:E.name}),(0,L.jsxs)("div",{className:"text-xs whitespace-nowrap",children:["Token: ",E.api_token]}),(0,L.jsxs)("div",{className:"text-xs whitespace-nowrap",children:["Organization ID: ",E.organization]})]}),children:g.length>1?(0,L.jsxs)("span",{children:[(0,L.jsx)("span",{children:g.find(Y=>Y.id===E.organization)?.name}),(0,L.jsx)("span",{className:"text-secondary mx-1",children:"/"}),(0,L.jsx)("span",{className:"flex-1 font-semibold",children:E.name})]}):(0,L.jsx)("span",{children:E.name})})}))??[],loading:l,placeholder:"Select projects..."})})]}):null,(0,L.jsxs)("div",{className:"flex items-center justify-between mt-4 mb-2",children:[(0,L.jsx)(Be,{children:"Scopes"}),(0,L.jsx)(X,{name:"preset",children:(0,L.jsx)(ve,{size:"small",placeholder:"Select preset",options:Kn,dropdownMatchSelectWidth:!1,dropdownPlacement:"bottom-end"})})]}),(0,L.jsx)(X,{name:"scopes",children:({error:C})=>(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("p",{className:"mb-0",children:"API keys are scoped to limit what actions they are able to do. We highly recommend you only give the key the permissions it needs to do its job. You can add or revoke scopes later."}),(0,L.jsx)("p",{className:"m-0",children:"Your API key can never take actions for which your account is missing permissions."}),C&&(0,L.jsxs)("div",{className:"text-danger flex items-center gap-1 text-sm",children:[(0,L.jsx)(oa,{className:"text-xl"})," ",C]}),i?(0,L.jsxs)(fe,{type:"warning",action:{children:"Reset",onClick:()=>_()},children:[(0,L.jsx)("b",{children:"This API key has full access to all supported endpoints!"})," We highly recommend scoping this to only what it needs."]}):(0,L.jsx)("div",{children:rd.map(({key:P,disabledActions:E,warnings:Y,disabledWhenProjectScoped:de,info:_e})=>{let qe=de&&r.access_type==="teams";return(0,L.jsxs)(Qi.Fragment,{children:[(0,L.jsxs)("div",{className:"flex items-center justify-between gap-2 min-h-8",children:[(0,L.jsxs)("div",{className:(0,ad.default)("flex items-center gap-1",qe&&"text-muted"),children:[(0,L.jsx)("b",{children:vo(P.replace(/_/g," "))}),_e?(0,L.jsx)(be,{title:_e,children:(0,L.jsx)(So,{className:"text-secondary text-base"})}):null]}),(0,L.jsx)(In,{onChange:Po=>b(P,Po),value:n[P]??"none",options:[{label:"No access",value:"none"},{label:"Read",value:"read",disabledReason:E?.includes("read")?"Does not apply to this resource":qe?"Not available for project scoped keys":void 0},{label:"Write",value:"write",disabledReason:E?.includes("write")?"Does not apply to this resource":qe?"Not available for project scoped keys":void 0}],size:"xsmall"})]}),Y?.[n[P]]&&(0,L.jsxs)("div",{className:"flex items-start gap-2 text-xs italic pb-2",children:[(0,L.jsx)(Bt,{className:"text-base text-secondary mt-0.5"}),(0,L.jsx)("span",{children:Y[n[P]]})]})]},P)})})]})})]})})})}function Br({tags:e,onMoreClick:o}){return(0,L.jsxs)("span",{className:"flex flex-wrap gap-1",children:[e.slice(0,4).map(t=>(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(ie,{children:t},t)})),e.length>4&&(0,L.jsx)(be,{title:e.slice(4).join(", "),children:(0,L.jsxs)(ie,{onClick:o,children:["+",e.length-4," more"]})})]})}function qm(){let{keys:e,keysLoading:o,allOrganizations:t,allTeams:n}=(0,Et.useValues)(Mt),{deleteKey:i,loadKeys:r,setEditingKeyId:s}=(0,Et.useActions)(Mt);return(0,Qi.useEffect)(()=>r(),[]),(0,L.jsx)(ae,{dataSource:e,loading:o,loadingSkeletonRows:3,className:"mt-4",nouns:["personal API key","personal API keys"],columns:[{title:"Label",dataIndex:"label",key:"label",render:function(g,p){return(0,L.jsx)(D,{subtle:!0,className:"text-left font-semibold truncate",onClick:()=>s(p.id),children:String(g)})}},{title:"Secret key",dataIndex:"mask_value",key:"mask_value",render:(l,g)=>g.mask_value?(0,L.jsx)("span",{className:"font-mono",children:g.mask_value}):(0,L.jsx)(be,{title:"This key was created before the introduction of previews",placement:"right",children:(0,L.jsxs)("span",{className:"inline-flex items-center gap-1 cursor-default",children:[(0,L.jsx)("span",{children:"No preview"}),(0,L.jsx)(So,{className:"text-base"})]})})},{title:"Scopes",key:"scopes",dataIndex:"scopes",render:function(g,p){return p.scopes[0]==="*"?(0,L.jsx)(ie,{type:"warning",children:"All access"}):(0,L.jsx)(Br,{tags:p.scopes,onMoreClick:()=>s(p.id)})}},{title:"Organization & project access",key:"access",dataIndex:"id",render:function(g,p){return p?.scoped_organizations?.length?(0,L.jsx)(Br,{tags:p.scoped_organizations?.map(b=>t.find(S=>S.id===b)?.name||""),onMoreClick:()=>s(p.id)}):p?.scoped_teams?.length?(0,L.jsx)(Br,{tags:p.scoped_teams?.map(b=>n?.find(S=>S.id===b)?.name||""),onMoreClick:()=>s(p.id)}):(0,L.jsx)(ie,{type:"warning",children:"All access"})}},{title:"Last Used",dataIndex:"last_used_at",key:"lastUsedAt",render:(l,g)=>Pt(g.last_used_at,"MMMM DD, YYYY","h A")},{title:"Created",dataIndex:"created_at",key:"createdAt",render:(l,g)=>Pt(g.created_at)},{title:"",key:"actions",align:"right",width:0,render:(l,g)=>(0,L.jsx)(en,{items:[{label:"Edit",onClick:()=>s(g.id)},{label:"Delete",status:"danger",onClick:()=>{K.open({title:`Permanently delete key "${g.label}"?`,description:"This action cannot be undone. Make sure to have removed the key from any live integrations first.",primaryButton:{status:"danger",children:"Permanently delete",onClick:()=>i(g.id)}})}}],children:(0,L.jsx)(u,{size:"small",icon:(0,L.jsx)(Kt,{})})})}]})}function ld(){let{keys:e}=(0,Et.useValues)(Mt),{setEditingKeyId:o}=(0,Et.useActions)(Mt);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("p",{children:["These keys allow full access to your personal account through the API, as if you were logged in. You can also use them in integrations, such as"," ",(0,L.jsx)(D,{to:"https://zapier.com/apps/posthog/",children:"our premium Zapier one"}),".",(0,L.jsx)("br",{}),"Try not to keep disused keys around. If you have any suspicion that one of these may be compromised, delete it and use a new one.",(0,L.jsx)("br",{}),(0,L.jsx)(D,{to:"https://posthog.com/docs/api/overview#authentication",children:"More about API authentication in PostHog Docs."})]}),(0,L.jsx)(u,{type:"primary",icon:(0,L.jsx)(ze,{}),onClick:()=>o("new"),disabledReason:e.length>=Dr?`You can only have ${Dr} personal API keys. Remove an existing key before creating a new one.`:!1,children:"Create personal API key"}),(0,L.jsx)(qm,{}),(0,L.jsx)(Km,{})]})}c();m();d();var Ht=a(I());var oe=a(f());function cd(){let{user:e}=(0,Ht.useValues)(B),{status:o,isDisable2FAModalOpen:t,isBackupCodesModalOpen:n}=(0,Ht.useValues)(Nn),{updateUser:i}=(0,Ht.useActions)(B),{loadMemberUpdates:r}=(0,Ht.useActions)(Oo),{generateBackupCodes:s,disable2FA:l,openTwoFactorSetupModal:g,toggleDisable2FAModal:p,toggleBackupCodesModal:b}=(0,Ht.useActions)(Nn),S=()=>{i({}),r()};return(0,oe.jsxs)("div",{className:"flex flex-col items-start",children:[t&&(0,oe.jsx)($,{title:"Disable 2FA",onClose:()=>p(!1),footer:(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(u,{onClick:()=>p(!1),children:"Cancel"}),(0,oe.jsx)(u,{type:"primary",status:"danger",onClick:()=>{l(),p(!1),S()},children:"Disable 2FA"})]}),children:(0,oe.jsx)("p",{children:"Are you sure you want to disable 2FA authentication? This will make your account less secure."})}),n&&(0,oe.jsx)($,{title:"Backup Codes",onClose:()=>b(!1),children:(0,oe.jsxs)("div",{className:"space-y-4 max-w-md",children:[o?.backup_codes?.length?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("p",{children:"Save these backup codes in a secure location. Each code can only be used once to sign in if you lose access to your authentication device."}),(0,oe.jsxs)("div",{className:"bg-primary p-4 rounded font-mono space-y-1 relative",children:[(0,oe.jsx)(u,{icon:(0,oe.jsx)(ti,{}),size:"small",className:"absolute top-4 right-4",onClick:()=>{Sa(o.backup_codes.join(`
`)||"","backup codes")},children:"Copy"}),o.backup_codes.map(_=>(0,oe.jsx)("div",{children:_},_))]})]}):(0,oe.jsx)("div",{className:"bg-primary p-4 rounded font-mono space-y-1 relative",children:(0,oe.jsx)("p",{className:"text-secondary mb-0",children:"No backup codes generated"})}),(0,oe.jsx)(u,{type:"primary",onClick:()=>{s()},children:o?.backup_codes?.length?"Generate new codes":"Generate backup codes"})]})}),e?.is_2fa_enabled?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{className:"mb-4 flex items-center space-x-2",children:[(0,oe.jsx)(_n,{color:"green",className:"text-xl"}),(0,oe.jsx)("span",{className:"font-medium",children:"2FA enabled"})]}),(0,oe.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,oe.jsx)(u,{type:"secondary",onClick:()=>b(!0),children:"View backup codes"}),(0,oe.jsx)(u,{type:"secondary",status:"danger",onClick:()=>p(!0),children:"Disable 2FA"})]})]}):(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{className:"mb-4 flex items-center space-x-2",children:[(0,oe.jsx)(Bt,{color:"orange",className:"text-xl"}),(0,oe.jsx)("span",{className:"font-medium",children:"2FA is not enabled"})]}),(0,oe.jsx)(u,{type:"primary",onClick:()=>g(),children:"Set up 2FA"})]})]})}c();m();d();var qn=a(I());var We=a(f());function dd(){let{user:e,userLoading:o}=(0,qn.useValues)(B),{updateUser:t}=(0,qn.useActions)(B),{currentOrganization:n}=(0,qn.useValues)(ee);return(0,We.jsxs)("div",{className:"space-y-4",children:[(0,We.jsx)(V,{id:"plugin-disabled","data-attr":"plugin_disabled",onChange:()=>{e?.notification_settings&&t({notification_settings:{...e?.notification_settings,plugin_disabled:!e?.notification_settings.plugin_disabled}})},checked:e?.notification_settings.plugin_disabled||!1,disabled:o,bordered:!0,label:"Get notified of data pipeline errors."}),(0,We.jsx)("h3",{children:"Weekly digest"}),(0,We.jsx)("p",{children:"The weekly digest keeps you up to date with everything that's happening in your PostHog organizations."}),(0,We.jsxs)("div",{className:"space-y-2",children:[(0,We.jsx)(V,{id:"all-digests-disabled","data-attr":"all_digests_disabled",onChange:()=>{e?.notification_settings&&t({notification_settings:{...e?.notification_settings,all_weekly_digest_disabled:!e?.notification_settings.all_weekly_digest_disabled}})},checked:!e?.notification_settings.all_weekly_digest_disabled,disabled:o,bordered:!0,label:"Receive the weekly digests",tooltip:"This option applies to all organizations you belong to. If you want to opt out of digests for a specific organization, disable all the individual project settings below."}),e?.notification_settings.all_weekly_digest_disabled?null:(0,We.jsxs)(We.Fragment,{children:[(0,We.jsx)("h4",{className:"ml-12",children:"Individual project settings:"}),(0,We.jsx)("ul",{className:"flex flex-col gap-2 w-fit",children:n?.teams?.map(i=>(0,We.jsx)("li",{className:"ml-16 grow list-disc",children:(0,We.jsx)("div",{className:"flex items-center grow",children:(0,We.jsx)(V,{id:`project-digest-${i.id}`,"data-attr":`project_digest_${i.id}`,onChange:()=>{e?.notification_settings&&t({notification_settings:{...e?.notification_settings,project_weekly_digest_disabled:{...e.notification_settings.project_weekly_digest_disabled,[i.id]:!e.notification_settings.project_weekly_digest_disabled?.[i.id]}}})},checked:!e?.notification_settings.project_weekly_digest_disabled?.[i.id],disabled:o||e?.notification_settings.all_weekly_digest_disabled,bordered:!0,label:(0,We.jsxs)(We.Fragment,{children:[i.name,(0,We.jsxs)(ie,{type:"muted",className:"ml-2",children:["id: ",i.id.toString()]})]}),fullWidth:!0})})},i.id))})]})]})]})}c();m();d();var md=a(I()),pd=a(He());var Go=a(f());function ud(){let{userLoading:e,isUserDetailsSubmitting:o,userDetailsChanged:t,user:n}=(0,md.useValues)(B);return(0,Go.jsxs)(pd.Form,{logic:B,formKey:"userDetails",enableFormOnSubmit:!0,className:"space-y-4",style:{maxWidth:"28rem"},children:[(0,Go.jsx)(X,{name:"first_name",label:"First name",children:(0,Go.jsx)(U,{className:"ph-ignore-input","data-attr":"settings-update-first-name",placeholder:"Jane",disabled:e})}),(0,Go.jsx)(X,{name:"last_name",label:"Last name",children:(0,Go.jsx)(U,{className:"ph-ignore-input","data-attr":"settings-update-last-name",placeholder:"Doe",disabled:e})}),(0,Go.jsx)(X,{name:"email",label:"Email",children:(0,Go.jsx)(U,{className:"ph-ignore-input","data-attr":"settings-update-email",placeholder:"email@yourcompany.com",disabled:e})}),n?.pending_email&&(0,Go.jsxs)(ie,{type:"highlight",children:["Pending verification for ",n.pending_email]}),(0,Go.jsx)(u,{type:"primary",htmlType:"submit",loading:o,disabled:!t,"data-attr":"user-details-submit-bottom",children:"Save name and email"})]})}var A=a(f()),gd=[{level:"environment",id:"environment-details",title:"General",settings:[{id:"display-name",title:"Display name",component:(0,A.jsx)(pc,{})},{id:"snippet",title:"Web snippet",component:(0,A.jsx)(uc,{})},{id:"bookmarklet",title:"Bookmarklet",component:(0,A.jsx)(gc,{})},{id:"variables",title:"Project ID",component:(0,A.jsx)(fc,{})}]},{level:"environment",id:"environment-autocapture",title:"Autocapture & heatmaps",settings:[{id:"autocapture",title:"Autocapture",component:(0,A.jsx)(Cl,{})},{id:"autocapture-data-attributes",title:"Data attributes",component:(0,A.jsx)(_l,{})},{id:"heatmaps",title:"Heatmaps",component:(0,A.jsx)(xl,{})},{id:"exception-autocapture",title:"Exception autocapture",component:(0,A.jsx)(Cr,{}),flag:"ERROR_TRACKING"},{id:"web-vitals-autocapture",title:"Web vitals autocapture",component:(0,A.jsx)(Sl,{})},{id:"dead-clicks-autocapture",title:"Dead clicks autocapture",component:(0,A.jsx)(Ys,{})}]},{level:"environment",id:"environment-product-analytics",title:"Product analytics",settings:[{id:"date-and-time",title:"Date & time",component:(0,A.jsx)(yc,{})},{id:"internal-user-filtering",title:"Filter out internal and test users",component:(0,A.jsx)(bc,{})},{id:"data-theme",title:(0,A.jsxs)(A.Fragment,{children:["Chart color themes",(0,A.jsx)(ie,{type:"warning",className:"ml-1 uppercase",children:"Beta"})]}),component:(0,A.jsx)(Il,{}),flag:"INSIGHT_COLORS"},{id:"persons-on-events",title:"Person properties mode",component:(0,A.jsx)(el,{}),flag:"!SETTINGS_PERSONS_ON_EVENTS_HIDDEN"},{id:"correlation-analysis",title:"Correlation analysis exclusions",component:(0,A.jsx)(Ll,{})},{id:"person-display-name",title:"Person display name",component:(0,A.jsx)(jl,{})},{id:"path-cleaning",title:"Path cleaning rules",component:(0,A.jsx)(Xl,{})},{id:"datacapture",title:"IP data capture configuration",component:(0,A.jsx)(Dl,{})},{id:"human-friendly-comparison-periods",title:"Human friendly comparison periods",component:(0,A.jsx)(Ml,{})},{id:"group-analytics",title:"Group analytics",component:(0,A.jsx)(Nl,{})},{id:"persons-join-mode",title:"Persons join mode",component:(0,A.jsx)(Ks,{}),flag:"SETTINGS_PERSONS_JOIN_MODE"},{id:"session-table-version",title:"Sessions Table Version",component:(0,A.jsx)(vl,{}),flag:"SETTINGS_SESSION_TABLE_VERSION"}]},{level:"environment",id:"environment-web-analytics",title:"Web analytics",settings:[{id:"channel-type",title:"Custom channel type",component:(0,A.jsx)(Hs,{})},{id:"cookieless-server-hash-mode",title:"Cookieless server hash mode",component:(0,A.jsx)(Ps,{}),flag:"COOKIELESS_SERVER_HASH_MODE_SETTING"},{id:"bounce-rate-duration",title:"Bounce rate duration",component:(0,A.jsx)(Ns,{})},{id:"bounce-rate-page-view-mode",title:"Bounce rate page view mode",component:(0,A.jsx)(Ms,{}),flag:"SETTINGS_BOUNCE_RATE_PAGE_VIEW_MODE"}]},{level:"environment",id:"environment-replay",title:"Session replay",settings:[{id:"replay",title:"Session replay",component:(0,A.jsx)(pl,{})},{id:"replay-network",title:"Network capture",component:(0,A.jsx)(cl,{})},{id:"replay-authorized-domains",title:"Authorized domains for replay",component:(0,A.jsx)(dl,{}),allowForTeam:e=>!!e?.recording_domains?.length},{id:"replay-triggers",title:"Replay triggers",component:(0,A.jsx)(hl,{})},{id:"replay-ingestion",title:"Ingestion controls",component:(0,A.jsx)(Gl,{})},{id:"replay-ai-config",title:"AI recording summary",component:(0,A.jsx)(ml,{}),flag:"AI_SESSION_PERMISSIONS"}]},{level:"environment",id:"environment-surveys",title:"Surveys",settings:[{id:"surveys-interface",title:"Surveys web interface",component:(0,A.jsx)($l,{})}]},{level:"environment",id:"environment-feature-flags",title:"Feature flags",settings:[{id:"feature-flags-interface",title:"Feature flags",component:(0,A.jsx)(Rl,{})}]},{level:"environment",id:"environment-error-tracking",title:"Error tracking",flag:"ERROR_TRACKING",settings:[{id:"exception-autocapture",title:"Exception autocapture",component:(0,A.jsx)(Cr,{})},{id:"error-tracking-user-groups",title:"User groups",description:"Allow collections of users to be assigned to issues",component:(0,A.jsx)(Cc,{})},{id:"error-tracking-symbol-sets",title:"Symbol sets",component:(0,A.jsx)(Rs,{})},{id:"error-tracking-alerting",title:"Alerting",flag:"ERROR_TRACKING_ALERTING",component:(0,A.jsx)(Ls,{})}]},{level:"environment",id:"environment-max",title:"Max AI",flag:"ARTIFICIAL_HOG",settings:[{id:"core-memory",title:"Memory",description:"Max automatically remembers details about your company and product. This context helps our AI assistant provide relevant answers and suggestions. If there are any details you don\u2019t want Max to remember, you can edit or remove them below.",component:(0,A.jsx)(Zs,{}),hideOn:["hosted-clickhouse","hosted"]}]},{level:"environment",id:"environment-toolbar",title:"Toolbar",settings:[{id:"authorized-toolbar-urls",title:"Authorized toolbar URLs",component:(0,A.jsx)(hc,{})}]},{level:"environment",id:"environment-integrations",title:"Integrations",settings:[{id:"integration-webhooks",title:"Webhook integration",component:(0,A.jsx)(Lc,{})},{id:"integration-slack",title:"Slack integration",component:(0,A.jsx)(Yl,{})},{id:"integration-other",title:"Other integrations",component:(0,A.jsx)(Vl,{})},{id:"integration-ip-allowlist",title:"Static IP addresses",component:(0,A.jsx)(Pl,{})}]},{level:"environment",id:"environment-access-control",title:"Access control",settings:[{id:"environment-access-control",title:"Access control",component:(0,A.jsx)(ic,{})}]},{level:"environment",id:"environment-danger-zone",title:"Danger zone",settings:[{id:"project-move",title:"Move project",flag:"!ENVIRONMENTS",component:(0,A.jsx)(Er,{}),allowForTeam:()=>(ee.findMounted()?.values.currentOrganization?.teams.length??0)>1},{id:"environment-delete",title:"Delete environment",component:(0,A.jsx)(rc,{})}]},{level:"project",id:"project-details",title:"General",settings:[{id:"display-name",title:"Display name",component:(0,A.jsx)(Zc,{})}]},{level:"project",id:"project-danger-zone",title:"Danger zone",settings:[{id:"project-move",title:"Move project",component:(0,A.jsx)(Er,{}),allowForTeam:()=>(ee.findMounted()?.values.currentOrganization?.teams.length??0)>1},{id:"project-delete",title:"Delete project",component:(0,A.jsx)(Pi,{})}]},{level:"organization",id:"organization-details",title:"General",settings:[{id:"organization-display-name",title:"Display name",component:(0,A.jsx)(Rc,{})},{id:"organization-logo",title:"Logo",component:(0,A.jsx)(Ec,{})},{id:"organization-ai-consent",title:"PostHog AI data analysis",description:(0,A.jsxs)(A.Fragment,{children:["PostHog AI features, such as our assistant Max, use"," ",(0,A.jsx)(be,{title:`As of ${(0,Wr.default)().format("MMMM YYYY")}: OpenAI for core analysis, Perplexity for fetching product information`,children:(0,A.jsx)("dfn",{children:"external AI services"})})," ","for data analysis.",(0,A.jsx)("br",{}),"This ",(0,A.jsx)("i",{children:"can"})," involve transfer of identifying user data, so we ask for your org-wide consent below.",(0,A.jsx)("br",{}),(0,A.jsx)("strong",{children:"Your data will not be used for training models."})]}),component:(0,A.jsx)(wc,{})}]},{level:"organization",id:"organization-members",title:"Members",settings:[{id:"invites",title:"Pending invites",component:(0,A.jsx)(_c,{})},{id:"members",title:"Organization members",component:(0,A.jsx)(kc,{})},{id:"email-members",title:"Notification preferences",component:(0,A.jsx)(Nc,{})}]},{level:"organization",id:"organization-roles",title:"Roles",settings:[{id:"organization-roles",title:"Roles",component:(0,A.jsx)(Uc,{})}]},{level:"organization",id:"organization-authentication",title:"Authentication domains & SSO",settings:[{id:"authentication-domains",title:"Authentication Domains",component:(0,A.jsx)(Yc,{})}]},{level:"organization",id:"organization-proxy",title:"Managed reverse proxy",settings:[{id:"organization-proxy",title:"Managed reverse proxies",component:(0,A.jsx)(zl,{})}]},{level:"organization",id:"organization-danger-zone",title:"Danger zone",settings:[{id:"organization-delete",title:"Delete organization",component:(0,A.jsx)(Ic,{})}]},{level:"organization",id:"organization-billing",hideSelfHost:!0,title:"Billing",to:ye.organizationBilling(),settings:[]},{level:"user",id:"user-profile",title:"Profile",settings:[{id:"details",title:"Details",component:(0,A.jsx)(ud,{})},{id:"change-password",title:"Change password",component:(0,A.jsx)(ed,{})},{id:"2fa",title:"Two-factor authentication",component:(0,A.jsx)(cd,{})}]},{level:"user",id:"user-api-keys",title:"Personal API keys",settings:[{id:"personal-api-keys",title:"Personal API keys",component:(0,A.jsx)(ld,{})}]},{level:"user",id:"user-customization",title:"Customization",settings:[{id:"theme",title:"Theme",component:(0,A.jsx)(Ss,{onlyLabel:!0})},{id:"notifications",title:"Notifications",component:(0,A.jsx)(dd,{})},{id:"optout",title:"Anonymize data collection",component:(0,A.jsx)(td,{}),hideOn:["cloud"]},{id:"hedgehog-mode",title:"Hedgehog mode",component:(0,A.jsx)(od,{})}]}];var ei=(0,yo.kea)([(0,yo.props)({}),(0,yo.key)(e=>e.logicKey??"global"),(0,yo.path)(e=>["scenes","settings","settingsLogic",e]),(0,yo.connect)({values:[Zo,["featureFlags"],B,["hasAvailableFeature"],Ye,["preflight","isCloudOrDev"],h,["currentTeam"]]}),(0,yo.actions)({selectLevel:e=>({level:e}),selectSection:(e,o)=>({section:e,level:o}),selectSetting:e=>({setting:e}),openCompactNavigation:!0,closeCompactNavigation:!0}),(0,yo.reducers)(({props:e})=>({selectedLevelRaw:[e.settingLevelId??"project",{selectLevel:(o,{level:t})=>t,selectSection:(o,{level:t})=>t}],selectedSectionIdRaw:[e.sectionId??null,{selectLevel:()=>null,selectSection:(o,{section:t})=>t}],selectedSettingId:[e.settingId??null,{selectLevel:()=>null,selectSection:()=>null,selectSetting:(o,{setting:t})=>t}],isCompactNavigationOpen:[!1,{openCompactNavigation:()=>!0,closeCompactNavigation:()=>!1,selectLevel:()=>!1,selectSection:()=>!1,selectSetting:()=>!1}]})),(0,yo.selectors)({levels:[e=>[e.sections],e=>e.reduce((o,t)=>(o.includes(t.level)||o.push(t.level),o),[])],sections:[e=>[e.doesMatchFlags,e.featureFlags,e.isCloudOrDev],(e,o,t)=>{let n=gd.filter(e).filter(i=>!(i.hideSelfHost&&!t));return o[bo.ENVIRONMENTS]?n:n.filter(i=>i.level!=="project").map(i=>({...i,id:i.id.replace("environment-","project-"),level:i.level==="environment"?"project":i.level,settings:i.settings.map(r=>({...r,title:typeof r.title=="string"?r.title.replace("environment","project"):r.title,id:r.id.replace("environment-","project-")}))}))}],selectedLevel:[e=>[e.selectedLevelRaw,e.selectedSectionIdRaw,e.featureFlags],(e,o,t)=>!o||!o.endsWith("-details")&&!o.endsWith("-danger-zone")?t[bo.ENVIRONMENTS]?e==="project"?"environment":e:e==="environment"?"project":e:e],selectedSectionId:[e=>[e.selectedSectionIdRaw,e.featureFlags],(e,o)=>e?!e.endsWith("-details")&&!e.endsWith("-danger-zone")?o[bo.ENVIRONMENTS]?e.replace(/^project/,"environment"):e.replace(/^environment/,"project"):e:null],selectedSection:[e=>[e.sections,e.selectedSectionId],(e,o)=>e.find(t=>t.id===o)??null],settings:[e=>[e.selectedLevel,e.selectedSectionId,e.sections,e.doesMatchFlags,e.preflight,e.currentTeam],(e,o,t,n,i,r)=>{let s=[];return o?s=t.find(l=>l.id===o)?.settings||[]:s=t.filter(l=>l.level===e).reduce((l,g)=>[...l,...g.settings],[]),s.filter(l=>!n(l)||l.hideOn?.includes("cloud")&&i?.cloud?!1:l.allowForTeam?l.allowForTeam(r):!0)}],selectedSetting:[e=>[e.settings,e.selectedSettingId],(e,o)=>e.find(t=>t.id===o)??null],doesMatchFlags:[e=>[e.featureFlags],e=>o=>{if(!o.flag)return!0;let t=Array.isArray(o.flag)?o.flag:[o.flag];for(let n of t){let i=n.startsWith("!")?n.slice(1):n,r=e[bo[i]];if(n.startsWith("!")&&(r=!r),!r)return!1}return!0}]})]);var G=a(f());function kx({hideSections:e=!1,handleLocally:o=!1,...t}){let{selectedSectionId:n,selectedSection:i,selectedLevel:r,selectedSettingId:s,selectedSetting:l,sections:g,settings:p,isCompactNavigationOpen:b,levels:S}=(0,Yt.useValues)(ei(t)),{selectSection:_,selectLevel:y,selectSetting:C,openCompactNavigation:P}=(0,Yt.useActions)(ei(t)),{currentTeam:E}=(0,Yt.useValues)(h),{ref:Y,size:de}=ba({0:"small",700:"medium"},{initialSize:"medium"}),_e=!Zr()&&de==="small",qe=_e?b:!0,Po=t.sectionId&&!!l,Ce=r!=="environment"&&r!=="project"?ts:hd.default.Fragment,Ao=Po?p.map(Te=>({key:Te.id,content:(0,G.jsx)(Or,{active:s===Te.id,handleLocally:o,onClick:()=>C(Te.id),children:Te.title})})):S.map(Te=>({key:Te,content:(0,G.jsx)(Or,{to:ye.settings(Te),handleLocally:o,active:r===Te&&!n,onClick:()=>y(Te),children:(0,G.jsx)("span",{className:"text-secondary",children:vo(Te)})}),items:g.filter(Ro=>Ro.level===Te).map(Ro=>({key:Ro.id,content:(0,G.jsx)(Or,{to:Ro.to??ye.settings(Ro.id),handleLocally:o,active:n===Ro.id,isLink:!!Ro.to,onClick:()=>{Ro.to?yd.router.actions.push(Ro.to):_(Ro.id,Te)},children:Ro.title})}))})),lt=Po?(0,G.jsx)(G.Fragment,{children:l.title}):(0,G.jsxs)(G.Fragment,{children:[vo(r),i?(0,G.jsxs)(G.Fragment,{children:["` / `",i.title]}):null]});return(0,G.jsxs)("div",{className:(0,fd.default)("Settings flex",_e&&"Settings--compact"),ref:Y,children:[e?null:(0,G.jsxs)(G.Fragment,{children:[qe?(0,G.jsx)("div",{className:"Settings__sections",children:(0,G.jsx)(bd,{options:Ao})}):(0,G.jsx)(u,{fullWidth:!0,sideIcon:(0,G.jsx)(Kr,{}),onClick:()=>P(),children:lt}),_e?(0,G.jsx)(Bo,{}):null]}),(0,G.jsx)(Ce,{children:(0,G.jsxs)("div",{className:"flex-1 w-full space-y-2 min-w-0",children:[!e&&r==="project"&&(0,G.jsxs)(fe,{type:"info",children:["These settings only apply to the current project"," ",E?.name?(0,G.jsxs)(G.Fragment,{children:["(",(0,G.jsx)("b",{children:E.name}),")"]}):null,"."]}),(0,G.jsx)(op,{...t,handleLocally:o})]})})]})}function op(e){let{settings:o,selectedLevel:t,selectedSectionId:n,selectedSetting:i}=(0,Yt.useValues)(ei(e)),{selectSetting:r}=(0,Yt.useActions)(ei(e)),s=!!i&&!!e.sectionId,l=s?[i]:o;return(0,G.jsx)("div",{className:"space-y-8",children:l.length?l.map(g=>(0,G.jsxs)("div",{className:"relative",children:[!s&&(0,G.jsxs)("h2",{id:g.id,className:"flex gap-2 items-center",children:[g.title,e.logicKey==="settingsScene"&&(0,G.jsx)(u,{icon:(0,G.jsx)(ia,{}),size:"small",to:ye.settings(n??t,g.id),onClick:p=>{r(g.id),p.preventDefault()}})]}),g.description&&(0,G.jsx)("p",{className:"max-w-160",children:g.description}),g.component]},g.id)):(0,G.jsx)(ns,{object:"setting"})})}var tp={1:"pl-4"},bd=({options:e,depth:o=0})=>(0,G.jsx)("ul",{className:"space-y-px",children:e.map(t=>(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("li",{className:tp[o],children:t.content},t.key),t.items?(0,G.jsx)(bd,{options:t.items,depth:o+1}):null]}))}),Or=({to:e,active:o,onClick:t,children:n,handleLocally:i,isLink:r=!1})=>(0,G.jsx)(u,{to:e,onClick:i?s=>{t(),s.preventDefault()}:void 0,size:"small",sideIcon:r?(0,G.jsx)(ma,{}):void 0,fullWidth:!0,active:o,children:n});export{ql as a,ei as b,kx as c};
//# sourceMappingURL=/static/chunk-YMJSMEVZ.js.map
