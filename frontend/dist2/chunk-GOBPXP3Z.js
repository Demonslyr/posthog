import{Ea as R,Fa as H,Ga as P,Mi as C,Pe as B,Qb as F,Sa as W,Sd as $,ca as z,ee as V,fe as w,h as te,io as x,pc as U,qc as Y,r as g}from"/static/chunk-TW5IU73S.js";import{Ia as X,Wa as k,a as re,na as j}from"/static/chunk-3UDJFOQH.js";import{b as ne,d as f,e as c,g as m,j as p}from"/static/chunk-SJXEOBQC.js";var q=ne((Fe,O)=>{"use strict";c();p();m();(function(){"use strict";var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var i=arguments[a];i&&(o=s(o,t(i)))}return o}function t(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var i in o)e.call(o,i)&&o[i]&&(a=s(a,i));return a}function s(o,a){return a?o?o+" "+a:o+a:o}typeof O<"u"&&O.exports?(n.default=n,O.exports=n):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return n}):window.classNames=n})()});c();p();m();var d=f(g());function K({inputDisplay:e,outputDisplay:n,inputHeading:t="Input",outputHeading:s="Output",bordered:o=!1}){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(V,{className:"my-3"}),(0,d.jsxs)("div",{className:o?"bg-surface-primary rounded-lg border p-2":void 0,children:[(0,d.jsxs)("h4",{className:"flex items-center gap-x-1.5 text-xs font-semibold mb-2",children:[(0,d.jsx)(H,{className:"text-base"}),t]}),e,(0,d.jsxs)("h4",{className:"flex items-center gap-x-1.5 text-xs font-semibold my-2",children:[(0,d.jsx)(P,{className:"text-base"}),s]}),n]})]})}c();p();m();function G(e,n){return`${e} \u2192 ${n||0} (\u2211\xA0${e+(n||0)})`}function Le(e){return"properties"in e&&typeof e.properties.$ai_input_tokens=="number"?G(e.properties.$ai_input_tokens,e.properties.$ai_output_tokens):!("properties"in e)&&typeof e.inputTokens=="number"?G(e.inputTokens,e.outputTokens):null}function he(e){return`${Math.round(e*100)/100}\xA0s`}var oe=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:4});function Ae(e){return oe.format(e)}function se(e){return"properties"in e}function ae(e){return e!==null&&typeof e=="object"&&"type"in e&&"function"in e&&e.type==="function"&&typeof e.function=="object"&&e.function!==null}function ie(e){return Array.isArray(e)&&e.every(ae)}function le(e){return!!e&&typeof e=="object"&&"role"in e&&"content"in e&&typeof e.content=="string"}function ce(e){return e.map(t=>({...t,function:{...t.function,arguments:typeof t.function.arguments=="string"?JSON.parse(t.function.arguments):t.function.arguments}}))}function me(e){return!!e&&typeof e=="object"&&"type"in e&&e.type==="text"}function pe(e){return!!e&&typeof e=="object"&&"type"in e&&e.type==="tool_use"}function fe(e){return!!e&&typeof e=="object"&&"type"in e&&e.type==="tool_result"}function de(e){return!!e&&typeof e=="object"&&"role"in e&&"content"in e&&(typeof e.content=="string"||Array.isArray(e.content))}function v(e,n){let t=n||"assistant";return le(e)?[{...e,role:e.role,content:e.content,tool_calls:ie(e.tool_calls)?ce(e.tool_calls):void 0,tool_call_id:e.tool_call_id}]:me(e)?[{role:t,content:e.text}]:pe(e)?[{role:t,content:"",tool_calls:[{type:"function",id:e.id,function:{name:e.name,arguments:e.input}}]}]:fe(e)?Array.isArray(e.content)?e.content.map(s=>v(s,t)).flat().map(s=>({...s,tool_call_id:e.tool_use_id})):[{role:t,content:e.content,tool_call_id:e.tool_use_id}]:de(e)?Array.isArray(e.content)?e.content.map(s=>v(s,e.role)).flat():[{role:e.role,content:e.content}]:[{role:"message",content:typeof e=="string"?e:JSON.stringify(e)}]}function J(e,n){return e?Array.isArray(e)?e.map(t=>v(t,n)).flat():typeof e=="object"&&"choices"in e&&Array.isArray(e.choices)?e.choices.map(t=>v(t,n)).flat():null:null}function Ne(e){return(0,j.default)(e).utc().format("YYYY-MM-DDTHH:mm:ss[Z]")}function we(e){if(se(e)){if(e.event==="$ai_generation"){let n=e.properties.$ai_model||"Generation";return e.properties.$ai_provider?`${n} (${e.properties.$ai_provider})`:n}return e.properties.$ai_span_name??"Span"}return e.traceName??"Trace"}c();p();m();var Z=f(te());var S=f(re());var r=f(g());function ze({input:e,output:n,httpStatus:t,raisedError:s,bordered:o=!1}){let a=J(e,"user"),i=J(n,"assistant"),M=s?(0,r.jsxs)("div",{className:"flex items-center gap-1.5 rounded border text-default p-2 font-medium bg-[var(--bg-fill-error-tertiary)] border-danger overflow-x-scroll",children:[(0,r.jsx)(z,{className:"text-base"}),k(n)?(0,r.jsx)(x,{src:n,collapsed:4}):(0,r.jsx)("span",{className:"font-mono",children:(()=>{try{let u=JSON.parse(n);return k(u)?(0,r.jsx)(x,{src:u,collapsed:5}):JSON.stringify(n??null)}catch{return JSON.stringify(n??null)}})()})]}):i?.map((u,b)=>(0,r.jsx)(_,{message:u,isOutput:!0},b))||(0,r.jsx)("div",{className:"rounded border text-default p-2 italic bg-[var(--bg-fill-error-tertiary)]",children:"No output"});return(0,r.jsx)(K,{inputDisplay:a?.map((u,b)=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_,{message:u},b),b<a.length-1&&(0,r.jsx)("div",{className:"border-l ml-2 h-2"})]}))||(0,r.jsx)("div",{className:"rounded border text-default p-2 italic bg-[var(--bg-fill-error-tertiary)]",children:"No input"}),outputDisplay:M,outputHeading:s?`Error (${t})`:`Output${i&&i.length>1?" (multiple choices)":""}`,bordered:o})}var _=S.default.memo(({message:e,isOutput:n})=>{let{role:t,content:s,...o}=e,[a,i]=S.default.useState(!0),[M,u]=S.default.useState(!0),b=s?/(\n\s*```|^>\s|#{1,6}\s)/.test(s):!1,D=Object.fromEntries(Object.entries(o).filter(([,l])=>l!==void 0)),ee=l=>{if(!l)return null;let N=l.trim();if(N.startsWith("{")&&N.endsWith("}")||N.startsWith("[")&&N.endsWith("]"))try{let E=JSON.parse(l);if(typeof E=="object"&&E!==null)return(0,r.jsx)(x,{src:E,name:null,collapsed:5})}catch{}return b?a?(0,r.jsx)(B,{children:l}):(0,r.jsx)("span",{className:"font-mono text-xs whitespace-pre-wrap",children:l}):(0,r.jsx)("span",{className:"text-xs whitespace-pre-wrap",children:l})};return(0,r.jsxs)("div",{className:(0,Z.default)("rounded border text-default",n?"bg-[var(--bg-fill-success-tertiary)]":t==="user"?"bg-[var(--bg-fill-tertiary)]":t==="assistant"?"bg-[var(--bg-fill-info-tertiary)]":null),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 w-full px-2 h-6 text-xs font-medium",children:[(0,r.jsx)("span",{className:"grow",children:t}),s&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($,{size:"small",noPadding:!0,icon:M?(0,r.jsx)(R,{}):(0,r.jsx)(F,{}),tooltip:"Toggle message content",onClick:()=>u(l=>!l)}),b&&(0,r.jsx)($,{size:"small",noPadding:!0,icon:a?(0,r.jsx)(Y,{}):(0,r.jsx)(U,{}),tooltip:"Toggle markdown rendering",onClick:()=>i(l=>!l)}),(0,r.jsx)(C,{iconSize:"small",description:"message content",explicitValue:s})]})]}),M&&!!s&&(0,r.jsx)("div",{className:"p-2 border-t",children:ee(s)}),M&&Object.keys(D).length>0&&(0,r.jsx)("div",{className:"p-2 text-xs border-t",children:(0,r.jsx)(x,{src:D,name:null,collapsed:5})})]})});_.displayName="LLMMessageDisplay";c();p();m();var Q=f(q());c();p();m();var I=f(g());function A({children:e,label:n,textToCopy:t}){let s=e;return typeof t=="string"?s=(0,I.jsx)(C,{iconSize:"xsmall",description:t,tooltipMessage:n,children:e}):s=(0,I.jsx)(W,{title:n,children:e}),(0,I.jsx)(w,{className:"bg-surface-primary cursor-default",children:s})}var y=f(g());function tn({inputTokens:e,outputTokens:n,totalCostUsd:t,model:s,latency:o,className:a,isError:i}){return(0,y.jsxs)("div",{className:(0,Q.default)("flex flex-wrap gap-2",a),children:[i&&(0,y.jsx)(w,{type:"danger",children:"Error"}),typeof o=="number"&&(0,y.jsx)(A,{label:"Latency",children:`${Math.round(o*1e3)/1e3} s of latency`}),typeof e=="number"&&typeof n=="number"&&(0,y.jsx)(A,{label:"Token usage",children:`${e} prompt tokens \u2192 ${n} completion tokens (\u2211 ${e+n})`}),s&&(0,y.jsx)(A,{label:"Model",textToCopy:X(s),children:s}),typeof t=="number"&&(0,y.jsx)(A,{label:"Total generation cost",children:`$${Math.round(t*1e7)/1e7}`})]})}export{K as a,Le as b,he as c,Ae as d,se as e,Ne as f,we as g,ze as h,q as i,tn as j};
/*! Bundled license information:

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)
*/
//# sourceMappingURL=/static/chunk-GOBPXP3Z.js.map
