import{a as H}from"/static/chunk-K6PZB6NF.js";import{a as u}from"/static/chunk-TIKFJXRT.js";import{a as P}from"/static/chunk-AZNOCCXL.js";import{j as R}from"/static/chunk-YDKHEMDP.js";import{$a as _w,Ae as Z,Cd as q,Ce as T,Do as y,Gm as C,Kc as F,Oe as d,Sd as r,Ta as c,Tb as x,Tf as m,Yh as L,a as M,ae as K,af as Y,ce as V,de as E,ee as O,f as mw,fe as b,h as yw,ie as f,r as W,se as Q,vo as B}from"/static/chunk-TW5IU73S.js";import{a as uw}from"/static/chunk-3UDJFOQH.js";import{d as i,e as g,g as v,j as N}from"/static/chunk-SJXEOBQC.js";g();N();v();var nw=i(yw()),_=i(M()),tw=i(_w()),G=i(mw());var rw=i(uw());g();N();v();var D=i(M());var A="/static/assets/early-access-feature-demo-PGQL2RR6.png";var o=i(W());function ww({onClose:n,visible:e,flag:s}){let{preflight:a}=(0,D.useValues)(Y),t=()=>(0,o.jsx)(K,{className:"mt-2 bg-surface-primary",defaultActiveKey:"1",panels:[{key:"1",header:"Option 1: Widget Site App",content:(0,o.jsxs)("div",{children:["Give your users a"," ",(0,o.jsx)(c,{to:y.pipelineNodeNew("site-app",a?.region==="EU"?332:574),children:"prebuilt widget"})," ","to opt-in to features",(0,o.jsx)("img",{className:"max-h-full max-w-full mt-2.5",src:A})]})},{key:"2",header:"Option 2: Custom implementation",content:(0,o.jsxs)("div",{children:[(0,o.jsx)("b",{children:"Opt user in"}),(0,o.jsx)("div",{children:(0,o.jsx)(h,{flag:s})}),(0,o.jsx)("b",{children:"Opt user out"}),(0,o.jsx)("div",{children:(0,o.jsx)(J,{flag:s})}),(0,o.jsx)("b",{children:"Retrieve Previews"}),(0,o.jsx)("div",{children:(0,o.jsx)(X,{})})]})}]}),p=()=>(0,o.jsxs)("div",{children:[(0,o.jsx)("b",{children:"Opt user in"}),(0,o.jsx)("div",{children:(0,o.jsx)(h,{flag:s})}),(0,o.jsx)("b",{children:"Opt user out"}),(0,o.jsx)("div",{children:(0,o.jsx)(J,{flag:s})}),(0,o.jsx)("b",{children:"Retrieve Previews"}),(0,o.jsx)("div",{children:(0,o.jsx)(X,{})})]}),k=a?.cloud?t():p();return(0,o.jsx)(V,{title:"How to implement opt-in feature flags",isOpen:e,onClose:n,width:640,children:(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"mb-2",children:"Implement manual release condition toggles to give your users the ability choose which features they want to try"}),k]})})}function h({flag:n}){return(0,o.jsx)(d,{language:"javascript",wrap:!0,children:`posthog.updateEarlyAccessFeatureEnrollment("${n}", true)
`})}function J({flag:n}){return(0,o.jsx)(d,{language:"javascript",wrap:!0,children:`posthog.updateEarlyAccessFeatureEnrollment("${n}", false)
`})}function X(){return(0,o.jsx)(d,{language:"javascript",wrap:!0,children:`posthog.getEarlyAccessFeatures((previewItemData) => {
    // do something with early access feature
})
`})}var w=i(W()),ue={component:Ww,logic:u,paramsToProps:({params:{id:n}})=>({id:n&&n!=="new"?n:"new"})};function Ww({id:n}={}){let{earlyAccessFeature:e,earlyAccessFeatureLoading:s,isEarlyAccessFeatureSubmitting:a,isEditingFeature:t,earlyAccessFeatureMissing:p,implementOptInInstructionsModal:k}=(0,_.useValues)(u),{submitEarlyAccessFeatureRequest:sw,loadEarlyAccessFeature:aw,editFeature:z,updateStage:S,deleteEarlyAccessFeature:iw,toggleImplementOptInInstructionsModal:I}=(0,_.useActions)(u),l=n==="new"||n===void 0,lw=L("HOG_FUNCTIONS_LINKED");if(p)return(0,w.jsx)(C,{object:"early access feature"});if(s)return(0,w.jsx)(Q,{active:!0});let U=!t&&!l&&"id"in e&&lw?{events:[{id:"$feature_enrollment_update",type:"events",properties:[{key:"$feature_flag",value:[e.feature_flag.key],operator:"exact",type:"event"}]}]}:null;return(0,w.jsxs)(tw.Form,{id:"early-access-feature",formKey:"earlyAccessFeature",logic:u,children:[(0,w.jsx)(B,{buttons:s?void 0:e.stage!="general-availability"&&(l||t)?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(r,{type:"secondary","data-attr":"cancel-feature",onClick:()=>{t?(z(!1),aw()):G.router.actions.push(y.earlyAccessFeatures())},disabledReason:a?"Saving\u2026":void 0,children:"Cancel"}),(0,w.jsx)(r,{type:"primary",htmlType:"submit","data-attr":"save-feature",onClick:()=>{sw(e)},loading:a,form:"early-access-feature",children:l?"Save as draft":"Save"})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(r,{"data-attr":"delete-feature",status:"danger",type:"secondary",onClick:()=>{E.open({title:"Permanently delete feature?",description:"Doing so will remove any opt in conditions from the feature flag.",primaryButton:{children:"Delete",type:"primary",status:"danger","data-attr":"confirm-delete-feature",onClick:()=>{iw(e?.id)}},secondaryButton:{children:"Close",type:"secondary"}})},children:"Delete"}),e.stage=="beta"&&(0,w.jsx)(r,{"data-attr":"archive-feature",type:"secondary",onClick:()=>S("archived"),children:"Archive"}),e.stage=="archived"&&(0,w.jsx)(r,{"data-attr":"reactive-feature",type:"secondary",onClick:()=>S("beta"),children:"Reactivate beta"}),e.stage=="draft"&&(0,w.jsx)(r,{onClick:()=>S("beta"),tooltip:"Make beta feature available",type:"primary",children:"Release beta"}),(0,w.jsx)(O,{vertical:!0}),e.stage!="general-availability"&&(0,w.jsx)(r,{type:"secondary",onClick:()=>z(!0),loading:!1,"data-attr":"edit-feature",children:"Edit"})]}),delimited:!0}),(0,w.jsxs)("div",{className:(0,nw.default)(t||l?"max-w-160":null),children:[(0,w.jsxs)("div",{className:"flex flex-col gap-4 flex-2 min-w-[15rem]",children:[l&&(0,w.jsx)(m,{name:"name",label:"Name",children:(0,w.jsx)(f,{"data-attr":"feature-name"})}),(0,w.jsxs)("div",{className:"flex flex-wrap items-start gap-4",children:[(0,w.jsx)("div",{className:"flex-1 min-w-[20rem]",children:"feature_flag"in e?(0,w.jsx)(m.Pure,{label:"Connected Feature flag",children:(0,w.jsx)("div",{children:(0,w.jsx)(r,{type:"secondary",onClick:()=>e.feature_flag&&G.router.actions.push(y.featureFlag(e.feature_flag.id)),icon:(0,w.jsx)(x,{}),children:e.feature_flag.key})})}):(0,w.jsx)(m,{name:"feature_flag_id",label:"Link feature flag (optional)",info:(0,w.jsx)(w.Fragment,{children:"A feature flag will be generated from feature name if not provided"}),children:({value:$,onChange:j})=>(0,w.jsxs)("div",{className:"flex",children:[(0,w.jsx)(H,{value:$,onChange:j}),$&&(0,w.jsx)(r,{className:"ml-2",icon:(0,w.jsx)(q,{}),size:"small",onClick:()=>j(void 0),"aria-label":"close"})]})})}),t||l?(0,w.jsx)(w.Fragment,{}):(0,w.jsxs)("div",{className:"flex-1 min-w-[20rem]",children:[(0,w.jsx)("b",{children:"Stage"}),(0,w.jsx)("div",{children:(0,w.jsx)(b,{type:e.stage==="beta"?"warning":e.stage==="general-availability"?"success":"default",className:"mt-2 uppercase",children:e.stage})})]})]}),(0,w.jsxs)("div",{className:"flex flex-wrap items-start gap-4",children:[(0,w.jsx)("div",{className:"flex-1 min-w-[20rem]",children:t||l?(0,w.jsx)(m,{name:"description",label:"Description",showOptional:!0,children:(0,w.jsx)(T,{className:"ph-ignore-input",placeholder:"Help your users understand the feature"})}):(0,w.jsxs)("div",{className:"mb-2",children:[(0,w.jsx)("b",{children:"Description"}),(0,w.jsx)("div",{children:e.description?e.description:(0,w.jsx)("span",{className:"text-secondary",children:"No description"})})]})}),(0,w.jsx)("div",{className:"flex-1 min-w-[20rem]",children:t||l?(0,w.jsx)(m,{name:"documentation_url",label:"Documentation URL",showOptional:!0,children:(0,w.jsx)(f,{autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:!1})}):(0,w.jsxs)("div",{className:"mb-2",children:[(0,w.jsx)("b",{children:"Documentation URL"}),(0,w.jsx)("div",{children:e.documentation_url?(0,w.jsx)(c,{to:e.documentation_url,target:"_blank",children:e.documentation_url}):(0,w.jsx)("span",{className:"text-secondary",children:"No documentation URL"})})]})})]})]}),U&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(O,{className:"my-8"}),(0,w.jsx)("h3",{children:"Notifications"}),(0,w.jsx)("p",{children:"Get notified when people opt in or out of your feature."}),(0,w.jsx)(P,{logicKey:"early-access-feature",type:"destination",filters:U,subTemplateId:"early-access-feature-enrollment"})]}),!t&&!l&&"id"in e&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(O,{className:"my-8"}),(0,w.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,w.jsxs)("div",{children:[(0,w.jsx)("h3",{children:"Users"}),(0,w.jsxs)("p",{children:["When a user opts in or out of the feature they will be listed here. You can choose to"," ",(0,w.jsx)(c,{onClick:I,children:"implement your own opt-in interface or use our provided app."})]})]}),(0,w.jsx)(r,{onClick:I,sideIcon:(0,w.jsx)(F,{}),type:"secondary",children:"Implement public opt-in"},"help-button")]}),(0,w.jsx)(Ow,{earlyAccessFeature:e})]})]}),"id"in e?(0,w.jsx)(ww,{flag:e.feature_flag.key,visible:k,onClose:I}):null]})}function ew(n,e){return{filter_group:{type:"AND",values:[{type:"AND",values:[{type:"events",order:0,id:"$feature_enrollment_update",name:"$feature_enrollment_update",properties:[{key:"$feature_enrollment",value:[e?"true":"false"],operator:"exact",type:"event"},{key:"$feature_flag",value:[n.feature_flag.key],operator:"exact",type:"event"}]}]}]}}}function Ow({earlyAccessFeature:n}){let{activeTab:e}=(0,_.useValues)(u),{setActiveTab:s}=(0,_.useActions)(u),a="$feature_enrollment/"+n.feature_flag.key;return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(Z,{activeKey:e,onChange:t=>s(t),tabs:[{key:"opted-in",label:"Opted-In Users",content:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(ow,{recordingsFilters:ew(n,!0),properties:[{key:a,type:"person",operator:"exact",value:["true"]}]})})},{key:"opted-out",label:"Opted-Out Users",content:(0,w.jsx)(ow,{recordingsFilters:ew(n,!1),properties:[{key:a,type:"person",operator:"exact",value:["false"]}]})}]})})}function ow({recordingsFilters:n,properties:e}){let[s,a]=(0,rw.useState)({kind:"DataTableNode",source:{kind:"ActorsQuery",fixedProperties:e},full:!0,propertiesViaUrl:!1});return(0,w.jsxs)("div",{className:"relative",children:[(0,w.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,w.jsx)(r,{to:y.replay("home",n),type:"secondary",children:"View recordings"},"view-opt-in-session-recordings")}),(0,w.jsx)(R,{query:s,setQuery:a})]})}export{ue as a,Ww as b,Ow as c};
//# sourceMappingURL=/static/chunk-VB6FMIJU.js.map
