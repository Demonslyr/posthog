import{j as N}from"/static/chunk-YDKHEMDP.js";import"/static/chunk-7SO55T25.js";import{n as b}from"/static/chunk-KBNOIM2W.js";import"/static/chunk-BB32DDTD.js";import"/static/chunk-QB3AUFV2.js";import"/static/chunk-PWG7LMNW.js";import"/static/chunk-CEZSENEJ.js";import"/static/chunk-GOBPXP3Z.js";import{Cb as v,Do as S,K as E,Nb as D,Sa as T,Sc as B,Sd as g,Ta as h,Wd as C,Xd as k,a as R,af as w,ei as F,f as I,ke as _,m as A,r as L}from"/static/chunk-TW5IU73S.js";import"/static/chunk-XPJ4MQJV.js";import"/static/chunk-KQJ3FYBQ.js";import{a as Q}from"/static/chunk-3UDJFOQH.js";import"/static/chunk-HHT4SG7V.js";import"/static/chunk-K7LQKAJG.js";import"/static/chunk-QQTK3LZH.js";import"/static/chunk-IJQNM355.js";import"/static/chunk-4CN6THWS.js";import"/static/chunk-272RTCFX.js";import"/static/chunk-2ROB4QWU.js";import"/static/chunk-ALT2ZZSO.js";import"/static/chunk-UE6SLBBN.js";import"/static/chunk-GINZUAUY.js";import"/static/chunk-SQELCOUW.js";import"/static/chunk-IGYUTZ65.js";import"/static/chunk-YM6UBNGD.js";import"/static/chunk-C6TQ5FFZ.js";import"/static/chunk-GXGA523B.js";import"/static/chunk-N4MMWRNK.js";import"/static/chunk-NRLAI7OY.js";import"/static/chunk-LVVHNICT.js";import"/static/chunk-2AXSSSSX.js";import"/static/chunk-DGXQI7RB.js";import"/static/chunk-HUCRWDLX.js";import"/static/chunk-RFEQG3YN.js";import"/static/chunk-PUISI233.js";import{d as p,e as d,g as f,j as y}from"/static/chunk-SJXEOBQC.js";d();y();f();var a=p(R());var U=p(Q());d();y();f();var s=p(R()),x=p(I());var P=[],J=["Source","Medium","ChannelType","ReferringDomain"],X={date_from:"-7d",date_to:"now"},u=(0,s.kea)([(0,s.path)(["scenes","webAnalytics","sessionDebuggerLogic"]),(0,s.connect)(()=>({values:[A,["featureFlags"]]})),(0,s.actions)({setProperties:e=>({properties:e}),setDateRange:e=>({dateRange:e}),setStateFromUrl:e=>({state:e}),enableGroupBy:e=>({groupBy:e}),disableGroupBy:e=>({groupBy:e})}),(0,s.reducers)({properties:[P,{setProperties:(e,{properties:r})=>r,setStateFromUrl:(e,{state:r})=>r.properties}],dateRange:[null,{setDateRange:(e,{dateRange:r})=>r,setStateFromUrl:(e,{state:r})=>r.dateRange}],groupBy:[J,{enableGroupBy:(e,{groupBy:r})=>Array.from(new Set([...e,r])),disableGroupBy:(e,{groupBy:r})=>e.filter(o=>o!==r)}]}),(0,s.selectors)({query:[e=>[e.properties,e.dateRange,e.groupBy],(e,r,o)=>{let n={properties:e,dateRange:r??X},i={kind:"SessionAttributionExplorerQuery",groupBy:o,filters:n};return{kind:"DataTableNode",source:i,showPropertyFilter:["session_properties"],showDateRange:!0,showOpenEditorButton:!0,showReload:!0}}]}),(0,x.actionToUrl)(({values:e})=>{let r=()=>{let{properties:o,dateRange:n}=e,i={};return o.length>0&&(i.properties=o),n&&(i.dateRange=n),[S.sessionAttributionExplorer(),i]};return{setProperties:r,setDateRange:r}}),(0,x.urlToAction)(({actions:e})=>({[S.sessionAttributionExplorer()]:(r,{properties:o,dateRange:n})=>{let i=b(o)?o:P,m=n??null;e.setStateFromUrl({properties:i,dateRange:m})}}))]);var t=p(L());function z(){return(0,t.jsx)(V,{})}var ve={component:z,logic:u},l=({value:e})=>{let[r,o]=U.default.useState(!1);return e==null||Array.isArray(e)&&e.length===0?(0,t.jsx)(T,{title:"NULL",children:(0,t.jsx)("span",{"aria-hidden":!0,className:"cursor-default",children:"\u2014"})}):Array.isArray(e)?(0,t.jsxs)("div",{className:"flex flex-row",children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:(0,t.jsx)(g,{active:r,onClick:()=>{o(!r)},icon:r?(0,t.jsx)(v,{}):(0,t.jsx)(D,{}),title:r?"Show less":"Show more",size:"small"})})}),(0,t.jsx)("div",{className:"flex flex-col items-center justify-center",children:(0,t.jsx)("div",{className:"flex flex-1",children:r?(0,t.jsx)("ul",{className:"flex-1 flex flex-col",children:e.map(n=>(0,t.jsx)("li",{className:"flex-1 mb-1 break-all",children:n},n))}):e[0]})})]}):(0,t.jsx)("div",{children:e})},W={columns:{channel_type:{title:"Channel type",render:l},count:{title:"Session count",align:"right"},referring_domain:{title:"Referring domain",render:l},utm_source:{title:"UTM source",render:l},utm_medium:{title:"UTM medium",render:l},utm_campaign:{title:"UTM campaign",render:l},ad_ids:{title:"Ad IDs",render:l},example_entry_urls:{title:"Example entry URLs",render:l}},emptyStateHeading:"There are no matching sessions for this query",emptyStateDetail:"Try changing the date range, or changing the property filters."},j=[{label:"Channel type",value:"ChannelType"},{label:"Referring domain",value:"ReferringDomain"},{label:"UTM source",value:"Source"},{label:"UTM medium",value:"Medium"},{label:"UTM campaign",value:"Campaign"},{label:"Ad IDs",value:"AdIds"},{label:"Entry URL",value:"InitialURL"}],K=()=>{let{groupBy:e}=(0,a.useValues)(u),{enableGroupBy:r,disableGroupBy:o}=(0,a.useActions)(u);return(0,t.jsx)("div",{className:"mb-2",children:(0,t.jsx)(_,{items:j.map(({label:n,value:i})=>({label:()=>(0,t.jsx)(k,{checked:e.includes(i),onChange:m=>{m?r(i):o(i)},fullWidth:!0,label:n})})),closeOnClickInside:!1,children:(0,t.jsx)(g,{icon:(0,t.jsx)(B,{}),size:"small",type:"secondary",children:"Group by"})})})};function V(){let{query:e}=(0,a.useValues)(u),{setDateRange:r,setProperties:o}=(0,a.useActions)(u),{preflight:n}=(0,a.useValues)(w),{openSupportForm:i}=(0,a.useActions)(F),m=n?.cloud;return(0,t.jsxs)("div",{children:[(0,t.jsx)(C,{type:"info",className:"my-4",children:(0,t.jsxs)("div",{className:"flex items-center flex-wrap gap-2 justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-full sm:min-w-0",children:[(0,t.jsxs)("p",{children:["You can use the Session attribution explorer (beta) to understand how your sessions are attributed. We use the referring domain, ",(0,t.jsx)("code",{children:"utm_source"}),", ",(0,t.jsx)("code",{children:"utm_medium"}),","," ",(0,t.jsx)("code",{children:"utm_campaign"}),", and the presence of advertising ids like ",(0,t.jsx)("code",{children:"gclid"})," and"," ",(0,t.jsx)("code",{children:"gad_source"}),", to assign a session a"," ",(0,t.jsx)(h,{to:"https://posthog.com/docs/data/channel-type",children:"Channel type"}),"."]}),(0,t.jsxs)("p",{children:["If you believe that a session is attributed incorrectly, please let us know! If you'd like to customize your Channel attribution, please leave feedback on the"," ",(0,t.jsx)(h,{to:"https://github.com/PostHog/posthog/issues/21195",children:"feature request"}),"."]})]}),m?(0,t.jsx)("span",{className:"flex items-center gap-2",children:(0,t.jsx)(g,{type:"secondary",icon:(0,t.jsx)(E,{}),onClick:()=>i({kind:"feedback",isEmailFormOpen:!0,target_area:"web_analytics"}),children:"Give feedback"})}):null]})}),(0,t.jsx)(K,{}),(0,t.jsx)(N,{context:W,query:e,setQuery:G=>{let c=G.source;c.filters&&b(c.filters.properties)?o(c.filters.properties):o([]),r(c.filters?.dateRange??null)}})]})}export{K as GroupByFilter,V as SessionAttributionExplorer,z as SessionAttributionExplorerScene,ve as scene};
//# sourceMappingURL=/static/SessionAttributionExplorerScene-QZWOIK4A.js.map
