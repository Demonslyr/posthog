import{c as y}from"/static/chunk-X3DMY2SE.js";import{$a as Q,Ac as R,Db as O,N as E,Sa as F,Sc as A,Sd as r,Tf as W,a as Y,de as D,fe as K,h as q,ie as N,na as B,r as S,td as P}from"/static/chunk-RFJTZKD6.js";import{a as H}from"/static/chunk-3UDJFOQH.js";import{d as p,e as T,g as w,j as C}from"/static/chunk-SJXEOBQC.js";T();C();w();var $=p(q()),d=p(Y()),M=p(Q());var G=p(H());var e=p(S());function Z({experimentId:i,actionId:a,type:n}){let t=y({experimentId:i??null,actionId:a??null,type:n}),{urlsKeyed:u,searchTerm:s,suggestionsLoading:l,isAddUrlFormVisible:h}=(0,d.useValues)(t),{loadSuggestions:b}=(0,d.useActions)(t),c=n==="RECORDING_DOMAINS"?"domain":"URL",[g,v]=u.reduce(([I,L],f)=>(f.type==="suggestion"?I.push(f):L.push(f),[I,L]),[[],[]]),m=(0,G.useMemo)(()=>v.length>0||h?null:s.length>0&&g.length===0?(0,e.jsxs)(e.Fragment,{children:["There are no authorized ",c,"s that match your search."]}):g.length>0?(0,e.jsxs)("p",{className:"mb-0",children:["There are no authorized ",c,"s. ",(0,e.jsx)("br",{}),"We've found some URLs you've used PostHog from in the last 3 days. Consider authorizing them.",(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:n==="RECORDING_DOMAINS"&&" When no domains are specified, recordings will be authorized on all domains."})]}):(0,e.jsxs)("div",{className:"flex flex-row items-center justify-between w-full",children:[(0,e.jsxs)("p",{children:[(0,e.jsxs)("span",{className:"font-bold",children:["There are no authorized ",c,"s."]}),(0,e.jsx)("br",{}),"Add one to get started. When you send us events we'll suggest the ones that you should authorize.",(0,e.jsx)("br",{}),(0,e.jsx)("span",{children:n==="RECORDING_DOMAINS"&&" When no domains are specified, recordings will be authorized on all domains."})]}),(0,e.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,e.jsx)(r,{onClick:b,disabled:l,type:"secondary",icon:(0,e.jsx)(B,{}),"data-attr":"toolbar-add-url",children:l?"Fetching...":"Fetch suggestions"}),(0,e.jsx)("span",{className:"text-small text-secondary",children:"Sent an event? Refetch suggestions."})]})]}),[v.length,h,s.length,g.length,l,n,c,b]);return m?(0,e.jsx)("div",{className:"border rounded p-4 text-secondary",children:m}):null}function _({actionId:i,experimentId:a,type:n,allowWildCards:t}){let u=y({actionId:i??null,experimentId:a??null,type:n,allowWildCards:t}),{isProposedUrlSubmitting:s}=(0,d.useValues)(u),{cancelProposingUrl:l}=(0,d.useActions)(u);return(0,e.jsxs)(M.Form,{logic:y,props:{actionId:i,type:n,experimentId:a,allowWildCards:t},formKey:"proposedUrl",enableFormOnSubmit:!0,className:"w-full space-y-2",children:[(0,e.jsx)(W,{name:"url",children:(0,e.jsx)(N,{autoFocus:!0,placeholder:t?"Enter a URL or wildcard subdomain (e.g. https://*.posthog.com)":"Enter a URL (e.g. https://posthog.com)","data-attr":"url-input"})}),(0,e.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,e.jsx)(r,{type:"secondary",onClick:l,children:"Cancel"}),(0,e.jsx)(r,{htmlType:"submit",type:"primary",disabled:s,"data-attr":"url-save",children:"Save"})]})]})}function pe({actionId:i,experimentId:a,query:n,type:t,addText:u="Add",allowWildCards:s}){let l=y({experimentId:a??null,actionId:i??null,type:t,query:n,allowWildCards:s}),{urlsKeyed:h,searchTerm:b,launchUrl:c,editUrlIndex:g,isAddUrlFormVisible:v,onlyAllowDomains:m,manualLaunchParamsLoading:I}=(0,d.useValues)(l),{addUrl:L,removeUrl:f,setSearchTerm:J,newUrl:V,setEditUrlIndex:X,copyLaunchCode:j}=(0,d.useActions)(l),z=!h.some(o=>o.type==="authorized");return(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"flex items-center mb-4 gap-2 justify-between",children:[(0,e.jsx)(N,{placeholder:`Search for authorized ${m?"domains":"URLs"}`,onChange:J,value:b,className:"w-full"}),(0,e.jsx)(r,{onClick:V,type:"secondary",icon:(0,e.jsx)(A,{}),"data-attr":"toolbar-add-url",children:u})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(Z,{experimentId:a,actionId:i,type:t}),v&&(0,e.jsx)("div",{className:"border rounded p-2 bg-surface-primary",children:(0,e.jsx)(_,{type:t,actionId:i,experimentId:a,allowWildCards:s})}),h.map((o,x)=>{let U=o.originalIndex===0&&o.type==="suggestion";return g===x?(0,e.jsx)("div",{className:"border rounded p-2 bg-surface-primary",children:(0,e.jsx)(_,{type:t,actionId:i,experimentId:a,allowWildCards:s})}):(0,e.jsxs)("div",{className:(0,$.default)("border rounded flex items-center p-2 pl-4 bg-surface-primary"),children:[o.type==="suggestion"&&(0,e.jsx)(F,{title:"Seen in "+o.count+" events in the last 3 days",children:(0,e.jsx)(K,{type:"highlight",className:"mr-4 uppercase cursor-pointer",children:"Suggestion"})}),(0,e.jsx)("span",{title:o.url,className:"flex-1 truncate",children:o.url}),(0,e.jsx)("div",{className:"Actions flex space-x-2 shrink-0",children:o.type==="suggestion"?(0,e.jsx)(r,{onClick:()=>L(o.url),icon:(0,e.jsx)(A,{}),"data-attr":"toolbar-apply-suggestion",type:z&&U?"primary":void 0,active:z&&U,children:"Apply suggestion"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r,{icon:(0,e.jsx)(E,{}),to:t==="TOOLBAR_URLS"?c(o.url):`${o.url}${n??""}`,targetBlank:!0,tooltip:t==="TOOLBAR_URLS"?"Launch toolbar":"Launch url",center:!0,"data-attr":"toolbar-open",type:"secondary",disabledReason:o.url.includes("*")?"Wildcard domains cannot be launched":void 0,sideAction:{dropdown:{placement:"bottom-start",overlay:(0,e.jsxs)("div",{className:"px-2 py-1",children:[(0,e.jsx)("h3",{children:"If launching the toolbar didn't work, "}),(0,e.jsx)("p",{children:"You can copy the launch code and paste it into the browser console on your site."}),(0,e.jsx)("p",{children:"NB you need to have added posthog to the `window`"}),(0,e.jsx)(r,{icon:(0,e.jsx)(O,{}),size:"small",className:"float-right",type:"primary","data-attr":"copy-manual-toolbar-launch-code",onClick:()=>{j(o.url)},loading:I,children:"Copy launch code"})]})},"data-attr":"launch-toolbar-sideaction-dropdown"},children:"Launch"}),(0,e.jsx)(r,{icon:(0,e.jsx)(R,{}),onClick:()=>X(o.originalIndex),tooltip:"Edit",center:!0}),(0,e.jsx)(r,{icon:(0,e.jsx)(P,{}),tooltip:`Remove ${m?"domain":"URL"}`,center:!0,onClick:()=>{D.open({title:(0,e.jsxs)(e.Fragment,{children:["Remove ",o.url," ?"]}),description:`Are you sure you want to remove this authorized ${m?"domain":"URL"}?`,primaryButton:{status:"danger",children:"Remove",onClick:()=>f(x)},secondaryButton:{children:"Cancel"}})}})]})})]},x)})]})]})}export{pe as a};
//# sourceMappingURL=/static/chunk-ZDFMFKTJ.js.map
