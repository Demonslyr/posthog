import{a as Z}from"/static/chunk-W7KYDQXK.js";import{a as j,b as p,c as q}from"/static/chunk-OQXRQEHG.js";import{a as z,o as W,p as Y}from"/static/chunk-CDTERFC5.js";import"/static/chunk-LZWHW4MC.js";import"/static/chunk-RSTRTBMR.js";import"/static/chunk-DYVMG6MY.js";import{d as $}from"/static/chunk-44P5EQSU.js";import"/static/chunk-GH3IWF3M.js";import{j as R}from"/static/chunk-CBJ7RAUW.js";import"/static/chunk-XSEDUXPL.js";import"/static/chunk-HRNZBUVG.js";import"/static/chunk-OKGJSIGC.js";import{j as T}from"/static/chunk-NKVVAJQ7.js";import"/static/chunk-2HTNY362.js";import"/static/chunk-S27Q4QO6.js";import"/static/chunk-JUFFFVO5.js";import"/static/chunk-JZCOVRBI.js";import{b as H,d as U,f as K}from"/static/chunk-EIJECEWK.js";import{Ae as Q,Do as u,Lh as _,Ne as A,Nk as V,No as ee,Sd as E,Ta as y,Vh as G,Wd as I,Zo as te,a as D,ch as B,f as fe,fb as F,fi as J,h as k,me as O,pg as P,r as v,vo as X}from"/static/chunk-RFJTZKD6.js";import"/static/chunk-XPJ4MQJV.js";import"/static/chunk-KQJ3FYBQ.js";import{a as be}from"/static/chunk-3UDJFOQH.js";import"/static/chunk-HHT4SG7V.js";import"/static/chunk-K7LQKAJG.js";import"/static/chunk-QQTK3LZH.js";import"/static/chunk-IJQNM355.js";import"/static/chunk-4CN6THWS.js";import"/static/chunk-272RTCFX.js";import"/static/chunk-2ROB4QWU.js";import"/static/chunk-ALT2ZZSO.js";import"/static/chunk-UE6SLBBN.js";import"/static/chunk-GINZUAUY.js";import"/static/chunk-SQELCOUW.js";import"/static/chunk-IGYUTZ65.js";import"/static/chunk-YM6UBNGD.js";import"/static/chunk-C6TQ5FFZ.js";import"/static/chunk-GXGA523B.js";import"/static/chunk-N4MMWRNK.js";import"/static/chunk-NRLAI7OY.js";import"/static/chunk-LVVHNICT.js";import"/static/chunk-2AXSSSSX.js";import"/static/chunk-DGXQI7RB.js";import"/static/chunk-HUCRWDLX.js";import"/static/chunk-RFEQG3YN.js";import"/static/chunk-PUISI233.js";import{d as l,e as h,g as L,j as C}from"/static/chunk-SJXEOBQC.js";h();C();L();var ue=l(k()),c=l(D()),b=l(fe());h();C();L();var se=l(k()),ie=l(D());var x=l(be());var m=l(v()),ae=x.default.forwardRef(function({query:t,title:i,description:s,context:a,highlighted:r,ribbonColor:d,className:f,...g},N){let{theme:S}=(0,ie.useValues)(A),[ge,ye]=(0,x.useState)(!1);return(0,m.jsx)("div",{className:(0,se.default)("InsightCard border",r&&"InsightCard--highlighted",f),"data-attr":"insight-card",...g,style:{...g?.style??{},...S?.boxStyle??{}},ref:N,children:(0,m.jsxs)(J,{tags:{feature:"insight"},children:[(0,m.jsx)(z,{ribbonColor:d,setAreDetailsShown:ye,areDetailsShown:ge,topHeading:(0,m.jsx)(W,{query:t}),content:(0,m.jsx)(Y,{title:i,description:s}),metaDetails:(0,m.jsx)($,{query:t}),samplingFactor:"samplingFactor"in t&&typeof t.samplingFactor=="number"?t.samplingFactor:void 0,moreButtons:(0,m.jsx)(O,{items:[{label:"Open as new insight",to:u.insightNew({query:t})}]}),showEditingControls:!0}),(0,m.jsx)("div",{className:"InsightCard__viz",children:(0,m.jsx)(R,{query:t,readOnly:!0,embedded:!0,context:a})})]})})});h();C();L();var w=l(D());var n=l(v());function le(){let{setDates:o,setShouldFilterTestAccounts:t,setPropertyFilters:i}=(0,w.useActions)(p),{tracesQuery:s}=(0,w.useValues)(p);return(0,n.jsx)(T,{query:s,setQuery:a=>{if(!te(a.source))throw new Error("Invalid query");o(a.source.dateRange?.date_from||null,a.source.dateRange?.date_to||null),t(a.source.filterTestAccounts||!1),i(a.source.properties||[])},context:{emptyStateHeading:"There were no traces in this period",emptyStateDetail:"Try changing the date range or filters.",columns:{id:{title:"ID",render:he},timestamp:{title:"Time",render:me},person:{title:"Person"},totalLatency:{title:"Latency",render:ce},usage:{title:"Token Usage",render:de},totalCost:{title:"Total Cost",render:pe}}},uniqueKey:"llm-observability-traces"})}var he=({record:o})=>{let t=o;return(0,n.jsx)("strong",{children:(0,n.jsxs)(y,{className:"ph-no-capture",to:u.llmObservabilityTrace(t.id,{timestamp:K(t.createdAt)}),children:[t.id.slice(0,4),"...",t.id.slice(-4)]})})},me=({record:o})=>(0,n.jsx)(B,{time:o.createdAt});me.displayName="TimestampColumn";var ce=({record:o})=>{let t=o;return typeof t.totalLatency=="number"?(0,n.jsxs)(n.Fragment,{children:[t.totalLatency,"s"]}):(0,n.jsx)(n.Fragment,{children:"\u2013"})};ce.displayName="LatencyColumn";var de=({record:o})=>{let i=H(o);return(0,n.jsx)(n.Fragment,{children:i||"\u2013"})};de.displayName="UsageColumn";var pe=({record:o})=>{let t=o;return typeof t.totalCost=="number"?(0,n.jsx)(n.Fragment,{children:U(t.totalCost)}):(0,n.jsx)(n.Fragment,{children:"\u2013"})};pe.displayName="CostColumn";var e=l(v()),ut={component:we},Le=()=>{let{dashboardDateFilter:o,dateFilter:t,shouldFilterTestAccounts:i,generationsQuery:s,propertyFilters:a,activeTab:r}=(0,c.useValues)(p),{setDates:d,setShouldFilterTestAccounts:f,setPropertyFilters:g}=(0,c.useActions)(p),N=r==="dashboard"?o.dateFrom:t.dateFrom,S=r==="dashboard"?o.dateTo:t.dateTo;return(0,e.jsxs)("div",{className:"flex gap-x-4 gap-y-2 items-center flex-wrap py-4 -mt-4 mb-4 border-b",children:[(0,e.jsx)(P,{dateFrom:N,dateTo:S,onChange:d}),(0,e.jsx)(_,{propertyFilters:a,taxonomicGroupTypes:s.showPropertyFilter,onChange:g,pageKey:"llm-observability"}),(0,e.jsx)("div",{className:"flex-1"}),(0,e.jsx)(V,{checked:i,onChange:f})]})},Ce=()=>{let{tiles:o}=(0,c.useValues)(p);return(0,e.jsx)("div",{className:"mt-2 grid grid-cols-1 @xl/dashboard:grid-cols-2 @4xl/dashboard:grid-cols-6 gap-4",children:o.map(({title:t,description:i,query:s,context:a},r)=>(0,e.jsx)(ae,{title:t,description:i,query:{kind:"InsightVizNode",source:s},context:a,className:(0,ue.default)("h-96",r<3||r>=5?"@4xl/dashboard:col-span-2":"@4xl/dashboard:col-span-3")},r))})},ve=()=>(0,e.jsxs)(I,{type:"warning",className:"mt-2",children:[(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:"No LLM generation events have been detected!"})}),(0,e.jsxs)("p",{children:["To use the LLM Observability product, please"," ",(0,e.jsx)(y,{to:"https://posthog.com/docs/ai-engineering/observability",children:"instrument your LLM calls with the PostHog SDK"})," ","(otherwise it'll be a little empty!)"]})]});function Te(){return(0,e.jsxs)("div",{className:"@container/dashboard",children:[(0,e.jsx)(Le,{}),(0,e.jsx)(Ce,{})]})}function xe(){let{setDates:o,setShouldFilterTestAccounts:t,setPropertyFilters:i,setGenerationsQuery:s}=(0,c.useActions)(p),{generationsQuery:a}=(0,c.useValues)(p);return(0,e.jsx)(T,{query:a,setQuery:r=>{if(!ee(r.source))throw new Error("Invalid query");o(r.source.after||null,r.source.before||null),t(r.source.filterTestAccounts||!1),i(r.source.properties||[]),s(r)},context:{emptyStateHeading:"There were no generations in this period",emptyStateDetail:"Try changing the date range or filters.",columns:{uuid:{title:"ID",render:({record:r,value:d})=>{let f=r[2];if(!d)return(0,e.jsx)(e.Fragment,{});let g=d.slice(0,4)+"..."+d.slice(-4);return f?(0,e.jsx)("strong",{children:(0,e.jsx)(y,{to:`/llm-observability/traces/${f}?event=${d}`,children:g})}):(0,e.jsx)("strong",{children:g})}},"properties.$ai_trace_id":{title:"Trace ID",render:({value:r})=>{if(!r)return(0,e.jsx)(e.Fragment,{});let d=r.slice(0,4)+"..."+r.slice(-4);return(0,e.jsx)(y,{to:`/llm-observability/traces/${r}`,children:d})}}}},uniqueKey:"llm-observability-generations"})}function M(){return(0,e.jsx)("div",{className:"w-full flex flex-col items-center justify-center",children:(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center max-w-md w-full",children:[(0,e.jsx)(F,{className:"text-5xl mb-2 text-muted-alt"}),(0,e.jsx)("h2",{className:"text-xl leading-tight",children:"We haven't detected any LLM generations yet"}),(0,e.jsxs)("p",{className:"text-sm text-center text-balance",children:["To use the LLM Observability product, please"," ",(0,e.jsx)(y,{to:"https://posthog.com/docs/ai-engineering/observability",children:"instrument your LLM calls with the PostHog SDK"})," "]})]})})}function we(){let{activeTab:o,hasSentAiGenerationEvent:t,hasSentAiGenerationEventLoading:i}=(0,c.useValues)(p),{searchParams:s}=(0,c.useValues)(b.router);return(0,e.jsxs)(c.BindLogic,{logic:G,props:{key:j},children:[(0,e.jsx)(X,{buttons:(0,e.jsx)(E,{to:"https://posthog.com/docs/ai-engineering/observability",type:"secondary",targetBlank:!0,children:"Documentation"})}),i?null:t?(0,e.jsx)(Z,{text:"LLM observability is currently in beta. Thanks for taking part! We'd love to hear what you think."}):(0,e.jsx)(ve,{}),(0,e.jsx)(Q,{activeKey:o,tabs:[{key:"dashboard",label:"Dashboard",content:(0,e.jsx)(Te,{}),link:(0,b.combineUrl)(u.llmObservabilityDashboard(),s).url},{key:"traces",label:"Traces",content:t?(0,e.jsx)(le,{}):(0,e.jsx)(M,{}),link:(0,b.combineUrl)(u.llmObservabilityTraces(),s).url},{key:"generations",label:"Generations",content:t?(0,e.jsx)(xe,{}):(0,e.jsx)(M,{}),link:(0,b.combineUrl)(u.llmObservabilityGenerations(),s).url},{key:"users",label:"Users",content:t?(0,e.jsx)(q,{}):(0,e.jsx)(M,{}),link:(0,b.combineUrl)(u.llmObservabilityUsers(),s).url}]})]})}export{we as LLMObservabilityScene,ut as scene};
//# sourceMappingURL=/static/LLMObservabilityScene-7RID2SD3.js.map
