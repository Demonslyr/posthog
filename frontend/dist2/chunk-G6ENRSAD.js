import{$a as q,Do as I,Eo as _,Io as h,Jb as E,Ko as L,Ne as k,Oe as x,Vd as N,Za as G,_e as D,a as b,b as O,ec as v,f as X,m as $,mi as w,pe as j,r as y,xc as z,zc as C}from"/static/chunk-RFJTZKD6.js";import{F as T,ob as F}from"/static/chunk-3UDJFOQH.js";import{d as i,e as m,g as l,j as d}from"/static/chunk-SJXEOBQC.js";m();d();l();var u=i(b()),A=i(X());var r=i(y());function se({onlyLabel:e,...o}){let{themeMode:s}=(0,u.useValues)(_),{updateUser:c}=(0,u.useActions)(_),{customCssEnabled:n}=(0,u.useValues)(k),p=[{options:[{icon:(0,r.jsx)(E,{}),value:"light",label:"Light mode"},{icon:(0,r.jsx)(z,{}),value:"dark",label:"Dark mode"},{icon:(0,r.jsx)(v,{}),value:"system",label:"Sync with system"}]}];return n&&p.push({options:[{icon:(0,r.jsx)(C,{}),value:"custom",label:"Edit custom CSS"}]}),(0,r.jsx)(j,{options:p,value:s,renderButtonContent:a=>{let S=a?a.label:"Sync with system";return e?S:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("span",{className:"flex-1 flex justify-between items-baseline gap-4",children:[(0,r.jsx)("span",{children:"Color theme"}),(0,r.jsx)("span",{className:"font-normal text-xs",children:a?a.label:"Sync with system"})]})})},onChange:a=>{a==="custom"?A.router.actions.push(I.customCss()):c({theme_mode:a})},dropdownPlacement:"right-start",dropdownMatchSelectWidth:!1,...o})}m();d();l();var g=i(b());m();d();l();var t=i(b()),B=i(q()),H=i(G());var U=(0,t.kea)([(0,t.path)(["scenes","project","Settings","proxyLogic"]),(0,t.connect)({values:[D,["currentOrganization"]]}),(0,t.actions)(()=>({collapseForm:!0,showForm:!0,completeForm:!0,maybeRefreshRecords:!0})),(0,t.reducers)(()=>({formState:["collapsed",{showForm:()=>"active",collapseForm:()=>"collapsed",completeForm:()=>"complete"}]})),(0,H.loaders)(({values:e,actions:o})=>({proxyRecords:{__default:[],loadRecords:async()=>await h.get(`api/organizations/${e.currentOrganization?.id}/proxy_records`),createRecord:async({domain:s})=>{let c=await h.create(`api/organizations/${e.currentOrganization?.id}/proxy_records`,{domain:s});return N.success("Record created"),o.completeForm(),[c,...e.proxyRecords]},deleteRecord:async s=>(h.delete(`api/organizations/${e.currentOrganization?.id}/proxy_records/${s}`),[...e.proxyRecords].map(n=>({...n,status:n.id===s?"deleting":n.status})))}})),(0,t.selectors)(()=>({shouldRefreshRecords:[e=>[e.proxyRecords],e=>e.some(o=>["waiting","issuing","deleting"].includes(o.status))]})),(0,t.listeners)(({actions:e,values:o})=>({collapseForm:()=>e.loadRecords(),deleteRecordFailure:()=>e.loadRecords(),createRecordSuccess:()=>e.loadRecords(),maybeRefreshRecords:()=>{o.shouldRefreshRecords&&e.loadRecords()}})),(0,B.forms)(({actions:e})=>({createRecord:{defaults:{domain:""},errors:({domain:o})=>({domain:o.includes("*")?"Domains cannot include wildcards":F("http://"+o)?o.match(/^[a-z0-9](?:[a-z0-9.-]*[a-z0-9])?$/)?void 0:"Invalid domain. Please provide a lowercase RFC 1123 subdomain. It must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character":"Do not include the protocol e.g. https://"}),submit:({domain:o})=>{e.createRecord({domain:o})}}})),(0,t.afterMount)(({actions:e,cache:o})=>{e.loadRecords(),o.refreshTimeout=setInterval(()=>e.maybeRefreshRecords(),5e3)}),(0,t.beforeUnmount)(({cache:e})=>{e.refreshTimeout&&clearTimeout(e.refreshTimeout)})]);var P=i(y());function K(e="/static/array.js"){let o=[],s=Object.getPrototypeOf(O);for(let n of Object.getOwnPropertyNames(s))typeof s[n]=="function"&&!n.startsWith("_")&&!["constructor","toString","push"].includes(n)&&o.push(n);let c=o.join(" ");return`!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"${e}",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="${c}".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);`}function Q(e){if(!e)return w();let o=e.domain;return o.startsWith("https://")||(o=`https://${o}`),o}function W(e=0,o){let{currentTeam:s}=(0,g.useValues)(L),{featureFlags:c}=(0,g.useValues)($),{proxyRecords:n}=(0,g.useValues)(U),p=n[0],a=c[T.PERSONLESS_EVENTS_NOT_SUPPORTED],S={api_host:{content:Q(p),comment:p?"your managed reverse proxy domain":void 0,enabled:!0},ui_host:{content:w(),comment:"neccessary because you're using a proxy, this way links will point back to PostHog properly",enabled:!!p},person_profiles:{content:"identified_only",comment:"or 'always' to create profiles for anonymous users as well",enabled:!a}};return["<script>",`    ${K(o)}`,`    posthog.init('${s?.api_token}', {`,...Object.entries(S).map(([R,f])=>{if(f.enabled)return`        ${R}: '${f.content}',${f.comment?` // ${f.comment}`:""}`}).filter(Boolean),"    })","<\/script>"].map(R=>" ".repeat(e)+R).join(`
`)}function Te(){let e=W();return(0,P.jsx)(x,{language:"html",children:e})}function Fe(){let{currentTeam:e}=(0,g.useValues)(L),o=W(0,`/array/${e?.api_token}/array.js`);return(0,P.jsx)(x,{language:"html",children:o})}export{U as a,W as b,Te as c,Fe as d,se as e};
//# sourceMappingURL=/static/chunk-G6ENRSAD.js.map
