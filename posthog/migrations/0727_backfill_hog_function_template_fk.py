# Generated by Django 4.2.18 on 2025-05-06 17:46

from django.db import migrations


def backfill_hog_function_template_fk(apps, schema_editor):
    HogFunction = apps.get_model("posthog", "HogFunction")
    HogFunctionTemplate = apps.get_model("posthog", "HogFunctionTemplate")

    for hog_function in HogFunction.objects.all():
        if hog_function.template_id:
            try:
                template = HogFunctionTemplate.objects.get(template_id=hog_function.template_id)
                hog_function.hog_function_template = template
                hog_function.save(update_fields=["hog_function_template"])
            except HogFunctionTemplate.DoesNotExist:
                pass


class Migration(migrations.Migration):
    dependencies = [
        ("posthog", "0726_add_hog_function_template_as_fk_to_hog_function"),
    ]

    operations = [
        migrations.RunPython(backfill_hog_function_template_fk, reverse_code=migrations.RunPython.noop),
    ]
