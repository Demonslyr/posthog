#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

protected_branch='master'
current_branch=$(git branch --show-current)

if [ $protected_branch = $current_branch ]
then
    echo "Pushing to $protected_branch is a sin! Instead, create a pull request and repent."
    exit 1 # push will not execute
fi

echo "Running mypy checks..."
flox activate -- pnpm mypy-check
if [ $? -ne 0 ]; then
    echo "MyPy checks failed. Please fix the issues before pushing."
    exit 1
fi

echo "All checks passed!"
exit 0
